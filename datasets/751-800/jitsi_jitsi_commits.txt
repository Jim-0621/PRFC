File: modules/impl/dns/src/main/java/net/java/sip/communicator/impl/dns/DnsJavaLogger.java
Patch:
@@ -70,8 +70,8 @@ private void logInternal(SocketAddress local,
                     String prefix, byte[] data)
     {
         if(packetLoggingService == null
-            || !(local instanceof InetSocketAddress
-                && remote instanceof InetSocketAddress))
+            || !(local instanceof InetSocketAddress && remote instanceof InetSocketAddress)
+            || !packetLoggingService.isLoggingEnabled(PacketLoggingService.ProtocolName.DNS))
         {
             return;
         }

File: modules/impl/replacement/src/main/java/net/java/sip/communicator/impl/replacement/ReplacementActivator.java
Patch:
@@ -60,7 +60,6 @@ public void startWithServices(BundleContext context)
         registerService(context, new Metacafe());
         registerService(context, new Twitpic());
         registerService(context, new Vbox7());
-        registerService(context, new Viddler());
         registerService(context, new Vimeo());
         registerService(context, new Youtube());
         registerService(context, new ReplacementServiceSmileyImpl());

File: modules/impl/protocol-jabber/src/main/java/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1221,6 +1221,8 @@ private ConnectState connectAndLogin(
         {
             // install all trust manager
             confConn.setCustomX509TrustManager(new TrustAllX509TrustManager());
+            // install all hosts verified
+            confConn.setHostnameVerifier((hostname, session) -> true);
         }
         else
         {

File: modules/plugin/otr/src/main/java/net/java/sip/communicator/plugin/otr/ScOtrEngineImpl.java
Patch:
@@ -1022,7 +1022,7 @@ public boolean isMessageUIDInjected(String mUID)
     @Override
     public void launchHelp()
     {
-        ServiceReference ref =
+        ServiceReference<?> ref =
             OtrActivator.bundleContext
                 .getServiceReference(BrowserLauncherService.class.getName());
 

File: modules/plugin/otr/src/main/java/net/java/sip/communicator/plugin/otr/authdialog/OtrBuddyAuthenticationDialog.java
Patch:
@@ -81,8 +81,8 @@ private void initComponents()
                 "plugin.otr.authbuddydialog.AUTHENTICATION_METHOD_SECRET"),
             OtrActivator.resourceService.getI18NString(
                 "plugin.otr.authbuddydialog.AUTHENTICATION_METHOD_FINGERPRINT")};
-        final JComboBox authenticationMethodComboBox =
-            new JComboBox(am);
+        final JComboBox<String> authenticationMethodComboBox =
+            new JComboBox<String>(am);
         JTextArea authMethodLabel = new CustomTextArea();
         authMethodLabel.setText(
                 OtrActivator.resourceService.getI18NString(
@@ -92,7 +92,7 @@ private void initComponents()
         mainPanel.add(Box.createVerticalStrut(10));
 
         // Add authentication panels in a card layout so that the user can
-        // use the combo box to switch between authentication methods. 
+        // use the combo box to switch between authentication methods.
         final JPanel authenticationPanel =
             new TransparentPanel(new CardLayout());
         final FingerprintAuthenticationPanel fingerprintPanel =

File: modules/impl/protocol-jabber/src/test/java/TestOperationSetMultiUserChat2.java
Patch:
@@ -1577,7 +1577,7 @@ public void testRevokeVoice()
         MUCEventCollector roomUser2Col = new MUCEventCollector(
             roomUser2, MUCEventCollector.EVENT_ROLE);
 
-        // User2 (moderator role) revokes voice right to user2 (guest):
+        // User2 (moderator role) revokes voice right to user3 (guest):
         roomUser2.revokeVoice(fixture.userID3);
 
         roomUser1Col.waitForEvent(10000);

File: modules/impl/gui/src/main/java/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -1882,7 +1882,7 @@ protected void windowClosed(WindowEvent event)
             }
             catch (BundleException ex)
             {
-                logger.error("Failed to gently shutdown Felix", ex);
+                logger.error("Failed to gently shutdown", ex);
                 System.exit(0);
             }
             //stopping a bundle doesn't leave the time to the felix thread to

File: modules/impl/neomedia/src/main/java/net/java/sip/communicator/impl/neomedia/video/VideoDeviceTab.java
Patch:
@@ -150,7 +150,7 @@ private void createVideoPreview(CaptureDeviceInfo device)
                 device))
             {
                 Dimension videoContainerSize
-                    = previewContainer.getPreferredSize();
+                    = previewContainer.getSize();
                 Component preview
                     = (Component)
                     mediaService.getVideoPreviewComponent(

File: modules/impl/packetlogging/src/main/java/net/java/sip/communicator/impl/packetlogging/PacketLoggingServiceImpl.java
Patch:
@@ -817,6 +817,8 @@ public void run()
                         }
                         catch (InterruptedException iex)
                         {
+                            Thread.currentThread().interrupt();
+                            break;
                         }
                         continue;
                     }

File: modules/impl/version/src/main/java/net/java/sip/communicator/impl/version/VersionServiceImpl.java
Patch:
@@ -48,10 +48,11 @@ public VersionServiceImpl()
         String prerelease = "unknown";
         Properties p = new Properties();
         try (InputStream is = VersionServiceImpl.class
-            .getResourceAsStream("/version.properties"))
+            .getResourceAsStream("version.properties"))
         {
             p.load(is);
-            applicationName = p.getProperty("version.name");
+            applicationName = Objects.requireNonNullElse(
+                p.getProperty("version.name"), applicationName);
             versionMajor = Integer.parseInt(p.getProperty("version.major"));
             versionMinor = Integer.parseInt(p.getProperty("version.minor"));
             versionBuildId = p.getProperty("version.buildId");

File: modules/launcher/src/main/java/net/java/sip/communicator/argdelegation/ArgDelegationPeerImpl.java
Patch:
@@ -15,7 +15,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package net.java.sip.communicator.impl.argdelegation;
+package net.java.sip.communicator.argdelegation;
 
 import java.util.*;
 

File: modules/launcher/src/main/java/net/java/sip/communicator/launcher/ShutdownTimeout.java
Patch:
@@ -15,7 +15,7 @@
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */
-package net.java.sip.communicator.impl.shutdowntimeout;
+package net.java.sip.communicator.launcher;
 
 import net.java.sip.communicator.launchutils.*;
 import org.osgi.framework.*;
@@ -72,7 +72,7 @@ private static void runInShutdownTimeoutThread()
 
             if ((s != null) && (s.length() > 0))
             {
-                long l = Long.valueOf(s);
+                long l = Long.parseLong(s);
 
                 // Make sure custom is not 0 to prevent waiting forever.
                 if (l > 0)

File: modules/plugin/googletalkaccregwizz/src/main/java/net/java/sip/communicator/plugin/googletalkaccregwizz/GoogleTalkAccRegWizzActivator.java
Patch:
@@ -37,9 +37,8 @@ public class GoogleTalkAccRegWizzActivator
      * Starts this bundle.
      */
     @Override
-    public void startWithServices(BundleContext context)
+    public void init(BundleContext context)
     {
-        super.startWithServices(context);
         UIService uiService = getService(UIService.class);
 
         GoogleTalkAccountRegistrationWizard wizard =

File: modules/service/desktop/src/main/java/net/java/sip/communicator/impl/osdependent/systemtray/appindicator/AppIndicator1.java
Patch:
@@ -30,7 +30,7 @@
 interface AppIndicator1 extends Library
 {
     AppIndicator1 INSTANCE =
-        Native.load("appindicator", AppIndicator1.class);
+        Native.load("ayatana-appindicator", AppIndicator1.class);
 
     String APP_INDICATOR_SIGNAL_NEW_ICON            = "new-icon";
     String APP_INDICATOR_SIGNAL_NEW_ATTENTION_ICON  = "new-attention-icon";
@@ -143,7 +143,7 @@ class AppIndicator extends Structure
         public Pointer priv;
 
         @Override
-        protected List getFieldOrder()
+        protected List<String> getFieldOrder()
         {
             return Arrays.asList("parent", "priv");
         }

File: modules/impl/protocol-sip/src/main/java/net/java/sip/communicator/impl/protocol/sip/SipLogger.java
Patch:
@@ -157,8 +157,7 @@ public void logDebug(String message)
                     {
                         try
                         {
-                            ((ProtocolProviderServiceSipImpl)pps).fireRegistrationStateChanged(
-                                pps.getRegistrationState(),
+                            ((ProtocolProviderServiceSipImpl)pps).getRegistrarConnection().setRegistrationState(
                                 RegistrationState.CONNECTION_FAILED,
                                 RegistrationStateChangeEvent.REASON_NOT_SPECIFIED,
                                 message);

File: modules/impl/protocol-sip/src/main/java/net/java/sip/communicator/impl/protocol/sip/SipRegistrarConnection.java
Patch:
@@ -245,7 +245,7 @@ void setTransport(String newRegistrationTransport)
     * @throws OperationFailedException with the corresponding error code
     * if registration or construction of the Register request fail.
     */
-    void register()
+    public void register()
         throws OperationFailedException
     {
         // skip REGISTERING event if we are already registered

File: modules/impl/protocol-sip/src/main/java/net/java/sip/communicator/impl/protocol/sip/SipRegistrarlessConnection.java
Patch:
@@ -75,7 +75,7 @@ public SipRegistrarlessConnection(
      * @throws OperationFailedException never thrown
      */
     @Override
-    void register()
+    public void register()
         throws OperationFailedException
     {
         setRegistrationState(RegistrationState.REGISTERED,

File: modules/impl/protocol-sip/src/main/java/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -1059,7 +1059,8 @@ else if (peerState.equals(CallPeerState.FAILED))
         else
         {
             setDisconnectedState(failed, reason);
-            logger.error("Could not determine call peer state!");
+            logger.error("Could not determine call peer state (" + peerState
+                + ")! Reason:" + reason + ", ReasonCode:" + reasonCode);
         }
     }
 

File: modules/impl/protocol-jabber/src/main/java/net/java/sip/communicator/impl/protocol/jabber/OperationSetJitsiMeetToolsJabberImpl.java
Patch:
@@ -60,7 +60,7 @@ public OperationSetJitsiMeetToolsJabberImpl(
     @Override
     public void addSupportedFeature(String featureName)
     {
-        parentProvider.getDiscoveryManager().addFeature(featureName);
+        parentProvider.addSupportedFeature(featureName);
     }
 
     /**

File: modules/impl/protocol-jabber/src/main/java/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -566,7 +566,7 @@ public EntityBareJid getIdentifierAsJid()
      */
     public String getUserNickname()
     {
-        return multiUserChat.getNickname().toString();
+        return multiUserChat.getNickname() == null ? null : multiUserChat.getNickname().toString();
     }
 
     /**

File: modules/impl/protocol-jabber/src/main/java/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -1022,7 +1022,7 @@ private void processJingleIQ(final JingleIQ jingleIQ)
 
                 OperationSetJitsiMeetToolsJabberImpl operationSetJitsiMeetTools
                     = (OperationSetJitsiMeetToolsJabberImpl)protocolProvider
-                        .getOperationSet(OperationSetJitsiMeetTools.class);
+                        .getOperationSet(OperationSetJitsiMeetToolsJabber.class);
 
                 if (operationSetJitsiMeetTools != null)
                 {

File: modules/impl/protocol-jabber/src/main/java/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -56,6 +56,7 @@
 import org.jxmpp.jid.impl.*;
 import org.jxmpp.jid.parts.*;
 import org.jxmpp.stringprep.XmppStringprepException;
+import org.minidns.dnsname.*;
 import org.xmlpull.v1.*;
 import org.xmpp.jnodes.smack.*;
 
@@ -1162,7 +1163,7 @@ private ConnectState connectAndLogin(
                     .setUseHttps(useHttps)
                     .setFile(file)
                     .setPort(port)
-                    .setHost(boshURI.getHost())
+                    .setHost(DnsName.from(boshURI.getHost()))
                     .setProxyInfo(proxy);
             }
             catch (URISyntaxException e)

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1000,7 +1000,7 @@ private ConnectState connectAndLogin(InetSocketAddress currentAddress,
             | InterruptedException
             | SmackException ex)
         {
-            logger.error("Failed to connect to XMPP service", ex);
+            logger.error("Failed to connect to XMPP service for:" + this, ex);
 
             // server disconnect us after such an error, do cleanup
             // as we maybe will try again

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -747,7 +747,7 @@ public boolean uninstallAccount(AccountID accountID)
 
             try
             {
-                protocolProvider.unregister();
+                protocolProvider.unregister(true);
             }
             catch (OperationFailedException ex)
             {

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -1031,7 +1031,8 @@ private void leave(String reason, EntityBareJid alternateAddress)
         {
             // if we are already disconnected
             // leave maybe called from gui when closing chat window
-            if(connection != null && connection.isConnected())
+            // skip leave if not joined, this is in case of an error, but we call leave to clear listeners and such
+            if(connection != null && connection.isConnected() && multiUserChat.isJoined())
                 multiUserChat.leave();
         }
         catch(Throwable e)

File: modules/service/certificate/src/main/java/net/java/sip/communicator/service/certificate/CertificateMatcher.java
Patch:
@@ -33,6 +33,6 @@ public interface CertificateMatcher
      *            client.
      * @throws CertificateException When any certificate parsing fails.
      */
-    public void verify(Iterable<String> identitiesToTest, X509Certificate cert)
+    void verify(Iterable<String> identitiesToTest, X509Certificate cert)
         throws CertificateException;
 }

File: modules/service/httputil/src/main/java/net/java/sip/communicator/service/httputil/HttpUtils.java
Patch:
@@ -35,6 +35,7 @@
 import org.apache.http.client.config.*;
 import org.apache.http.client.methods.*;
 import org.apache.http.client.utils.*;
+import org.apache.http.conn.ssl.*;
 import org.apache.http.entity.*;
 import org.apache.http.entity.mime.*;
 import org.apache.http.impl.client.*;
@@ -435,6 +436,8 @@ public static CloseableHttpClient getHttpClient(
         return HttpClientBuilder.create()
             .setUserAgent(userAgent)
             .setSSLContext(sslCtx)
+            // The custom SSLContext already takes care of validating the hostname
+            .setSSLHostnameVerifier(new NoopHostnameVerifier())
             .setDefaultRequestConfig(RequestConfig.copy(RequestConfig.DEFAULT)
                 .setSocketTimeout(10_000)
                 .setConnectTimeout(10_000)

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -960,6 +960,8 @@ public void processTransactionTerminated(TransactionTerminatedEvent
                 }
             }
         }
+
+        getSipSecurityManager().handleTransactionTerminate(transaction);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/security/CredentialsCacheEntry.java
Patch:
@@ -39,7 +39,7 @@ class CredentialsCacheEntry
      * has not reached this class). The transactionHistory's elements are
      * <tt>String</tt>s corresponding to branch id-s.
      */
-    private Vector<String> transactionHistory = new Vector<String>();
+    private List<String> transactionHistory = new ArrayList<>();
 
     /**
      * Adds the specified branch id to the transaction history list so that we

File: modules/impl/neomedia/src/main/java/net/java/sip/communicator/impl/neomedia/EncodingConfigurationTab.java
Patch:
@@ -84,7 +84,7 @@ public Component getTableCellRendererComponent(JTable rtable,
         downButton = new JButton(resources.getI18NString(downKey));
         downButton.setMnemonic(resources.getI18nMnemonic(downKey));
         downButton.setOpaque(false);
-        upButton.addActionListener(e -> move(false));
+        downButton.addActionListener(e -> move(false));
 
         Container buttonBar = new TransparentPanel(new GridLayout(0, 1));
         buttonBar.add(upButton);

File: modules/impl/sparkle/src/main/java/net/java/sip/communicator/impl/sparkle/SparkleActivator.java
Patch:
@@ -17,6 +17,7 @@
  */
 package net.java.sip.communicator.impl.sparkle;
 
+import lombok.extern.slf4j.*;
 import net.java.sip.communicator.util.osgi.*;
 import org.jitsi.service.configuration.*;
 import org.jitsi.service.resources.*;
@@ -27,11 +28,10 @@
  *
  * @author Romain Kuntz
  */
+@Slf4j
 public class SparkleActivator
     extends DependentActivator
 {
-    private static final org.slf4j.Logger logger = org.slf4j.LoggerFactory.getLogger(SparkleActivator.class);
-
     /**
      * Native method declaration
      *

File: modules/impl/shutdowntimeout/src/main/java/net/java/sip/communicator/impl/shutdowntimeout/ShutdownTimeout.java
Patch:
@@ -17,6 +17,7 @@
  */
 package net.java.sip.communicator.impl.shutdowntimeout;
 
+import net.java.sip.communicator.launchutils.*;
 import org.osgi.framework.*;
 
 /**

File: modules/launcher/src/main/java/net/java/sip/communicator/launcher/SIPCommunicator.java
Patch:
@@ -20,6 +20,7 @@
 import java.io.*;
 
 import java.util.*;
+import net.java.sip.communicator.launchutils.*;
 import org.apache.commons.lang3.*;
 import org.apache.felix.framework.*;
 import org.apache.felix.main.*;

File: modules/launcher/src/main/java/net/java/sip/communicator/launcher/SipCommunicatorLock.java
Patch:
@@ -23,6 +23,7 @@
 import java.util.*;
 
 import lombok.extern.slf4j.Slf4j;
+import net.java.sip.communicator.launchutils.*;
 
 /**
  * This class is used to prevent from running multiple instances of Jitsi. The

File: modules/service/argdelegation/src/main/java/net/java/sip/communicator/impl/argdelegation/ArgDelegationActivator.java
Patch:
@@ -17,6 +17,7 @@
  */
 package net.java.sip.communicator.impl.argdelegation;
 
+import net.java.sip.communicator.launchutils.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.util.*;
 

File: modules/impl/gui/src/main/java/net/java/sip/communicator/impl/gui/customcontrols/ExtendedTableModel.java
Patch:
@@ -39,10 +39,10 @@ public class ExtendedTableModel extends DefaultTableModel
     @SuppressWarnings("unchecked") //DefaultTableModel legacy code
     public int rowIndexOf(Object value)
     {
-        Vector<Vector<Object>> dataVec = this.getDataVector();
+        Vector<Vector> dataVec = this.getDataVector();
 
         for(int i = 0; i < dataVector.size(); i ++) {
-            Vector<Object> rowVector = dataVec.get(i);
+            Vector rowVector = dataVec.get(i);
 
             if(rowVector.contains(value)) {
                 return i;

File: modules/impl/gui/src/main/java/net/java/sip/communicator/impl/gui/main/contactlist/ContactNode.java
Patch:
@@ -28,8 +28,7 @@
  * @author Yana Stamcheva
  */
 public class ContactNode
-    extends DefaultMutableTreeNode
-    implements ContactListNode
+    extends ContactListNode
 {
     /**
      * The <tt>UIContact</tt> corresponding to this contact node.

File: modules/impl/contactlist/src/main/java/net/java/sip/communicator/impl/contactlist/MclStorageManager.java
Patch:
@@ -80,13 +80,13 @@ public class MclStorageManager
      * other words that it has successfully found and read the xml contact list
      * file.
      */
-    private boolean started = false;
+    private volatile boolean started = false;
 
     /**
      * Indicates whether there has been a change since the last time we stored
      * this contact list. Used by the storage methods.
      */
-    private boolean isModified = false;
+    private volatile boolean isModified = false;
 
     /**
      * A currently valid reference to the OSGI bundle context,

File: modules/impl/packetlogging/src/main/java/net/java/sip/communicator/impl/packetlogging/PacketLoggingServiceImpl.java
Patch:
@@ -18,7 +18,6 @@
 package net.java.sip.communicator.impl.packetlogging;
 
 import java.io.*;
-import java.util.*;
 
 import com.google.common.collect.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -2541,8 +2541,8 @@ public void roomDestroyed(MultiUserChat alternateMUC, String reason)
                 ChatRoomJabberImpl.this,
                 LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_ROOM_DESTROYED,
                 reason,
-                multiUserChat != null && multiUserChat.getRoom() != null
-                    ? multiUserChat.getRoom().toString() : null);
+                alternateMUC != null && alternateMUC.getRoom() != null
+                    ? alternateMUC.getRoom().toString() : null);
         }
 
         /**

File: src/net/java/sip/communicator/impl/protocol/jabber/debugger/SmackPacketDebugger.java
Patch:
@@ -22,7 +22,6 @@
 import org.jitsi.service.packetlogging.*;
 import org.jivesoftware.smack.*;
 import org.jivesoftware.smack.packet.*;
-import org.jivesoftware.smack.tcp.*;
 
 import java.lang.reflect.*;
 import java.net.*;
@@ -105,7 +104,7 @@ public void processStanza(Stanza packet)
                         else
                         {
                             remoteAddress = new byte[4];
-                            localAddress = new byte[4];
+                            localAddress = new byte[] { 127, 0, 0, 1 };
                         }
                     }
 

File: modules/service/resourcemanager/src/main/java/net/java/sip/communicator/impl/resources/ResourceManagementServiceImpl.java
Patch:
@@ -550,7 +550,7 @@ public InputStream getSettingsInputStream(String streamKey)
     public InputStream getSettingsInputStream(  String streamKey,
                                                 Class<?> resourceClass)
     {
-        String path = getSettingsString(streamKey);
+        String path = settingsPack.getResources().get(streamKey);
 
         if (path == null || path.length() == 0)
         {

File: modules/plugin/otr/src/main/java/net/java/sip/communicator/plugin/otr/OtrMetaContactMenu.java
Patch:
@@ -29,6 +29,7 @@
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;
 import net.java.sip.communicator.service.protocol.*;
+import org.jitsi.util.*;
 
 /**
  * @author George Politis
@@ -72,7 +73,7 @@ public OtrMetaContactMenu(Container container,
 
         inMacOSXScreenMenuBar =
             Container.CONTAINER_CHAT_MENU_BAR.equals(container)
-                && OtrActivator.uiService.useMacOSXScreenMenuBar();
+                && OSUtils.IS_MAC;
     }
 
     /*

File: modules/service/resourcemanager/src/main/java/net/java/sip/communicator/impl/resources/ResourceManagementActivator.java
Patch:
@@ -38,9 +38,9 @@ public ResourceManagementActivator()
             ConfigurationService.class,
             ColorPack.class,
             ImagePack.class,
-            LanguagePack.class,
+            SoundPack.class,
             SettingsPack.class,
-            SoundPack.class
+            LanguagePack.class
         );
     }
 

File: modules/service/resourcemanager/src/main/java/net/java/sip/communicator/service/resources/SettingsPack.java
Patch:
@@ -18,11 +18,10 @@
 package net.java.sip.communicator.service.resources;
 
 /**
- *
  * @author Damian Minkov
  */
 public interface SettingsPack
     extends ResourcePack
 {
-    public String RESOURCE_NAME_DEFAULT_VALUE = "DefaultSettingsPack";
+    String RESOURCE_NAME_DEFAULT_VALUE = "DefaultSettingsPack";
 }

File: src/net/java/sip/communicator/service/protocol/StunServerDescriptor.java
Patch:
@@ -28,7 +28,6 @@
 import java.util.*;
 
 import org.apache.commons.lang3.StringUtils;
-import org.jitsi.utils.*;
 
 /**
  * A <tt>StunServerDescriptor</tt> stores information necessary to create a
@@ -251,7 +250,8 @@ public void storeDescriptor(Map<String, String> props, String namePrefix)
 
         if (getUsername() != null && getUsername().length > 0)
                 props.put(namePrefix + STUN_USERNAME,
-                          StringUtils.toEncodedString(getUsername(), StandardCharsets.UTF_8));
+                          StringUtils.toEncodedString(
+                              getUsername(), StandardCharsets.UTF_8));
 
         if (getPassword() != null && getPassword().length > 0)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -2342,7 +2342,9 @@ public void processMessage(org.jivesoftware.smack.packet.Message msg)
             // if we are sending this message, this either a delivery report
             // or if there is a delay extension this is a history coming from
             // the chat room
-            if(multiUserChat.getNickname().equals(msgFrom.getResourceOrThrow()))
+            if(multiUserChat.getNickname() != null
+                && multiUserChat.getNickname()
+                    .equals(msgFrom.getResourceOrThrow()))
             {
                 // message delivered
                 ChatRoomMessageDeliveredEvent msgDeliveredEvt

File: src/net/java/sip/communicator/impl/protocol/jabber/LoginByPasswordStrategy.java
Patch:
@@ -1,7 +1,7 @@
 /*
  * Jitsi, the OpenSource Java VoIP and Instant Messaging client.
  *
- * Copyright @ 2015 Atlassian Pty Ltd
+ * Copyright @ 2018 - present 8x8, Inc.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -22,7 +22,6 @@
 import net.java.sip.communicator.service.protocol.event.*;
 import org.jivesoftware.smack.*;
 import org.jxmpp.jid.*;
-import org.jxmpp.jid.parts.Resourcepart;
 
 import javax.net.ssl.*;
 import java.io.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1302,10 +1302,10 @@ else if (loginStrategy.isTlsRequired())
                         ProtocolProviderFactory.KEEP_ALIVE_INTERVAL, -1);
         if (this.isKeepAliveEnabled && keepAliveInterval > 0)
         {
-            PingManager.getInstanceFor(connection).setPingInterval(keepAliveInterval);
+            PingManager.getInstanceFor(connection)
+                .setPingInterval(keepAliveInterval);
         }
 
-        connection.setReplyTimeout(30000);
         connection.connect();
 
         setTrafficClass();

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationForm.java
Patch:
@@ -423,7 +423,7 @@ public void loadAccount(JabberAccountRegistration accountReg)
 
         iceConfigPanel.setUseIce(accountReg.isUseIce());
 
-        iceConfigPanel.setAutoDiscoverStun(accountReg.isAutoDiscoverStun());
+        iceConfigPanel.setAutoDiscoverStun(accountReg.isStunServerDiscoveryEnabled());
 
         iceConfigPanel.setUseDefaultStunServer(
                 accountReg.isUseDefaultStunServer());

File: src/net/java/sip/communicator/service/protocol/event/RegistrationStateChangeEvent.java
Patch:
@@ -1,7 +1,7 @@
 /*
  * Jitsi, the OpenSource Java VoIP and Instant Messaging client.
  *
- * Copyright @ 2015 Atlassian Pty Ltd
+ * Copyright @ 2018 - present 8x8, Inc.
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
@@ -199,6 +199,7 @@ public String toString()
         return "RegistrationStateChangeEvent[ oldState="
             + getOldState().getStateName()
             + "; newState="+ getNewState()
+            + "; userRequest="+ isUserRequest()
             + "; reasonCode=" + getReasonCode()
             + "; reason=" + getReason() + "]";
     }

File: src/net/java/sip/communicator/plugin/desktoputil/plaf/SearchFieldUI.java
Patch:
@@ -29,6 +29,7 @@
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.util.skin.*;
 
+import org.apache.commons.lang3.StringUtils;
 import org.jitsi.service.resources.*;
 import org.jitsi.utils.*;
 
@@ -182,7 +183,7 @@ protected void customPaintBackground(Graphics g)
             String str = c.getText();
             boolean containsLetter = false;
 
-            if (str != null && !str.isEmpty()) {
+            if (str != null && StringUtils.isNotEmpty(str)) {
                 for (int i = 0; i < str.length(); i++)
                 {
                     char chr = str.charAt(i);

File: src/net/java/sip/communicator/service/protocol/StunServerDescriptor.java
Patch:
@@ -258,7 +258,7 @@ public void storeDescriptor(Map<String, String> props, String namePrefix)
             catch (UnsupportedEncodingException e)
             {
                 props.put(namePrefix + STUN_USERNAME,
-                    StringUtils.toEncodedString(getUsername(), StandardCharsets.UTF_8));
+                          StringUtils.toEncodedString(getUsername(), StandardCharsets.UTF_8));
             }
 
         if (getPassword() != null && getPassword().length > 0)

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/IceConfigPanel.java
Patch:
@@ -216,8 +216,8 @@ public void actionPerformed(ActionEvent e)
                             stunServer.getPassword(), StandardCharsets.UTF_8.name());
                     }
                     catch (UnsupportedEncodingException ex) {
-                        userName = new String(stunServer.getUsername());
-                        password = new String(stunServer.getPassword());
+                        userName = StringUtils.toEncodedString(stunServer.getUsername(), StandardCharsets.UTF_8);
+                        password = StringUtils.toEncodedString(stunServer.getPassword(), StandardCharsets.UTF_8);
                     }
 
                     StunConfigDialog dialog = new StunConfigDialog(

File: src/net/java/sip/communicator/service/protocol/StunServerDescriptor.java
Patch:
@@ -258,7 +258,7 @@ public void storeDescriptor(Map<String, String> props, String namePrefix)
             catch (UnsupportedEncodingException e)
             {
                 props.put(namePrefix + STUN_USERNAME,
-                    getUsername().toString());
+                    StringUtils.toEncodedString(getUsername(), StandardCharsets.UTF_8));
             }
 
         if (getPassword() != null && getPassword().length > 0)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/UnknownContactPanel.java
Patch:
@@ -20,7 +20,6 @@
 import java.awt.*;
 import java.awt.event.*;
 import java.util.List;
-import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 
 import javax.swing.*;

File: src/net/java/sip/communicator/plugin/loggingutils/LoggingConfigForm.java
Patch:
@@ -247,7 +247,7 @@ private void init()
         c.gridy = 4;
         mainPanel.add(archiveButton, c);
 
-        if(StringUtils.isEmpty(getUploadLocation()))
+        if(StringUtils.isNotEmpty(getUploadLocation()))
         {
             uploadLogsButton = new JButton(
                 resources.getI18NString("plugin.loggingutils.UPLOAD_LOGS_BUTTON"));

File: src/net/java/sip/communicator/service/protocol/StunServerDescriptor.java
Patch:
@@ -253,7 +253,7 @@ public void storeDescriptor(Map<String, String> props, String namePrefix)
             try
             {
                 props.put(namePrefix + STUN_USERNAME,
-                          StringUtils.toString(getUsername(), StandardCharsets.UTF_8.name()));
+                          new String(getUsername(), StandardCharsets.UTF_8.name()));
             }
             catch (UnsupportedEncodingException e)
             {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/UnknownContactPanel.java
Patch:
@@ -20,7 +20,6 @@
 import java.awt.*;
 import java.awt.event.*;
 import java.util.List;
-import java.util.regex.Matcher;
 import java.util.regex.Pattern;
 
 import javax.swing.*;

File: src/net/java/sip/communicator/plugin/loggingutils/LoggingConfigForm.java
Patch:
@@ -247,7 +247,7 @@ private void init()
         c.gridy = 4;
         mainPanel.add(archiveButton, c);
 
-        if(StringUtils.isEmpty(getUploadLocation()))
+        if(StringUtils.isNotEmpty(getUploadLocation()))
         {
             uploadLogsButton = new JButton(
                 resources.getI18NString("plugin.loggingutils.UPLOAD_LOGS_BUTTON"));

File: src/net/java/sip/communicator/service/protocol/StunServerDescriptor.java
Patch:
@@ -253,7 +253,7 @@ public void storeDescriptor(Map<String, String> props, String namePrefix)
             try
             {
                 props.put(namePrefix + STUN_USERNAME,
-                          StringUtils.toString(getUsername(), StandardCharsets.UTF_8.name()));
+                          new String(getUsername(), StandardCharsets.UTF_8.name()));
             }
             catch (UnsupportedEncodingException e)
             {

File: src/net/java/sip/communicator/impl/version/VersionActivator.java
Patch:
@@ -84,8 +84,9 @@ public void start(BundleContext context) throws Exception
 
         // TODO: Damencho has volunteered to export these to a constant at a
         // later stage.
-        cfg.setProperty("sip-communicator.version", applicationName, true);
-        cfg.setProperty("sip-communicator.application.name", versionString, true);
+        cfg.setProperty("sip-communicator.version", versionString, true);
+        cfg.setProperty(
+            "sip-communicator.application.name", applicationName, true);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/media/CallPeerMediaHandler.java
Patch:
@@ -1602,8 +1602,9 @@ public void sendHolePunchPacket(MediaStream stream, MediaType mediaType)
 
         // send as a hole punch packet a constructed rtp packet
         // has the correct payload type and ssrc
-        RawPacket packet = new RawPacket(
-            HOLE_PUNCH_PACKET, 0, RawPacket.FIXED_HEADER_SIZE);
+        RawPacket packet
+            = new RawPacket(
+                    HOLE_PUNCH_PACKET.clone(), 0, HOLE_PUNCH_PACKET.length);
 
         MediaFormat format = stream.getFormat();
         byte payloadType = format.getRTPPayloadType();

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetMultiUserChat2.java
Patch:
@@ -24,7 +24,6 @@
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
-import org.jivesoftware.smack.util.StringUtils;
 import org.jxmpp.jid.impl.*;
 import org.jxmpp.stringprep.*;
 import org.jxmpp.util.*;
@@ -544,9 +543,9 @@ public void testFindRoom()
 
         ChatRoom foundRoom = null;
         /*
-         //findRoom always returns ChatRoom instance. If it doesn't exists in 
+         //findRoom always returns ChatRoom instance. If it doesn't exists in
          //the cache it creates an instance of ChatRoom.
-        
+
         try
         {
             foundRoom = opSetMUC1.findRoom("WhoCreatedThatRoom");

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1164,7 +1164,8 @@ private ConnectState connectAndLogin(
                 }
 
                 String file = boshURI.getPath();
-                String query = boshURI.getQuery();
+                // use rawQuery as getQuery() decodes the string
+                String query = boshURI.getRawQuery();
                 if (!StringUtils.isNullOrEmpty(query))
                 {
                     file += "?" + query;

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -1540,7 +1540,7 @@ private void reflectConferenceFocus(javax.sip.message.Message message)
             // we must set the value of the parameter as null
             // in order to avoid wrong generation of the tag - ';isfocus='
             // as it must be ';isfocus'
-            if (getCall().isConferenceFocus())
+            if (getCall() != null && getCall().isConferenceFocus())
                 contactHeader.setParameter("isfocus", null);
             else
                 contactHeader.removeParameter("isfocus");

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -973,7 +973,9 @@ private ConnectState connectAndLogin(InetSocketAddress currentAddress,
                 JidCreate.entityFullFrom(userID, resource),
                 loginStrategy);
         }
-        catch (ConnectException | NoRouteToHostException ex)
+        catch (ConnectException
+            | NoRouteToHostException
+            | NoResponseException ex)
         {
             //as we got an exception not handled in connectAndLogin
             //no state was set, so fire it here so we can continue

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopSharingClientJabberImpl.java
Patch:
@@ -214,7 +214,7 @@ else if(inputIQ.getAction() == InputEvtAction.STOP)
                 }
                 else
                 {
-                    addAddDeferredRemoteControlPeer(callPeerID);
+                    addAddDeferredRemoteControlPeer(callPeerID.toString());
                 }
             }
         }

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatContactListModel.java
Patch:
@@ -34,7 +34,7 @@
  * @author Lyubomir Marinov
  */
 public class ChatContactListModel
-    extends AbstractListModel
+    extends AbstractListModel<ChatContact<?>>
     implements ChatRoomMemberPropertyChangeListener
 {
 

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomMemberListPanel.java
Patch:
@@ -52,7 +52,7 @@ public class ChatRoomMemberListPanel
     /**
      * The list of members.
      */
-    private final DefaultContactList memberList = new DefaultContactList();
+    private final ChatRoomContactList memberList = new ChatRoomContactList();
 
     /**
      * The model of the members list.

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomContactList.java
Patch:
@@ -60,7 +60,7 @@ public ChatRoomContactList()
                 ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
 
         this.setDragEnabled(true);
-//        this.setTransferHandler(new ContactListTransferHandler(this));
+        this.setTransferHandler(new ChatRoomContactListTransferHandler(this));
         this.setCellRenderer(renderer);
     }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatContactListModel.java
Patch:
@@ -34,7 +34,7 @@
  * @author Lyubomir Marinov
  */
 public class ChatContactListModel
-    extends AbstractListModel
+    extends AbstractListModel<ChatContact<?>>
     implements ChatRoomMemberPropertyChangeListener
 {
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/DefaultContactList.java
Patch:
@@ -40,7 +40,7 @@
  * @author Adam Netocny
  */
 public class DefaultContactList
-    extends JList
+    extends JList<ChatContact<?>>
     implements Skinnable
 {
     private static final long serialVersionUID = 0L;

File: src/net/java/sip/communicator/impl/protocol/jabber/UriHandlerJabberImpl.java
Patch:
@@ -329,7 +329,7 @@ public void handleUri(String uri)
 
             //todo check url!!
             //Set the email pattern string
-            Pattern p = Pattern.compile(".+@.+\\.[a-z]+");
+            Pattern p = Pattern.compile(".+@.+");
             if(!p.matcher(contactId).matches())
             {
                 showErrorMessage(

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopSharingServerJabberImpl.java
Patch:
@@ -334,6 +334,7 @@ public void disableRemoteControl(CallPeer callPeer)
     {
         this.modifyRemoteControl(callPeer, false);
         callPeer.removeCallPeerListener(callPeerListener);
+        origin = null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopSharingServerJabberImpl.java
Patch:
@@ -334,6 +334,7 @@ public void disableRemoteControl(CallPeer callPeer)
     {
         this.modifyRemoteControl(callPeer, false);
         callPeer.removeCallPeerListener(callPeerListener);
+        origin = null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/thumbnail/FileElement.java
Patch:
@@ -263,7 +263,7 @@ else if (elementName.equals("x")
                 }
                 else if (elementName.equals("thumbnail"))
                 {
-                    thumbnail = new ThumbnailElement(parser.getText());
+                    thumbnail = ThumbnailElement.parseExtension(parser);
                 }
             }
             else if (eventType == XmlPullParser.END_TAG)

File: src/net/java/sip/communicator/util/ServiceUtils.java
Patch:
@@ -48,7 +48,8 @@ public static <T> T getService(
             Class<T> serviceClass)
     {
         ServiceReference<T> serviceReference
-            = bundleContext.getServiceReference(serviceClass);
+            = bundleContext == null
+                ? null : bundleContext.getServiceReference(serviceClass);
 
         return
             (serviceReference == null)

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberActivator.java
Patch:
@@ -152,7 +152,6 @@ public class JabberActivator
      */
     public void start(BundleContext context) throws Exception
     {
-        SmackConfiguration.DEBUG = true;
         // Disables unused class, throwing some errors on login (disco-info)
         SmackConfiguration.addDisabledSmackClass(
             "org.jivesoftware.smackx.httpfileupload.HttpFileUploadManager");

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberActivator.java
Patch:
@@ -152,7 +152,6 @@ public class JabberActivator
      */
     public void start(BundleContext context) throws Exception
     {
-        SmackConfiguration.DEBUG = true;
         // Disables unused class, throwing some errors on login (disco-info)
         SmackConfiguration.addDisabledSmackClass(
             "org.jivesoftware.smackx.httpfileupload.HttpFileUploadManager");

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomMemberJabberImpl.java
Patch:
@@ -35,7 +35,6 @@
  * @author Emil Ivov
  */
 public class ChatRoomMemberJabberImpl
-    extends DataObject
     implements JabberChatRoomMember
 {
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/AnonymousLoginStrategy.java
Patch:
@@ -96,7 +96,7 @@ public SSLContext createSslContext(CertificateService certificateService,
         X509ExtendedTrustManager trustManager)
         throws GeneralSecurityException
     {
-        return null;
+        return certificateService.getSSLContext(trustManager);
     }
 
     @Override

File: src/net/java/sip/communicator/impl/protocol/jabber/UriHandlerJabberImpl.java
Patch:
@@ -329,7 +329,7 @@ public void handleUri(String uri)
 
             //todo check url!!
             //Set the email pattern string
-            Pattern p = Pattern.compile(".+@.+\\.[a-z]+");
+            Pattern p = Pattern.compile(".+@.+");
             if(!p.matcher(contactId).matches())
             {
                 showErrorMessage(

File: src/net/java/sip/communicator/impl/protocol/jabber/UriHandlerJabberImpl.java
Patch:
@@ -329,7 +329,7 @@ public void handleUri(String uri)
 
             //todo check url!!
             //Set the email pattern string
-            Pattern p = Pattern.compile(".+@.+\\.[a-z]+");
+            Pattern p = Pattern.compile(".+@.+");
             if(!p.matcher(contactId).matches())
             {
                 showErrorMessage(

File: src/net/java/sip/communicator/impl/protocol/jabber/JingleNodesHarvester.java
Patch:
@@ -206,6 +206,9 @@ protected JingleNodesCandidate createJingleNodesCandidate(
                         localEndPoint);
             IceSocketWrapper stunSocket = cand.getStunSocket(null);
             cand.getStunStack().addSocket(stunSocket);
+
+            component.getComponentSocket()
+                .add(cand.getCandidateIceSocketWrapper());
         }
         catch(Throwable e)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/JingleNodesHarvester.java
Patch:
@@ -206,6 +206,9 @@ protected JingleNodesCandidate createJingleNodesCandidate(
                         localEndPoint);
             IceSocketWrapper stunSocket = cand.getStunSocket(null);
             cand.getStunStack().addSocket(stunSocket);
+
+            component.getComponentSocket()
+                .add(cand.getCandidateIceSocketWrapper());
         }
         catch(Throwable e)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriBuilder.java
Patch:
@@ -125,14 +125,14 @@ private static boolean copyDescription(
         boolean added = false;
         for (PayloadTypePacketExtension payloadType : description.getPayloadTypes())
         {
-            channel.addPayloadType(new PayloadTypePacketExtension(payloadType));
+            channel.addPayloadType(PayloadTypePacketExtension.clone(payloadType));
             added = true;
         }
 
         for (RTPHdrExtPacketExtension rtpHdrExt : description.getExtmapList())
         {
             channel
-                .addRtpHeaderExtension(new RTPHdrExtPacketExtension(rtpHdrExt));
+                .addRtpHeaderExtension(RTPHdrExtPacketExtension.clone(rtpHdrExt));
             added = true;
         }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriConferenceIQ.java
Patch:
@@ -751,7 +751,8 @@ public void addRtpHeaderExtension(RTPHdrExtPacketExtension ext)
             Objects.requireNonNull(ext, "ext");
 
             // Create a new instance, because we are going to modify the NS
-            RTPHdrExtPacketExtension newExt = new RTPHdrExtPacketExtension(ext);
+            RTPHdrExtPacketExtension newExt
+                = RTPHdrExtPacketExtension.clone(ext);
 
             // Make sure that the parent namespace (COLIBRI) is used.
             newExt.setNamespace(null);

File: test/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriIQProviderTest.java
Patch:
@@ -144,7 +144,6 @@ public void testParseSource()
         assertEquals(ColibriConferenceIQ.ELEMENT_NAME, name);
 
         IQ result = colibriIQProvider.parse(xmlPullParser, 0);
-        System.out.println(result.toXML());
         List<SourcePacketExtension> sources =
                 ((ColibriConferenceIQ) result)
                         .getContent("video")

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/thumbnail/FileElement.java
Patch:
@@ -263,7 +263,7 @@ else if (elementName.equals("x")
                 }
                 else if (elementName.equals("thumbnail"))
                 {
-                    thumbnail = new ThumbnailElement(parser.getText());
+                    thumbnail = ThumbnailElement.parseExtension(parser);
                 }
             }
             else if (eventType == XmlPullParser.END_TAG)

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/RTPHdrExtPacketExtension.java
Patch:
@@ -77,7 +77,9 @@ public RTPHdrExtPacketExtension(RTPHdrExtPacketExtension ext)
         this();
         String attributes = ext.getAttributes();
         if (attributes != null)
+        {
             setAttributes(attributes);
+        }
         setID(ext.getID());
         setSenders(ext.getSenders());
         setURI(ext.getURI());

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h264/OpenH264Retriever.java
Patch:
@@ -398,7 +398,7 @@ private static void install(File file)
                 OPENH264_INSTALL_DIR_WINDOWS.replace(
                     "%ALLUSERSPROFILE%",
                     System.getenv("ALLUSERSPROFILE")),
-                "openh264.dll");
+                "libopenh264.dll");
         }
         else if (OSUtils.IS_MAC)
         {

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatTransport.java
Patch:
@@ -27,6 +27,7 @@
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.FileUtils;
 
 /**
  * The single chat implementation of the <tt>ChatTransport</tt> interface that

File: src/net/java/sip/communicator/impl/gui/utils/FileImageLabel.java
Patch:
@@ -25,6 +25,7 @@
 
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.FileUtils;
 
 /**
  * The <tt>FileImageLabel</tt> is a <tt>JLabel</tt> associated with a file. It

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriBuilder.java
Patch:
@@ -389,7 +389,7 @@ public boolean addBundleTransportUpdateReq(
         boolean hasAnyChanges = request.addEndpoint(endpointUpdate);
         if (!hasAnyChanges)
         {
-            logger.warn("A endpoint update has been lost (an instance "
+            logger.warn("An endpoint update has been lost (an instance "
                             + "with its ID already exists)");
         }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriConferenceIQ.java
Patch:
@@ -2297,7 +2297,7 @@ public static class Endpoint
         private String statsId;
 
         /**
-         * The transport element of this <tt>ChannelBundle</tt>.
+         * The transport element of this <tt>Endpoint</tt>.
          */
         private IceUdpTransportPacketExtension transport;
 
@@ -2404,7 +2404,6 @@ public IQChildElementXmlStringBuilder toXML(
             xml.optAttribute(DISPLAYNAME_ATTR_NAME, displayName);
             xml.optAttribute(STATS_ID_ATTR_NAME, statsId);
 
-
             IceUdpTransportPacketExtension transport = getTransport();
             if (transport != null)
             {

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jibri/JibriIq.java
Patch:
@@ -251,6 +251,9 @@ protected IQ.IQChildElementXmlStringBuilder getIQChildElementBuilder(IQ.IQChildE
         xml.optAttribute(STREAM_ID_ATTR_NAME, streamId);
         xml.optAttribute(DISPLAY_NAME_ATTR_NAME, displayName);
         xml.optAttribute(SIP_ADDRESS_ATTR_NAME, sipAddress);
+
+        xml.setEmptyElement();
+
         return xml;
     }
 

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -326,7 +326,7 @@ private SSLContext getCustomSSLContext(final String hostname)
         try
         {
             CertificateService cs = IrcActivator.getCertificateService();
-            X509TrustManager tm = cs.getTrustManager(hostname);
+            X509ExtendedTrustManager tm = cs.getTrustManager(hostname);
             context = cs.getSSLContext(tm);
         }
         catch (GeneralSecurityException e)

File: src/net/java/sip/communicator/impl/protocol/jabber/AnonymousLoginStrategy.java
Patch:
@@ -87,7 +87,7 @@ public boolean isTlsRequired()
 
     @Override
     public SSLContext createSslContext(CertificateService certificateService,
-                                       X509TrustManager trustManager)
+        X509ExtendedTrustManager trustManager)
         throws GeneralSecurityException
     {
         return null;

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberLoginStrategy.java
Patch:
@@ -80,6 +80,6 @@ public boolean login(Connection connection, String userName,
      * @return the SSLContext
      */
     public SSLContext createSslContext(CertificateService certificateService,
-            X509TrustManager trustManager)
+        X509ExtendedTrustManager trustManager)
             throws GeneralSecurityException;
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/LoginByClientCertificateStrategy.java
Patch:
@@ -97,7 +97,7 @@ public boolean isTlsRequired()
      * @throws GeneralSecurityException
      */
     public SSLContext createSslContext(CertificateService cs,
-            X509TrustManager trustManager)
+        X509ExtendedTrustManager trustManager)
         throws GeneralSecurityException
     {
         String certConfigName = accountID.getAccountPropertyString(

File: src/net/java/sip/communicator/impl/protocol/jabber/LoginByPasswordStrategy.java
Patch:
@@ -180,7 +180,7 @@ public boolean isTlsRequired()
      * @throws GeneralSecurityException
      */
     public SSLContext createSslContext(CertificateService cs,
-            X509TrustManager trustManager)
+            X509ExtendedTrustManager trustManager)
             throws GeneralSecurityException
     {
         return cs.getSSLContext(trustManager);

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -781,11 +781,11 @@ public static ChatRoomMemberRole smackRoleToScRole(MUCRole smackRole,
     {
         if(affiliation != null)
         {
-            if(affiliation.equals("admin"))
+            if(affiliation == MUCAffiliation.admin)
             {
                 return ChatRoomMemberRole.ADMINISTRATOR;
             }
-            else if(affiliation.equals("owner"))
+            else if(affiliation == MUCAffiliation.owner)
             {
                 return ChatRoomMemberRole.OWNER;
             }

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jitsimeet/MediaPresenceExtension.java
Patch:
@@ -86,7 +86,7 @@ public static class Source
         /**
          * No namespace attached.
          */
-        public final static String NAMESPACE = MediaPresenceExtension.NAMESPACE;
+        public final static String NAMESPACE = "urn:xmpp:jingle:apps:rtp:ssma:0";
 
         /**
          * SSRC media type attribute name. Can be 'audio' or 'video'.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/AbstractPacketExtension.java
Patch:
@@ -143,7 +143,7 @@ public String toXML()
         String text = getText();
         List<Stanza> packets = getPackets();
 
-        if (childElements == null && packets == null)
+        if (childElements.size() == 0 && packets.size() == 0)
         {
             if ((text == null) || (text.length() == 0))
             {

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jitsimeet/MediaPresenceExtension.java
Patch:
@@ -86,7 +86,7 @@ public static class Source
         /**
          * No namespace attached.
          */
-        public final static String NAMESPACE = "";
+        public final static String NAMESPACE = MediaPresenceExtension.NAMESPACE;
 
         /**
          * SSRC media type attribute name. Can be 'audio' or 'video'.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriConferenceIQ.java
Patch:
@@ -1874,7 +1874,9 @@ public IQChildElementXmlStringBuilder toXML(IQChildElementXmlStringBuilder xml)
                 .optAttribute(ENDPOINT_ATTR_NAME, getEndpoint())
                 .optIntAttribute(EXPIRE_ATTR_NAME, getExpire())
                 .optAttribute(ID_ATTR_NAME, getID())
-                .optBooleanAttribute(INITIATOR_ATTR_NAME, isInitiator())
+                .optBooleanAttribute(INITIATOR_ATTR_NAME, isInitiator() == null
+                    ? false
+                    : isInitiator())
                 .optAttribute(CHANNEL_BUNDLE_ID_ATTR_NAME, getChannelBundleId());
 
             // Print derived class attributes

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriBuilder.java
Patch:
@@ -938,9 +938,9 @@ private ColibriConferenceIQ.ChannelCommon getColibriChannel(
      *         be expired then <tt>null</tt> is returned which signals that
      *         there's nothing to be done.
      */
-    public ColibriConferenceIQ getRequest(String videobridge)
+    public ColibriConferenceIQ getRequest(Jid videobridge)
     {
-        if (StringUtils.isNullOrEmpty(videobridge))
+        if (videobridge == null)
         {
             throw new NullPointerException("videobridge");
         }

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriIQProvider.java
Patch:
@@ -27,6 +27,7 @@
 import org.jivesoftware.smack.provider.*;
 import org.jxmpp.jid.*;
 import org.jxmpp.jid.impl.*;
+import org.jxmpp.jid.parts.Localpart;
 import org.xmlpull.v1.*;
 
 /**
@@ -264,8 +265,8 @@ public IQ parse(XmlPullParser parser, int depth)
             String conferenceName = parser
                 .getAttributeValue("", ColibriConferenceIQ.NAME_ATTR_NAME);
 
-            if ((conferenceName != null) && (conferenceName.length() != 0))
-                conference.setName(conferenceName);
+            if (!StringUtils.isNullOrEmpty(conferenceName))
+                conference.setName(Localpart.from(conferenceName));
 
             boolean done = false;
             ColibriConferenceIQ.Channel channel = null;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransferHandler.java
Patch:
@@ -33,7 +33,8 @@
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.Logger;
+import org.jitsi.util.*;
 
 /**
  * A TransferHandler that we use to handle copying, pasting and DnD operations
@@ -161,7 +162,7 @@ public boolean importData(JComponent comp, Transferable t)
             }
         }
 
-        if (t.isDataFlavorSupported(uriListFlavor))
+        if (t.isDataFlavorSupported(uriListFlavor) && OSUtils.IS_LINUX)
         {
             try
             {

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransferHandler.java
Patch:
@@ -33,7 +33,8 @@
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.Logger;
+import org.jitsi.util.*;
 
 /**
  * A TransferHandler that we use to handle copying, pasting and DnD operations
@@ -161,7 +162,7 @@ public boolean importData(JComponent comp, Transferable t)
             }
         }
 
-        if (t.isDataFlavorSupported(uriListFlavor))
+        if (t.isDataFlavorSupported(uriListFlavor) && OSUtils.IS_LINUX)
         {
             try
             {

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigurationPanel.java
Patch:
@@ -266,7 +266,7 @@ public void actionPerformed(ActionEvent e)
                 boolean value = ((JCheckBox) e.getSource()).isSelected();
                 ConfigurationUtils.setIsMinimizeInsteadOfHide(value);
                 UtilActivator.getUIService().setMainWindowCanHide(
-                    !UtilActivator.getSystrayService().checkInitialized());
+                    UtilActivator.getSystrayService().checkInitialized());
             }
         });
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -489,8 +489,7 @@ public String getMessageContents(String messageUID)
             return null;
         }
 
-        String res = new String(net.java.sip.communicator.util.Base64
-            .decode(original_message.toString()));
+        String res = StringEscapeUtils.unescapeXml(original_message.toString());
         // Remove all newline characters that were inserted to make copying
         // newlines from the conversation panel work.
         // They shouldn't be in the write panel, because otherwise a newline

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/SourcePacketExtension.java
Patch:
@@ -206,7 +206,6 @@ else if (hasRid() && other.hasRid())
         return false;
     }
 
-
     /**
      * Returns deep copy of this <tt>SourcePacketExtension</tt>.
      */
@@ -215,7 +214,6 @@ public SourcePacketExtension copy()
         SourcePacketExtension copy
             = AbstractPacketExtension.clone(this);
 
-        // COPY SSRC PARAMS
         for (PacketExtension ppe : getChildExtensions())
         {
             if (ppe instanceof AbstractPacketExtension)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -319,7 +319,7 @@ public void actionPerformed(ActionEvent e)
             ChatOperationReasonDialog reasonDialog
                 = new ChatOperationReasonDialog();
 
-            int result = new ChatOperationReasonDialog().showDialog();
+            int result = reasonDialog.showDialog();
 
             if (result == MessageDialog.OK_RETURN_CODE)
                 new KickParticipantThread(  room,

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -3079,8 +3079,8 @@ public void chatRoomPropertyChanged(ChatRoomMemberPropertyChangeEvent event)
                 GuiActivator.getResources().getI18NString(
                     "service.gui.CHAT_NICKNAME_CHANGE",
                     new String[]
-                    { (String) event.getOldValue(),
-                        (String) event.getNewValue() });
+                    { event.getOldValue().toString(),
+                        event.getNewValue().toString() });
             this.conversationPanel.appendMessageToEnd(
                 "<DIV identifier=\"message\" style=\"color:#707070;\">"
                     + StringEscapeUtils.escapeHtml4(message) + "</DIV>",

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomMemberJabberImpl.java
Patch:
@@ -129,7 +129,7 @@ public Jid getJabberID()
      */
     public String getContactAddress()
     {
-        return nickName.toString();
+        return jabberID.toString();
     }
 
     /**

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetFileTransferImpl.java
Patch:
@@ -23,6 +23,7 @@
 import net.java.sip.communicator.slick.protocol.generic.*;
 import net.java.sip.communicator.util.*;
 
+import org.jivesoftware.smackx.filetransfer.FileTransferNegotiator;
 import org.osgi.framework.*;
 
 /**
@@ -72,6 +73,7 @@ public Contact getContact2()
     public void start()
         throws Exception
     {
+        FileTransferNegotiator.IBB_ONLY = true;
         fixture.setUp();
 
         Map<String, OperationSet> supportedOperationSets1 =

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriConferenceIQ.java
Patch:
@@ -652,14 +652,14 @@ public static class Channel
          * Sessions associated with this <tt>channel</tt>.
          */
         private final List<PayloadTypePacketExtension> payloadTypes
-            = new ArrayList<PayloadTypePacketExtension>();
+            = new ArrayList<>();
 
         /**
          * The <tt>rtp-hdrext</tt> elements defined by XEP-0294: Jingle RTP
          * Header Extensions Negotiation associated with this channel.
          */
         private final Map<Integer, RTPHdrExtPacketExtension> rtpHeaderExtensions
-            = new HashMap<Integer, RTPHdrExtPacketExtension>();
+            = new HashMap<>();
 
         /**
          * The target quality of the simulcast substreams to be sent from Jitsi
@@ -703,7 +703,7 @@ public static class Channel
          * The <tt>SourcePacketExtension</tt>s of this channel.
          */
         private final List<SourcePacketExtension> sources
-            = new LinkedList<SourcePacketExtension>();
+            = new LinkedList<>();
 
         /**
          * The list of (RTP) SSRCs which have been seen/received on this

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -741,6 +741,7 @@ private void enableDisableCarbon(final boolean enable)
             @Override
             protected IQChildElementXmlStringBuilder getIQChildElementBuilder(IQChildElementXmlStringBuilder buf)
             {
+                buf.setEmptyElement();
                 return buf;
             }
         };

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTelephonyConferencingJabberImpl.java
Patch:
@@ -278,7 +278,7 @@ private IQ getConferenceInfo(CallPeerJabberImpl callPeer,
             ConferenceInfoDocument.NAMESPACE){
             @Override
             protected IQChildElementXmlStringBuilder getIQChildElementBuilder(IQChildElementXmlStringBuilder buf) {
-                // FIXME: element name and namespace might be duplicated
+                buf.rightAngleBracket();
                 buf.append(confInfo.toXml());
                 return buf;
             }

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriStatsExtension.java
Patch:
@@ -166,9 +166,9 @@ public String toXML()
             {
                 return
                     "<" + ELEMENT_NAME + " " + NAME_ATTR_NAME + "='"
-                        + StringUtils.escapeForXML(name) + "' "
+                        + StringUtils.escapeForXml(name) + "' "
                         + VALUE_ATTR_NAME + "='"
-                        + StringUtils.escapeForXML(value.toString()) + "' />";
+                        + StringUtils.escapeForXml(value.toString()) + "' />";
             }
         }
     }

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriStatsIQ.java
Patch:
@@ -52,6 +52,7 @@ public ColibriStatsIQ()
     @Override
     protected IQ.IQChildElementXmlStringBuilder getIQChildElementBuilder(IQ.IQChildElementXmlStringBuilder buf)
     {
+        buf.rightAngleBracket();
         buf.append(backEnd.toXML());
         return buf;
     }

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/health/HealthCheckIQ.java
Patch:
@@ -49,7 +49,7 @@ public HealthCheckIQ()
     @Override
     protected IQ.IQChildElementXmlStringBuilder getIQChildElementBuilder(IQ.IQChildElementXmlStringBuilder buf)
     {
-        buf.append("<" + ELEMENT_NAME + " xmlns='" + NAMESPACE + "' />");
+        buf.setEmptyElement();
         return buf;
     }
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetFileTransferJabberImpl.java
Patch:
@@ -370,12 +370,12 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
                 ProviderManager.addIQProvider(
                     FileElement.ELEMENT_NAME,
                     FileElement.NAMESPACE,
-                    new FileElement());
+                    new FileElementIQProvider());
 
                 ProviderManager.addIQProvider(
                     ThumbnailIQ.ELEMENT_NAME,
                     ThumbnailIQ.NAMESPACE,
-                    new ThumbnailIQ());
+                    new ThumbnailIQProvider());
 
                 jabberProvider.getConnection().addPacketListener(
                     fileTransferRequestListener,

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingleinfo/RelayPacketExtension.java
Patch:
@@ -32,7 +32,7 @@ public class RelayPacketExtension
     /**
      * The namespace.
      */
-    public static final String NAMESPACE = null;
+    public static final String NAMESPACE = "google:jingleinfo";
 
     /**
      * The element name.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingleinfo/ServerPacketExtension.java
Patch:
@@ -30,7 +30,7 @@ public class ServerPacketExtension
     /**
      * The namespace.
      */
-    public static final String NAMESPACE = null;
+    public static final String NAMESPACE = "google:jingleinfo";
 
     /**
      * The element name.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingleinfo/StunPacketExtension.java
Patch:
@@ -30,7 +30,7 @@ public class StunPacketExtension
     /**
      * The namespace.
      */
-    public static final String NAMESPACE = null;
+    public static final String NAMESPACE = "google:jingleinfo";
 
     /**
      * The element name.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/DefaultPacketExtensionProvider.java
Patch:
@@ -32,7 +32,7 @@
  * @author Emil Ivov
  */
 public class DefaultPacketExtensionProvider<C extends AbstractPacketExtension>
-    extends ExtensionElementProvider
+    extends ExtensionElementProvider<C>
 {
     /**
      * The <tt>Logger</tt> used by the <tt>DefaultPacketExtensionProvider</tt>

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/ReasonProvider.java
Patch:
@@ -27,7 +27,7 @@
  *
  * @author Emil Ivov
  */
-public class ReasonProvider extends ExtensionElementProvider
+public class ReasonProvider extends ExtensionElementProvider<ReasonPacketExtension>
 {
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1796,7 +1796,7 @@ private void dispatchEventToButtons(MouseEvent event)
                 getCellRenderer().getTreeCellRendererComponent(
                         this,
                         mousePath.getLastPathComponent(),
-                        true,
+                        getLastSelectedPathComponent() == mousePath.getLastPathComponent(),
                         true,
                         true,
                         getRowForPath(mousePath),

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriAnalyser.java
Patch:
@@ -126,6 +126,7 @@ public static ColibriConferenceIQ getResponseContents(
 
         conferenceResult.setFrom(conferenceResponse.getFrom());
         conferenceResult.setID(conferenceResponse.getID());
+        conferenceResult.setGID(conferenceResponse.getGID());
         conferenceResult.setName(conferenceResponse.getName());
 
         // FIXME: we support single bundle for all channels

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -652,7 +652,7 @@ protected void initialize(String    sipAddress,
                 // Jitsi Meet Tools
                 addSupportedOperationSet(
                     OperationSetJitsiMeetTools.class,
-                    new OperationSetJitsiMeetToolsSipImpl());
+                    new OperationSetJitsiMeetToolsSipImpl(this));
 
                 boolean isParkingEnabled
                     = accountID.getAccountPropertyBoolean(
@@ -2465,6 +2465,8 @@ else if(uriStr.toLowerCase().startsWith("callto:"))
             uriStr = uriStr.substring("callto:".length());
         else if(uriStr.toLowerCase().startsWith("sips:"))
             uriStr = uriStr.substring("sips:".length());
+        else if(uriStr.toLowerCase().startsWith("sip:"))
+            uriStr = uriStr.substring("sip:".length());
 
         String user = uriStr;
         String remainder = "";

File: src/net/java/sip/communicator/impl/version/VersionImpl.java
Patch:
@@ -42,7 +42,7 @@ public class VersionImpl
      * number changes when a relatively extensive set of new features and
      * possibly rearchitecturing have been applied to the Jitsi.
      */
-    public static final int VERSION_MINOR = 9;
+    public static final int VERSION_MINOR = 11;
 
     /**
      * Indicates whether this version represents a prerelease (i.e. a

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1221,13 +1221,12 @@ else if (tlsRequired)
             throw new XMPPException("Error creating custom trust manager", e);
         }
 
-        // FIXME rework debugger to work with Connection if possible
-        if(debugger == null && connection instanceof XMPPConnection)
+        if(debugger == null)
         {
             debugger = new SmackPacketDebugger();
 
             // sets the debugger
-            debugger.setConnection((XMPPConnection) connection);
+            debugger.setConnection(connection);
             connection.addPacketListener(debugger, null);
             connection.addPacketInterceptor(debugger, null);
         }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1796,7 +1796,7 @@ private void dispatchEventToButtons(MouseEvent event)
                 getCellRenderer().getTreeCellRendererComponent(
                         this,
                         mousePath.getLastPathComponent(),
-                        true,
+                        getLastSelectedPathComponent() == mousePath.getLastPathComponent(),
                         true,
                         true,
                         getRowForPath(mousePath),

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -2857,7 +2857,8 @@ private void processOwnPresence(Presence presence)
                 // room is created and locked till we send
                 // the configuration
                 if (mucUser.getStatus() != null
-                    && "201".equals(mucUser.getStatus().getCode()))
+                    && mucUser.getStatus().contains(
+                        MUCUser.Status.ROOM_CREATED_201))
                 {
                     try
                     {

File: src/net/java/sip/communicator/util/NetworkUtils.java
Patch:
@@ -1204,11 +1204,11 @@ private static String determineAnyAddress()
      * @param port the port number that we'd like verified.
      *
      * @return <tt>true</tt> if port is a valid and bindable port number and
-     * <tt>alse</tt> otherwise.
+     * <tt>false</tt> otherwise.
      */
     public static boolean isValidPortNumber(int port)
     {
-        return MIN_PORT_NUMBER < port && port < MAX_PORT_NUMBER;
+        return MIN_PORT_NUMBER <= port && port <= MAX_PORT_NUMBER;
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -2465,6 +2465,8 @@ else if(uriStr.toLowerCase().startsWith("callto:"))
             uriStr = uriStr.substring("callto:".length());
         else if(uriStr.toLowerCase().startsWith("sips:"))
             uriStr = uriStr.substring("sips:".length());
+        else if(uriStr.toLowerCase().startsWith("sip:"))
+            uriStr = uriStr.substring("sip:".length());
 
         String user = uriStr;
         String remainder = "";

File: src/net/java/sip/communicator/impl/osdependent/systemtray/TrayIcon.java
Patch:
@@ -29,7 +29,7 @@
  */
 public interface TrayIcon
 {
-    public void addActionListener(ActionListener listener);
+    public void setDefaultAction(Object menuItem);
 
     public void addBalloonActionListener(ActionListener listener);
 

File: test/net/java/sip/communicator/slick/configuration/ConfigurationServiceLick.java
Patch:
@@ -52,7 +52,7 @@ public void start(BundleContext bundleContext) throws Exception
         properties.put("service.pid", getName());
 
         addTestSuite(TestConfigurationService.class);
-        addTestSuite(TestConfigurationServicePersistency.class);
+        //addTestSuite(TestConfigurationServicePersistency.class);
         addTestSuite(TestConfigurationSlickFinalizer.class);
         bundleContext.registerService(getClass().getName(), this, properties);
 

File: src/net/java/sip/communicator/impl/protocol/sip/ContactSipImpl.java
Patch:
@@ -172,7 +172,7 @@ void setParentGroup(ContactGroupSipImpl newParentGroup)
     public String getAddress()
     {
         SipURI sipURI = (SipURI) sipAddress.getURI();
-        return sipURI.getUser() + "@" + sipURI.getHost();
+        return sipURI.toString().substring(sipURI.getScheme().length() + 1);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/media/CallPeerMediaHandler.java
Patch:
@@ -1046,7 +1046,7 @@ public MediaStream getStream(MediaType mediaType)
         case VIDEO:
             return videoStream;
         default:
-            throw new IllegalArgumentException("mediaType");
+            return null;
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriBuilder.java
Patch:
@@ -549,8 +549,9 @@ public boolean addRtpDescription(
                 anyUpdates = true;
 
                 ColibriConferenceIQ.Channel channelRequest
-                    = request.getOrCreateContent(contentName)
-                        .getChannel(channel.getID());
+                    = (ColibriConferenceIQ.Channel) getRequestChannel(
+                            request.getOrCreateContent(contentName),
+                            channel);
                 if (channelRequest == null)
                 {
                     channelRequest = new ColibriConferenceIQ.Channel();

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriConferenceIQ.java
Patch:
@@ -1077,8 +1077,8 @@ protected void printAttributes(StringBuilder xml)
 
             if (adaptiveSimulcast != null)
             {
-                xml.append(' ').append(adaptiveSimulcast).append("='")
-                        .append(adaptiveSimulcast).append('\'');
+                xml.append(' ').append(ADAPTIVE_SIMULCAST_ATTR_NAME)
+                        .append("='").append(adaptiveSimulcast).append('\'');
             }
 
             // simulcastMode

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriConferenceIQ.java
Patch:
@@ -161,7 +161,7 @@ public boolean addChannelBundle(ChannelBundle channelBundle)
             throw new NullPointerException("channelBundle");
 
         return
-            channelBundles.contains(channelBundles)
+            channelBundles.contains(channelBundle)
                ? false
                : channelBundles.add(channelBundle);
     }

File: src/net/java/sip/communicator/impl/replacement/directimage/ReplacementServiceDirectImageImpl.java
Patch:
@@ -45,7 +45,7 @@ public class ReplacementServiceDirectImageImpl
      * The regex used to match the link in the message.
      */
     public static final String URL_PATTERN =
-        "https?\\:\\/\\/(www\\.)*.*\\.(?:jpg|png|gif)";
+        "https?\\:\\/\\/.*\\.(?:jpg|png|gif)";
 
     /**
      * Configuration label shown in the config form.

File: src/net/java/sip/communicator/impl/replacement/directimage/ReplacementServiceDirectImageImpl.java
Patch:
@@ -45,7 +45,7 @@ public class ReplacementServiceDirectImageImpl
      * The regex used to match the link in the message.
      */
     public static final String URL_PATTERN =
-        "https?\\:\\/\\/*.*\\.(?:jpg|png|gif)";
+        "https?\\:\\/\\/.*\\.(?:jpg|png|gif)";
 
     /**
      * Configuration label shown in the config form.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/AbstractPacketExtension.java
Patch:
@@ -32,7 +32,6 @@
  *
  * @author Emil Ivov
  * @author Lyubomir Marinov
- * 
  */
 public abstract class AbstractPacketExtension
     implements PacketExtension

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriIQProvider.java
Patch:
@@ -41,7 +41,7 @@ public class ColibriIQProvider
     /**
      * Smack interoperation layer
      */
-    AbstractSmackInteroperabilityLayer smackInteroperabilityLayer =
+    private AbstractSmackInteroperabilityLayer smackInteroperabilityLayer =
             AbstractSmackInteroperabilityLayer.getInstance();
     
     /** Initializes a new <tt>ColibriIQProvider</tt> instance. */

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetContactCapabilitiesJabberImpl.java
Patch:
@@ -489,7 +489,8 @@ public void userCapsNodeChanged(String user, ArrayList<String> fullJids,
             if(JabberActivator.getConfigurationService()
                 .getBoolean(
                     PROP_XMPP_USE_ALL_RESOURCES_FOR_CAPABILITIES,
-                    USE_ALL_RESOURCES_FOR_CAPABILITIES_DEFAULT))
+                    USE_ALL_RESOURCES_FOR_CAPABILITIES_DEFAULT)
+                && !fullJids.isEmpty())
             {
                 String bareJid = StringUtils.parseBareAddress(user);
                 Contact contact = opsetPresence.findContactByID(bareJid);
@@ -570,7 +571,7 @@ public void fireContactCapabilitiesChanged(String user,
             .getBoolean(
                 PROP_XMPP_USE_ALL_RESOURCES_FOR_CAPABILITIES,
                 USE_ALL_RESOURCES_FOR_CAPABILITIES_DEFAULT)
-            ||fullJids.isEmpty())
+            || fullJids.isEmpty())
         {
             OperationSetPresence opsetPresence
             = parentProvider.getOperationSet(OperationSetPresence.class);

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetContactCapabilitiesJabberImpl.java
Patch:
@@ -489,7 +489,8 @@ public void userCapsNodeChanged(String user, ArrayList<String> fullJids,
             if(JabberActivator.getConfigurationService()
                 .getBoolean(
                     PROP_XMPP_USE_ALL_RESOURCES_FOR_CAPABILITIES,
-                    USE_ALL_RESOURCES_FOR_CAPABILITIES_DEFAULT))
+                    USE_ALL_RESOURCES_FOR_CAPABILITIES_DEFAULT)
+                && !fullJids.isEmpty())
             {
                 String bareJid = StringUtils.parseBareAddress(user);
                 Contact contact = opsetPresence.findContactByID(bareJid);
@@ -570,7 +571,7 @@ public void fireContactCapabilitiesChanged(String user,
             .getBoolean(
                 PROP_XMPP_USE_ALL_RESOURCES_FOR_CAPABILITIES,
                 USE_ALL_RESOURCES_FOR_CAPABILITIES_DEFAULT)
-            ||fullJids.isEmpty())
+            || fullJids.isEmpty())
         {
             OperationSetPresence opsetPresence
             = parentProvider.getOperationSet(OperationSetPresence.class);

File: src/net/java/sip/communicator/plugin/desktoputil/wizard/SecurityPanel.java
Patch:
@@ -54,7 +54,7 @@ public class SecurityPanel
     private JPanel pnlAdvancedSettings;
     private JCheckBox enableDefaultEncryption;
     private JCheckBox enableSipZrtpAttribute;
-    private JComboBox cboSavpOption;
+    private JComboBox<SavpOption> cboSavpOption;
     private JTable tabCiphers;
     private CipherTableModel cipherModel;
     private JLabel cmdExpandAdvancedSettings;
@@ -410,7 +410,7 @@ public void mouseClicked(MouseEvent e)
             pnlAdvancedSettings.add(new JSeparator(), c);
         }
 
-        cboSavpOption = new JComboBox(new SavpOption[]{
+        cboSavpOption = new JComboBox<SavpOption>(new SavpOption[]{
             new SavpOption(0),
             new SavpOption(1),
             new SavpOption(2)

File: src/net/java/sip/communicator/plugin/sipaccregwizz/ConnectionPanel.java
Patch:
@@ -129,8 +129,7 @@ public void actionPerformed(ActionEvent e)
             }
         });
 
-        proxyForceBypassCheckBox =
-            new SIPCommCheckBox(
+        proxyForceBypassCheckBox = new SIPCommCheckBox(
                 Resources.getString("plugin.sipaccregwizz.PROXY_FORCE_BYPASS"),
                 regform.getRegistration().isProxyForceBypassConfigure());
         enablesProxyForceBypassConfigure(proxyForceBypassCheckBox.isSelected());
@@ -861,7 +860,7 @@ void enablesProxyAutoConfigure(boolean isEnable)
      */
     boolean isProxyForceBypassConfigureEnabled()
     {
-        return proxyAutoCheckBox.isSelected();
+        return proxyForceBypassCheckBox.isSelected();
     }
 
     /**

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationForm.java
Patch:
@@ -433,6 +433,7 @@ public void loadAccount(SIPAccountRegistration sipAccReg)
         connectionPanel.setCertificateId(clientTlsCertificateId);
 
         connectionPanel.enablesProxyAutoConfigure(proxyAutoConfigureEnabled);
+        connectionPanel.enablesProxyForceBypassConfigure(proxyForceBypassConfigureEnabled);
         connectionPanel.setServerPort(serverPort);
         connectionPanel.setProxy(proxyAddress);
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -2112,7 +2112,7 @@ public void run()
                         qualityControl.setPreferredRemoteSendMaxPreset(
                                 qualityPreset);
                     }
-                    catch(org.jitsi.service.protocol.OperationFailedException e)
+                    catch(Exception e)
                     {
                         logger.info("Unable to change video quality.", e);
 

File: src/net/java/sip/communicator/service/protocol/media/AbstractQualityControlWrapper.java
Patch:
@@ -18,7 +18,6 @@
 package net.java.sip.communicator.service.protocol.media;
 
 import org.jitsi.service.neomedia.*;
-import org.jitsi.service.protocol.*;
 
 /**
  * A wrapper of media quality control.
@@ -153,8 +152,8 @@ public void setRemoteSendMaxPreset(QualityPreset preset)
      * with those settings.
      *
      * @param preset the desired video settings
-     * @throws OperationFailedException
+     * @throws MediaException
      */
     public abstract void setPreferredRemoteSendMaxPreset(QualityPreset preset)
-        throws OperationFailedException;
+        throws MediaException;
 }

File: src/net/java/sip/communicator/service/protocol/media/MediaHandler.java
Patch:
@@ -32,7 +32,6 @@
 import org.jitsi.service.neomedia.device.*;
 import org.jitsi.service.neomedia.event.*;
 import org.jitsi.service.neomedia.format.*;
-import org.jitsi.service.protocol.*;
 import org.jitsi.util.event.*;
 
 /**

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationForm.java
Patch:
@@ -535,7 +535,7 @@ public boolean isWebSignupSupported()
      */
     public JabberAccountCreationFormService getCreateAccountService()
     {
-         return wizard.getCreateAccountService();
+         return null; //wizard.getCreateAccountService();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1157,7 +1157,7 @@ private ConnectState connectAndLogin(
                         getTrustManager(cvs, serviceName));
 
                 // log SSL/TLS algorithms and protocols
-                if (logger.isDebugEnabled())
+                if (logger.isDebugEnabled() && sslContext != null)
                 {
                     final StringBuilder buff = new StringBuilder();
                     buff.append("Available TLS protocols and algorithms:\n");

File: src/net/java/sip/communicator/util/ScLogFormatter.java
Patch:
@@ -50,7 +50,7 @@ public synchronized String format(LogRecord record)
         //current time
         Calendar cal = Calendar.getInstance();
         int year = cal.get(Calendar.YEAR);
-        int month = cal.get(Calendar.MONTH);
+        int month = cal.get(Calendar.MONTH) + 1;
         int day = cal.get(Calendar.DAY_OF_MONTH);
         int hour = cal.get(Calendar.HOUR_OF_DAY);
         int minutes = cal.get(Calendar.MINUTE);

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsConnectionImpl.java
Patch:
@@ -135,7 +135,7 @@ public synchronized ConnectionStatus connect()
     {
         try
         {
-            googleService.setOAuth2Credentials(this.store.get());
+            googleService.setOAuth2Credentials(this.store.get(this.login));
             return ConnectionStatus.SUCCESS;
         }
         catch (FailedAcquireCredentialException e)

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsServiceImpl.java
Patch:
@@ -68,7 +68,7 @@ public class GoogleContactsServiceImpl
     /**
      * Path where to store the account settings
      */
-    private final static String CONFIGURATION_PATH =
+    final static String CONFIGURATION_PATH =
         "net.java.sip.communicator.impl.googlecontacts";
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriConferenceIQ.java
Patch:
@@ -1029,7 +1029,7 @@ protected void printAttributes(StringBuilder xml)
 
             if (simulcastMode != null)
             {
-                xml.append(' ').append(SIMULCAST_MODE_ATTR_NAME).append("=")
+                xml.append(' ').append(SIMULCAST_MODE_ATTR_NAME).append("='")
                         .append(simulcastMode).append('\'');
             }
 

File: src/net/java/sip/communicator/impl/protocol/irc/IrcConnection.java
Patch:
@@ -222,6 +222,7 @@ private static CapabilityNegotiator determineNegotiator(final String user,
     {
         final ArrayList<Capability> capabilities = new ArrayList<Capability>();
         capabilities.add(new SimpleCapability("away-notify"));
+        capabilities.add(new SimpleCapability("multi-prefix"));
         final SASL sasl = config.getSASL();
         if (sasl != null)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1370,7 +1370,8 @@ private void registerServiceDiscoveryManager()
                     new String[] { "http://jabber.org/protocol/commands"},
                     // Add features Jitsi supports in addition to smack.
                     supportedFeatures.toArray(
-                            new String[supportedFeatures.size()]));
+                            new String[supportedFeatures.size()]),
+                    true);
 
         /*
          * Expose the discoveryManager as service-public through the

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/IceUdpTransportPacketExtension.java
Patch:
@@ -315,6 +315,7 @@ public static IceUdpTransportPacketExtension cloneTransportAndCandidates(
                 copy.setFingerprint(dtlsFingerprint.getFingerprint());
                 copy.setHash(dtlsFingerprint.getHash());
                 copy.setRequired(dtlsFingerprint.getRequired());
+                copy.setSetup(dtlsFingerprint.getSetup());
 
                 dst.addChildExtension(copy);
             }

File: src/net/java/sip/communicator/impl/protocol/irc/BasicPollerPresenceWatcher.java
Patch:
@@ -217,7 +217,8 @@ public void run()
             // The ISON reply contains the most overhead, so base the maximum
             // number of nicks limit on that.
             final int maxQueryLength =
-                MessageManager.IRC_PROTOCOL_MAXIMUM_MESSAGE_SIZE - overhead();
+                MessageManager.IRC_PROTOCOL_MAX_MESSAGE_SIZE
+                    - MessageManager.SAFETY_NET - overhead();
             for (String nick : list)
             {
                 if (query.length() + nick.length() >= maxQueryLength)

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberActivator.java
Patch:
@@ -139,7 +139,6 @@ public class JabberActivator
     public void start(BundleContext context) throws Exception
     {
         JabberActivator.bundleContext = context;
-        EntityCapsManager.setBundleContext(context);
 
         Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.JABBER);
@@ -158,6 +157,8 @@ public void start(BundleContext context) throws Exception
                     ProtocolProviderFactory.class.getName(),
                     jabberProviderFactory,
                     hashtable);
+
+        EntityCapsManager.setBundleContext(context);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriBuilder.java
Patch:
@@ -213,7 +213,7 @@ public ColibriBuilder addAllocateChannelsReq(
             }
         }
 
-        if (useBundle)
+        if (useBundle && contents.size() >= 1)
         {
             // Copy first transport to bundle
             ColibriConferenceIQ.ChannelBundle bundle

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -380,7 +380,7 @@ else if(calleeAddress.endsWith(GOOGLE_VOICE_DOMAIN))
             throw new OperationFailedException(
                     "Failed to create outgoing call to " + calleeAddress
                             + ". Could not find a resource which supports " +
-                            "Jingle or Google Talk",
+                            "Jingle",
                     OperationFailedException.INTERNAL_ERROR);
 
         DiscoverInfo di = null;
@@ -408,7 +408,7 @@ else if(calleeAddress.endsWith(GOOGLE_VOICE_DOMAIN))
 
             throw new OperationFailedException(
                     "Failed to create an outgoing call.\n"
-                    + fullCalleeURI + " does not support jingle or Google Talk",
+                    + fullCalleeURI + " does not support jingle",
                     OperationFailedException.INTERNAL_ERROR);
         }
 

File: src/net/java/sip/communicator/impl/protocol/irc/ProtocolProviderServiceIrcImpl.java
Patch:
@@ -303,6 +303,8 @@ public void register(final SecurityAuthority authority)
 
         // configure client options according to account properties
         final ClientConfigImpl config = new ClientConfigImpl();
+        // TODO makes allow-version-3 configurable in GUI
+        config.setVersion3Allowed(true);
         config.setContactPresenceTaskEnabled(contactPresenceTask);
         config.setChannelPresenceTaskEnabled(channelPresenceTask);
 

File: src/net/java/sip/communicator/impl/protocol/irc/IdentityManager.java
Patch:
@@ -26,6 +26,9 @@
  * TODO Query remote identity service for current identity-state such as:
  * unknown, unauthenticated, authenticated.
  *
+ * TODO Catch 900 (AUTHENTICATE LoggedIn) message and extract identity from
+ * there so that we do not have to do a separate WHOIS query.
+ *
  * @author Danny van Heumen
  */
 public class IdentityManager

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -144,10 +144,11 @@ public void connect(final String host, final int port,
                     irc.addListener(new DebugListener());
                 }
 
+                // FIXME Add option to enable/disable IRCv3.
                 // Synchronized IRCApi instance passed on to the connection
                 // instance.
                 this.session.set(new IrcConnection(this.context, config, irc,
-                    this.params, this));
+                    this.params, password, this));
 
                 this.provider.setCurrentRegistrationState(
                     RegistrationState.REGISTERED,

File: src/net/java/sip/communicator/impl/protocol/irc/SynchronizedIRCApi.java
Patch:
@@ -45,9 +45,10 @@ public SynchronizedIRCApi(final IRCApi irc)
 
     @Override
     public synchronized void connect(final IServerParameters aServerParameters,
-        final Callback<IIRCState> aCallback)
+        final Callback<IIRCState> aCallback,
+        final CapabilityNegotiator negotiator)
     {
-        this.irc.connect(aServerParameters, aCallback);
+        this.irc.connect(aServerParameters, aCallback, negotiator);
     }
 
     @Override

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaUIContact.java
Patch:
@@ -163,7 +163,8 @@ public int getSourceIndex()
         if(parentGroup != null)
             groupSourceIndex = parentGroup.indexOf(parentMetaContactGroup) 
                 * UIGroup.MAX_CONTACTS;
-        return  GuiActivator.getContactListService().getSourceIndex() 
+        return GuiActivator.getContactList()
+                .getMetaContactListSource().getIndex()
             * UIGroup.MAX_GROUPS + groupSourceIndex +
             parentMetaContactGroup.indexOf(metaContact) + 1;
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaUIGroup.java
Patch:
@@ -68,7 +68,8 @@ public Object getDescriptor()
     public int getSourceIndex()
     {
         MetaContactGroup parentGroup = metaGroup.getParentMetaContactGroup();
-        return GuiActivator.getContactListService().getSourceIndex() 
+        return GuiActivator.getContactList()
+                .getMetaContactListSource().getIndex()
             * MAX_GROUPS + 
             ((parentGroup == null)? 0 : (parentGroup.indexOf(metaGroup) + 1)) 
             * MAX_CONTACTS;

File: src/net/java/sip/communicator/impl/msghistory/MessageSourceService.java
Patch:
@@ -54,7 +54,7 @@ public class MessageSourceService
     /**
      * The type of the source service, the place to be shown in the ui.
      */
-    private int sourceServiceType = RECENT_MESSAGES_TYPE;
+    private int sourceServiceType = CONTACT_LIST_TYPE;
 
     /**
      * Whether to show recent messages in history or in contactlist.

File: src/net/java/sip/communicator/impl/muc/ChatRoomContactSourceService.java
Patch:
@@ -22,7 +22,7 @@ public class ChatRoomContactSourceService
      */
     public int getType()
     {
-        return CHAT_ROOM_TYPE;
+        return CONTACT_LIST_TYPE;
     }
 
     /**
@@ -75,7 +75,7 @@ public ContactQuery createContactQuery(String queryString, int contactCount)
     @Override
     public int getIndex()
     {
-        return 0;
+        return 1;
     }
 
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/UriHandlerJabberImpl.java
Patch:
@@ -317,7 +317,7 @@ public void handleUri(String uri)
                 = provider
                     .getOperationSet(OperationSetPersistentPresence.class);
 
-            String contactId = uri.replaceFirst(getProtocol() + ":", "");
+            String contactId = uri.substring(uri.indexOf(':') + 1);
 
             //todo check url!!
             //Set the email pattern string

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -705,6 +705,7 @@ public void currentChatTransportChanged(ChatSession chatSession)
     {
         setChatIcon(new ImageIcon(Constants.getStatusIcon(
             this.chatSession.getCurrentChatTransport().getStatus())));
+        this.writeMessagePanel.currentChatTransportChanged(chatSession);
     }
 
     /**
@@ -718,6 +719,7 @@ public void currentChatTransportUpdated(int eventID)
             setChatIcon(new ImageIcon(Constants.getStatusIcon(
                 this.chatSession.getCurrentChatTransport().getStatus())));
         }
+        this.writeMessagePanel.currentChatTransportUpdated(eventID);
     }
 
     /**

File: src/net/java/sip/communicator/plugin/otr/ScOtrEngineImpl.java
Patch:
@@ -1304,8 +1304,7 @@ public PublicKey getRemotePublicKey(OtrContact otrContact)
     public List<Session> getSessionInstances(OtrContact otrContact)
     {
         if (otrContact == null)
-            return null;
-
+            return Collections.emptyList();
         return getSession(otrContact).getInstances();
     }
 

File: src/net/java/sip/communicator/plugin/otr/authdialog/OTRv3OutgoingSessionSwitcher.java
Patch:
@@ -244,9 +244,6 @@ public void setCurrentContact(MetaContact metaContact)
      */
     public void setCurrentContact(Contact contact, String resourceName)
     {
-        if (this.contact != null && this.contact.contact == contact)
-            return;
-
         if (resourceName == null)
         {
             this.contact =

File: src/net/java/sip/communicator/impl/muc/ChatRoomQuery.java
Patch:
@@ -395,7 +395,7 @@ private boolean contactEqualsChatRoom(final ChatRoomSourceContact contact,
         final ChatRoom chatRoom)
     {
         return contact.getProvider() == chatRoom.getParentProvider()
-            && contact.getContactAddress().equals(chatRoom.getIdentifier());
+            && chatRoom.getIdentifier().equals(contact.getContactAddress());
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/presence/ReadonlyStatusItem.java
Patch:
@@ -98,7 +98,9 @@ public void setSelectedStatus(PresenceStatus status)
 
         tooltip = tooltip.substring(0, tooltip.lastIndexOf("<br>"));
 
-        this.setToolTipText(tooltip.concat("<br>" + status.getStatusName()));
+        if(status != null)
+            this.setToolTipText(
+                    tooltip.concat("<br>" + status.getStatusName()));
     }
 
     /**

File: src/net/java/sip/communicator/launcher/SIPCommunicator.java
Patch:
@@ -110,7 +110,7 @@ public static void main(String[] args)
                     "dns,dnsjava");
         }
 
-        if (version.startsWith("1.4") || vmVendor.startsWith("Gnu") ||
+        if (version.startsWith("1.5") || vmVendor.startsWith("Gnu") ||
                 vmVendor.startsWith("Free"))
         {
             String os = "";

File: src/net/java/sip/communicator/plugin/ircaccregwizz/FirstWizardPage.java
Patch:
@@ -77,8 +77,8 @@ public class FirstWizardPage
     private JLabel infoPassword
         = new JLabel(Resources.getString("plugin.ircaccregwizz.INFO_PASSWORD"));
 
-    private JLabel nick
-        = new JLabel(Resources.getString("plugin.ircaccregwizz.USERNAME"));
+    private JLabel nick = new JLabel(
+        Resources.getString("plugin.ircaccregwizz.USERNAME") + ":");
 
     private JLabel passLabel = new JLabel(
         Resources.getString("service.gui.PASSWORD") + ":");

File: src/net/java/sip/communicator/impl/protocol/irc/ProtocolProviderFactoryIrcImpl.java
Patch:
@@ -204,9 +204,8 @@ public void modifyAccount(final ProtocolProviderService protocolProvider,
         this.storeAccount(accountID);
 
         registration =
-            (ServiceRegistration<ProtocolProviderService>) context
-                .registerService(ProtocolProviderService.class.getName(),
-                    protocolProvider, properties);
+            context.registerService(ProtocolProviderService.class,
+                protocolProvider, properties);
 
         registeredAccounts.put(accountID, registration);
     }

File: src/net/java/sip/communicator/impl/protocol/irc/OperationSetPersistentPresenceIrcImpl.java
Patch:
@@ -539,7 +539,8 @@ Contact findOrCreateContactByID(final String id)
      * @param nick the nick
      * @param newStatus the new status
      */
-    void updateNickContactPresence(final String nick, final PresenceStatus newStatus)
+    void updateNickContactPresence(final String nick,
+        final PresenceStatus newStatus)
     {
         LOGGER.trace("Received presence update for nick '" + nick
             + "', status: " + newStatus.getStatus());

File: src/net/java/sip/communicator/impl/contactlist/MclStorageManager.java
Patch:
@@ -346,9 +346,8 @@ void start(BundleContext bc, MetaContactListServiceImpl mclServImpl)
         try
         {
             // load the contact list
-            DocumentBuilderFactory factory =
-                DocumentBuilderFactory.newInstance();
-            DocumentBuilder builder = factory.newDocumentBuilder();
+            DocumentBuilder builder
+                = XMLUtils.newDocumentBuilderFactory().newDocumentBuilder();
             if (contactlistFile.length() == 0)
             {
                 // if the contact list does not exist - create it.

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -1982,7 +1982,7 @@ private void transfer(CallPeer peer, Address target)
          * may choose to require a valid Referred-By token.
          */
         refer.addHeader( ((HeaderFactoryImpl) headerFactory)
-                .createReferredByHeader(sipPeer.getPeerAddress()));
+                .createReferredByHeader(dialog.getLocalParty()));
 
         protocolProvider.sendInDialogRequest(
                         sipPeer.getJainSipProvider(), refer, dialog);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -478,7 +478,8 @@ public String getMessageContents(String messageUID)
             return null;
         }
 
-        String res = new String(Base64.decode(original_message.toString()));
+        String res = new String(net.java.sip.communicator.util.Base64
+            .decode(original_message.toString()));
         // Remove all newline characters that were inserted to make copying
         // newlines from the conversation panel work.
         // They shouldn't be in the write panel, because otherwise a newline

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -478,7 +478,7 @@ public String getMessageContents(String messageUID)
             return null;
         }
 
-        String res = original_message.toString();
+        String res = new String(Base64.decode(original_message.toString()));
         // Remove all newline characters that were inserted to make copying
         // newlines from the conversation panel work.
         // They shouldn't be in the write panel, because otherwise a newline

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -608,8 +608,9 @@ else if (messageType.equals(Chat.SMS_MESSAGE))
         }
         else if (messageType.equals(Chat.STATUS_MESSAGE))
         {
-            chatString = "<h4 id=\"statusMessage\" date=\"" + date + "\">";
-            endHeaderTag = "</h4>";
+            chatString = "<div id=\"statusMessage\" date=\"" + date + "\""
+                + " style=\"color: #8F8F8F; font-size: 8px;\">";
+            endHeaderTag = "</div>";
 
             chatString +=
                 GuiUtils.formatTime(date)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -215,8 +215,9 @@ private void init()
         int roleIndex = role.getRoleIndex();
         String roleName = role.getLocalizedRoleName();
 
-        JLabel jl_username
-            = new JLabel(" "+chatContact.getName()+" ("+roleName+") ");
+        JLabel jl_username =
+            new JLabel(" " + chatContact.getName() + " ("
+                + GuiActivator.getResources().getI18NString(roleName) + ") ");
         jl_username.setFont(jl_username.getFont().deriveFont(Font.BOLD));
 
         this.add(jl_username);

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -27,6 +27,8 @@
 /**
  * An implementation of IRC using the irc-api library.
  *
+ * TODO remove Debug listener in case of disconnect by QUIT or ERROR
+ *
  * @author Danny van Heumen
  */
 public class IrcStack implements IrcConnectionListener

File: src/net/java/sip/communicator/impl/protocol/irc/MessageManager.java
Patch:
@@ -206,8 +206,10 @@ private void command(final String source, final String message)
         }
         catch (IllegalArgumentException e)
         {
+            final String error = e.getMessage();
             final String help = cmd.help();
-            throw new BadCommandInvocationException(msg, help, e);
+            throw new BadCommandInvocationException(msg, error + "\n" + help,
+                e);
         }
         catch (RuntimeException e)
         {

File: src/net/java/sip/communicator/impl/protocol/irc/command/Mode.java
Patch:
@@ -31,8 +31,7 @@ public class Mode implements Command
      * @param provider the provider instance
      * @param connection the connection instance
      */
-    @Override
-    public void init(final ProtocolProviderServiceIrcImpl provider,
+    public Mode(final ProtocolProviderServiceIrcImpl provider,
             final IrcConnection connection)
     {
         if (connection == null)

File: src/net/java/sip/communicator/impl/protocol/irc/command/Msg.java
Patch:
@@ -31,8 +31,7 @@ public class Msg implements Command
      * @param provider the provider instance
      * @param connection the connection instance
      */
-    @Override
-    public void init(final ProtocolProviderServiceIrcImpl provider,
+    public Msg(final ProtocolProviderServiceIrcImpl provider,
             final IrcConnection connection)
     {
         if (connection == null)

File: src/net/java/sip/communicator/impl/protocol/irc/command/Nick.java
Patch:
@@ -26,8 +26,7 @@ public class Nick implements Command
      * @param provider the provider instance
      * @param connection the connection instance
      */
-    @Override
-    public void init(final ProtocolProviderServiceIrcImpl provider,
+    public Nick(final ProtocolProviderServiceIrcImpl provider,
             final IrcConnection connection)
     {
         if (connection == null)

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -1468,8 +1468,7 @@ private void processContent(
     {
         RtpDescriptionPacketExtension description
             = JingleUtils.getRtpDescription(content);
-        MediaType mediaType
-            = MediaType.parseString(description.getMedia());
+        MediaType mediaType = JingleUtils.getMediaType(content);
 
         //stream target
         TransportManagerJabberImpl transportManager = getTransportManager();

File: src/net/java/sip/communicator/impl/protocol/irc/IrcConnection.java
Patch:
@@ -10,6 +10,7 @@
 import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
+import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
 import com.ircclouds.irc.api.*;
@@ -199,7 +200,8 @@ public void onFailure(final Exception e)
                 }
             });
 
-            provider.setCurrentRegistrationState(RegistrationState.REGISTERING);
+            provider.setCurrentRegistrationState(RegistrationState.REGISTERING,
+                RegistrationStateChangeEvent.REASON_USER_REQUEST);
 
             while (!result.isDone())
             {

File: src/net/java/sip/communicator/impl/certificate/CertificateServiceImpl.java
Patch:
@@ -27,6 +27,7 @@
 
 import org.bouncycastle.asn1.*;
 import org.bouncycastle.asn1.x509.*;
+import org.bouncycastle.asn1.x509.Extension;
 import org.bouncycastle.x509.extension.*;
 import org.jitsi.service.configuration.*;
 import org.jitsi.service.resources.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTelephonyConferencingJabberImpl.java
Patch:
@@ -487,7 +487,8 @@ protected String getLocalEntity(CallPeer callPeer)
             = (OperationSetMultiUserChatJabberImpl)
                 parentProvider.getOperationSet(OperationSetMultiUserChat.class);
         ChatRoom room = null;
-        room = opSetMUC.getChatRoom(chatRoomName);
+        if(opSetMUC != null)
+            room = opSetMUC.getChatRoom(chatRoomName);
         
         if(room != null)
             return "xmpp:" + chatRoomName + "/" + room.getUserNickname();

File: src/net/java/sip/communicator/impl/muc/MUCServiceImpl.java
Patch:
@@ -412,7 +412,8 @@ public ChatRoomWrapper createChatRoom(
      * @param join whether we should join the room after creating it.
      * @param persistent whether the newly created room will be persistent.
      * @param isPrivate whether the room will be private or public.
-     * @return the <tt>ChatRoomWrapper</tt> corresponding to the created room
+     * @return the <tt>ChatRoomWrapper</tt> corresponding to the created room or
+     *         <tt>null</tt> if the protocol fails to create the chat room.
      */
     public ChatRoomWrapper createChatRoom(
         String roomName,

File: src/net/java/sip/communicator/service/muc/MUCService.java
Patch:
@@ -169,7 +169,8 @@ public abstract ChatRoomWrapper createPrivateChatRoom(
     * @param join whether we should join the room after creating it.
     * @param persistent whether the newly created room will be persistent.
     * @param isPrivate whether the room will be private or public.
-    * @return the <tt>ChatRoomWrapper</tt> corresponding to the created room
+    * @return the <tt>ChatRoomWrapper</tt> corresponding to the created room or
+    *         <tt>null</tt> if the protocol failed to create the chat room
     */
     public abstract ChatRoomWrapper createChatRoom(String roomName,
         ProtocolProviderService protocolProvider, Collection<String> contacts,

File: src/net/java/sip/communicator/impl/protocol/irc/ChatRoomIrcImpl.java
Patch:
@@ -457,7 +457,7 @@ public void leave()
             this.parentProvider.getIrcStack().getConnection();
         if (connection == null)
         {
-            throw new IllegalStateException("Connection is not available.");
+            return;
         }
         connection.getChannelManager().leave(this);
         this.chatRoomMembers.clear();

File: src/net/java/sip/communicator/impl/protocol/irc/OperationSetBasicInstantMessagingIrcImpl.java
Patch:
@@ -111,10 +111,8 @@ public void sendInstantMessage(final Contact to, final Message original)
                 String transformedContent =
                     event.getSourceMessage().getContent();
 
-                // FIXME how to handle HTML content?
-
                 // Note: can't set subject since it leaks information while
-                // message content actually gets encrypted.
+                // message content actually did get encrypted.
                 MessageIrcImpl message = this.createMessage(transformedContent,
                     original.getContentType(), original.getEncoding(), "");
 

File: src/net/java/sip/communicator/impl/protocol/irc/IrcConnection.java
Patch:
@@ -152,7 +152,7 @@ public IrcConnection(final ProtocolProviderServiceIrcImpl provider,
 
         // instantiate presence manager for the connection
         this.presence =
-            new PresenceManager(irc, this.connectionState,
+            new PresenceManager(this.irc, this.connectionState,
                 this.provider.getPersistentPresence());
 
         // instantiate server channel lister
@@ -292,7 +292,8 @@ public void away(final boolean away, final String awayMessage)
      */
     public boolean isConnected()
     {
-        return this.connectionState.isConnected();
+        return this.connectionState != null
+            && this.connectionState.isConnected();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -1631,9 +1631,6 @@ public void onTopicChange(final TopicMessage msg)
             {
                 return;
             }
-
-            // FIXME Topic change event report message interprets HTML chars in
-            // channel name.
             this.chatroom.updateSubject(msg.getTopic().getValue());
         }
 

File: src/net/java/sip/communicator/impl/gui/main/account/Account.java
Patch:
@@ -302,6 +302,6 @@ public JCheckBox getEnableCheckBox()
     @Override
     public String toString()
     {
-        return protocolProvider.getAccountID().getDisplayName();
+        return accountID.getDisplayName();
     }
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriIQProvider.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.impl.protocol.jabber.extensions.colibri;
 
-import com.google.gdata.util.common.base.*;
 import net.java.sip.communicator.impl.protocol.jabber.extensions.*;
 import net.java.sip.communicator.impl.protocol.jabber.extensions.jingle.*;
 

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStatusEnum.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.impl.protocol.irc.*;
 import net.java.sip.communicator.service.protocol.*;
 
 /**

File: src/net/java/sip/communicator/util/Entities.java
Patch:
@@ -1028,7 +1028,7 @@ static class IntHashMap {
          */
         private static class Entry {
             final int hash;
-            final int key;
+//            final int key;
             Object value;
             Entry next;
 
@@ -1042,7 +1042,7 @@ private static class Entry {
              */
             protected Entry(int hash, int key, Object value, Entry next) {
                 this.hash = hash;
-                this.key = key;
+//                this.key = key;
                 this.value = value;
                 this.next = next;
             }

File: src/net/java/sip/communicator/plugin/otr/ScOtrEngine.java
Patch:
@@ -70,7 +70,7 @@ public abstract void respondSmp(OtrContact contact,
      * @param content the original message content.
      * @return the transformed message content.
      */
-    public abstract String transformSending(OtrContact contact, String content);
+    public abstract String[] transformSending(OtrContact contact, String content);
 
     /**
      * Transforms an incoming message.

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -2236,7 +2236,7 @@ public void connectionClosed()
         public void connectionClosedOnError(Exception exception)
         {
             logger.error("connectionClosedOnError " +
-                         exception.getLocalizedMessage());
+                         exception.getLocalizedMessage(), exception);
 
             if(exception instanceof XMPPException)
             {

File: src/net/java/sip/communicator/impl/credentialsstorage/CredentialsStorageServiceImpl.java
Patch:
@@ -75,7 +75,7 @@ public class CredentialsStorageServiceImpl
     void start(BundleContext bc)
     {
         configurationService
-                = ServiceUtils.getService(bc, ConfigurationService.class);
+            = ServiceUtils.getService(bc, ConfigurationService.class);
 
         /*
          * If a master password is set, the migration of the unencrypted
@@ -471,7 +471,8 @@ private String showPasswordPrompt()
 
         if(masterPasswordInputService == null)
         {
-            logger.error("Missing MasterPasswordInputService to show input dialog");
+            logger.error(
+                    "Missing MasterPasswordInputService to show input dialog");
             return null;
         }
 

File: src/net/java/sip/communicator/service/protocol/AccountManagerUtils.java
Patch:
@@ -113,8 +113,7 @@ public void handleAccountManagerEvent(AccountManagerEvent event)
                          */
                         factoryRefs = null;
                     }
-
-                    if (factoryRefs != null)
+                    if ((factoryRefs != null) && !factoryRefs.isEmpty())
                     {
                         boolean factoryIsRegistered = false;
 

File: src/net/java/sip/communicator/impl/gui/main/chat/SmileysSelectorBox.java
Patch:
@@ -112,7 +112,9 @@ private Dimension calculateGridDimensions(int itemsCount)
          * Was the intention to have the division produce a real number?
          */
         int gridRowCount = itemsCount / gridColCount;
-        
+        if (itemsCount > gridRowCount*gridColCount)
+            gridColCount++;
+
         return new Dimension(gridColCount, gridRowCount);
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -1469,7 +1469,7 @@ private void processContent(
         RtpDescriptionPacketExtension description
             = JingleUtils.getRtpDescription(content);
         MediaType mediaType
-            = MediaType.parseString(description.getMedia());
+            = JingleUtils.getMediaType(content);
 
         //stream target
         TransportManagerJabberImpl transportManager = getTransportManager();
@@ -1666,7 +1666,7 @@ public void processOffer(List<ContentPacketExtension> offer)
             RtpDescriptionPacketExtension description
                 = JingleUtils.getRtpDescription(content);
             MediaType mediaType
-                = MediaType.parseString( description.getMedia() );
+                = JingleUtils.getMediaType(content);
 
             List<MediaFormat> remoteFormats
                 = JingleUtils.extractFormats(

File: src/net/java/sip/communicator/impl/protocol/sip/UriHandlerSipImpl.java
Patch:
@@ -38,7 +38,7 @@ public class UriHandlerSipImpl
      * Default value for INITIAL_REGISTRATION_TIMEOUT (milliseconds)
      */
     public static final long DEFAULT_INITIAL_REGISTRATION_TIMEOUT
-        = 2000;
+        = 5000;
 
     /**
      * The <tt>Logger</tt> used by the <tt>UriHandlerSipImpl</tt> class and its

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomAutoOpenConfigDialog.java
Patch:
@@ -228,7 +228,7 @@ private void refreshValue()
                 propertyListener);
         
         if(value == null)
-            value = MUCService.OPEN_ON_IMPORTANT_MESSAGE;
+            value = MUCService.DEFAULT_AUTO_OPEN_BEHAVIOUR;
         
         if(value.equals(MUCService.OPEN_ON_ACTIVITY))
         {

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -24,9 +24,8 @@
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;
 
-import org.jitsi.util.*;
-
 import org.jdesktop.swingworker.SwingWorker;
+import org.jitsi.util.*;
 import org.osgi.framework.*;
 
 /**
@@ -214,7 +213,7 @@ public void messageReceived(ChatRoomMessageReceivedEvent evt)
                 sourceChatRoom.getParentProvider(),
                 sourceChatRoom.getIdentifier());
         if(autoOpenConfig == null)
-            autoOpenConfig = MUCService.OPEN_ON_IMPORTANT_MESSAGE;
+            autoOpenConfig = MUCService.DEFAULT_AUTO_OPEN_BEHAVIOUR;
 
         if(autoOpenConfig.equals(MUCService.OPEN_ON_ACTIVITY)
             || (autoOpenConfig.equals(MUCService.OPEN_ON_MESSAGE)

File: src/net/java/sip/communicator/impl/muc/MUCCustomContactActionService.java
Patch:
@@ -8,15 +8,15 @@
 
 import java.util.*;
 
-import org.jitsi.service.resources.*;
-
 import net.java.sip.communicator.plugin.desktoputil.chat.*;
 import net.java.sip.communicator.service.contactsource.*;
 import net.java.sip.communicator.service.customcontactactions.*;
 import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 
+import org.jitsi.service.resources.*;
+
 /**
  * Implements <tt>CustomContactActionsService</tt> for MUC contact source.
  *
@@ -643,7 +643,7 @@ public String getText(SourceContact actionSource)
                     ((ChatRoomSourceContact)actionSource).getProvider(),
                     ((ChatRoomSourceContact)actionSource).getChatRoomID());
             if(openAutomaticallyValue == null)
-                openAutomaticallyValue = MUCService.OPEN_ON_IMPORTANT_MESSAGE;
+                openAutomaticallyValue = MUCService.DEFAULT_AUTO_OPEN_BEHAVIOUR;
             String openAutomaticallyKey = MUCService.autoOpenConfigValuesTexts
                 .get(openAutomaticallyValue);
             return "<html>" + text +  "...<br><font size=\"2\"><center> ("

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -514,6 +514,9 @@ public List<String> getServerChatRoomList()
                 }
                 list = listSignal.getValue();
                 this.channellist.set(list);
+                // TODO Set a timer for past channel expiration delay and clean
+                // up outdated cached channel list. Because it won't be cleaned
+                // up if a user won't list server chat rooms again.
                 LOGGER.trace("Finished retrieving server chat room list.");
             }
             else

File: src/net/java/sip/communicator/plugin/ircaccregwizz/IrcAccRegWizzActivator.java
Patch:
@@ -87,7 +87,7 @@ public Class<?> getDependentServiceClass()
     @Override
     public void setBundleContext(final BundleContext context)
     {
-        this.bundleContext = context;
+        IrcAccRegWizzActivator.bundleContext = context;
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/SctpMapExtension.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package org.jitsi.jirecon.extension;
+package net.java.sip.communicator.impl.protocol.jabber.extensions.jingle;
 
 import org.jivesoftware.smack.packet.PacketExtension;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/SctpMapExtensionProvider.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package org.jitsi.jirecon.extension;
+package net.java.sip.communicator.impl.protocol.jabber.extensions.jingle;
 
 import org.jivesoftware.smack.packet.*;
 import org.jivesoftware.smack.provider.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/AbstractCallJabberGTalkImpl.java
Patch:
@@ -87,7 +87,7 @@ public T getPeer(String sid)
     {
         for(T peer : getCallPeerList())
         {
-            if (peer.getSID().equals(sid))
+            if (peer.getSID() != null && peer.getSID().equals(sid))
                 return peer;
         }
         return null;

File: src/net/java/sip/communicator/impl/gui/main/chat/ShowPreviewDialog.java
Patch:
@@ -15,12 +15,9 @@
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.plugin.desktoputil.SwingWorker;
 import net.java.sip.communicator.service.gui.*;
-import net.java.sip.communicator.service.replacement.*;
 import net.java.sip.communicator.service.replacement.directimage.*;
 import net.java.sip.communicator.util.*;
 
-import org.jitsi.service.configuration.*;
-
 public class ShowPreviewDialog
     extends SIPCommDialog
     implements ActionListener,

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigurationFrame.java
Patch:
@@ -253,6 +253,7 @@ public void run()
             this.configList.setSelectedIndex(0);
         }
         super.setVisible(isVisible);
+        super.toFront();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -1674,7 +1674,7 @@ private void initializeUserInterfaceHierarchy()
             settingsPanel.add(recordButton);
         if (showHideVideoButton != null)
             settingsPanel.add(showHideVideoButton);
-        if (mergeButton != null)
+        if (transferCallButton != null)
             settingsPanel.add(transferCallButton);
         if (videoButton != null)
             settingsPanel.add(videoButton);

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -1674,7 +1674,7 @@ private void initializeUserInterfaceHierarchy()
             settingsPanel.add(recordButton);
         if (showHideVideoButton != null)
             settingsPanel.add(showHideVideoButton);
-        if (mergeButton != null)
+        if (transferCallButton != null)
             settingsPanel.add(transferCallButton);
         if (videoButton != null)
             settingsPanel.add(videoButton);

File: src/net/java/sip/communicator/impl/protocol/irc/ChatRoomIrcImpl.java
Patch:
@@ -643,6 +643,9 @@ public String getUserNickname()
     public void setUserNickname(final String nickName)
         throws OperationFailedException
     {
+        // FIXME Consider not supporting this operation. Chat rooms can be
+        // configured to have their own nick name, which causes nick changes
+        // upon joining that particular chat room.
         try
         {
             parentProvider.getIrcStack().setUserNickname(nickName);

File: src/net/java/sip/communicator/plugin/desktoputil/VerifyCertificateDialogImpl.java
Patch:
@@ -242,7 +242,8 @@ private void actionShowCertificate()
         Component certInfoPane = null;
         if (!certs.isEmpty())
         {
-            certInfoPane = new X509CertificatePanel(certs);
+            certInfoPane = new X509CertificatePanel(
+                    certs.toArray(new X509Certificate[0]));
         }
         else
         {

File: src/net/java/sip/communicator/impl/protocol/irc/ChatRoomMemberIrcImpl.java
Patch:
@@ -214,6 +214,8 @@ public byte[] getAvatar()
      */
     public Contact getContact()
     {
+        // FIXME look up contact via Persistent Presence OS. It might already
+        // exist.
         return null;
     }
 

File: src/net/java/sip/communicator/plugin/desktoputil/ViewCertificateFrame.java
Patch:
@@ -124,7 +124,7 @@ private void init()
         this.getContentPane().add(contentPane, BorderLayout.CENTER);
 
         Component certInfoPane;
-        if(certs[0] instanceof X509Certificate)
+        if (certs[0] instanceof X509Certificate)
         {
             certInfoPane = new X509CertificatePanel(Arrays.asList((X509Certificate[])certs));
         }

File: src/net/java/sip/communicator/plugin/ircaccregwizz/FirstWizardPage.java
Patch:
@@ -39,8 +39,10 @@ public class FirstWizardPage
      */
     public static final String FIRST_PAGE_IDENTIFIER = "FirstPageIdentifier";
 
+    // FIXME create resource string
     public static final String USER_NAME_EXAMPLE = "Ex: ircuser";
 
+    // FIXME create resource string
     public static final String SERVER_EXAMPLE = "Ex: chat.freenode.net";
     
     private static final String DEFAULT_PLAINTEXT_PORT = "6667";

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -1086,9 +1086,9 @@ public void onUserPrivMessage(final UserPrivMsg msg)
                     OperationSetBasicInstantMessaging.HTML_MIME_TYPE,
                     OperationSetBasicInstantMessaging.DEFAULT_MIME_ENCODING,
                     null);
-            Contact from =
-                IrcStack.this.provider.getPersistentPresence().findContactByID(
-                    user);
+            final Contact from =
+                IrcStack.this.provider.getPersistentPresence()
+                    .findOrCreateContactByID(user);
             try
             {
                 IrcStack.this.provider.getBasicInstantMessaging()

File: src/net/java/sip/communicator/impl/protocol/irc/MessageIrcImpl.java
Patch:
@@ -61,7 +61,7 @@ public boolean isCommand()
      */
     public boolean isAction()
     {
-        return getContent().startsWith("/me");
+        return getContent().startsWith("/me ");
     }
 
     /**

File: src/net/java/sip/communicator/service/muc/MUCService.java
Patch:
@@ -229,8 +229,8 @@ public static boolean isPrivate(ChatRoom chatRoom)
             {
                 for (ChatRoomMember member : chatRoom.getMembers())
                     if (nickname.equals(member.getName()))
-                        return true;
-                return false;
+                        return false;
+                return true;
             }
         }
         return false;

File: src/net/java/sip/communicator/service/muc/MUCService.java
Patch:
@@ -229,8 +229,8 @@ public static boolean isPrivate(ChatRoom chatRoom)
             {
                 for (ChatRoomMember member : chatRoom.getMembers())
                     if (nickname.equals(member.getName()))
-                        return false;
-                return true;
+                        return true;
+                return false;
             }
         }
         return false;

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -1066,7 +1066,7 @@ public void onChannelKick(ChannelKick msg)
             if (isMe(kickedUser))
             {
                 IrcStack.this.irc.deleteListener(this);
-                IrcStack.this.joined.remove(this.chatroom);
+                IrcStack.this.joined.remove(this.chatroom.getIdentifier());
                 IrcStack.this.provider.getMUC().fireLocalUserPresenceEvent(
                     this.chatroom,
                     LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_KICKED,
@@ -1158,7 +1158,7 @@ public void onChannelMessage(ChannelPrivMsg msg)
         private void leaveChatRoom()
         {
             IrcStack.this.irc.deleteListener(this);
-            IrcStack.this.joined.remove(this.chatroom);
+            IrcStack.this.joined.remove(this.chatroom.getIdentifier());
             IrcStack.this.provider.getMUC().fireLocalUserPresenceEvent(
                 this.chatroom,
                 LocalUserChatRoomPresenceChangeEvent.LOCAL_USER_LEFT, null);

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -1630,9 +1630,9 @@ private String checkNick(String nick)
             if (nick == null)
                 throw new IllegalArgumentException(
                     "a nick name must be provided");
-            if (nick.startsWith("#"))
+            if (nick.startsWith("#") || nick.startsWith("&"))
                 throw new IllegalArgumentException(
-                    "the nick name must not start with '#' "
+                    "the nick name must not start with '#' or '&' "
                         + "since this is reserved for IRC channels");
             return nick;
         }

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -221,17 +221,18 @@ public void onFailure(Exception e)
                     // the exception if one exists
                     this.provider
                         .setCurrentRegistrationState(
-                            RegistrationState.UNREGISTERED);
+                            RegistrationState.CONNECTION_FAILED);
                     Exception e = result.getException();
                     if (e != null)
                         throw e;
                 }
             }
             catch (IOException e)
             {
+                // Also SSL exceptions will be caught here.
                 this.provider
                     .setCurrentRegistrationState(
-                        RegistrationState.UNREGISTERED);
+                        RegistrationState.CONNECTION_FAILED);
                 throw e;
             }
             catch (InterruptedException e)

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -488,7 +488,7 @@ public void onSuccess(IRCChannel channel)
                         {
                             try
                             {
-                                if (!channel.getName().equals(
+                                if (!channel.getName().equalsIgnoreCase(
                                     actualChatRoom.getIdentifier()))
                                 {
                                     // If the channel name is not the
@@ -1334,7 +1334,7 @@ else if (source instanceof IRCUser)
          */
         private boolean isThisChatRoom(String chatRoomName)
         {
-            return this.chatroom.getIdentifier().equals(chatRoomName);
+            return this.chatroom.getIdentifier().equalsIgnoreCase(chatRoomName);
         }
 
         /**

File: src/net/java/sip/communicator/impl/protocol/irc/ChatRoomIrcImpl.java
Patch:
@@ -1070,7 +1070,8 @@ public boolean isPrivate()
         // TODO Since we cannot change the chat room name/identifier maybe we
         // should compute this upon construction and save the result, instead of
         // doing a string operation every time the method is called.
-        return !this.chatRoomName.startsWith("#");
+        return !this.chatRoomName.startsWith("#")
+            && !this.chatRoomName.startsWith("&");
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -31,6 +31,7 @@
  * @author Danny van Heumen
  * 
  * TODO Make irc-api OSGi aware.
+ * FIXME Surround expensive LOGGER calls with if-conditions.
  */
 public class IrcStack
 {

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -310,6 +310,7 @@ public String getNick()
      */
     public void setUserNickname(String nick)
     {
+        LOGGER.trace("Setting user's nick name to " + nick);
         if (this.connectionState == null)
         {
             this.params.setNickname(nick);
@@ -333,8 +334,9 @@ public void setSubject(ChatRoomIrcImpl chatroom, String subject)
                 "Please connect to an IRC server first.");
         if (chatroom == null)
             throw new IllegalArgumentException("Cannot have a null chatroom");
+        LOGGER.trace("Setting chat room topic to '" + subject + "'");
         this.irc
-            .changeTopic(chatroom.getName(), subject == null ? "" : subject);
+            .changeTopic(chatroom.getIdentifier(), subject == null ? "" : subject);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/irc/ChatRoomIrcImpl.java
Patch:
@@ -116,7 +116,7 @@ public class ChatRoomIrcImpl
     /**
      * The role of the local user for this chat room.
      */
-    private ChatRoomMemberRole userRole = ChatRoomMemberRole.MEMBER;
+    private ChatRoomMemberRole userRole = ChatRoomMemberRole.SILENT_MEMBER;
 
     /**
      * Creates an instance of <tt>ChatRoomIrcImpl</tt>, by specifying the room

File: src/net/java/sip/communicator/plugin/ircaccregwizz/FirstWizardPage.java
Patch:
@@ -185,7 +185,9 @@ private void init(String userId, String server)
         this.defaultPort.setSelected(true);
         this.passwordNotRequired.setSelected(true);
         this.useSecureConnection.setSelected(true);
-        this.portField.setText(this.useSecureConnection.isSelected() ? DEFAULT_SECURE_PORT : DEFAULT_PLAINTEXT_PORT);
+        this.portField
+            .setText(this.useSecureConnection.isSelected() ? DEFAULT_SECURE_PORT
+                : DEFAULT_PLAINTEXT_PORT);
 
         this.nickExampleLabel.setForeground(Color.GRAY);
         this.nickExampleLabel.setFont(

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -111,7 +111,7 @@ public boolean isSecureConnection()
      * @throws Exception
      */
     public void connect(String host, int port, String password,
-        boolean autoNickChange) throws Exception
+        boolean secureConnection, boolean autoNickChange) throws Exception
     {
         if (this.irc != null && this.connectionState != null
             && this.connectionState.isConnected())
@@ -124,7 +124,7 @@ public void connect(String host, int port, String password,
         final Exception[] exceptionContainer = new Exception[1];
 
         this.irc = new IRCApiImpl(true);
-        this.params.setServer(new IRCServer(host, port, password, false));
+        this.params.setServer(new IRCServer(host, port, password, secureConnection));
         synchronized (this.irc)
         {
             // register a server listener in order to catch server and cross-/multi-channel messages

File: src/net/java/sip/communicator/impl/protocol/irc/ModeParser.java
Patch:
@@ -63,6 +63,9 @@ private ModeEntry process(boolean add, char mode)
             return new ModeEntry(add, Mode.bySymbol(mode), this.params[this.index++]);
         case 'v':
             return new ModeEntry(add, Mode.bySymbol(mode), this.params[this.index++]);
+        case 'l':
+            String[] params = (add ? new String[] { this.params[this.index++] } : new String[]{});
+            return new ModeEntry(add, Mode.bySymbol(mode), params);
         default:
             throw new IllegalArgumentException(""+mode);
         }

File: src/net/java/sip/communicator/impl/credentialsstorage/CredentialsStorageServiceImpl.java
Patch:
@@ -10,6 +10,7 @@
 
 import net.java.sip.communicator.service.credentialsstorage.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.Base64; // disambiguation
 
 import org.jitsi.service.configuration.*;
 import org.osgi.framework.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/sasl/SASLDigestMD5Mechanism.java
Patch:
@@ -13,7 +13,7 @@
 import javax.security.sasl.*;
 
 import org.jivesoftware.smack.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.Base64; // disambiguation
 
 /**
  * Creates our custom SASLDigestMD5Mechanism with some changes in order

File: src/net/java/sip/communicator/impl/protocol/sip/ServerStoredContactListSipImpl.java
Patch:
@@ -23,6 +23,7 @@
 import net.java.sip.communicator.service.protocol.ServerStoredDetails.ImageDetail;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.Base64; // disambiguation
 
 import org.jitsi.util.xml.XMLUtils;
 import org.w3c.dom.*;

File: src/net/java/sip/communicator/impl/protocol/ssh/ContactSSHImpl.java
Patch:
@@ -14,10 +14,11 @@
 import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.Base64; // disambiguation
 import net.java.sip.communicator.util.Logger;
 
 import com.jcraft.jsch.*;
+// disambiguation
 
 /**
  * A Contact of SSH Type

File: src/net/java/sip/communicator/plugin/otr/OtrConfigurator.java
Patch:
@@ -8,7 +8,7 @@
 
 import java.util.*;
 
-import org.bouncycastle.util.encoders.*;
+import org.bouncycastle.util.encoders.Base64; // disambiguation
 import org.jitsi.service.configuration.*;
 
 /**

File: src/net/java/sip/communicator/service/protocol/AccountManager.java
Patch:
@@ -11,6 +11,7 @@
 import net.java.sip.communicator.service.credentialsstorage.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.Base64; // disambiguation
 
 import org.jitsi.service.configuration.*;
 import org.osgi.framework.*;

File: test/net/java/sip/communicator/slick/protocol/sip/TestOperationSetServerStoredInfo.java
Patch:
@@ -16,7 +16,7 @@
 import net.java.sip.communicator.impl.protocol.sip.xcap.*;
 import net.java.sip.communicator.impl.protocol.sip.xcap.model.prescontent.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.Base64; // disambiguation
 
 /**
  * Testing of the user and account info. Tests for reading, adding, removing,

File: test/net/java/sip/communicator/slick/slickless/util/TestBase64.java
Patch:
@@ -9,7 +9,7 @@
 import java.util.*;
 
 import junit.framework.*;
-import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.Base64; // disambiguation
 
 /**
  * Tests the methods of the Base64 class.

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -1288,7 +1288,8 @@ public boolean dispatchKeyEvent(KeyEvent e)
 
             // Don't re-dispatch any events if the menu is active. Fixes the
             // navigation in the menu.
-            if (menuBar.isSelected())
+            if (menuBar.getSelectedMenu() != null
+                && menuBar.getSelectedMenu().isPopupMenuVisible())
             {
                 return false;
             }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -237,7 +237,6 @@ public ChatConversationPanel(ChatConversationContainer chatContainer)
         this.chatTextPane.setEditable(false);
         this.chatTextPane.setDocument(document);
         this.chatTextPane.setDragEnabled(true);
-        this.chatTextPane.setFocusable(false);
 
         chatTextPane.putClientProperty(
             JEditorPane.HONOR_DISPLAY_PROPERTIES, Boolean.TRUE);

File: src/net/java/sip/communicator/impl/protocol/sip/CallSipImpl.java
Patch:
@@ -451,7 +451,8 @@ public CallPeerSipImpl processInvite(SipProvider       jainSipProvider,
             serverTran.sendResponse(response);
 
             if(serverTran instanceof SIPTransaction
-                && !((SIPTransaction)serverTran).isReliable())
+                && !((SIPTransaction)serverTran).isReliable()
+                && peer.getState().equals(CallPeerState.INCOMING_CALL))
             {
                 final Timer timer = new Timer();
                 CallPeerAdapter stateListener = new CallPeerAdapter()

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -487,6 +487,8 @@ private MessageDeliveredEvent sendMessage(  Contact to,
             threadID = nextThreadID();
 
         msg.setThread(threadID);
+        msg.setType(org.jivesoftware.smack.packet.Message.Type.chat);
+        msg.setFrom(jabberProvider.getConnection().getUser());
 
         jabberProvider.getConnection().sendPacket(msg);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -304,7 +304,8 @@ public Chat obtainChatInstance(String toAddress,
 
         if (ta != null
             && ta.chat != null
-            && ta.jid.equals(jid))
+            && ta.jid.equals(jid)
+            && ta.chat.getParticipant().equals(jid))
         {
             return ta.chat;
         }
@@ -324,7 +325,6 @@ public void processMessage(
                 }
             };
 
-
         //we don't have a thread for this chat, so let's create one.
         Chat chat = jabberConnection.getChatManager()
                 .createChat(jid, msgListener);

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -1544,8 +1544,7 @@ private void processContent(
         {
             for (CallPeerJabberImpl peer : call.getCallPeerList())
             {
-                SendersEnum senders
-                    = peer.getSenders(mediaType);
+                SendersEnum senders = peer.getSenders(mediaType);
                 boolean initiator = peer.isInitiator();
                 //check if the direction of the jingle session we have with
                 //this peer allows us receiving media. If senders is null,

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/ConferenceMediumPacketExtension.java
Patch:
@@ -152,7 +152,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/DescriptionPacketExtension.java
Patch:
@@ -155,7 +155,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/EndpointPacketExtension.java
Patch:
@@ -187,7 +187,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/ExecutionPacketExtension.java
Patch:
@@ -162,7 +162,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/HostInfoPacketExtension.java
Patch:
@@ -112,7 +112,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/MediaPacketExtension.java
Patch:
@@ -212,7 +212,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/SIPDialogIDPacketExtension.java
Patch:
@@ -94,7 +94,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/StatePacketExtension.java
Patch:
@@ -144,7 +144,7 @@ public String toXML()
            bldr.append("xmlns='").append(getNamespace()).append("'");
 
        //add the rest of the attributes if any
-       for(Map.Entry<String, String> entry : attributes.entrySet())
+       for(Map.Entry<String, Object> entry : attributes.entrySet())
        {
            bldr.append(" ")
                    .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/URIPacketExtension.java
Patch:
@@ -116,7 +116,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/UserLanguagesPacketExtension.java
Patch:
@@ -84,7 +84,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/UserPacketExtension.java
Patch:
@@ -96,7 +96,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/UserRolesPacketExtension.java
Patch:
@@ -84,7 +84,7 @@ public String toXML()
             bldr.append("xmlns='").append(getNamespace()).append("'");
 
         //add the rest of the attributes if any
-        for(Map.Entry<String, String> entry : attributes.entrySet())
+        for(Map.Entry<String, Object> entry : attributes.entrySet())
         {
             bldr.append(" ")
                     .append(entry.getKey())

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTypingNotificationsJabberImpl.java
Patch:
@@ -465,7 +465,8 @@ public void stateChanged(Chat chat,
                 {
                     //create the volatile contact
                     sourceContact = opSetPersPresence.createVolatileContact(
-                        chat.getParticipant(), isPrivateMessagingAddress);
+                        (isPrivateMessagingAddress? message.getFrom() : 
+                            chat.getParticipant()), isPrivateMessagingAddress);
                 }
             }
 

File: src/net/java/sip/communicator/impl/neomedia/DeviceConfigurationComboBoxModel.java
Patch:
@@ -26,6 +26,7 @@
  */
 public class DeviceConfigurationComboBoxModel
     implements ComboBoxModel,
+               ListModel,
                PropertyChangeListener
 {
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -1619,7 +1619,7 @@ private void initializeUserInterfaceHierarchy()
 
         localLevel
             = new InputVolumeControlButton(
-                    aCall,
+                    callConference,
                     ImageLoader.MICROPHONE,
                     ImageLoader.MUTE_BUTTON,
                     true,

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -369,7 +369,7 @@ private void createSoundLevelIndicators()
 
         localLevel
             = new InputVolumeControlButton(
-                    call,
+                    call.getConference(),
                     ImageLoader.MICROPHONE,
                     ImageLoader.MUTE_BUTTON,
                     false,

File: src/net/java/sip/communicator/service/protocol/AbstractCallPeer.java
Patch:
@@ -274,9 +274,9 @@ public void addConferenceMember(ConferenceMember conferenceMember)
      *
      * @param errorMessage error message that can be displayed.
      */
-    public void fireConferenceMemberErrorEvent(String errorMessge)
+    public void fireConferenceMemberErrorEvent(String errorMessage)
     {
-        if(errorMessge == null || errorMessge.length() == 0)
+        if(errorMessage == null || errorMessage.length() == 0)
         {
             logger.warn("The error message for " + this.getDisplayName()
                 + " null or empty string.");
@@ -289,7 +289,7 @@ public void fireConferenceMemberErrorEvent(String errorMessge)
                 CallPeerConferenceEvent
                     .CONFERENCE_MEMBER_ERROR_RECEIVED,
                 null,
-                errorMessge));
+                errorMessage));
     }
     /**
      * Finds the first <tt>ConferenceMember</tt> whose <tt>audioSsrc</tt> is

File: src/net/java/sip/communicator/impl/protocol/jabber/VolatileContactJabberImpl.java
Patch:
@@ -94,8 +94,6 @@ public class VolatileContactJabberImpl
                 setJid(id);
             }
         }
-
-
     }
 
     /**

File: src/net/java/sip/communicator/plugin/addrbook/msoutlook/calendar/RecurringPattern.java
Patch:
@@ -220,12 +220,14 @@ public static PatternType getFromShort(short value)
      * Parses the binary data that describes the recurrent pattern.
      * @param data the binary data.
      * @param sourceTask the calendar item.
+     * @throws IndexOutOfBoundsException if data can't be parsed.
      */
     public RecurringPattern(byte[] data, CalendarItemTimerTask sourceTask)
+    throws IndexOutOfBoundsException
     {
         this.sourceTask = sourceTask;
         dataBuffer = ByteBuffer.wrap(data).order(ByteOrder.LITTLE_ENDIAN);
-
+        
         int offset = 4;
         recurFrequency = dataBuffer.getShort(offset);
         offset += 2;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatHtmlUtils.java
Patch:
@@ -49,12 +49,12 @@ public class ChatHtmlUtils
     /**
      * The closing tag of the <code>PLAINTEXT</code> HTML element.
      */
-    private static final String END_PLAINTEXT_TAG = "</PLAINTEXT>";
+    public static final String END_PLAINTEXT_TAG = "</PLAINTEXT>";
 
     /**
      * The opening tag of the <code>PLAINTEXT</code> HTML element.
      */
-    private static final String START_PLAINTEXT_TAG = "<PLAINTEXT>";
+    public static final String START_PLAINTEXT_TAG = "<PLAINTEXT>";
 
     /**
      * The html text content type.

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -1095,7 +1095,8 @@ private void appendChatMessage(ChatMessage chatMessage)
     {
         String keyword = null;
 
-        if (chatSession instanceof ConferenceChatSession && Chat.INCOMING_MESSAGE.equals(chatMessage.getMessageType()))
+        if (chatSession instanceof ConferenceChatSession
+            && Chat.INCOMING_MESSAGE.equals(chatMessage.getMessageType()))
         {
             keyword =
                 ((ChatRoomWrapper) chatSession.getDescriptor()).getChatRoom()

File: src/net/java/sip/communicator/impl/replacement/bliptv/ReplacementServiceBliptvImpl.java
Patch:
@@ -32,8 +32,7 @@ public class ReplacementServiceBliptvImpl
      * The regex used to match the link in the message.
      */
     public static final String BLIPTV_PATTERN =
-        "(?<=>)(http:\\/\\/(?:www\\.)?blip\\.tv"
-        + "\\/file\\/(\\d+)([?&\\?]\\w+=[\\w-]+)*)(?=</A>)";
+        "(http:\\/\\/(?:www\\.)?blip\\.tv\\/.*)";
 
     /**
      * Configuration label shown in the config form.
@@ -64,7 +63,8 @@ public String getReplacement(String sourceString)
     {
         try
         {
-            String url = "http://oohembed.com/oohembed/?url=" + sourceString;
+            String url = "http://api.embed.ly/1/oembed?url=" + sourceString
+                + "&key=cff57b37766440a6a8aa45df88097efe";
 
             URL sourceURL = new URL(url);
             URLConnection conn = sourceURL.openConnection();

File: src/net/java/sip/communicator/impl/replacement/dailymotion/ReplacementServiceDailymotionImpl.java
Patch:
@@ -29,8 +29,8 @@ public class ReplacementServiceDailymotionImpl
      * The regex used to match the link in the message.
      */
     public static final String DAILYMOTION_PATTERN =
-        "(?<=>)(https?\\:\\/\\/(www\\.)*?dailymotion\\.com"
-        + "\\/video\\/([a-zA-Z0-9_\\-]+))([?#]([a-zA-Z0-9_\\-]+))*(?=</A>)";
+        "(https?\\:\\/\\/(www\\.)*?dailymotion\\.com"
+        + "\\/video\\/([a-zA-Z0-9_\\-]+))([?#]([a-zA-Z0-9_\\-]+))*";
 
     /**
      * Configuration label shown in the config form.

File: src/net/java/sip/communicator/impl/replacement/directimage/ReplacementServiceDirectImageImpl.java
Patch:
@@ -33,7 +33,7 @@ public class ReplacementServiceDirectImageImpl
      * The regex used to match the link in the message.
      */
     public static final String URL_PATTERN =
-        "[^<>]+\\.(?:jpg|png|gif)[^<>]*(?=</a>)";
+        "https?\\:\\/\\/(www\\.)*.*\\.(?:jpg|png|gif)";
 
     /**
      * Configuration label shown in the config form.

File: src/net/java/sip/communicator/impl/replacement/flickr/ReplacementServiceFlickrImpl.java
Patch:
@@ -33,8 +33,8 @@ public class ReplacementServiceFlickrImpl
      * The regex used to match the link in the message.
      */
     public static final String FLICKR_PATTERN =
-        "(?<=>)(https?\\:\\/\\/(www\\.)*?flickr\\.com"
-        + "\\/photos\\/[0-9a-zA-Z_\\-\\@]+\\/([0-9]+)(\\/[^\"\\<]*)*)(?=</A>)";
+        "(https?\\:\\/\\/(www\\.)*?flickr\\.com"
+        + "\\/photos\\/[0-9a-zA-Z_\\-\\@]+\\/([0-9]+)(\\/[^\"\\<]*)*)";
 
     /**
      * API Key required to access the Flickr api.
@@ -107,7 +107,7 @@ public String getReplacement(String sourceString)
                     JSONObject result = (JSONObject)wrapper.get("photo");
                     if (!(result.isEmpty()))
                     {
-                        String farmID = (String)result.get("farm");
+                        String farmID = String.valueOf(result.get("farm"));
                         String serverID = (String)result.get("server");
                         String secret = (String)result.get("secret");
 

File: src/net/java/sip/communicator/impl/replacement/metacafe/ReplacementServiceMetacafeImpl.java
Patch:
@@ -29,8 +29,8 @@ public class ReplacementServiceMetacafeImpl
      * The regex used to match the link in the message.
      */
     public static final String METACAFE_PATTERN =
-        "(?<=>)(https?\\:\\/\\/(www\\.)*?metacafe\\.com"
-        + "\\/watch\\/([a-zA-Z0-9_\\-]+))(\\/[a-zA-Z0-9_\\-\\/]+)*(?=</A>)";
+        "(https?\\:\\/\\/(www\\.)*?metacafe\\.com"
+        + "\\/watch\\/([a-zA-Z0-9_\\-]+))(\\/[a-zA-Z0-9_\\-\\/]+)*";
 
     /**
      * Configuration label shown in the config form.

File: src/net/java/sip/communicator/impl/replacement/viddler/ReplacementServiceViddlerImpl.java
Patch:
@@ -30,8 +30,8 @@ public class ReplacementServiceViddlerImpl
      * The regex used to match the link in the message.
      */
     public static final String VIDDLER_PATTERN =
-        "(?<=>)(http:\\/\\/(?:www\\.)?viddler\\.com"
-        + "\\/explore\\/(\\w+)\\/videos\\/\\d+.*(?=<\\/A>))";
+        "(http:\\/\\/(?:www\\.)?viddler\\.com"
+        + "\\/explore\\/(\\w+)\\/videos\\/\\d+.*)";
 
     /**
      * API Key required to access the viddler api.

File: src/net/java/sip/communicator/impl/replacement/vimeo/ReplacementServiceVimeoImpl.java
Patch:
@@ -33,8 +33,8 @@ public class ReplacementServiceVimeoImpl
      * The regex used to match the link in the message.
      */
     public static final String VIMEO_PATTERN =
-        "(?<=>)(https?\\:\\/\\/(www\\.)*?vimeo\\.com"
-        + "\\/([a-zA-Z0-9_\\-]+))(?=</A>)";
+        "(https?\\:\\/\\/(www\\.)*?vimeo\\.com"
+        + "\\/([a-zA-Z0-9_\\-]+))";
 
     /**
      * Configuration label shown in the config form.

File: src/net/java/sip/communicator/impl/replacement/youtube/ReplacementServiceYoutubeImpl.java
Patch:
@@ -29,8 +29,8 @@ public class ReplacementServiceYoutubeImpl
      * The regex used to match the link in the message.
      */
     public static final String YOUTUBE_PATTERN =
-        "(?<=>)(https?\\:\\/\\/(www\\.)*?youtube\\.com"
-        + "\\/watch\\?v=([a-zA-Z0-9_\\-]+))([?&]\\w+=[\\w-]+)*(?=</A>)";
+        "(https?\\:\\/\\/(www\\.)*?youtube\\.com"
+        + "\\/watch\\?v=([a-zA-Z0-9_\\-]+))([?&]\\w+=[\\w-]+)*";
 
     /**
      * Configuration label shown in the config form.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/colibri/ColibriIQProvider.java
Patch:
@@ -9,7 +9,6 @@
 import net.java.sip.communicator.impl.protocol.jabber.extensions.*;
 import net.java.sip.communicator.impl.protocol.jabber.extensions.jingle.*;
 
-import net.java.sip.communicator.service.protocol.*;
 import org.jitsi.service.neomedia.*;
 import org.jitsi.util.*;
 import org.jivesoftware.smack.packet.*;

File: src/net/java/sip/communicator/plugin/desktoputil/MessageDialog.java
Patch:
@@ -37,7 +37,7 @@ public class MessageDialog
     protected JButton okButton = new JButton(
         DesktopUtilActivator.getResources().getI18NString("service.gui.OK"));
 
-    private JCheckBox doNotAskAgain = new SIPCommCheckBox(
+    protected JCheckBox doNotAskAgain = new SIPCommCheckBox(
         DesktopUtilActivator.getResources()
             .getI18NString("service.gui.DO_NOT_ASK_AGAIN"));
 
@@ -49,15 +49,15 @@ public class MessageDialog
     private TransparentPanel buttonsPanel
         = new TransparentPanel(new FlowLayout(FlowLayout.CENTER));
 
-    private TransparentPanel checkBoxPanel
+    protected TransparentPanel checkBoxPanel
         = new TransparentPanel(new FlowLayout(FlowLayout.LEADING));
 
     private TransparentPanel mainPanel
         = new TransparentPanel(new BorderLayout(5, 5));
 
     private boolean isConfirmationEnabled = true;
 
-    private int returnCode;
+    protected int returnCode;
 
     /**
      * Indicates that the OK button is pressed.

File: src/net/java/sip/communicator/impl/protocol/jabber/VolatileContactJabberImpl.java
Patch:
@@ -52,7 +52,6 @@ public class VolatileContactJabberImpl
      * instance that created us.
      * @param isPrivateMessagingContact if <tt>true</tt> this should be private
      * messaging contact.
-     * @param displayName the display name of the contact
      */
     VolatileContactJabberImpl(String id,
           ServerStoredContactListJabberImpl ssclCallback,
@@ -80,7 +79,7 @@ public class VolatileContactJabberImpl
 
         if(this.isPrivateMessagingContact)
         {
-            displayName = StringUtils.parseResource(id) + " from " +
+            this.displayName = StringUtils.parseResource(id) + " from " +
                 StringUtils.parseBareAddress(id);
             this.contactId = id;
             setJid(id);

File: src/net/java/sip/communicator/plugin/desktoputil/SIPCommFrame.java
Patch:
@@ -9,7 +9,6 @@
 import java.awt.*;
 import java.awt.event.*;
 import java.awt.image.*;
-import java.lang.reflect.*;
 import java.net.*;
 import java.util.*;
 import java.util.List;

File: src/net/java/sip/communicator/impl/muc/ServerChatRoomQuery.java
Patch:
@@ -56,7 +56,6 @@ public class ServerChatRoomQuery
      * @param contactSource the parent contact source
      * @param queryString the query string to match
      * @param provider the provider associated with the query
-     * @param count the maximum result contact count
      */
     public ServerChatRoomQuery(String queryString,
         ServerChatRoomContactSourceService contactSource,
@@ -131,7 +130,6 @@ private void providerAdded(ChatRoomProviderWrapper provider,
      * @param chatRoomID the id of the chat room.
      * @param addQueryResult indicates whether we should add the chat room to
      * the query results or fire an event without adding it to the results.
-     * @param isAutoJoin the auto join state of the contact.
      */
     private void addChatRoom(ProtocolProviderService pps,
         String chatRoomName, String chatRoomID, boolean addQueryResult)

File: src/net/java/sip/communicator/impl/protocol/jabber/InfoRetreiver.java
Patch:
@@ -383,7 +383,7 @@ void addCachedContactDetails(
      * @param card the card to check.
      * @return the Full name if existing, null otherwise.
      */
-    private String checkForFullName(VCard card)
+    String checkForFullName(VCard card)
     {
         String vcardXml = card.toXML();
 

File: src/net/java/sip/communicator/plugin/addrbook/AdvancedConfigForm.java
Patch:
@@ -108,7 +108,7 @@ public void actionPerformed(ActionEvent arg0)
         });
         return checkBox;
     }
-    
+
     /**
      * Creates the default IM application check box.
      *

File: src/net/java/sip/communicator/plugin/addrbook/macosx/MacOSXAddrBookContactQuery.java
Patch:
@@ -1168,6 +1168,7 @@ protected void run()
             query.toString(),
             new PtrCallback()
             {
+                @Override
                 public boolean callback(long person)
                 {
                     return onPerson(person);

File: src/net/java/sip/communicator/plugin/addrbook/msoutlook/MsOutlookAddrBookSourceContact.java
Patch:
@@ -386,7 +386,7 @@ private void setDisplayPostalAddress()
         synchronized(this)
         {
             MsOutlookAddrBookContactDetail detail;
-            
+
             // Setting the display work postal address.
             boolean firstLineCR = false;
             boolean secondLineCR = false;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTLSJabberImpl.java
Patch:
@@ -14,7 +14,7 @@
 /**
  * An implementation of the OperationSetTLS for the Jabber protocol.
  *
- * @author Markus Kilås
+ * @author Markus Kilas
  */
 public class OperationSetTLSJabberImpl
     implements OperationSetTLS

File: src/net/java/sip/communicator/service/protocol/OperationSetTLS.java
Patch:
@@ -12,7 +12,7 @@
  * An <tt>OperationSet</tt> that allows access to information about TLS used by 
  * the protocol provider.
  *
- * @author Markus Kilås
+ * @author Markus Kilas
  */
 public interface OperationSetTLS
     extends OperationSet

File: src/net/java/sip/communicator/impl/msghistory/MessageSourceService.java
Patch:
@@ -505,7 +505,7 @@ else if(obj instanceof ChatRoomMessageDeliveredEvent)
         }
         else if(obj instanceof ChatRoomMessageReceivedEvent)
         {
-            chatRoom = ((ChatRoomMessageDeliveredEvent)obj).getSourceChatRoom();
+            chatRoom = ((ChatRoomMessageReceivedEvent)obj).getSourceChatRoom();
         }
 
         for(MessageSourceContact msc : list)

File: src/net/java/sip/communicator/plugin/addrbook/AddrBookActivator.java
Patch:
@@ -338,7 +338,7 @@ else if (OSUtils.IS_MAC
             css
                 = (ContactSourceService)
                     Class.forName(cssClassName).newInstance();
-            if(css.equals("net.java.sip.communicator.plugin.addrbook"
+            if(cssClassName.equals("net.java.sip.communicator.plugin.addrbook"
                     + ".msoutlook.MsOutlookAddrBookContactSourceService"))
             {
                 MsOutlookAddrBookContactSourceService contactSource

File: src/net/java/sip/communicator/impl/gui/main/call/ViewCertificateFrame.java
Patch:
@@ -15,7 +15,9 @@
 /**
  * Frame for showing information about a certificate.
  */
-public class ViewCertificateFrame extends SIPCommFrame {
+public class ViewCertificateFrame
+    extends SIPCommFrame
+{
 
     /**
      * Serial version UID.

File: src/net/java/sip/communicator/service/contactsource/AsyncContactQuery.java
Patch:
@@ -9,8 +9,6 @@
 import java.util.*;
 import java.util.regex.*;
 
-import net.java.sip.communicator.service.protocol.*;
-
 /**
  * Provides an abstract implementation of a <tt>ContactQuery</tt> which runs in
  * a separate <tt>Thread</tt>.

File: src/net/java/sip/communicator/impl/muc/MUCServiceImpl.java
Patch:
@@ -249,9 +249,6 @@ public void joinChatRoom(   ChatRoom chatRoom,
 
             chatRoomList.addChatRoom(chatRoomWrapper);
 
-            fireChatRoomListChangedEvent(
-                chatRoomWrapper,
-                ChatRoomListChangeEvent.CHAT_ROOM_ADDED);
         }
 
         this.joinChatRoom(chatRoomWrapper, nickname, password);

File: src/net/java/sip/communicator/plugin/branding/AboutWindow.java
Patch:
@@ -118,6 +118,7 @@ public AboutWindow(Frame owner)
 
         setModal(false);
         setDefaultCloseOperation(DISPOSE_ON_CLOSE);
+        setResizable(false);
 
         JPanel mainPanel = new WindowBackground();
         mainPanel.setLayout(new BorderLayout());
@@ -245,7 +246,6 @@ public String getUIClassID()
         this.getContentPane().add(mainPanel);
 
         this.pack();
-        this.setResizable(false);
 
         setLocationRelativeTo(getParent());
 

File: src/net/java/sip/communicator/plugin/desktoputil/ExtendedPopupMenu.java
Patch:
@@ -30,7 +30,7 @@ public class ExtendedPopupMenu
     /**
      * The invoker component.
      */
-    private final JComponent invoker;
+    private final Component invoker;
  
     /**
      * Creates this dialog by specifying a list of items to choose from.
@@ -39,7 +39,7 @@ public class ExtendedPopupMenu
      * @param title
      * @param menuItems the list of items to select through
      */
-    public ExtendedPopupMenu(JComponent invoker,
+    public ExtendedPopupMenu(Component invoker,
                              String title,
                              List<JMenuItem> menuItems)
     {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MetaContactRightButtonMenu.java
Patch:
@@ -31,11 +31,9 @@
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.OperationSetExtendedAuthorizations.SubscriptionStatus;
 import net.java.sip.communicator.util.*;
-import net.java.sip.communicator.util.Logger;
 import net.java.sip.communicator.util.call.*;
 import net.java.sip.communicator.util.skin.*;
 
-import org.jitsi.util.*;
 import org.osgi.framework.*;
 
 /**

File: src/net/java/sip/communicator/impl/msghistory/MessageSourceContact.java
Patch:
@@ -299,7 +299,7 @@ private void initDetails(boolean isChatRoom, Contact contact)
             = preferredProvider
                 .getOperationSet(OperationSetContactCapabilities.class);
         Map<String, OperationSet> opsetCapabilities = null;
-        if(capOpSet != null)
+        if(capOpSet != null && contact != null)
             opsetCapabilities = capOpSet.getSupportedOperationSets(contact);
 
         if (preferredProvider != null)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -506,7 +506,9 @@ else if (messageType.equals(Chat.SMS_MESSAGE))
                 contactDisplayName,
                 getContactAvatar(protocolProvider, contactAddress),
                 date,
-                formatMessage("SMS: " + message, contentType, keyword),
+                ConfigurationUtils.isSmsNotifyTextDisabled() ?
+                    formatMessage(message, contentType, keyword)
+                    : formatMessage("SMS: " + message, contentType, keyword),
                 contentType,
                 false,
                 isSimpleTheme);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -477,7 +477,8 @@ public void messageDelivered(MessageDeliveredEvent evt)
                 msg.getMessageUID(),
                 evt.getCorrectedMessageUID());
 
-            if(evt.isSmsMessage())
+            if(evt.isSmsMessage()
+                && !ConfigurationUtils.isSmsNotifyTextDisabled())
             {
                 chatPanel.addMessage(
                         contact.getDisplayName(),

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -316,7 +316,7 @@ else if (menuItemName.equals("banItem"))
             ChatOperationReasonDialog reasonDialog
                 = new ChatOperationReasonDialog();
 
-            int result = new ChatOperationReasonDialog().showDialog();
+            int result = reasonDialog.showDialog();
 
             if (result == MessageDialog.OK_RETURN_CODE)
                 new BanParticipantThread(   room,

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -1562,7 +1562,9 @@ public void banParticipant(ChatRoomMember chatRoomMember, String reason)
     {
         try
         {
-            multiUserChat.banUser(chatRoomMember.getContactAddress(), reason);
+            multiUserChat.banUser(
+                ((ChatRoomMemberJabberImpl)chatRoomMember).getJabberID(),
+                reason);
         }
         catch (XMPPException e)
         {

File: src/net/java/sip/communicator/impl/notification/PopupMessageNotificationHandlerImpl.java
Patch:
@@ -65,10 +65,11 @@ public void popupMessage(PopupMessageNotificationAction action,
 
             systray.showPopupMessage(popupMsg);
         }
-        else
+        else if (message == null)
         {
-            logger.error("Message is null or empty!");
+            logger.error("Message is null!");
         }
+        // Allow messages to be empty, since some protocols allow empty lines.
     }
 
     /**

File: src/net/java/sip/communicator/impl/dns/DnsUtilActivator.java
Patch:
@@ -235,7 +235,7 @@ public static void reloadDnsResolverConfig()
             StringBuilder sb = new StringBuilder();
             sb.append("Reloading resolver config, default DNS servers are: ");
             ResolverConfig config = ResolverConfig.getCurrentConfig();
-            if (config != null)
+            if (config != null && config.servers() != null)
             {
                 for(String s : config.servers())
                 {

File: src/net/java/sip/communicator/impl/gui/main/presence/SimpleStatusMenu.java
Patch:
@@ -127,6 +127,9 @@ private JCheckBoxMenuItem createMenuItem(
      */
     public void actionPerformed(ActionEvent e)
     {
+        if(GuiActivator.getGlobalStatusService() == null)
+            return;
+
         JMenuItem menuItem = (JMenuItem) e.getSource();
         String itemName = menuItem.getName();
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -4177,6 +4177,9 @@ public void run()
             // Queries all available resolvers
             for(ContactSourceService css : GuiActivator.getContactSources())
             {
+                if(css.getType() != ContactSourceService.SEARCH_TYPE)
+                    continue;
+
                 ContactQuery query;
                 if(css instanceof ExtendedContactSourceService)
                 {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -10,7 +10,6 @@
 import java.awt.event.*;
 import java.util.*;
 import java.util.List;
-import java.util.regex.*;
 
 import javax.swing.*;
 import javax.swing.event.*;
@@ -28,9 +27,7 @@
 import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
-import net.java.sip.communicator.util.Logger;
 
-import org.jitsi.util.*;
 import org.osgi.framework.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -19,7 +19,6 @@
 import net.java.sip.communicator.plugin.desktoputil.presence.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.Logger;
-import net.java.sip.communicator.util.account.*;
 
 import org.jitsi.util.*;
 

File: src/net/java/sip/communicator/impl/gui/main/presence/StatusSelectorMenu.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.awt.*;
 import java.awt.image.*;
-import java.util.*;
 
 import javax.swing.*;
 

File: src/net/java/sip/communicator/plugin/desktoputil/chat/ChatRoomDestroyReasonDialog.java
Patch:
@@ -7,14 +7,13 @@
 package net.java.sip.communicator.plugin.desktoputil.chat;
 
 import java.awt.*;
-import java.io.*;
 
 import javax.swing.*;
 
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.util.*;
+
 import org.jitsi.service.resources.*;
-import sun.util.logging.resources.*;
 
 /**
  * Dialog with fields for reason and alternate address.

File: src/net/java/sip/communicator/impl/muc/MUCCustomContactActionService.java
Patch:
@@ -663,6 +663,8 @@ public boolean isVisible(SourceContact actionSource)
                 .findChatRoomWrapperFromSourceContact(contact);
             if(name.equals("autojoin") || name.equals("autojoin_pressed"))
             {
+                if(room == null)
+                    return true;
 
                 if(name.equals("autojoin"))
                     return !room.isAutojoin();

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableDialog.java
Patch:
@@ -398,8 +398,6 @@ public void actionPerformed(ActionEvent e)
                         false,
                         false);
 
-                String nickName = nicknameField.getText().trim();
-                
                 if(!chatRoomWrapper.isPersistent())
                 {
                     chatRoomWrapper.setPersistent(true);
@@ -411,7 +409,9 @@ public void actionPerformed(ActionEvent e)
                         chatRoomWrapper.getChatRoomID(),
                         chatRoomWrapper.getChatRoomName());
                 }
-                
+
+                String nickName = nicknameField.getText().trim();
+
                 ConfigurationUtils.updateChatRoomProperty(
                     chatRoomWrapper.getParentProvider().getProtocolProvider(),
                     chatRoomWrapper.getChatRoomID(), "userNickName", nickName);

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -773,9 +773,9 @@ private static boolean enableDesktopSharing(Call call,
                                             MediaDevice mediaDevice,
                                             boolean enable)
     {
-        OperationSetDesktopSharingServer desktopOpSet
+        OperationSetDesktopStreaming desktopOpSet
             = call.getProtocolProvider().getOperationSet(
-                    OperationSetDesktopSharingServer.class);
+                OperationSetDesktopStreaming.class);
         boolean enableSucceeded = false;
 
         // This shouldn't happen at this stage, because we disable the button

File: src/net/java/sip/communicator/plugin/desktoputil/plaf/SearchFieldUI.java
Patch:
@@ -482,11 +482,9 @@ protected void updateIcon(MouseEvent evt)
         int x = evt.getX();
         int y = evt.getY();
 
-        Rectangle callButtonRect = getCallButtonRect();
-
         boolean outsideButtons = true;
 
-        if (isCallIconVisible && callButtonRect.contains(x, y))
+        if (isCallIconVisible && getCallButtonRect().contains(x, y))
         {
             JTextComponent c = getComponent();
             String searchText = c.getText();

File: src/net/java/sip/communicator/impl/msghistory/MessageHistoryServiceImpl.java
Patch:
@@ -1447,7 +1447,7 @@ private void handleProviderAdded(ProtocolProviderService provider)
             opSetSMS.addMessageListener(this);
 
             if(this.messageSourceService != null)
-                opSetIm.addMessageListener(messageSourceService);
+                opSetSMS.addMessageListener(messageSourceService);
         }
         else
         {
@@ -1519,7 +1519,7 @@ private void handleProviderRemoved(ProtocolProviderService provider)
             opSetSMS.removeMessageListener(this);
 
             if(this.messageSourceService != null)
-                opSetIm.removeMessageListener(messageSourceService);
+                opSetSMS.removeMessageListener(messageSourceService);
         }
 
         OperationSetMultiUserChat opSetMultiUChat =

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryContactSource.java
Patch:
@@ -35,7 +35,6 @@ public String getDisplayName()
     /**
      * Creates query for the given <tt>searchString</tt>.
      * @param queryString the string to search for
-     * @param listener the listener that receives the found contacts
      * @return the created query
      */
     public ContactQuery createContactQuery(String queryString)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/CallHistoryFilter.java
Patch:
@@ -51,6 +51,9 @@ public void applyFilter(FilterQuery filterQuery)
                 = contactSource.getContactSourceService()
                     .createContactQuery("", 50);
 
+            if(query == null)
+                continue;
+
             query.addContactQueryListener(contactList);
             filterQuery.addContactQuery(query);
             query.start();

File: src/net/java/sip/communicator/impl/gui/main/contactlist/PresenceFilter.java
Patch:
@@ -112,6 +112,9 @@ public void applyFilter(FilterQuery filterQuery)
                 ContactQuery contactQuery
                     = sourceService.createContactQuery(null);
 
+                if(contactQuery == null)
+                    continue;
+
                 // Add this query to the filterQuery.
                 filterQuery.addContactQuery(contactQuery);
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -2239,6 +2239,9 @@ public void contactChanged(ContactChangedEvent event)
                 ContactQuery query = ((ExtendedContactSourceService)
                     contactSource).createContactQuery(filterPattern);
 
+                if(query == null)
+                    continue;
+
                 loadedQueries.add(query);
 
                 query.start();

File: src/net/java/sip/communicator/impl/msghistory/MessageSourceService.java
Patch:
@@ -538,8 +538,8 @@ private void handle(EventObject obj,
             List<MessageSourceContact> removedItems = null;
             if(messages.size() > numberOfMessages)
             {
-                removedItems = messages.subList(
-                    numberOfMessages, messages.size());
+                removedItems = new ArrayList<MessageSourceContact>(
+                    messages.subList(numberOfMessages, messages.size()));
 
                 messages.removeAll(removedItems);
             }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -191,6 +191,9 @@ protected ContactQuery applyFilter(UIContactSource contactSource,
         else
             contactQuery = sourceService.createContactQuery(filterString);
 
+        if(contactQuery == null)
+            return null;
+
         contactQuery.addContactQueryListener(sourceContactList);
 
         if (contactQuery.getStatus() == ContactQuery.QUERY_IN_PROGRESS)

File: src/net/java/sip/communicator/impl/muc/BaseChatRoomSourceContact.java
Patch:
@@ -40,7 +40,6 @@ public class BaseChatRoomSourceContact
      * @param chatRoomID the id of the chat room associated with the room.
      * @param query the query associated with the contact.
      * @param pps the protocol provider of the contact.
-     * @param isAutoJoin the auto join state.
      */
     public BaseChatRoomSourceContact(String chatRoomName, 
         String chatRoomID, ContactQuery query, ProtocolProviderService pps)

File: src/net/java/sip/communicator/impl/muc/ChatRoomQuery.java
Patch:
@@ -23,8 +23,9 @@
  */
 public class ChatRoomQuery
     extends AsyncContactQuery<ContactSourceService>
-    implements LocalUserChatRoomPresenceListener, ChatRoomListChangeListener, 
-    ChatRoomProviderWrapperListener
+    implements LocalUserChatRoomPresenceListener,
+               ChatRoomListChangeListener,
+               ChatRoomProviderWrapperListener
 {
     /**
      * The query string.

File: src/net/java/sip/communicator/impl/msghistory/MessageHistoryServiceImpl.java
Patch:
@@ -1020,6 +1020,8 @@ public void messageReceived(ChatRoomMessageReceivedEvent evt)
                             (ChatRoomMessageReceivedEvent)e;
 
                         if( evt.getSourceChatRoomMember().getContactAddress()
+                                != null
+                            && evt.getSourceChatRoomMember().getContactAddress()
                                 .equals(cev.getSourceChatRoomMember()
                                                 .getContactAddress())
                             && evt.getTimestamp() != null

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomMemberJabberImpl.java
Patch:
@@ -110,6 +110,7 @@ public String getJabberID()
     {
         return jabberID;
     }
+
     /**
      * Returns the contact identifier representing this contact.
      *
@@ -119,7 +120,7 @@ public String getJabberID()
      */
     public String getContactAddress()
     {
-        return StringUtils.parseBareAddress(jabberID);
+        return nickName;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1448,7 +1448,9 @@ else if (lastComponent instanceof GroupNode)
             fireContactListEvent(
                 ((GroupNode) lastComponent).getGroupDescriptor(),
                 ContactListEvent.GROUP_CLICKED, e.getClickCount());
+            setAutoSectionAllowed(false);
         }
+
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandlerSipImpl.java
Patch:
@@ -1691,7 +1691,7 @@ protected SrtpCryptoAttribute selectSdesCryptoSuite(
                             SrtpCryptoAttribute.create(a.getValue()));
                 }
             }
-            catch (SdpParseException e)
+            catch (Exception e)
             {
                 logger.error("received an unparsable sdp attribute", e);
             }

File: src/net/java/sip/communicator/impl/gui/main/SingleWindowContainer.java
Patch:
@@ -202,7 +202,7 @@ public void close(CallPanel callPanel, boolean delay)
      * @return <tt>true</tt> to indicate that a component contained in this
      * container currently owns the keyboard focus, <tt>false</tt> - otherwise
      */
-    public boolean containsFocus()
+    public boolean containsFocusOwner()
     {
         ChatPanel chat = getCurrentChat();
 

File: src/net/java/sip/communicator/service/protocol/jabber/JabberAccountRegistration.java
Patch:
@@ -9,13 +9,11 @@
 import java.io.*;
 import java.util.*;
 
-import net.java.sip.communicator.service.credentialsstorage.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 
 import org.jitsi.service.configuration.*;
 import org.jitsi.service.neomedia.*;
-
 import org.osgi.framework.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderFactorySipImpl.java
Patch:
@@ -296,8 +296,8 @@ protected AccountID createAccountID(String userID, Map<String, String> accountPr
     protected ProtocolProviderService createService(String userID,
         AccountID accountID)
     {
-        ProtocolProviderServiceSipImpl service =
-            new ProtocolProviderServiceSipImpl();
+        ProtocolProviderServiceSipImpl service
+            = new ProtocolProviderServiceSipImpl();
 
         try
         {

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsSourceService.java
Patch:
@@ -19,7 +19,7 @@
  * @author Sebastien Vincent
  */
 public class GoogleContactsSourceService
-    implements ExtendedContactSourceService
+    implements ExtendedContactSourceService, PrefixedContactSourceService
 {
     /**
      * Logger.
@@ -406,6 +406,7 @@ void stopped(GoogleContactsQuery query)
      *
      * @return the phoneNumber prefix for all phone numbers
      */
+    @Override
     public String getPhoneNumberPrefix()
     {
         return phoneNumberprefix;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/SourceUIContact.java
Patch:
@@ -359,9 +359,9 @@ public SourceContactDetail( ContactDetail detail,
             ContactSourceService contactSource
                 = sourceContact.getContactSource();
 
-            if (contactSource instanceof ExtendedContactSourceService)
+            if (contactSource instanceof PrefixedContactSourceService)
             {
-                String prefix = ((ExtendedContactSourceService) contactSource)
+                String prefix = ((PrefixedContactSourceService) contactSource)
                     .getPhoneNumberPrefix();
 
                 if (prefix != null)

File: src/net/java/sip/communicator/impl/ldap/LdapContactSourceService.java
Patch:
@@ -24,7 +24,7 @@
  * @author Sebastien Vincent
  */
 public class LdapContactSourceService
-    implements ContactSourceService
+    implements ContactSourceService, PrefixedContactSourceService
 {
     /**
      * The <tt>List</tt> of <tt>LdapContactQuery</tt> instances
@@ -167,6 +167,7 @@ public LdapDirectory getLdapDirectory()
      *
      * @return the phoneNumber prefix for all phone numbers
      */
+    @Override
     public String getPhoneNumberPrefix()
     {
         return ldapDirectory.getSettings().getGlobalPhonePrefix();

File: src/net/java/sip/communicator/plugin/addrbook/macosx/MacOSXAddrBookContactSourceService.java
Patch:
@@ -18,7 +18,7 @@
  */
 public class MacOSXAddrBookContactSourceService
     extends AsyncContactSourceService
-    implements EditableContactSourceService
+    implements EditableContactSourceService, PrefixedContactSourceService
 {
     /**
      * the Mac OS X address book prefix.
@@ -148,6 +148,7 @@ public synchronized void stop()
      *
      * @return the global phone number prefix
      */
+    @Override
     public String getPhoneNumberPrefix()
     {
         return AddrBookActivator.getConfigService()

File: src/net/java/sip/communicator/plugin/addrbook/msoutlook/MsOutlookAddrBookContactSourceService.java
Patch:
@@ -22,7 +22,7 @@
  */
 public class MsOutlookAddrBookContactSourceService
     extends AsyncContactSourceService
-    implements EditableContactSourceService
+    implements EditableContactSourceService, PrefixedContactSourceService
 {
     /**
      * The <tt>Logger</tt> used by the
@@ -209,6 +209,7 @@ public void stop()
      *
      * @return the global phone number prefix
      */
+    @Override
     public String getPhoneNumberPrefix()
     {
         return AddrBookActivator.getConfigService()

File: src/net/java/sip/communicator/service/callhistory/CallHistoryService.java
Patch:
@@ -10,7 +10,6 @@
 
 import net.java.sip.communicator.service.callhistory.event.*;
 import net.java.sip.communicator.service.contactlist.*;
-import net.java.sip.communicator.service.protocol.*;
 
 /**
  * The Call History Service stores info about calls made from various protocols
@@ -153,7 +152,7 @@ public void removeSearchProgressListener(
      * @param address the value of the secondary address .
      */
     public void updateCallRecordPeerSecondaryAddress(final Date date,
-        final CallPeer peer,
+        final String peerAddress,
         final String address);
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomConfigurationWindow.java
Patch:
@@ -155,6 +155,7 @@ private void loadConfigurationForm()
             {
                 // Create a check box when the field is of type boolean.
                 field = new SIPCommCheckBox(formField.getLabel());
+                label.setText("");
 
                 if(values.hasNext())
                 {

File: src/net/java/sip/communicator/impl/gui/main/call/ZrtpSecurityPanel.java
Patch:
@@ -664,7 +664,7 @@ public void run()
             if (!videoSecurityLabel.isVisible())
                 videoSecurityLabel.setVisible(true);
         }
-        else if (visible)
+        else
             videoSecurityLabel.setVisible(visible);
 
         revalidate();

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -1696,7 +1696,7 @@ private void fireMemberRoleEvent(ChatRoomMember member,
      * @param evt the <tt>EventObject</tt> that we'd like delivered to all
      * registered message listeners.
      */
-    private void fireMessageEvent(EventObject evt)
+    void fireMessageEvent(EventObject evt)
     {
         Iterable<ChatRoomMessageListener> listeners;
         synchronized (messageListeners)
@@ -1930,8 +1930,8 @@ public void processPacket(Packet packet)
                 member = smackParticipantToScMember(msgFrom);
             }
 
-            // somtimes when connecting to rooms they send history
-            // when the member is nolonger available we create
+            // sometimes when connecting to rooms they send history
+            // when the member is no longer available we create
             // a fake one so the messages to be displayed.
             if(member == null)
             {

File: src/net/java/sip/communicator/impl/protocol/sip/ClientCapabilities.java
Patch:
@@ -346,8 +346,7 @@ public void run()
                 }
                 catch (TransactionUnavailableException ex)
                 {
-                    logger.error("Could not create a register transaction!\n"
-                              + "Check that the Registrar address is correct!",
+                    logger.error("Could not create options transaction!\n",
                               ex);
                     return;
                 }
@@ -434,6 +433,7 @@ private class RegistrationListener
         public void registrationStateChanged(RegistrationStateChangeEvent evt)
         {
             if(evt.getNewState() == RegistrationState.UNREGISTERING ||
+                evt.getNewState() == RegistrationState.UNREGISTERED ||
                 evt.getNewState() == RegistrationState.AUTHENTICATION_FAILED ||
                 evt.getNewState() == RegistrationState.CONNECTION_FAILED)
             {

File: src/net/java/sip/communicator/service/protocol/AccountManager.java
Patch:
@@ -807,6 +807,9 @@ public String getAccountNodeName( ProtocolProviderFactory factory,
                 = configurationService.getString(
                     storedAccount + "." + ProtocolProviderFactory.ACCOUNT_UID);
 
+            if(storedAccountUID == null)
+                continue;
+
             if (storedAccountUID.equals(accountUID))
                 accountNodeName = configurationService.getString(storedAccount);
         }

File: src/net/java/sip/communicator/impl/protocol/sip/UriHandlerSipImpl.java
Patch:
@@ -303,7 +303,7 @@ public void handleUri(String uri)
 
         //handle "sip://" URIs as "sip:" 
         if(uri != null)
-            uri = uri.replace("sip://", "sip");
+            uri = uri.replace("sip://", "sip:");
 
         OperationSetBasicTelephony<?> telephonyOpSet
             = provider.getOperationSet(OperationSetBasicTelephony.class);

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -1301,6 +1301,8 @@ public void invitationRejected(AdHocChatRoomInvitationRejectedEvent evt) {}
     @Override
     public void localUserRoleChanged(ChatRoomLocalUserRoleChangeEvent evt)
     {
+        if(evt.isInitial())
+            return;
         ChatRoom sourceChatRoom = evt.getSourceChatRoom();
         ChatRoomWrapper chatRoomWrapper
             = GuiActivator.getMUCService().findChatRoomWrapperFromChatRoom(

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -1617,6 +1617,7 @@ public void showAddChatRoomDialog()
     public void showChatRoomAutoOpenConfigDialog(
         ProtocolProviderService pps, String chatRoomId)
     {
-        new ChatRoomAutoOpenConfigDialog(pps, chatRoomId);
+        ChatRoomAutoOpenConfigDialog.showChatRoomAutoOpenConfigDialog(
+            pps, chatRoomId);
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -211,7 +211,7 @@ public void messageReceived(ChatRoomMessageReceivedEvent evt)
                 sourceChatRoom.getParentProvider(), 
                 sourceChatRoom.getIdentifier());
         if(autoOpenConfig == null)
-            autoOpenConfig = MUCService.OPEN_ON_MESSAGE;
+            autoOpenConfig = MUCService.OPEN_ON_IMPORTANT_MESSAGE;
     
         if(autoOpenConfig.equals(MUCService.OPEN_ON_ACTIVITY)
             || (autoOpenConfig.equals(MUCService.OPEN_ON_MESSAGE) 

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -17,7 +17,6 @@
 import net.java.sip.communicator.impl.gui.main.chatroomslist.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.gui.*;
-import net.java.sip.communicator.service.msghistory.*;
 import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;

File: src/net/java/sip/communicator/util/ConfigurationUtils.java
Patch:
@@ -14,7 +14,6 @@
 
 import javax.net.ssl.*;
 
-import net.java.sip.communicator.service.msghistory.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.resources.*;
 

File: src/net/java/sip/communicator/plugin/otr/authdialog/OTRv3OutgoingSessionSwitcher.java
Patch:
@@ -157,8 +157,6 @@ public OTRv3OutgoingSessionSwitcher(Container container,
         this.setOpaque(false);
         this.menu.setVisible(false);
 
-        buildMenu(contact);
-
         /*
          * XXX This OtrV3OutgoingSessionSwitcher instance cannot be added as a
          * listener to scOtrEngine and scOtrKeyManager without being removed
@@ -193,6 +191,8 @@ public OTRv3OutgoingSessionSwitcher(Container container,
         {
             logger.debug("Failed to load padlock image");
         }
+
+        buildMenu(contact);
     }
 
     @Override

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatTransport.java
Patch:
@@ -415,7 +415,8 @@ public void correctInstantMessage(String message, String mimeType,
             msg = mcOpSet.createMessage(message);
         }
 
-        mcOpSet.correctMessage(contact, msg, correctedMessageUID);
+        mcOpSet.correctMessage(
+            contact, contactResource, msg, correctedMessageUID);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/OperationSetMessageCorrection.java
Patch:
@@ -19,9 +19,10 @@ public interface OperationSetMessageCorrection
      * the contact <tt>to</tt> with the message <tt>message</tt>
      *
      * @param to The contact to send the message to.
+     * @param resource The ContactResource to send the message to.
      * @param message The new message.
      * @param correctedMessageUID The ID of the message being replaced.
      */
-    public void correctMessage(Contact to, Message message,
-            String correctedMessageUID);
+    public void correctMessage(Contact to, ContactResource resource,
+        Message message, String correctedMessageUID);
 }

File: src/net/java/sip/communicator/plugin/otr/OtrContactMenu.java
Patch:
@@ -220,7 +220,8 @@ else if (ACTION_COMMAND_CB_RESET.equals(actionCommand))
     public void contactPolicyChanged(Contact contact)
     {
         // Update the corresponding to the contact menu.
-        if (contact.equals(OtrContactMenu.this.contact))
+        if (OtrContactMenu.this.contact != null &&
+            contact.equals(OtrContactMenu.this.contact.contact))
             setOtrPolicy(OtrActivator.scOtrEngine.getContactPolicy(contact));
     }
 

File: src/net/java/sip/communicator/plugin/otr/OtrMetaContactButton.java
Patch:
@@ -72,7 +72,8 @@ public void sessionStatusChanged(OtrContact otrContact)
     public void contactPolicyChanged(Contact contact)
     {
         // OtrMetaContactButton.this.contact can be null.
-        if (contact.equals(OtrMetaContactButton.this.otrContact.contact))
+        if (OtrMetaContactButton.this.otrContact != null &&
+            contact.equals(OtrMetaContactButton.this.otrContact.contact))
         {
             setPolicy(
                 OtrActivator.scOtrEngine.getContactPolicy(contact));

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -37,8 +37,6 @@
 import org.jitsi.util.event.*;
 import org.osgi.framework.*;
 
-import sun.security.provider.*;
-
 /**
  * The dialog created for a given call.
  *

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -25,7 +25,7 @@
 import net.java.sip.communicator.service.contactsource.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.event.*;
-import net.java.sip.communicator.service.muc.ChatRoomWrapper;
+import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;

File: src/net/java/sip/communicator/plugin/desktoputil/chat/ChatOperationReasonDialog.java
Patch:
@@ -11,8 +11,7 @@
 import javax.swing.*;
 import javax.swing.event.*;
 
-import net.java.sip.communicator.plugin.desktoputil.DesktopUtilActivator;
-import net.java.sip.communicator.plugin.desktoputil.MessageDialog;
+import net.java.sip.communicator.plugin.desktoputil.*;
 
 /**
  *

File: src/net/java/sip/communicator/service/gui/UIService.java
Patch:
@@ -23,7 +23,7 @@
  * <p>
  * Through the <tt>UIService</tt> all modules can add their own components in
  * different menus, toolbars, etc. within the ui. Each <tt>UIService</tt>
- * implementation should export its supported "plugable" containers - a set of
+ * implementation should export its supported "pluggable" containers - a set of
  * <tt>Container</tt>s corresponding to different "places" in the application,
  * where a module can add a component.
  * <p>

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -4140,11 +4140,13 @@ private static String resolveContactSource(String peerAddress)
                 // use the pattern method of (ExtendedContactSourceService)
                 ContactQuery query
                     = ((ExtendedContactSourceService)contactSourceService)
-                            .queryContactSource(pattern);
+                            .createContactQuery(pattern);
 
                 resolvers.add(
                         new ResolveAddressToDisplayNameContactQueryListener(
                             query));
+                
+                query.start();
             }
 
             long startTime = System.currentTimeMillis();

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableDialog.java
Patch:
@@ -375,7 +375,7 @@ public void actionPerformed(ActionEvent e)
     {
         String subject = null;
         JButton sourceButton = (JButton) e.getSource();
-         if(sourceButton.equals(okButton))
+        if(sourceButton.equals(okButton))
         {
 
             if((chatRoomNameField.getText() != null

File: src/net/java/sip/communicator/plugin/addrbook/macosx/MacOSXAddrBookContactSourceService.java
Patch:
@@ -91,7 +91,7 @@ public int getType()
     }
 
     /**
-     * Queries this <tt>ContactSourceService</tt> for <tt>SourceContact</tt>s
+     * Creates query that searches for <tt>SourceContact</tt>s
      * which match a specific <tt>query</tt> <tt>Pattern</tt>.
      *
      * @param query the <tt>Pattern</tt> which this
@@ -102,14 +102,13 @@ public int getType()
      * any) will be returned
      * @see ExtendedContactSourceService#queryContactSource(Pattern)
      */
-    public ContactQuery queryContactSource(Pattern query)
+    public ContactQuery createContactQuery(Pattern query)
     {
         if(latestQuery != null)
             latestQuery.clear();
 
         latestQuery = new MacOSXAddrBookContactQuery(this, query);
 
-        latestQuery.start();
         return latestQuery;
     }
 

File: src/net/java/sip/communicator/service/contactsource/ExtendedContactSourceService.java
Patch:
@@ -29,11 +29,11 @@ public interface ExtendedContactSourceService
     extends ContactSourceService
 {
     /**
-     * Queries this search source for the given <tt>searchPattern</tt>.
+     * Creates query for the given <tt>searchPattern</tt>.
      * @param queryPattern the pattern to search for
      * @return the created query
      */
-    public ContactQuery queryContactSource(Pattern queryPattern);
+    public ContactQuery createContactQuery(Pattern queryPattern);
 
     /**
      * Returns the global phone number prefix to be used when calling contacts

File: src/net/java/sip/communicator/impl/muc/ServerChatRoomQuery.java
Patch:
@@ -11,7 +11,6 @@
 import net.java.sip.communicator.service.contactsource.*;
 import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.Logger;
 
 /**
  * The <tt>ServerChatRoomQuery</tt> is a query over the

File: src/net/java/sip/communicator/service/protocol/Call.java
Patch:
@@ -498,7 +498,9 @@ public CallConference getConference()
                 throw new IllegalStateException("conference");
             }
             else
+            {
                 setConference(newValue);
+            }
         }
         return conference;
     }

File: src/net/java/sip/communicator/service/protocol/CallConference.java
Patch:
@@ -149,16 +149,19 @@ else if (callCount > 1)
     private final CallChangeListener callChangeListener
         = new CallChangeListener()
         {
+            @Override
             public void callPeerAdded(CallPeerEvent ev)
             {
                 CallConference.this.onCallPeerEvent(ev);
             }
 
+            @Override
             public void callPeerRemoved(CallPeerEvent ev)
             {
                 CallConference.this.onCallPeerEvent(ev);
             }
 
+            @Override
             public void callStateChanged(CallChangeEvent ev)
             {
                 CallConference.this.callStateChanged(ev);

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCallConference.java
Patch:
@@ -66,6 +66,7 @@ public class MediaAwareCallConference
     private final PropertyChangeListener propertyChangeListener
         = new PropertyChangeListener()
         {
+            @Override
             public void propertyChange(PropertyChangeEvent ev)
             {
                 MediaAwareCallConference.this.propertyChange(ev);
@@ -534,6 +535,7 @@ protected void addThisToNotifier()
          * Notifies this instance about a <tt>PropertyChangeEvent</tt> fired by
          * {@link #notifier}.
          */
+        @Override
         public void propertyChange(PropertyChangeEvent ev)
         {
             PropertyChangeListener[] ls;

File: src/net/java/sip/communicator/impl/protocol/icq/ContactGroupIcqImpl.java
Patch:
@@ -303,6 +303,9 @@ public boolean equals(Object obj)
         if(!((ContactGroup)obj).getGroupName().equals(getGroupName()))
             return false;
 
+        if(getProtocolProvider() != ((ContactGroup)obj).getProtocolProvider())
+            return false;
+
         //since ICQ does not support having two groups with the same name
         // at this point we could bravely state that the groups are the same
         // and not bother to compare buddies. (gotta check that though)

File: src/net/java/sip/communicator/impl/protocol/msn/ContactGroupMsnImpl.java
Patch:
@@ -267,6 +267,9 @@ public boolean equals(Object obj)
         if(!((ContactGroup)obj).getGroupName().equals(getGroupName()))
             return false;
 
+        if(getProtocolProvider() != ((ContactGroup)obj).getProtocolProvider())
+            return false;
+
         //since Msn does not support having two groups with the same name
         // at this point we could bravely state that the groups are the same
         // and not bother to compare buddies. (gotta check that though)

File: src/net/java/sip/communicator/impl/protocol/sip/ContactGroupSipImpl.java
Patch:
@@ -592,6 +592,9 @@ public boolean equals(Object obj)
             || sipGroup.countSubgroups() != countSubgroups())
             return false;
 
+        if(getProtocolProvider() != ((ContactGroup)obj).getProtocolProvider())
+            return false;
+
         //traverse child contacts
         Iterator<Contact> theirContacts = sipGroup.contacts();
 

File: src/net/java/sip/communicator/impl/protocol/yahoo/ContactGroupYahooImpl.java
Patch:
@@ -268,6 +268,9 @@ public boolean equals(Object obj)
         if(!((ContactGroup)obj).getGroupName().equals(getGroupName()))
             return false;
 
+        if(getProtocolProvider() != ((ContactGroup)obj).getProtocolProvider())
+            return false;
+
         //since Yahoo does not support having two groups with the same name
         // at this point we could bravely state that the groups are the same
         // and not bother to compare buddies. (gotta check that though)

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -4143,11 +4143,13 @@ private static String resolveContactSource(String peerAddress)
                 // use the pattern method of (ExtendedContactSourceService)
                 ContactQuery query
                     = ((ExtendedContactSourceService)contactSourceService)
-                            .queryContactSource(pattern);
+                            .createContactQuery(pattern);
 
                 resolvers.add(
                         new ResolveAddressToDisplayNameContactQueryListener(
                             query));
+                
+                query.start();
             }
 
             long startTime = System.currentTimeMillis();

File: src/net/java/sip/communicator/impl/muc/ServerChatRoomQuery.java
Patch:
@@ -11,7 +11,6 @@
 import net.java.sip.communicator.service.contactsource.*;
 import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.Logger;
 
 /**
  * The <tt>ServerChatRoomQuery</tt> is a query over the

File: src/net/java/sip/communicator/plugin/addrbook/macosx/MacOSXAddrBookContactSourceService.java
Patch:
@@ -91,7 +91,7 @@ public int getType()
     }
 
     /**
-     * Queries this <tt>ContactSourceService</tt> for <tt>SourceContact</tt>s
+     * Creates query that searches for <tt>SourceContact</tt>s
      * which match a specific <tt>query</tt> <tt>Pattern</tt>.
      *
      * @param query the <tt>Pattern</tt> which this
@@ -102,14 +102,13 @@ public int getType()
      * any) will be returned
      * @see ExtendedContactSourceService#queryContactSource(Pattern)
      */
-    public ContactQuery queryContactSource(Pattern query)
+    public ContactQuery createContactQuery(Pattern query)
     {
         if(latestQuery != null)
             latestQuery.clear();
 
         latestQuery = new MacOSXAddrBookContactQuery(this, query);
 
-        latestQuery.start();
         return latestQuery;
     }
 

File: src/net/java/sip/communicator/service/contactsource/ExtendedContactSourceService.java
Patch:
@@ -29,11 +29,11 @@ public interface ExtendedContactSourceService
     extends ContactSourceService
 {
     /**
-     * Queries this search source for the given <tt>searchPattern</tt>.
+     * Creates query for the given <tt>searchPattern</tt>.
      * @param queryPattern the pattern to search for
      * @return the created query
      */
-    public ContactQuery queryContactSource(Pattern queryPattern);
+    public ContactQuery createContactQuery(Pattern queryPattern);
 
     /**
      * Returns the global phone number prefix to be used when calling contacts

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactGroupJabberImpl.java
Patch:
@@ -308,6 +308,9 @@ public boolean equals(Object obj)
         if(!((ContactGroup)obj).getGroupName().equals(getGroupName()))
             return false;
 
+        if(getProtocolProvider() != ((ContactGroup)obj).getProtocolProvider())
+            return false;
+
         //since Jabber does not support having two groups with the same name
         // at this point we could bravely state that the groups are the same
         // and not bother to compare buddies. (gotta check that though)

File: src/net/java/sip/communicator/impl/muc/MUCActivator.java
Patch:
@@ -134,7 +134,9 @@ public void stop(BundleContext context) throws Exception
         {
             bundleContext.removeServiceListener(protocolProviderRegListener);
         }
-        chatRoomProviders.clear();
+
+        if(chatRoomProviders != null)
+            chatRoomProviders.clear();
     }
 
     /**

File: src/net/java/sip/communicator/plugin/globalproxyconfig/GlobalProxyConfigForm.java
Patch:
@@ -58,7 +58,7 @@ public class GlobalProxyConfigForm
     /**
      * The dns forward global checkbox, hides/shows the panel with values.
      */
-    private JCheckBox dnsForwardCheck = new JCheckBox();
+    private JCheckBox dnsForwardCheck = new SIPCommCheckBox();
 
     /**
      * Dns server address initially filled with the value of the proxy.
@@ -165,7 +165,7 @@ private void init()
         constraints.gridy = 6;
         constraints.gridwidth = 4;
         constraints.gridheight = 2;
-        constraints.insets = new Insets(20,20,20,20);
+        constraints.insets = new Insets(0, 20, 0, 20);
         JEditorPane table = new JEditorPane();
         table.setContentType("text/html");
         table.setEditable(false);

File: src/net/java/sip/communicator/impl/muc/MUCServiceImpl.java
Patch:
@@ -794,7 +794,7 @@ else if(SUBSCRIPTION_ALREADY_EXISTS.equals(returnCode))
             if (!SUCCESS.equals(returnCode) && 
                 !AUTHENTICATION_FAILED.equals(returnCode))
             {
-                MUCActivator.getAlertUIService().showAlertDialog(
+                MUCActivator.getAlertUIService().showAlertPopup(
                     resources.getI18NString("service.gui.ERROR"), errorMessage);
             }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransportSelectorBox.java
Patch:
@@ -183,7 +183,9 @@ public void addChatTransport(ChatTransport chatTransport)
      */
     public void removeChatTransport(ChatTransport chatTransport)
     {
-        this.menu.remove(transportMenuItems.get(chatTransport));
+        JCheckBoxMenuItem menuItem = transportMenuItems.get(chatTransport);
+        this.menu.remove(menuItem);
+        this.buttonGroup.remove(menuItem);
         this.transportMenuItems.remove(chatTransport);
 
         updateEnableStatus();

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -622,7 +622,7 @@ public AdHocChatRoomWrapper createAdHocChatRoom(
                 GuiActivator.getResources().getI18NString("service.gui.ERROR"),
                 GuiActivator.getResources().getI18NString(
                     "service.gui.CREATE_CHAT_ROOM_ERROR",
-                    new String[]{protocolProvider.getProtocolName()}),
+                    new String[]{protocolProvider.getProtocolDisplayName()}),
                     ex)
             .showDialog();
         }
@@ -633,7 +633,7 @@ public AdHocChatRoomWrapper createAdHocChatRoom(
                 GuiActivator.getResources().getI18NString("service.gui.ERROR"),
                 GuiActivator.getResources().getI18NString(
                     "service.gui.CREATE_CHAT_ROOM_ERROR",
-                    new String[]{protocolProvider.getProtocolName()}),
+                    new String[]{protocolProvider.getProtocolDisplayName()}),
                     ex)
             .showDialog();
         }

File: src/net/java/sip/communicator/impl/muc/MUCServiceImpl.java
Patch:
@@ -410,7 +410,7 @@ public ChatRoomWrapper createChatRoom(
                 MUCActivator.getResources().getI18NString("service.gui.ERROR"),
                 MUCActivator.getResources().getI18NString(
                     "service.gui.CREATE_CHAT_ROOM_ERROR",
-                    new String[]{protocolProvider.getProtocolName()}),
+                    new String[]{protocolProvider.getProtocolDisplayName()}),
                     ex);
         }
         catch (OperationNotSupportedException ex)
@@ -421,7 +421,7 @@ public ChatRoomWrapper createChatRoom(
                 MUCActivator.getResources().getI18NString("service.gui.ERROR"),
                 MUCActivator.getResources().getI18NString(
                     "service.gui.CREATE_CHAT_ROOM_ERROR",
-                    new String[]{protocolProvider.getProtocolName()}),
+                    new String[]{protocolProvider.getProtocolDisplayName()}),
                     ex);
         }
 

File: src/net/java/sip/communicator/plugin/spellcheck/SpellChecker.java
Patch:
@@ -352,7 +352,8 @@ void setLocale(Parameters.Locale locale) throws Exception
     {
         synchronized (this.locale)
         {
-            if(this.locale.equals(locale))
+            if(this.locale.equals(locale)
+                && this.dict != null)
                 return;
 
             File dictLocation = getLocalDictForLocale(locale);

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTelephonyConferencingJabberImpl.java
Patch:
@@ -459,8 +459,9 @@ private void handleCoin(CallPeerJabberImpl callPeer, CoinIQ coinIQ)
      * temporary and should be removed once we choose a better way to pass the
      * SID.
      */
+    @Override
     protected ConferenceInfoDocument getCurrentConferenceInfo(
-            MediaAwareCallPeer callPeer)
+            MediaAwareCallPeer<?,?,?> callPeer)
     {
         ConferenceInfoDocument confInfo
                 = super.getCurrentConferenceInfo(callPeer);

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetDTMF.java
Patch:
@@ -169,7 +169,7 @@ else if(dtmfString.equals("SIP_INFO_DTMF"))
      * @param peer the call peer.
      * @return whether we can use rfc4733 in this call.
      */
-    protected static boolean isRFC4733Active(MediaAwareCallPeer peer)
+    protected static boolean isRFC4733Active(MediaAwareCallPeer<?,?,?> peer)
     {
         Iterator<MediaFormat> iter =
             peer.getMediaHandler().getStream(MediaType.AUDIO)

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetTelephonyConferencing.java
Patch:
@@ -1009,7 +1009,7 @@ public static String stripParametersFromAddress(String address)
      * state of the conference in which this <tt>CallPeer</tt> participates.
      */
     protected ConferenceInfoDocument getCurrentConferenceInfo(
-            MediaAwareCallPeer callPeer)
+            MediaAwareCallPeer<?,?,?> callPeer)
     {
         ConferenceInfoDocument confInfo;
         try
@@ -1109,7 +1109,7 @@ else if (stream != null)
                      * streams we have already set up with the other
                      * participants in the conference.
                      */
-                    for (MediaAwareCallPeer otherCallPeer
+                    for (MediaAwareCallPeer<?,?,?> otherCallPeer
                             : callPeer.getCall().getCallPeerList())
                     {
                         MediaStream otherStream

File: src/net/java/sip/communicator/service/protocol/PresenceStatus.java
Patch:
@@ -38,8 +38,10 @@ public class PresenceStatus
     /**
      * An integer above which all values of the status coefficient indicate both
      * connectivity and availability but the person is away from the computer.
+     * This value has special meaning, it is the border between dnd and away and
+     * statuses with this value are normally considered on the phone.
      */
-    public static final int EXTENDED_AWAY_THRESHOLD = 32;
+    public static final int EXTENDED_AWAY_THRESHOLD = 31;
 
     /**
      * An integer above which all values of the status coefficient indicate both

File: src/net/java/sip/communicator/plugin/simpleaccreg/InitialAccountRegistrationFrame.java
Patch:
@@ -210,7 +210,8 @@ public void mousePressed(MouseEvent e)
     private void initAccountWizards()
     {
         String simpleWizards
-            = Resources.getLoginProperty("plugin.simpleaccreg.PROTOCOL_ORDER");
+            = SimpleAccountRegistrationActivator.getConfigService()
+                .getString("plugin.simpleaccreg.PROTOCOL_ORDER");
 
         StringTokenizer tokenizer = new StringTokenizer(simpleWizards, "|");
 

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -295,7 +295,10 @@ public void dispose()
         titleArea = null;
 
         if(statusMessageMenu != null)
+        {
+            statusMessageMenu.removePropertyChangeListener(this);
             statusMessageMenu.dispose();
+        }
         statusMessageMenu = null;
     }
 }

File: src/net/java/sip/communicator/plugin/otr/authdialog/OtrBuddyAuthenticationDialog.java
Patch:
@@ -167,7 +167,7 @@ public void actionPerformed(ActionEvent e)
                 }
                 else if (authenticationMethod.equals(am[1]))
                 {
-                    String secret = secretQuestionPanel.getSecret();
+                    String secret = sharedSecretPanel.getSecret();
                     String question = null;
 
                     OtrActivator.scOtrEngine.initSmp(contact, question, secret);

File: src/net/java/sip/communicator/impl/muc/ChatRoomQuery.java
Patch:
@@ -205,7 +205,8 @@ public void localUserPresenceChanged(
                 ChatRoomWrapper chatRoom 
                     = MUCActivator.getMUCService()
                         .findChatRoomWrapperFromChatRoom(sourceChatRoom);
-                addChatRoom(sourceChatRoom, false, chatRoom.isAutojoin());
+                if(chatRoom != null)
+                    addChatRoom(sourceChatRoom, false, chatRoom.isAutojoin());
             }
         }
         else if ((LocalUserChatRoomPresenceChangeEvent

File: src/net/java/sip/communicator/service/protocol/AbstractConferenceMember.java
Patch:
@@ -222,7 +222,7 @@ public MediaDirection getVideoStatus()
         return videoStatus;
     }
 
-    private static long parseMediaSssrc(Object value)
+    private static long parseMediaSSRC(Object value)
     {
         long ssrc;
 
@@ -376,7 +376,7 @@ public boolean setProperties(Map<String, Object> properties)
 
             if (AUDIO_SSRC_PROPERTY_NAME.equals(key))
             {
-                long ssrc = parseMediaSssrc(value);
+                long ssrc = parseMediaSSRC(value);
 
                 if (getAudioSsrc() != ssrc)
                 {
@@ -396,7 +396,7 @@ else if (AUDIO_STATUS_PROPERTY_NAME.equals(key))
             }
             else if (VIDEO_SSRC_PROPERTY_NAME.equals(key))
             {
-                long ssrc = parseMediaSssrc(value);
+                long ssrc = parseMediaSSRC(value);
 
                 if (getVideoSsrc() != ssrc)
                 {

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -695,8 +695,7 @@ public void removeGroup(ContactGroupJabberImpl groupToRemove)
     void removeContact(ContactJabberImpl contactToRemove)
         throws OperationFailedException
     {
-        if(contactToRemove instanceof VolatileContactJabberImpl &&
-            ((VolatileContactJabberImpl)contactToRemove).isPrivateMessagingContact())
+        if(contactToRemove instanceof VolatileContactJabberImpl)
         {
             contactDeleted(contactToRemove);
             return;

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -16,7 +16,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.plugin.desktoputil.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -25,7 +25,6 @@
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.plugin.desktoputil.SwingWorker;
-import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.filehistory.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.event.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MetaContactListManager.java
Patch:
@@ -9,7 +9,6 @@
 import java.util.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.contactlist.*;

File: src/net/java/sip/communicator/service/customcontactactions/ContactActionMenuItem.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.service.customcontactactions;
 
-import net.java.sip.communicator.service.contactsource.SourceContact;
 import net.java.sip.communicator.service.protocol.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -12,9 +12,9 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.plugin.desktoputil.chat.*;
 import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableUI.java
Patch:
@@ -19,6 +19,7 @@
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.plugin.desktoputil.chat.*;
 import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
@@ -176,9 +177,7 @@ void openChatForSelection()
 
         if (savedNick == null)
         {
-            ConferenceChatManager conferenceManager 
-                = GuiActivator.getUIService().getConferenceChatManager();
-            String[] joinOptions = conferenceManager.getJoinOptions(
+            String[] joinOptions = ChatRoomJoinOptionsDialog.getJoinOptions(
                 chatRoomWrapper.getParentProvider().getProtocolProvider(), 
                 chatRoomWrapper.getChatRoomID());
             String nickName = joinOptions[0];

File: src/net/java/sip/communicator/impl/gui/main/login/DefaultSecurityAuthority.java
Patch:
@@ -9,7 +9,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.protocol.*;
 
@@ -71,7 +70,7 @@ public UserCredentials obtainCredentials(
         String userName = userCredentials.getUserName();
         char[] password = userCredentials.getPassword();
         ImageIcon icon
-            = ImageLoader.getAuthenticationWindowIcon(protocolProvider);
+            = AuthenticationWindow.getAuthenticationWindowIcon(protocolProvider);
 
         if (errorMessage == null)
             loginWindow = new AuthenticationWindow(

File: src/net/java/sip/communicator/impl/gui/main/login/LoginRendererSwingImpl.java
Patch:
@@ -7,9 +7,9 @@
 package net.java.sip.communicator.impl.gui.main.login;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.authorization.*;
+import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.muc.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.account.*;

File: src/net/java/sip/communicator/impl/muc/MUCServiceImpl.java
Patch:
@@ -11,7 +11,7 @@
 import org.jitsi.service.resources.*;
 
 
-import net.java.sip.communicator.impl.gui.utils.*;
+import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.contactsource.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.muc.*;
@@ -737,7 +737,7 @@ private void done(String returnCode)
                     authWindowsService.create(
                         null, null, null, false,
                         chatRoomWrapper.isPersistent(),
-                        ImageLoader.getAuthenticationWindowIcon(
+                        AuthenticationWindow.getAuthenticationWindowIcon(
                             chatRoomWrapper.getParentProvider()
                                 .getProtocolProvider()),
                         resources.getI18NString(

File: src/net/java/sip/communicator/plugin/otr/ScOtrEngineImpl.java
Patch:
@@ -597,7 +597,7 @@ public OtrPolicy getContactPolicy(Contact contact)
     public OtrPolicy getGlobalPolicy()
     {
         return new OtrPolicyImpl(this.configurator.getPropertyInt("POLICY",
-            OtrPolicy.OTRL_POLICY_DEFAULT));
+            OtrPolicy.OTRL_POLICY_MANUAL));
     }
 
     /**

File: src/net/java/sip/communicator/plugin/otr/OtrConfigurationPanel.java
Patch:
@@ -16,6 +16,7 @@
 import net.java.otr4j.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.plugin.otr.authdialog.*;
 
 /**
  * A special {@link Panel} that manages the OTR configuration.

File: src/net/java/sip/communicator/plugin/otr/SwingOtrActionHandler.java
Patch:
@@ -6,6 +6,7 @@
  */
 package net.java.sip.communicator.plugin.otr;
 
+import net.java.sip.communicator.plugin.otr.authdialog.*;
 import net.java.sip.communicator.service.protocol.*;
 
 import java.awt.*;

File: src/net/java/sip/communicator/plugin/otr/authdialog/CustomTextArea.java
Patch:
@@ -1,4 +1,4 @@
-package net.java.sip.communicator.plugin.otr;
+package net.java.sip.communicator.plugin.otr.authdialog;
 
 import java.awt.*;
 

File: src/net/java/sip/communicator/plugin/otr/authdialog/KnownFingerprintsPanel.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.plugin.otr;
+package net.java.sip.communicator.plugin.otr.authdialog;
 
 import java.awt.*;
 import java.awt.event.*;
@@ -15,6 +15,7 @@
 
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.plugin.otr.*;
 
 /**
  * @author @George Politis

File: src/net/java/sip/communicator/plugin/otr/authdialog/KnownFingerprintsTableModel.java
Patch:
@@ -4,13 +4,14 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.plugin.otr;
+package net.java.sip.communicator.plugin.otr.authdialog;
 
 import java.awt.*;
 import java.util.*;
 
 import javax.swing.table.*;
 
+import net.java.sip.communicator.plugin.otr.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.protocol.*;
 

File: src/net/java/sip/communicator/plugin/otr/authdialog/OtrBuddyAuthenticationDialog.java
Patch:
@@ -4,15 +4,16 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.plugin.otr;
+package net.java.sip.communicator.plugin.otr.authdialog;
 
 import java.awt.*;
 import java.awt.event.*;
 
 import javax.swing.*;
 
 import net.java.sip.communicator.plugin.desktoputil.*;
-import net.java.sip.communicator.plugin.otr.FingerprintAuthenticationPanel.ActionComboBoxItem;
+import net.java.sip.communicator.plugin.otr.*;
+import net.java.sip.communicator.plugin.otr.authdialog.FingerprintAuthenticationPanel.*;
 import net.java.sip.communicator.service.protocol.*;
 
 /**

File: src/net/java/sip/communicator/plugin/otr/authdialog/SecretQuestionAuthenticationPanel.java
Patch:
@@ -4,13 +4,14 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.plugin.otr;
+package net.java.sip.communicator.plugin.otr.authdialog;
 
 import java.awt.*;
 
 import javax.swing.*;
 
 import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.plugin.otr.*;
 
 /**
  * @author Marin Dzhigarov

File: src/net/java/sip/communicator/plugin/otr/authdialog/SharedSecretAuthenticationPanel.java
Patch:
@@ -4,13 +4,14 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.plugin.otr;
+package net.java.sip.communicator.plugin.otr.authdialog;
 
 import java.awt.*;
 
 import javax.swing.*;
 
 import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.plugin.otr.*;
 
 /**
  * @author Marin Dzhigarov

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceCallPanel.java
Patch:
@@ -264,8 +264,8 @@ protected void conferenceMemberErrorReceived(CallPeerConferenceEvent ev)
         
         GuiActivator.getAlertUIService().showAlertPopup(
             GuiActivator.getResources().getI18NString(
-                "service.gui.ERROR_RECEIVED_FROM") 
-            + callPeer.getDisplayName(), 
+                "service.gui.ERROR_RECEIVED_FROM",
+                new String[]{callPeer.getDisplayName()}), 
             ev.getErrorString());
     }
 

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferencePeerPanel.java
Patch:
@@ -303,6 +303,8 @@ public Component getComponent()
      */
     private void initSecuritySettings()
     {
+        securityStatusLabel.setSecurityOff();
+
         CallPeerSecurityStatusEvent securityEvent
             = callPeer.getCurrentSecuritySettings();
 
@@ -318,8 +320,6 @@ private void initSecuritySettings()
         securityStatusLabel.setBorder(
             BorderFactory.createEmptyBorder(2, 5, 2, 5));
 
-        securityStatusLabel.setSecurityOff();
-
         securityStatusLabel.addMouseListener(new MouseAdapter()
         {
             /**

File: src/net/java/sip/communicator/impl/gui/main/chat/filetransfer/ReceiveFileConversationComponent.java
Patch:
@@ -377,8 +377,8 @@ public void finished()
     @Override
     protected String getProgressLabel(String bytesString)
     {
-        return bytesString
-            + " " + resources.getI18NString("service.gui.RECEIVED");
+        return resources.getI18NString("service.gui.RECEIVED",
+            new String[]{bytesString});
     }
 
     public void fileTransferCreated(FileTransferCreatedEvent event)

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -1744,8 +1744,9 @@ public ConferenceDescription publishConference(ConferenceDescription cd,
             String displayName;
             if(name == null)
             {
-                displayName = nickname + JabberActivator.getResources()
-                    .getI18NString("service.gui.CHAT_CONFERENCE_ITEM_LABEL");
+                displayName = JabberActivator.getResources()
+                    .getI18NString("service.gui.CHAT_CONFERENCE_ITEM_LABEL",
+                        new String[]{nickname});
             }
             else
             {

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatConferenceCallDialog.java
Patch:
@@ -361,7 +361,7 @@ private void joinConference()
     {
         
         ConferenceDescription chatConference
-            = (ConferenceDescription)chatConferenceListPanel.getSelectedValue();
+            = chatConferenceListPanel.getSelectedValue();
 
         if (chatConference != null)
             CallManager.call(chatPanel.getChatSession()
@@ -381,7 +381,7 @@ public void loadSkin()
     /**
      * Adds a <tt>ConferenceDescription</tt> to the list of conferences.
      *
-     * @param chatConference the <tt>ConferenceDescription</tt> to add
+     * @param conferenceDescription the <tt>ConferenceDescription</tt> to add
      */
     public void addConference(ConferenceDescription conferenceDescription)
     {

File: src/net/java/sip/communicator/impl/muc/MUCActivator.java
Patch:
@@ -193,7 +193,7 @@ public static CredentialsStorageService getCredentialsStorageService()
         if (credentialsService == null)
         {
             credentialsService
-                = (CredentialsStorageService) ServiceUtils.getService(
+                = ServiceUtils.getService(
                     bundleContext, CredentialsStorageService.class);
         }
         return credentialsService;

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -1022,7 +1022,8 @@ public void moveContact(Contact contact,
         OperationSetMultiUserChat opSetMUC
             = provider.getOperationSet(OperationSetMultiUserChat.class);
         
-        if(opSetMUC.isPrivateMessagingContact(contact.getAddress()))
+        if(opSetMUC != null
+           && opSetMUC.isPrivateMessagingContact(contact.getAddress()))
         {
             addNewContactToMetaContact(provider, newParentMetaContact, 
                 contact.getPersistableAddress());

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -192,7 +192,7 @@ private void init()
         {
             groupCombo.setEnabled(false);
 
-            this.setSelectedGroup(metaContact.getParentMetaContactGroup());
+            groupCombo.setSelectedItem(metaContact.getParentMetaContactGroup());
         }
 
         TransparentPanel labelsPanel

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -414,8 +414,9 @@ public void showChatConferenceDialog()
         }
         
         chatConferencesDialog.setVisible(true);
-        chatConferencesDialog.pack();
+        
         chatConferencesDialog.toFront();
+        chatConferencesDialog.pack();
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatConferenceCallDialog.java
Patch:
@@ -294,7 +294,7 @@ else if(source.equals(endConference))
             {
                 chatRoom.publishConference(null, null);
             }
-            this.dispose();
+            this.setVisible(false);
 
         }
         else if(source instanceof JRadioButton)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -13,7 +13,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
-import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomConferenceCallsListPanel.java
Patch:
@@ -7,12 +7,11 @@
 package net.java.sip.communicator.impl.gui.main.chat.conference;
 
 import java.awt.*;
-import java.awt.event.*;
+import java.lang.annotation.*;
 
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/ChatFileMenu.java
Patch:
@@ -15,7 +15,6 @@
 import net.java.sip.communicator.impl.gui.main.chat.history.*;
 import net.java.sip.communicator.impl.gui.main.chatroomslist.*;
 import net.java.sip.communicator.impl.gui.utils.*;
-import net.java.sip.communicator.util.Logger;
 import net.java.sip.communicator.util.skin.*;
 
 /**

File: src/net/java/sip/communicator/util/ServiceUtils.java
Patch:
@@ -57,7 +57,7 @@ public static <T> T getService(
      */
     public static ServiceReference[] getServiceReferences(
             BundleContext bundleContext,
-            Class serviceClass)
+            Class<?> serviceClass)
     {
         ServiceReference[] handlerRefs = null;
         try

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatConferenceCallsListModels.java
Patch:
@@ -20,7 +20,7 @@
  * @author Hristo Terezov
  */
 public class ChatConferenceCallsListModels
-    extends AbstractListModel<ConferenceDescription>
+    extends AbstractListModel
 {
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomConferenceCallsListPanel.java
Patch:
@@ -34,7 +34,7 @@ public class ChatRoomConferenceCallsListPanel
     /**
      * The list of conferences.
      */
-    private final JList<ConferenceDescription> conferenceCallList;
+    private final JList conferenceCallList;
 
     /**
      * The model of the conferences list.
@@ -179,7 +179,7 @@ public ChatRoomConferenceCallsListPanel(final ChatPanel chatPanel)
         this.conferenceCallsListModel
             = new ChatConferenceCallsListModels(chatPanel.getChatSession());
         this.conferenceCallList 
-            = new JList<ConferenceDescription>(conferenceCallsListModel);
+            = new JList(conferenceCallsListModel);
         this.conferenceCallList.addKeyListener(
             new CListKeySearchListener(conferenceCallList));
         this.conferenceCallList.setCellRenderer(

File: src/net/java/sip/communicator/impl/gui/main/menus/ToolsMenu.java
Patch:
@@ -437,7 +437,7 @@ private List<ProtocolProviderService> getVideoBridgeProviders()
         {
             OperationSetVideoBridge videoBridgeOpSet
                 = videoBridgeProvider.getOperationSet(
-                    OperationSetVideoBridge.class);
+                        OperationSetVideoBridge.class);
 
             // Check if the video bridge is actually active before adding it to
             // the list of active providers.

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatSession.java
Patch:
@@ -761,6 +761,8 @@ private void removeChatTransports(Contact contact)
         }
 
         contact.removeResourceListener(this);
+
+        currentChatTransport = null;
     }
 
     /**

File: src/net/java/sip/communicator/plugin/spellcheck/ChatAttachments.java
Patch:
@@ -121,8 +121,7 @@ public List<JMenuItem> getMenuElements(final Chat chat,
                     }
                     catch (BadLocationException e)
                     {
-                        // TODO Auto-generated catch block
-                        e.printStackTrace();
+                        logger.error("Error", e);
                     }
                 }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -265,6 +265,8 @@ public void removeUpdate(DocumentEvent e)
 
         // All items are now instantiated and could safely load the skin.
         loadSkin();
+
+        this.initialized = true;
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/globalstatus/GlobalStatusEnum.java
Patch:
@@ -47,7 +47,7 @@ public class GlobalStatusEnum
      */
     public static final GlobalStatusEnum ONLINE
         = new GlobalStatusEnum(
-                85,
+                65,
                 ONLINE_STATUS,
                 loadIcon("service.gui.statusicons.USER_ONLINE_ICON"),
                 "service.gui.ONLINE");
@@ -58,7 +58,7 @@ public class GlobalStatusEnum
      */
     public static final GlobalStatusEnum FREE_FOR_CHAT
         = new GlobalStatusEnum(
-                65,
+                85,
                 FREE_FOR_CHAT_STATUS,
                 loadIcon("service.gui.statusicons.USER_FFC_ICON"),
                 "service.gui.FFC_STATUS");

File: src/net/java/sip/communicator/service/gui/AccountRegistrationWizard.java
Patch:
@@ -145,8 +145,9 @@ public abstract ProtocolProviderService signin()
      * new account
      * @throws OperationFailedException if the operation didn't succeed
      */
-    public abstract ProtocolProviderService signin(  String userName,
-                                            String password)
+    public abstract ProtocolProviderService signin(
+            String userName,
+            String password)
         throws OperationFailedException;
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -550,6 +550,7 @@ public Component getListCellRendererComponent(  JList list,
                                                         boolean isSelected,
                                                         boolean cellHasFocus)
         {
+            this.setBorder(BorderFactory.createEmptyBorder(0, 5, 0, 0));
             if (value instanceof String)
             {
                 setIcon(null);
@@ -606,12 +607,12 @@ public Component getListCellRendererComponent(  JList list,
             {
                 this.setBorder(BorderFactory.createCompoundBorder(
                     BorderFactory.createMatteBorder(1, 0, 0, 0, Color.LIGHT_GRAY),
-                    BorderFactory.createEmptyBorder(5, 0, 0, 0)));
+                    BorderFactory.createEmptyBorder(5, 5, 0, 0)));
                 this.setText((String) value);
             }
             else
             {
-                this.setBorder(null);
+                this.setBorder(BorderFactory.createEmptyBorder(0, 5, 0, 0));
                 MetaContactGroup group = (MetaContactGroup) value;
 
                 if (group.equals(GuiActivator

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigPluginActivator.java
Patch:
@@ -350,7 +350,7 @@ public static ProtocolProviderService[] getProtocolProviders()
 
         if (serRefs == null || serRefs[0] == null)
         {
-            return null;
+            return new ProtocolProviderService[0];
         }
 
         Set<ProtocolProviderService> pps = new HashSet<ProtocolProviderService>();

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -227,7 +227,10 @@ public void removeAccount(ProtocolProviderService protocolProvider)
         StatusSelectorMenu menu = getStatusSelectorMenu(protocolProvider);
 
         if (menu != null)
+        {
+            menu.dispose();
             remove(menu);
+        }
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -1945,6 +1945,9 @@ public void dispose()
     {
         super.dispose();
 
+        if(showPreview != null)
+            showPreview.dispose();
+
         clear();
     }
 

File: src/net/java/sip/communicator/service/gui/PluginComponentFactory.java
Patch:
@@ -139,6 +139,7 @@ public PluginComponent getPluginComponentInstance(Object parent)
         if(p == null)
         {
             p = getPluginInstance();
+            pluginInstances.put(parent, p);
         }
 
         return p;

File: src/net/java/sip/communicator/impl/gui/main/call/CallInfoFrame.java
Patch:
@@ -750,7 +750,7 @@ private void appendStreamEncryptionMethod(
             }
             else
             {
-                info = "SDES";
+                info = srtpControl.getSrtpControlType().toString();
             }
 
             rtpType = resources.getI18NString(

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -1135,6 +1135,8 @@ private String formatMessage(String message,
                                  String contentType,
                                  String keyword)
     {
+        if(message == null)
+            return "";
         // If the message content type is HTML we won't process links and
         // new lines, but only the smileys.
         if (!ChatHtmlUtils.HTML_CONTENT_TYPE.equals(contentType))

File: src/net/java/sip/communicator/service/protocol/ContactResource.java
Patch:
@@ -41,7 +41,7 @@ public class ContactResource
     /**
      * The priority of this contact source.
      */
-    private int priority;
+    protected int priority;
 
     /**
      * Whether this contact resource is a mobile one.

File: src/net/java/sip/communicator/service/protocol/ContactResource.java
Patch:
@@ -46,7 +46,7 @@ public class ContactResource
     /**
      * Whether this contact resource is a mobile one.
      */
-    private boolean mobile = false;
+    protected boolean mobile = false;
 
     /**
      * Creates an empty instance of <tt>ContactResource</tt> representing the

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -552,7 +552,7 @@ private boolean isMobile(MetaContact metaContact)
         {
             Contact contact = iter.next();
 
-            if(!contact.isMobile())
+            if(contact.getPresenceStatus().isOnline() && !contact.isMobile())
                 return false;
         }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/toolBars/MainToolBar.java
Patch:
@@ -19,7 +19,6 @@
 import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
-import net.java.sip.communicator.impl.gui.main.chat.history.*;
 import net.java.sip.communicator.impl.gui.main.configforms.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.contactsource.*;

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetTelephonyConferencingSipImpl.java
Patch:
@@ -6,6 +6,8 @@
  */
 package net.java.sip.communicator.impl.protocol.sip;
 
+import gov.nist.javax.sip.header.*;
+
 import java.io.*;
 import java.text.*;
 import java.util.*;
@@ -16,12 +18,12 @@
 import javax.sip.message.*;
 import javax.sip.message.Message;
 
-import gov.nist.javax.sip.header.*;
 import net.java.sip.communicator.impl.protocol.sip.sdp.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.service.protocol.media.*;
 import net.java.sip.communicator.util.*;
+
 import org.jitsi.util.xml.*;
 
 /**

File: src/net/java/sip/communicator/plugin/spellcheck/LanguageMenuBar.java
Patch:
@@ -15,15 +15,14 @@
 import javax.swing.*;
 import javax.swing.event.*;
 
+import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.plugin.desktoputil.SwingWorker;
 import net.java.sip.communicator.plugin.spellcheck.Parameters.Default;
 import net.java.sip.communicator.plugin.spellcheck.Parameters.Locale;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
-import net.java.sip.communicator.service.gui.Container;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
-import net.java.sip.communicator.plugin.desktoputil.*;
-import net.java.sip.communicator.plugin.desktoputil.SwingWorker;
 
 /**
  * Combo box providing a listing of all available locales with corresponding

File: src/net/java/sip/communicator/util/ConfigurationUtils.java
Patch:
@@ -10,11 +10,10 @@
 import java.beans.*;
 import java.io.*;
 import java.util.*;
-import java.util.List; /* disambiguation */
+import java.util.List;
 
 import javax.net.ssl.*;
 
-import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.msghistory.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.resources.*;

File: src/net/java/sip/communicator/plugin/branding/AboutWindowPluginComponent.java
Patch:
@@ -38,9 +38,10 @@ public static void actionPerformed()
      *
      * @param container parent container
      */
-    public AboutWindowPluginComponent(Container container)
+    public AboutWindowPluginComponent(Container container,
+                                      PluginComponentFactory parentFactory)
     {
-        super(container);
+        super(container, parentFactory);
     }
 
     public Object getComponent()

File: src/net/java/sip/communicator/plugin/branding/BrandingActivator.java
Patch:
@@ -229,7 +229,7 @@ private void registerMenuEntryNonMacOSX(UIService uiService)
                 @Override
                 protected PluginComponent getPluginInstance()
                 {
-                    return new AboutWindowPluginComponent(getContainer());
+                    return new AboutWindowPluginComponent(getContainer(), this);
                 }
             },
             helpMenuFilter);
@@ -251,7 +251,7 @@ protected PluginComponent getPluginInstance()
                 @Override
                 protected PluginComponent getPluginInstance()
                 {
-                    return new AboutWindowPluginComponent(getContainer());
+                    return new AboutWindowPluginComponent(getContainer(), this);
                 }
             },
             chatHelpMenuFilter);

File: src/net/java/sip/communicator/plugin/contactinfo/ContactInfoActivator.java
Patch:
@@ -185,7 +185,7 @@ private class ContactInfoPluginComponentFactory
         @Override
         protected PluginComponent getPluginInstance()
         {
-            return new ContactInfoMenuItem(getContainer());
+            return new ContactInfoMenuItem(getContainer(), this);
         }
     }
 }

File: src/net/java/sip/communicator/plugin/exampleplugin/ExamplePluginActivator.java
Patch:
@@ -33,8 +33,6 @@ public class ExamplePluginActivator
     public void start(BundleContext bc)
         throws Exception
     {
-        final ExamplePluginMenuItem examplePlugin = new ExamplePluginMenuItem();
-
         Hashtable<String, String> containerFilter
             = new Hashtable<String, String>();
         containerFilter.put(
@@ -49,7 +47,7 @@ public void start(BundleContext bc)
                 @Override
                 protected PluginComponent getPluginInstance()
                 {
-                    return examplePlugin;
+                    return new ExamplePluginMenuItem(this);
                 }
             },
             containerFilter);

File: src/net/java/sip/communicator/plugin/exampleplugin/ExamplePluginMenuItem.java
Patch:
@@ -35,9 +35,9 @@ public class ExamplePluginMenuItem
     /**
      * Creates an instance of <tt>ExamplePluginMenuItem</tt>.
      */
-    public ExamplePluginMenuItem()
+    public ExamplePluginMenuItem(PluginComponentFactory parentFactory)
     {
-        super(Container.CONTAINER_CONTACT_RIGHT_BUTTON_MENU);
+        super(Container.CONTAINER_CONTACT_RIGHT_BUTTON_MENU, parentFactory);
     }
 
     /**

File: src/net/java/sip/communicator/plugin/otr/OtrActivator.java
Patch:
@@ -465,9 +465,9 @@ protected PluginComponent getPluginInstance()
         {
             Container container = getContainer();
             if(container.equals(Container.CONTAINER_CHAT_TOOL_BAR))
-                return new OtrMetaContactButton(container);
+                return new OtrMetaContactButton(container, this);
             else
-                return new OtrMetaContactMenu(container);
+                return new OtrMetaContactMenu(container, this);
         }
     }
 }

File: src/net/java/sip/communicator/plugin/otr/OtrMetaContactButton.java
Patch:
@@ -78,9 +78,10 @@ public void contactVerificationStatusChanged(Contact contact)
             }
         };
 
-    public OtrMetaContactButton(Container container)
+    public OtrMetaContactButton(Container container,
+                                PluginComponentFactory parentFactory)
     {
-        super(container);
+        super(container, parentFactory);
 
         OtrActivator.scOtrEngine.addListener(scOtrEngineListener);
         OtrActivator.scOtrKeyManager.addListener(scOtrKeyManagerListener);

File: src/net/java/sip/communicator/plugin/otr/OtrMetaContactMenu.java
Patch:
@@ -54,9 +54,10 @@ public class OtrMetaContactMenu
      */
     private JMenuItem whatsThis;
 
-    public OtrMetaContactMenu(Container container)
+    public OtrMetaContactMenu(Container container,
+                              PluginComponentFactory parentFactory)
     {
-        super(container);
+        super(container, parentFactory);
 
         inMacOSXScreenMenuBar =
             Container.CONTAINER_CHAT_MENU_BAR.equals(container)

File: src/net/java/sip/communicator/plugin/profiler4j/SettingsWindowMenuEntry.java
Patch:
@@ -24,9 +24,10 @@ public class SettingsWindowMenuEntry
     private static final String PROFILER_NAME = "plugin.profiler.PLUGIN_NAME";
     private JMenuItem settingsMenuEntry;
 
-    public SettingsWindowMenuEntry(Container container)
+    public SettingsWindowMenuEntry(Container container,
+                                   PluginComponentFactory parentFactory)
     {
-        super(container);
+        super(container, parentFactory);
 
         settingsMenuEntry = new JMenuItem(Resources.getString( PROFILER_NAME ));
         settingsMenuEntry.addActionListener(new ActionListener()

File: src/net/java/sip/communicator/plugin/update/CheckForUpdatesMenuItemComponent.java
Patch:
@@ -32,9 +32,10 @@ public class CheckForUpdatesMenuItemComponent
      *
      * @param container the container of the update menu component
      */
-    public CheckForUpdatesMenuItemComponent(Container container)
+    public CheckForUpdatesMenuItemComponent(Container container,
+                                            PluginComponentFactory parentFactory)
     {
-        super(container);
+        super(container, parentFactory);
     }
 
     /**

File: src/net/java/sip/communicator/plugin/update/UpdateActivator.java
Patch:
@@ -205,7 +205,7 @@ public void start(Object dependentService)
                         protected PluginComponent getPluginInstance()
                         {
                             return new CheckForUpdatesMenuItemComponent(
-                                getContainer());
+                                getContainer(), this);
                         }
                     },
                     toolsMenuFilter);

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardActivator.java
Patch:
@@ -44,8 +44,6 @@ public void start (BundleContext bc) throws Exception
 
         session = new WhiteboardSessionManager ();
 
-        final WhiteboardMenuItem whiteboardPlugin = new WhiteboardMenuItem (session);
-
         Hashtable<String, String> containerFilter
             = new Hashtable<String, String>();
         containerFilter.put(
@@ -60,7 +58,7 @@ public void start (BundleContext bc) throws Exception
                 @Override
                 protected PluginComponent getPluginInstance()
                 {
-                    return whiteboardPlugin;
+                    return new WhiteboardMenuItem(session, this);
                 }
             },
             containerFilter);

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardMenuItem.java
Patch:
@@ -42,9 +42,10 @@ public class WhiteboardMenuItem
      *
      * @param session the whiteboard session manager
      */
-    public WhiteboardMenuItem (WhiteboardSessionManager session)
+    public WhiteboardMenuItem (WhiteboardSessionManager session,
+                               PluginComponentFactory parentFactory)
     {
-        super(Container.CONTAINER_CONTACT_RIGHT_BUTTON_MENU);
+        super(Container.CONTAINER_CONTACT_RIGHT_BUTTON_MENU, parentFactory);
 
         this.session = session;
         this.whiteboardMenu.setIcon (

File: src/net/java/sip/communicator/impl/replacement/directimage/ReplacementServiceDirectImageImpl.java
Patch:
@@ -139,9 +139,9 @@ public String getPattern()
      * @return the file size in bytes of the image link provided; -1 if the size
      * isn't available or exceeds the max allowed image size.
      */
-    public long getImageSize(String sourceString)
+    public int getImageSize(String sourceString)
     {
-        long length = -1;
+        int length = -1;
         try
         {
             
@@ -151,7 +151,7 @@ public long getImageSize(String sourceString)
             {
                 HttpURLConnection connection =
                     (HttpURLConnection)url.openConnection();
-                length = connection.getContentLengthLong();
+                length = connection.getContentLength();
                 connection.disconnect();
             }
             else if (protocol.equals("ftp"))

File: src/net/java/sip/communicator/service/replacement/directimage/DirectImageReplacementService.java
Patch:
@@ -22,7 +22,7 @@ public interface DirectImageReplacementService
      * @return the file size in bytes of the image link provided; -1 if the size
      * isn't available or exceeds the max allowed image size.
      */
-    public long getImageSize(String sourceString);
+    public int getImageSize(String sourceString);
 
     /**
      * Checks if the resource pointed by sourceString is an image.

File: src/net/java/sip/communicator/util/FTPUtils.java
Patch:
@@ -146,7 +146,7 @@ else if(!code.equals("230"))
      * @return the size of the file in bytes.
      * @throws Exception if <tt>readLine</tt> fails.
      */
-    public long getSize() throws Exception
+    public int getSize() throws Exception
     {
         sendLine("SIZE " + path);
 
@@ -157,11 +157,11 @@ public long getSize() throws Exception
         }
 
         String fileSizeStr = line.substring(4);
-        long fileSize = INVALID_FILE_SIZE;
+        int fileSize = INVALID_FILE_SIZE;
 
         try
         {
-            fileSize = Long.parseLong(fileSizeStr);
+            fileSize = Integer.parseInt(fileSizeStr);
         }
         catch (NumberFormatException e)
         {

File: src/net/java/sip/communicator/impl/replacement/vbox7/ReplacementServiceVbox7Impl.java
Patch:
@@ -66,7 +66,7 @@ public String getReplacement(String sourceString)
 
         while (m.find())
         {
-            thumbUrl = "http://i.vbox7.com/p/" + m.group(1) + "3.jpg";
+            thumbUrl = "https://i.vbox7.com/p/" + m.group(1) + "3.jpg";
         }
 
         return thumbUrl;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -318,9 +318,8 @@ else if(calleeAddress.endsWith(GOOGLE_VOICE_DOMAIN))
         // If there's no fullCalleeURI specified we'll discover the most
         // connected one with highest priority.
         if (fullCalleeURI == null)
-            fullCalleeURI = (!isPrivateMessagingContact? 
-                discoverFullJid(calleeAddress, alwaysCallGtalk) : 
-                    calleeAddress);
+            fullCalleeURI = 
+                discoverFullJid(calleeAddress, alwaysCallGtalk);
 
         if (fullCalleeURI == null)
             throw new OperationFailedException(

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -318,7 +318,7 @@ else if(calleeAddress.endsWith(GOOGLE_VOICE_DOMAIN))
         // If there's no fullCalleeURI specified we'll discover the most
         // connected one with highest priority.
         if (fullCalleeURI == null)
-            fullCalleeURI = (isPrivateMessagingContact? 
+            fullCalleeURI = (!isPrivateMessagingContact? 
                 discoverFullJid(calleeAddress, alwaysCallGtalk) : 
                     calleeAddress);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetMultiUserChatJabberImpl.java
Patch:
@@ -788,9 +788,6 @@ public void subscriptionMoved(SubscriptionMovedEvent evt) {}
       */
      public void subscriptionRemoved(SubscriptionEvent evt)
      {
-         // Set to null the contact reference in all corresponding chat room
-         // members.
-         this.updateChatRoomMembers(null);
      }
 
      /**

File: src/net/java/sip/communicator/impl/protocol/mock/MockChatRoom.java
Patch:
@@ -551,7 +551,7 @@ public void setUserNickname(String nickname) throws OperationFailedException
      */
     public String getIdentifier()
     {
-        throw new UnsupportedOperationException("Not supported yet.");
+        return name;
     }
 
     /**

File: src/net/java/sip/communicator/plugin/otr/ScOtrEngineImpl.java
Patch:
@@ -292,7 +292,8 @@ private boolean isHistoryLoggingEnabled(Contact contact)
         MetaContact metaContact = OtrActivator
             .getContactListService().findMetaContactByContact(contact);
         if(metaContact != null)
-            return ConfigurationUtils.isHistoryLoggingEnabled(metaContact);
+            return ConfigurationUtils.isHistoryLoggingEnabled(
+                metaContact.getMetaUID());
         else
             return true;
     }

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountCreationForm.java
Patch:
@@ -169,7 +169,8 @@ private boolean createJabberAccount(String server, int port, String username,
         catch (XMPPException exc)
         {
             logger.error(exc);
-            if (exc.getXMPPError().getCode() == 409)
+            if (exc.getXMPPError() != null
+                && exc.getXMPPError().getCode() == 409)
             {
                 showErrorMessage(Resources.getString(
                         "plugin.jabberaccregwizz.USER_EXISTS_ERROR"));

File: src/net/java/sip/communicator/service/protocol/AccountManager.java
Patch:
@@ -870,7 +870,7 @@ public boolean removeStoredAccount(ProtocolProviderFactory factory,
                 accountRootPropertyName //node id
                 + "." + ProtocolProviderFactory.ACCOUNT_UID); // propname
 
-            if (accountUID.equals(accountID.getAccountUniqueID()))
+            if (accountID.getAccountUniqueID().equals(accountUID))
             {
                 //retrieve the names of all properties registered for the
                 //current account.

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableDialog.java
Patch:
@@ -362,7 +362,7 @@ public void actionPerformed(ActionEvent e)
                     .getConferenceChatManager()
                     .createChatRoom(chatRoomName.trim(),
                         getSelectedProvider().getProtocolProvider(),
-                        new ArrayList<String>(), "", false, false, true);
+                        new ArrayList<String>(), "", false, true, true);
 
             chatRoomWrapper.getJoinOptions(true);
 

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomRightButtonMenu.java
Patch:
@@ -148,6 +148,7 @@ else if (itemName.equals("openChatRoom"))
                             new ArrayList<String>(),
                             "",
                             false,
+                            false,
                             true);
             }
             

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableUI.java
Patch:
@@ -158,7 +158,7 @@ void openChatForSelection()
                         chatRoomWrapper.getChatRoomName(),
                         chatRoomWrapper.getParentProvider()
                             .getProtocolProvider(), new ArrayList<String>(),
-                        "", false, true);
+                        "", false, false, true);
 
             // leave the chatroom because getChatRoom().isJoined() returns true
             // otherwise

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -533,6 +533,9 @@ public void run()
                 ChatPanel chatPanel
                     = chatWindowManager.getMultiChat(chatRoomWrapper, true);
 
+                chatPanel.setChatIcon(
+                    chatPanel.getChatSession().getChatStatusIcon());
+
                 // Check if we have already opened a chat window for this chat
                 // wrapper and load the real chat room corresponding to the
                 // wrapper.

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -603,12 +603,13 @@ public Iterable<ContentPacketExtension> generateSessionAccept()
                 = JingleUtils.getRtpDescription(theirContent);
             MediaFormat format = null;
 
+            List<MediaFormat> localFormats = getLocallySupportedFormats(dev);
             for(PayloadTypePacketExtension payload
                     : theirDescription.getPayloadTypes())
             {
                 format = JingleUtils.payloadTypeToMediaFormat(
                             payload, getDynamicPayloadTypes());
-                if(format != null)
+                if(format != null && localFormats.contains(format))
                     break;
             }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -336,6 +336,9 @@ else if (chatSession instanceof ConferenceChatSession)
             // The subject panel is added here, because it's specific for the
             // multi user chat and is not contained in the single chat chat panel.
             this.add(subjectPanel, BorderLayout.NORTH);
+
+            this.revalidate();
+            this.repaint();
         }
 
         if (chatContactListPanel != null)

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetMultiUserChatJabberImpl.java
Patch:
@@ -158,7 +158,9 @@ public ChatRoom createChatRoom(
             }
 
             room = createLocalChatRoomInstance(muc);
-            room.setLocalUserRole(ChatRoomMemberRole.MODERATOR);
+            // as we are creating the room we are the owner of it
+            // at least that's what MultiUserChat.create says
+            room.setLocalUserRole(ChatRoomMemberRole.OWNER);
         }
         return room;
     }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -1022,6 +1022,9 @@ private String processKeyword(  String message,
                                     String contentType,
                                     String keyword)
     {
+        if(message == null)
+            return message;
+
         Matcher m
             = Pattern.compile(Pattern.quote(keyword), Pattern.CASE_INSENSITIVE)
                 .matcher(message);

File: src/net/java/sip/communicator/impl/msghistory/MessageHistoryServiceImpl.java
Patch:
@@ -1922,7 +1922,7 @@ public void progressChanged(ProgressEvent evt)
         /**
          * Calculates the progress according the count of the records
          * we will search
-         * @param historyProgress int
+         * @param evt the progress event
          * @return int
          */
         private int getProgressMapping(ProgressEvent evt)

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerJabberImpl.java
Patch:
@@ -588,7 +588,7 @@ public void processContentModify(JingleIQ content)
 
             setSenders(mediaType, ext.getSenders());
 
-            if (MediaType.VIDEO.equals(mediaType));
+            if (MediaType.VIDEO.equals(mediaType))
                 getCall().modifyVideoContent();
         }
         catch(Exception e)

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/ContentPacketExtension.java
Patch:
@@ -272,6 +272,8 @@ public SendersEnum getSenders()
      */
     public void setSenders(SendersEnum senders)
     {
+        if (senders == null)
+            senders = SendersEnum.both;
         setAttribute(SENDERS_ATTR_NAME, senders.toString());
     }
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTelephonyConferencingJabberImpl.java
Patch:
@@ -464,7 +464,8 @@ protected ConferenceInfoDocument getCurrentConferenceInfo(
         ConferenceInfoDocument confInfo
                 = super.getCurrentConferenceInfo(callPeer);
 
-        if (callPeer instanceof CallPeerJabberImpl)
+        if (callPeer instanceof CallPeerJabberImpl
+                && confInfo != null)
         {
             confInfo.setSid(((CallPeerJabberImpl)callPeer).getSID());
         }

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetTelephonyConferencing.java
Patch:
@@ -1020,6 +1020,9 @@ protected ConferenceInfoDocument getCurrentConferenceInfo(
         confInfo.setEntity(getLocalEntity(callPeer));
 
         Call call = callPeer.getCall();
+        if (call == null)
+            return null;
+
         List<CallPeer> conferenceCallPeers = CallConference.getCallPeers(call);
         confInfo.setUserCount(
                 1 /* the local peer/user */ + conferenceCallPeers.size());

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetVideoTelephony.java
Patch:
@@ -197,7 +197,6 @@ public void setLocalVideoAllowed(Call call, boolean allowed)
         MediaAwareCall<?, ?, ?> mediaAwareCall = (MediaAwareCall<?, ?, ?>) call;
         MediaUseCase useCase = MediaUseCase.CALL;
 
-        mediaAwareCall.setVideoDevice(null, useCase);
         mediaAwareCall.setLocalVideoAllowed(allowed, useCase);
     }
 

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetVideoTelephony.java
Patch:
@@ -195,9 +195,10 @@ public void setLocalVideoAllowed(Call call, boolean allowed)
         throws OperationFailedException
     {
         MediaAwareCall<?, ?, ?> mediaAwareCall = (MediaAwareCall<?, ?, ?>) call;
+        MediaUseCase useCase = MediaUseCase.CALL;
 
-        mediaAwareCall.setVideoDevice(null);
-        mediaAwareCall.setLocalVideoAllowed(allowed, MediaUseCase.CALL);
+        mediaAwareCall.setVideoDevice(null, useCase);
+        mediaAwareCall.setLocalVideoAllowed(allowed, useCase);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetAutoAnswerJabberImpl.java
Patch:
@@ -32,6 +32,8 @@ public OperationSetAutoAnswerJabberImpl(
             ProtocolProviderServiceJabberImpl protocolProvider)
     {
         super(protocolProvider);
+
+        this.load();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetAutoAnswerSipImpl.java
Patch:
@@ -74,6 +74,8 @@ public OperationSetAutoAnswerSipImpl(
             ProtocolProviderServiceSipImpl protocolProvider)
     {
         super(protocolProvider);
+
+        this.load();
     }
 
     /**
@@ -329,8 +331,6 @@ protected boolean satisfyAutoAnswerConditions(Call call)
      * Makes a check after creating call locally, should we answer it.
      *
      * @param call The new incoming call to auto-answer if needed.
-     * @param isVideoCall Indicates if the remote peer which has created this
-     * call wish to have a video call.
      *
      * @return <tt>true</tt> if we have processed and no further processing is
      *          needed, <tt>false</tt> otherwise.

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetBasicAutoAnswer.java
Patch:
@@ -52,9 +52,6 @@ public AbstractOperationSetBasicAutoAnswer(
             ProtocolProviderService protocolProvider)
     {
         this.protocolProvider = protocolProvider;
-
-        // init values from account props
-        load();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -16,7 +16,6 @@
 
 import javax.swing.*;
 import javax.swing.event.*;
-import javax.swing.plaf.*;
 import javax.swing.plaf.basic.*;
 import javax.swing.text.*;
 
@@ -25,6 +24,7 @@
 import net.java.sip.communicator.impl.gui.main.chat.filetransfer.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.plugin.desktoputil.SwingWorker;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.filehistory.*;
 import net.java.sip.communicator.service.gui.*;
@@ -35,7 +35,6 @@
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;
 import net.java.sip.communicator.util.skin.*;
-import net.java.sip.communicator.plugin.desktoputil.SwingWorker;
 
 import org.jitsi.util.*;
 

File: src/net/java/sip/communicator/service/protocol/media/CallPeerMediaHandler.java
Patch:
@@ -866,7 +866,6 @@ public List<MediaFormat> getLocallySupportedFormats(
             encodingConfiguration.loadProperties(
                     accountProperties,
                     ProtocolProviderFactory.ENCODING_PROP_PREFIX);
-
             return
                 mediaDevice.getSupportedFormats(
                         sendPreset, receivePreset,

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableDialog.java
Patch:
@@ -208,8 +208,9 @@ public void itemStateChanged(ItemEvent e)
                     okButton.setEnabled(true);
                     addButton.setEnabled(true);
                 }
-                else if(roomsCombo.getSelectedIndex() == -1
+                else if((roomsCombo.getSelectedIndex() == -1
                         || e.getStateChange() == ItemEvent.DESELECTED)
+                        && editor.getText().trim().length() <= 0)
                 {
                     okButton.setEnabled(false);
                     addButton.setEnabled(false);

File: src/net/java/sip/communicator/impl/protocol/jabber/ProviderManagerExt.java
Patch:
@@ -99,8 +99,8 @@ public void load()
             DiscoverInfoProvider.class);
 
         //<!-- Data Forms-->
-        //addExtProvider("x", "jabber:x:data",
-        //    org.jivesoftware.smackx.provider.DataFormProvider.class);
+        addExtProvider("x", "jabber:x:data",
+            org.jivesoftware.smackx.provider.DataFormProvider.class);
 
         //<!-- MUC User -->
         addExtProvider("x", "http://jabber.org/protocol/muc#user",

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -1909,7 +1909,7 @@ public void setRemotelyOnHold(boolean onHold)
                     MediaDirection newDirection
                             = getPeer().getCall().isConferenceFocus()
                             ? MediaDirection.INACTIVE
-                            : stream.getDirection().and(MediaDirection.SENDRECV);
+                            : stream.getDirection().and(MediaDirection.RECVONLY);
                     stream.setDirection(newDirection);
                 }
                 else

File: src/net/java/sip/communicator/impl/replacement/smiley/Resources.java
Patch:
@@ -89,7 +89,7 @@ public static Collection<Smiley> getDefaultSmileyPack()
             new String[] {"(angry)"}, "Angry"));
 
         defaultSmileyList.add(new SmileyImpl("service.gui.smileys.SMILEY18",
-            new String[] {"(bomb)"}, "Explosing"));
+            new String[] {"(bomb)"}, "Exploding"));
 
         defaultSmileyList.add(new SmileyImpl("service.gui.smileys.SMILEY19",
             new String[] {"(search)"}, "Searching"));

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomRightButtonMenu.java
Patch:
@@ -12,10 +12,8 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
-import net.java.sip.communicator.impl.gui.main.chatroomslist.joinforms.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.protocol.*;
@@ -34,7 +32,7 @@
  */
 public class ChatRoomRightButtonMenu
     extends SIPCommPopupMenu
-    implements  ActionListener
+    implements ActionListener
 {
     /**
      * The current chat room wrapper.

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableDialog.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.event.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
@@ -36,7 +35,7 @@
  */
 public class ChatRoomTableDialog
     extends SIPCommDialog
-    implements  ActionListener
+    implements ActionListener
 {
     /**
      * The global/shared <code>ChatRoomTableDialog</code> currently showing.

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableUI.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.table.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/ChatRoomAuthenticationWindow.java
Patch:
@@ -15,7 +15,6 @@
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 
 /**
@@ -27,8 +26,8 @@
  */
 public class ChatRoomAuthenticationWindow
     extends SIPCommFrame
-    implements  ActionListener,
-                Skinnable
+    implements ActionListener,
+               Skinnable
 {
     private JTextArea infoTextArea = new JTextArea();
 

File: src/net/java/sip/communicator/service/httputil/SSLSocketFactoryEx.java
Patch:
@@ -127,7 +127,8 @@ public Socket connectSocket(
         }
         catch(SocketTimeoutException ex)
         {
-            throw new ConnectTimeoutException("Connect to " + remoteAddress + " timed out");
+            throw new ConnectTimeoutException(
+                    "Connect to " + remoteAddress + " timed out");
         }
 
         String hostname;

File: src/net/java/sip/communicator/impl/gui/customcontrols/MessageDialog.java
Patch:
@@ -37,7 +37,7 @@ public class MessageDialog
     private JButton cancelButton = new JButton(
         GuiActivator.getResources().getI18NString("service.gui.CANCEL"));
 
-    private JButton okButton = new JButton(
+    protected JButton okButton = new JButton(
         GuiActivator.getResources().getI18NString("service.gui.OK"));
 
     private JCheckBox doNotAskAgain = new SIPCommCheckBox(

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -352,7 +352,7 @@ else if (menuItemName.equals("changeNicknameItem"))
                     GuiActivator.getResources().getI18NString(
                     "service.gui.CHANGE_NICKNAME_LABEL"),
                     "Ok",
-                    false);
+                    false, true);
 
            // reasonDialog.setIconImage(ImageLoader.getImage(
            //   ImageLoader.CHANGE_NICKNAME_ICON_16x16));

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -1076,7 +1076,7 @@ public OperationSetMultiUserChat getMultiUserChatOpSet(
      */
     public boolean isMenuSelected()
     {
-        return menu.isSelected();
+        return menu.hasSelectedMenus();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/toolBars/MainToolBar.java
Patch:
@@ -344,7 +344,9 @@ public void chatChanged(ChatPanel chatPanel)
             sendFileButton.setEnabled(
                 chatPanel.findFileTransferChatTransport() != null);
 
-            new UpdateCallButtonWorker(contact).start();
+            // null when using chat rooms
+            if(contact != null)
+                new UpdateCallButtonWorker(contact).start();
 
             changeHistoryButtonsState(chatPanel);
         }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -787,7 +787,7 @@ public void processPacket(Packet packet)
                                    + fromUserID);
                 //create the volatile contact
                 sourceContact = opSetPersPresence
-                    .createVolatileContact(fromUserID);
+                    .createVolatileContact(msg.getFrom());
             }
 
             Date timestamp = new Date();

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetGenericNotificationsJabberImpl.java
Patch:
@@ -248,7 +248,8 @@ public void processPacket(Packet packet)
         Contact sender = opSetPersPresence.findContactByID(fromUserID);
 
         if(sender == null)
-            sender = opSetPersPresence.createVolatileContact(fromUserID);
+            sender = opSetPersPresence.createVolatileContact(
+                notifyEvent.getFrom());
 
         if(notifyEvent.getType() == Type.GET)
             fireNewEventNotification(
@@ -291,7 +292,7 @@ private void fireNewEventNotification(
                 opSetPersPresence.findContactByID(sourceUserID);
         if(sourceContact == null)
             sourceContact = opSetPersPresence
-                    .createVolatileContact(sourceUserID);
+                    .createVolatileContact(source);
 
         GenericEvent
             event = new GenericEvent(

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -967,7 +967,7 @@ private void initRoster()
      *
      * @return ContactGroupJabberImpl
      */
-    private ContactGroupJabberImpl getNonPersistentGroup()
+    ContactGroupJabberImpl getNonPersistentGroup()
     {
         for (int i = 0; i < getRootGroup().countSubgroups(); i++)
         {

File: src/net/java/sip/communicator/plugin/desktoputil/FramedImage.java
Patch:
@@ -117,7 +117,9 @@ public void setImageIcon(Image image)
      */
     public Image getImage()
     {
-        return icon.getImage();
+        if(icon != null)
+            return icon.getImage();
+        return null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryServiceImpl.java
Patch:
@@ -1213,6 +1213,9 @@ public void callStateChanged(CallChangeEvent evt)
             // no such call
             if (callRecord == null)
                 return;
+            if (!CallChangeEvent.CALL_STATE_CHANGE
+                    .equals(evt.getPropertyName()))
+                return;
 
             if (evt.getNewValue().equals(CallState.CALL_ENDED))
             {

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -136,6 +136,9 @@ public void run()
                                 });
                         return;
                     }
+                    if (!CallChangeEvent.CALL_STATE_CHANGE
+                            .equals(ev.getPropertyName()))
+                        return;
 
                     // When the call state changes, we ensure here that the
                     // received call notification dialog is closed.

File: src/net/java/sip/communicator/service/protocol/Call.java
Patch:
@@ -326,8 +326,7 @@ protected void fireCallChangeEvent( String type,
                         new CallChangeListener[callListeners.size()]);
         }
         for (CallChangeListener listener : listeners)
-            if(type.equals(CallChangeEvent.CALL_STATE_CHANGE))
-                listener.callStateChanged(event);
+            listener.callStateChanged(event);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/CallConference.java
Patch:
@@ -467,7 +467,9 @@ private void callStateChanged(CallChangeEvent ev)
             }
             finally
             {
-                if (CallState.CALL_ENDED.equals(ev.getNewValue()))
+                if (CallChangeEvent.CALL_STATE_CHANGE
+                        .equals(ev.getPropertyName())
+                    && CallState.CALL_ENDED.equals(ev.getNewValue()))
                 {
                     /*
                      * Should not be vital because Call will remove itself.

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetTelephonyConferencing.java
Patch:
@@ -1247,7 +1247,7 @@ protected ConferenceInfoDocument getConferenceInfoDiff(
 
         boolean needsPartial = false;
         boolean hasDifference = false;
-        if (from.getEntity() != to.getEntity()
+        if (!from.getEntity().equals(to.getEntity())
                 || from.getUserCount() != to.getUserCount())
         {
             hasDifference = true;

File: src/net/java/sip/communicator/plugin/update/UpdateServiceImpl.java
Patch:
@@ -96,7 +96,6 @@ private static Component createBrowser(String url)
         // Initialize the user interface.
         JEditorPane editorPane = new JEditorPane();
 
-        editorPane.setBorder(BorderFactory.createLoweredBevelBorder());
         editorPane.setContentType("text/html");
         editorPane.setEditable(false);
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -1272,9 +1272,7 @@ public void setMessage(String message)
     private boolean isGreyHistoryStyleDisabled(
         ProtocolProviderService protocolProvider)
     {
-        boolean isProtocolHidden =
-            protocolProvider.getAccountID().getAccountPropertyBoolean(
-                ProtocolProviderFactory.IS_PROTOCOL_HIDDEN, false);
+        boolean isProtocolHidden = protocolProvider.getAccountID().isHidden();
         boolean isGreyHistoryDisabled = false;
 
         String greyHistoryProperty

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetMessageWaitingSipImpl.java
Patch:
@@ -276,8 +276,8 @@ else if (evt.getNewState().equals(RegistrationState.UNREGISTERING))
     private Address getSubscribeAddress()
         throws ParseException
     {
-        String vmAddressURI = (String)provider.getAccountID()
-            .getAccountProperty(
+        String vmAddressURI = provider.getAccountID()
+            .getAccountPropertyString(
                     ProtocolProviderFactory.VOICEMAIL_URI);
 
         if(StringUtils.isNullOrEmpty(vmAddressURI))

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -283,9 +283,9 @@ public void register(SecurityAuthority authority)
          * Evaluate whether FORCE_PROXY_BYPASS is enabled for the account
          * before registering.
          */
-        forceLooseRouting = Boolean.valueOf((String)
-                getAccountID().getAccountProperty(
-                    ProtocolProviderFactory.FORCE_PROXY_BYPASS));
+        forceLooseRouting
+                = getAccountID().getAccountPropertyBoolean(
+                        ProtocolProviderFactory.FORCE_PROXY_BYPASS, false);
 
         sipStackSharing.addSipListener(this);
         // be warned when we will unregister, so that we can

File: src/net/java/sip/communicator/impl/protocol/sip/net/SslNetworkLayer.java
Patch:
@@ -232,8 +232,8 @@ private SSLSocketFactory getSSLSocketFactory(InetAddress address)
             }
 
             return certificateVerification.getSSLContext(
-                (String)id.getAccountProperty(
-                    ProtocolProviderFactory.CLIENT_TLS_CERTIFICATE),
+                    id.getAccountPropertyString(
+                        ProtocolProviderFactory.CLIENT_TLS_CERTIFICATE),
                 certificateVerification.getTrustManager(
                     identities,
                     null,

File: src/net/java/sip/communicator/plugin/zeroconfaccregwizz/FirstWizardPage.java
Patch:
@@ -334,9 +334,9 @@ public void loadAccount(ProtocolProviderService protocolProvider)
         this.lastField.setText(accountID.getAccountPropertyString("last"));
         this.mailField.setText(accountID.getAccountPropertyString("mail"));
 
-        Boolean remember =
-            (Boolean) accountID.getAccountProperty("rememberContacts");
-        if (remember.booleanValue())
+        boolean remember = accountID
+                .getAccountPropertyBoolean("rememberContacts", true);
+        if (remember)
             this.rememberContacts.setSelected(true);
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTelephonyConferencingJabberImpl.java
Patch:
@@ -428,7 +428,7 @@ private void handleCoin(CallPeerJabberImpl callPeer, CoinIQ coinIQ)
      * SID.
      */
     protected ConferenceInfoDocument getCurrentConferenceInfo(
-            MediaAwareCallPeer<?,?,?> callPeer)
+            MediaAwareCallPeer callPeer)
     {
         ConferenceInfoDocument confInfo
                 = super.getCurrentConferenceInfo(callPeer);

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetTelephonyConferencing.java
Patch:
@@ -1021,7 +1021,7 @@ public static String stripParametersFromAddress(String address)
      * state of the conference in which this <tt>CallPeer</tt> participates.
      */
     protected ConferenceInfoDocument getCurrentConferenceInfo(
-            MediaAwareCallPeer<?,?,?> callPeer)
+            MediaAwareCallPeer callPeer)
     {
         ConferenceInfoDocument confInfo;
         try

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -3692,7 +3692,8 @@ private static String resolveContactSource(String peerAddress)
                 (index > -1) ? peerAddress.substring(0, index) : peerAddress;
 
             // searches for the whole number/username or with the @serverpart
-            Pattern p = Pattern.compile(
+            peerUserID = Pattern.quote(peerUserID);
+            Pattern pattern = Pattern.compile(
                 "^(" + peerUserID + "|" + peerUserID + "@.*)$");
 
             // Queries all available resolvers
@@ -3706,7 +3707,7 @@ private static String resolveContactSource(String peerAddress)
                 // use the pattern method of (ExtendedContactSourceService)
                 ContactQuery query
                     = ((ExtendedContactSourceService)contactSourceService)
-                            .queryContactSource(p);
+                            .queryContactSource(pattern);
 
                 resolvers.add(
                         new ResolveAddressToDisplayNameContactQueryListener(

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatSession.java
Patch:
@@ -736,6 +736,7 @@ private void removeChatTransport(ChatTransport chatTransport)
             chatTransports.remove(chatTransport);
         }
         sessionRenderer.removeChatTransport(chatTransport);
+        chatTransport.dispose();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTelephonyConferencingJabberImpl.java
Patch:
@@ -389,8 +389,8 @@ public void processPacket(Packet packet)
             if (callPeer != null)
             {
                 if (logger.isDebugEnabled())
-                    logger.debug("Processing COIN from" + coinIQ.getFrom()
-                                    + "(version=" + coinIQ.getVersion() + ")");
+                    logger.debug("Processing COIN from " + coinIQ.getFrom()
+                                    + " (version=" + coinIQ.getVersion() + ")");
                 handleCoin(callPeer, coinIQ);
             }
         }

File: src/net/java/sip/communicator/util/ConferenceInfoDocument.java
Patch:
@@ -228,7 +228,7 @@ public ConferenceInfoDocument(String xml) throws Exception
             throw(e);
         }
 
-        conferenceInfo = document.getElementById(CONFERENCE_INFO_ELEMENT_NAME);
+        conferenceInfo = document.getDocumentElement();
         if (conferenceInfo == null)
         {
             throw(new Exception("Could not parse conference-info document,"

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTelephonyConferencingJabberImpl.java
Patch:
@@ -227,7 +227,7 @@ private IQ getConferenceInfo(CallPeerJabberImpl callPeer,
             @Override
             public String getChildElementXML()
             {
-                return confInfo.toString();
+                return confInfo.toXml();
             }
         };
 

File: src/net/java/sip/communicator/util/ConferenceInfoDocument.java
Patch:
@@ -188,7 +188,7 @@ public ConferenceInfoDocument()
         setUserCount(0);
 
         users = document.createElement(USERS_ELEMENT_NAME);
-        conferenceState.appendChild(users);
+        conferenceInfo.appendChild(users);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetTelephonyConferencing.java
Patch:
@@ -1326,7 +1326,7 @@ private boolean conferenceInfoDocumentsMatch(
             throw new IllegalArgumentException("The 'b' document needs to"
                     + "have state=full");
 
-        if (stringsMatch(a.getEntity(), b.getEntity()))
+        if (!stringsMatch(a.getEntity(), b.getEntity()))
             return false;
         else if (a.getUserCount() != b.getUserCount())
             return false;

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetTelephonyConferencing.java
Patch:
@@ -1030,7 +1030,7 @@ protected ConferenceInfoDocument getCurrentConferenceInfo(CallPeer callPeer)
         for (CallPeer conferenceCallPeer : conferenceCallPeers)
             addPeerToConferenceInfo(confInfo, conferenceCallPeer, true);
 
-        return null;
+        return confInfo;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/menus/ToolsMenu.java
Patch:
@@ -195,6 +195,9 @@ public void actionPerformed(ActionEvent e)
         JMenuItem menuItem = (JMenuItem) e.getSource();
         String itemName = menuItem.getName();
 
+        if (itemName == null)
+            return;
+
         if (itemName.equalsIgnoreCase("config"))
         {
             configActionPerformed();

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -1196,7 +1196,7 @@ protected void stop(ServiceRegistration registeredAccount)
      *
      * @return <tt>AccountManager</tt> of the protocol
      */
-    protected AccountManager getAccountManager()
+    private AccountManager getAccountManager()
     {
         BundleContext bundleContext = getBundleContext();
         ServiceReference serviceReference =

File: test/net/java/sip/communicator/slick/popupmessagehandler/PopupMessageHandlerSLick.java
Patch:
@@ -6,6 +6,7 @@
  */
 package net.java.sip.communicator.slick.popupmessagehandler;
 
+import java.awt.*;
 import java.util.*;
 
 import junit.framework.*;

File: src/net/java/sip/communicator/service/protocol/jabber/JabberAccountID.java
Patch:
@@ -680,7 +680,7 @@ public static String getDefaultStr(String key)
      */
     public static boolean getDefaultBool(String key)
     {
-        return Boolean.getBoolean(getDefaultStr(key));
+        return Boolean.parseBoolean(getDefaultStr(key));
     }
 
 

File: src/net/java/sip/communicator/impl/gui/main/account/NewAccountDialog.java
Patch:
@@ -631,6 +631,7 @@ else if (e.getErrorCode()
             }
             catch (Exception e)
             {
+                logger.error("Error creating account: "+e.getMessage(), e);
                 // make sure buttons don't stay disabled
                 SwingUtilities.invokeLater(new Runnable()
                 {

File: src/net/java/sip/communicator/impl/osdependent/PopupMessageHandlerTrayIconImpl.java
Patch:
@@ -56,7 +56,7 @@ public void showPopupMessage(PopupMessage popupMessage)
         trayIcon.displayMessage(
                 messageTitle,
                 messageContent,
-                TrayIcon.NONE_MESSAGE_TYPE);
+                java.awt.TrayIcon.MessageType.NONE);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -1191,7 +1191,7 @@ protected void stop(ServiceRegistration registeredAccount)
      *
      * @return <tt>AccountManager</tt> of the protocol
      */
-    private AccountManager getAccountManager()
+    protected AccountManager getAccountManager()
     {
         BundleContext bundleContext = getBundleContext();
         ServiceReference serviceReference =

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetTelephonyConferencing.java
Patch:
@@ -506,7 +506,7 @@ protected MediaDirection getRemoteDirection(
         }
         else
             remoteDirection = null;
-        return null;
+        return remoteDirection;
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/globalstatus/GlobalStatusEnum.java
Patch:
@@ -34,12 +34,12 @@ public class GlobalStatusEnum
     /**
      * Indicates that the user is connected and eager to communicate.
      */
-    public static final String FREE_FOR_CHAT_STATUS = "FreeForChat";
+    public static final String FREE_FOR_CHAT_STATUS = "Free For Chat";
 
     /**
      * Indicates that the user is connected and eager to communicate.
      */
-    public static final String DO_NOT_DISTURB_STATUS = "DoNotDisturb";
+    public static final String DO_NOT_DISTURB_STATUS = "Do Not Disturb";
 
     /**
      * The Online status. Indicate that the user is able and willing to

File: src/net/java/sip/communicator/plugin/addrbook/msoutlook/MsOutlookAddrBookContactQuery.java
Patch:
@@ -827,16 +827,17 @@ private boolean onMailUser(String id)
         }
         catch(MsOutlookMAPIHResultException ex)
         {
-            if(ex.getHResult() == 0x80070057 // E_INVALIDARG
+            if(ex.getHresultString().equals("MAPI_E_0x57")
                     && firstIMAPIPropGetPropFailureLogged == false)
             {
                 firstIMAPIPropGetPropFailureLogged = true;
                 throw ex;
             }
-            else if(ex.getHResult() != 0x80070057) // NOT E_INVALIDARG
+            else if(!ex.getHresultString().equals("MAPI_E_0x57"))
             {
                 throw ex;
             }
+            return true;
         }
 
         long objType = 0;

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsSourceService.java
Patch:
@@ -352,7 +352,7 @@ public ContactQuery queryContactSource(String query, int contactCount)
         {
             pattern = Pattern.compile(query);
         }
-        catch(PatternSyntaxException pse)
+        catch (PatternSyntaxException pse)
         {
             pattern = Pattern.compile(
                     Pattern.quote(query));

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -161,7 +161,7 @@ public Iterator<Map.Entry<String,String>> getSummary()
 
         summaryTable.put(
             Resources.getString("service.gui.REMEMBER_PASSWORD"),
-            Boolean.toString(registration.getPassword() != null));
+            Boolean.toString(registration.isRememberPassword()));
 
         summaryTable.put(
             Resources.getString("plugin.jabberaccregwizz.SERVER"),

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -153,7 +153,7 @@ public Iterator<Map.Entry<String, String>> getSummary()
         LinkedHashMap<String, String> summaryTable
             = new LinkedHashMap<String, String>();
 
-        boolean rememberPswd = registration.getPassword() != null;
+        boolean rememberPswd = registration.isRememberPassword();
         String rememberPswdString = Resources.getString(
                 rememberPswd ? "service.gui.YES" : "service.gui.NO");
         String displayName = registration.getAccountDisplayName();

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceParticipantPanel.java
Patch:
@@ -14,7 +14,6 @@
 import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
-import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.service.resources.*;
 import net.java.sip.communicator.util.skin.*;

File: src/net/java/sip/communicator/launcher/BrowserLauncher.java
Patch:
@@ -51,7 +51,6 @@ public LaunchBrowser(String url)
          * FileProtocolHandler to do so, on Linux, loops through a list of
          * known browsers until we find one that seems to work.
          */
-        @Override
         public void run()
         {
             try

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryQueryImpl.java
Patch:
@@ -15,7 +15,7 @@
 import net.java.sip.communicator.service.history.records.*;
 
 /**
- * 
+ *
  * @author Yana Stamcheva
  */
 public class CallHistoryQueryImpl

File: src/net/java/sip/communicator/impl/contactlist/ContactlistActivator.java
Patch:
@@ -75,7 +75,7 @@ public void stop(BundleContext context) throws Exception
 
     /**
      * Returns the <tt>FileAccessService</tt> obtained from the bundle context.
-     * 
+     *
      * @return the <tt>FileAccessService</tt> obtained from the bundle context
      */
     public static FileAccessService getFileAccessService()

File: src/net/java/sip/communicator/impl/contactlist/MclStorageManager.java
Patch:
@@ -443,6 +443,7 @@ private void launchStorageThread()
     {
         new Thread()
         {
+            @Override
             public void run()
             {
                 try
@@ -2049,6 +2050,7 @@ static class StoredProtoContactDescriptor
          *
          * @return a string representation of the descriptor.
          */
+        @Override
         public String toString()
         {
 

File: src/net/java/sip/communicator/impl/contactlist/MetaContactImpl.java
Patch:
@@ -491,6 +491,7 @@ public int compareTo(MetaContact o)
      *
      * @return  a string representation of this contact.
      */
+    @Override
     public String toString()
     {
         StringBuffer buff = new StringBuffer("MetaContact[ DisplayName=")

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -1178,7 +1178,7 @@ public void removeContact(Contact contact) throws MetaContactListException
         if (opSetPresence == null)
         {
             opSetPresence =
-                (OperationSetPresence) contact.getProtocolProvider()
+                contact.getProtocolProvider()
                     .getOperationSet(OperationSetPersistentPresence.class);
 
             if (opSetPresence == null)
@@ -1586,7 +1586,7 @@ public Iterator<MetaContact> findAllMetaContactsForProvider(
     /**
      * Returns a list of all <tt>MetaContact</tt>s containing a protocol contact
      * corresponding to the given <tt>contactAddress</tt> string.
-     * 
+     *
      * @param contactAddress the contact address for which we're looking for
      * a parent <tt>MetaContact</tt>.
      * @return a list of all <tt>MetaContact</tt>s containing a protocol contact
@@ -1605,7 +1605,7 @@ public Iterator<MetaContact> findAllMetaContactsForAddress(
     /**
      * Returns a list of all <tt>MetaContact</tt>s containing a protocol contact
      * corresponding to the given <tt>contactAddress</tt> string.
-     * 
+     *
      * @param contactAddress the contact address for which we're looking for
      * a parent <tt>MetaContact</tt>.
      * @param metaContactGroup the parent group.

File: src/net/java/sip/communicator/impl/credentialsstorage/CredentialsStorageActivator.java
Patch:
@@ -38,7 +38,7 @@ public class CredentialsStorageActivator
 
     /**
      * Starts the credentials storage service
-     * 
+     *
      * @param bundleContext the <tt>BundleContext</tt> as provided from the OSGi
      * framework
      * @throws Exception if anything goes wrong
@@ -50,7 +50,7 @@ public void start(BundleContext bundleContext) throws Exception
             logger.debug(
                     "Service Impl: " + getClass().getName() + " [  STARTED ]");
         }
-        
+
         CredentialsStorageActivator.bundleContext = bundleContext;
 
         impl = new CredentialsStorageServiceImpl();
@@ -68,7 +68,7 @@ public void start(BundleContext bundleContext) throws Exception
 
     /**
      * Unregisters the credentials storage service.
-     * 
+     *
      * @param bundleContext BundleContext
      * @throws Exception if anything goes wrong
      */

File: src/net/java/sip/communicator/impl/credentialsstorage/Crypto.java
Patch:
@@ -17,7 +17,7 @@ public interface Crypto
 {
     /**
      * Decrypts the cipher text and returns the result.
-     * 
+     *
      * @param ciphertext base64 encoded encrypted data
      * @return decrypted data
      * @throws CryptoException when the ciphertext cannot be decrypted with the
@@ -27,7 +27,7 @@ public interface Crypto
 
     /**
      * Encrypts the plain text and returns the result.
-     * 
+     *
      * @param plaintext data to be encrypted
      * @return base64 encoded encrypted data
      * @throws CryptoException on encryption error

File: src/net/java/sip/communicator/impl/dns/ConfigurableDnssecResolver.java
Patch:
@@ -352,6 +352,7 @@ private String createPropNameUnsigned(String fqdn, String type)
     /**
      * Reloads the configuration of forwarders and trust anchors.
      */
+    @Override
     public void reset()
     {
         String forwarders = DnsUtilActivator.getConfigurationService()

File: src/net/java/sip/communicator/impl/dns/ParallelResolverImpl.java
Patch:
@@ -501,6 +501,7 @@ public void sendFirstQuery()
         /**
          * Sends this collector's query to the default resolver.
          */
+        @Override
         public void run()
         {
             Message localResponse = null;
@@ -543,6 +544,7 @@ public void sendBackupQueries()
             //and i do want to keep code simple to read ... this whole parallel
             //resolving is complicated enough as it is.
             new Thread(){
+                @Override
                 public void run()
                 {
                     synchronized(ParallelResolution.this)

File: src/net/java/sip/communicator/impl/dns/SecureResolveMode.java
Patch:
@@ -8,7 +8,7 @@
 
 /**
  * Defines how DNSSEC validation errors should be handled.
- * 
+ *
  * @author Ingo Bauersachs
  */
 public enum SecureResolveMode

File: src/net/java/sip/communicator/impl/globaldisplaydetails/GlobalDisplayDetailsActivator.java
Patch:
@@ -15,7 +15,7 @@
 import org.osgi.framework.*;
 
 /**
- * 
+ *
  * @author Yana Stamcheva
  */
 public class GlobalDisplayDetailsActivator

File: src/net/java/sip/communicator/impl/globalshortcut/UIShortcut.java
Patch:
@@ -94,6 +94,7 @@ private void setVisible(final ExportedWindow window, final boolean visible)
     {
         new Thread()
         {
+            @Override
             public void run()
             {
                 if(!visible)

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsServiceImpl.java
Patch:
@@ -78,6 +78,7 @@ public GoogleContactsServiceImpl()
     {
         new Thread()
         {
+            @Override
             public void run()
             {
                 loadConfig();

File: src/net/java/sip/communicator/impl/googlecontacts/configform/AccountSettingsForm.java
Patch:
@@ -290,6 +290,7 @@ public GoogleContactsConnection getConnection()
      * @param escaped <tt>true</tt> if this dialog has been closed by pressing
      * the Esc key; otherwise, <tt>false</tt>
      */
+    @Override
     protected void close(boolean escaped)
     {
         cancelBtn.doClick();

File: src/net/java/sip/communicator/impl/googlecontacts/configform/GoogleContactsConfigForm.java
Patch:
@@ -340,6 +340,7 @@ public static class RefreshContactSourceThread
         /**
          * Thread entry point.
          */
+        @Override
         public void run()
         {
             if(oldCnx != null)

File: src/net/java/sip/communicator/impl/gui/GuiActivator.java
Patch:
@@ -101,7 +101,7 @@ public class GuiActivator implements BundleActivator
     private static DemuxContactSourceService demuxContactSourceService;
 
     private static GlobalDisplayDetailsService globalDisplayDetailsService;
-    
+
     private static AlertUIService alertUIService;
 
     private static final Map<Object, ProtocolProviderFactory>
@@ -142,7 +142,7 @@ public void start(BundleContext bContext)
             bundleContext.registerService(GlobalStatusService.class.getName(),
                                           new GlobalStatusServiceImpl(),
                                           null);
-            
+
             alertUIService = new AlertUIServiceImpl();
             // Registers an implementation of the AlertUIService.
             bundleContext.registerService(  AlertUIService.class.getName(),
@@ -415,7 +415,7 @@ public static UIServiceImpl getUIService()
     {
         return uiService;
     }
-    
+
     /**
      * Returns the implementation of the <tt>AlertUIService</tt>.
      * @return the implementation of the <tt>AlertUIService</tt>

File: src/net/java/sip/communicator/impl/gui/customcontrols/BooleanToCheckTableModel.java
Patch:
@@ -23,10 +23,12 @@ public class BooleanToCheckTableModel extends DefaultTableModel {
      * then the first column in the wizard would contain text
      * ("true"/"false"), rather than a check box.
      */
+    @Override
     public Class<?> getColumnClass(int c) {
         return getValueAt(0, c).getClass();
     }
 
+    @Override
     public boolean isCellEditable(int row, int col)
     {
         return (col < 1);

File: src/net/java/sip/communicator/impl/gui/customcontrols/ExtendedTableModel.java
Patch:
@@ -41,6 +41,7 @@ public int rowIndexOf(Object value)
     }
 
 
+    @Override
     public boolean isCellEditable(int row, int col)
     {
         return false;

File: src/net/java/sip/communicator/impl/gui/customcontrols/MessageDialog.java
Patch:
@@ -314,6 +314,7 @@ public void actionPerformed(ActionEvent e)
      * @param isEscaped indicates if the window was close by pressing the escape
      * button
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         this.cancelButton.doClick();

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommToolBar.java
Patch:
@@ -55,6 +55,7 @@ public SIPCommToolBar() {
      * Adds a separator to this toolbar. The separator is added after
      * the last component in the toolbar.
      */
+    @Override
     public void addSeparator()
     {
         JToolBar.Separator s = new JToolBar.Separator(new Dimension(8, 22));
@@ -72,6 +73,7 @@ public void addSeparator()
      * Overrides the <code>paintBorder</code> method of <tt>JToolBar</tt>
      * to paint the drag icon in the beginning of the toolbar.
      */
+    @Override
     protected void paintBorder(Graphics g) {
 
         Graphics2D g2 = (Graphics2D) g;
@@ -90,6 +92,7 @@ protected void paintBorder(Graphics g) {
      * @see JComponent#getUIClassID
      * @see UIDefaults#getUI
      */
+    @Override
     public String getUIClassID()
     {
         return uiClassID;

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardController.java
Patch:
@@ -20,7 +20,7 @@
  * of the three buttons, 'Next', 'Previous', and 'Cancel.' Based on what
  * button is pressed, the controller will update the model to show a new panel
  * and reset the state of the buttons as necessary.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class WizardController implements ActionListener

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardListener.java
Patch:
@@ -11,7 +11,7 @@
 /**
  * Listens for <tt>WizardEvent</tt>s triggered when a wizard is closed and
  * finished.
- * 
+ *
  * @author Yana Stamcheva
  */
 public interface WizardListener extends EventListener

File: src/net/java/sip/communicator/impl/gui/event/PluginComponentEvent.java
Patch:
@@ -59,7 +59,7 @@ public PluginComponentEvent(
     /**
      * Returns the ID of this event which is one of
      * {@link #PLUGIN_COMPONENT_ADDED} and {@link #PLUGIN_COMPONENT_REMOVED}.
-     * 
+     *
      * @return the ID of this event which is one of the
      * <tt>PLUGIN_COMPONENT_XXX</tt> constants defined by the
      * <tt>PluginComponentEvent</tt> class

File: src/net/java/sip/communicator/impl/gui/event/PluginComponentListener.java
Patch:
@@ -10,10 +10,10 @@
 
 /**
  * Listens for all events caused by adding or removing of a plugin component.
- * 
+ *
  * @author Yana Stamcheva
  */
-public interface PluginComponentListener 
+public interface PluginComponentListener
     extends EventListener
 {
     /**

File: src/net/java/sip/communicator/impl/gui/lookandfeel/ExtendedTreeUI.java
Patch:
@@ -28,6 +28,7 @@ public class ExtendedTreeUI
      * @param path the <tt>TreePath</tt> to select
      * @param event the <tt>MouseEvent</tt> that provoked the select
      */
+    @Override
     protected void selectPathForEvent(TreePath path, MouseEvent event)
     {
         Object lastComponent = path.getLastPathComponent();

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommChatSelectorMenuUI.java
Patch:
@@ -19,7 +19,7 @@
 
 /**
  * The SIPCommChatSelectorMenuUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */
@@ -43,12 +43,13 @@ public static ComponentUI createUI(JComponent x)
 
     /**
      * Draws the background of the menu item.
-     * 
+     *
      * @param g the paint graphics
      * @param menuItem menu item to be painted
      * @param bgColor selection background color
      * @since 1.4
      */
+    @Override
     protected void paintBackground( Graphics g,
                                     JMenuItem menuItem,
                                     Color bgColor)

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommCheckBoxUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * SIPCommCheckBoxUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommCheckBoxUI extends MetalCheckBoxUI
@@ -29,6 +29,7 @@ public static ComponentUI createUI(JComponent x)
         return new SIPCommCheckBoxUI();
     }
 
+    @Override
     public void paint(Graphics g, JComponent c)
     {
         AntialiasingManager.activateAntialiasing(g);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommEditorPaneUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * The SIPCommEditorPaneUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommEditorPaneUI extends BasicEditorPaneUI {
@@ -29,6 +29,7 @@ public static ComponentUI createUI(JComponent x)
         return new SIPCommEditorPaneUI();
     }
 
+    @Override
     public void paintSafely(Graphics g)
     {
         AntialiasingManager.activateAntialiasing(g);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommLFUtils.java
Patch:
@@ -12,7 +12,7 @@
 import net.java.sip.communicator.plugin.desktoputil.*;
 
 /**
- * The <tt>SIPCommLFUtils</tt> is an utility class helping in drawing some 
+ * The <tt>SIPCommLFUtils</tt> is an utility class helping in drawing some
  *
  * @author Yana Stamcheva
  */
@@ -44,7 +44,7 @@ static void drawRoundBorder(Graphics g, int x, int y, int w,
             g2.dispose();
         }
     }
-   
+
    /**
      * Draws the "Round Disabled Border" which is used throughout the SIPComm
      * L&F.

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommLabelUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * The SIPCommLabelUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommLabelUI extends MetalLabelUI {
@@ -29,6 +29,7 @@ public static ComponentUI createUI(JComponent x)
         return new SIPCommLabelUI();
     }
 
+    @Override
     public void paint(Graphics g, JComponent c)
     {
         AntialiasingManager.activateAntialiasing(g);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommListUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * <tt>SIPCommListUI</tt> is an implementation of the <tt>BasicListUI</tt>.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommListUI extends BasicListUI {
@@ -29,6 +29,7 @@ public static ComponentUI createUI(JComponent x)
         return new SIPCommListUI();
     }
 
+    @Override
     public void paint(Graphics g, JComponent c)
     {
         AntialiasingManager.activateAntialiasing(g);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommMenuItemUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * The SIPCommMenuItemUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommMenuItemUI
@@ -58,6 +58,7 @@ private void internalPaintRollover(Graphics g, JMenuItem menuItem)
         }
     }
 
+    @Override
     protected void paintMenuItem (Graphics g, JComponent c, Icon
         checkIcon, Icon arrowIcon, Color background,
         Color foreground, int defaultTextIconGap)
@@ -67,6 +68,7 @@ protected void paintMenuItem (Graphics g, JComponent c, Icon
         this.internalPaintRollover(g, menuItem);
     }
 
+    @Override
     protected void paintText (Graphics g, JMenuItem menuItem, Rectangle
         textRect, String text)
     {

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommOpaquePanelUI.java
Patch:
@@ -23,6 +23,7 @@ public static ComponentUI createUI(JComponent c)
         return new SIPCommOpaquePanelUI();
     }
 
+    @Override
     public void paint(Graphics g, JComponent c)
     {
         super.paint(g, c);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommOptionPaneUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * The SIPCommOptionPaneUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommOptionPaneUI extends BasicOptionPaneUI {
@@ -29,7 +29,8 @@ public static ComponentUI createUI(JComponent x)
        return new SIPCommOptionPaneUI();
    }
 
-   public void paint(Graphics g, JComponent c)
+   @Override
+public void paint(Graphics g, JComponent c)
    {
        AntialiasingManager.activateAntialiasing(g);
        super.paint(g, c);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommPasswordFieldUI.java
Patch:
@@ -17,7 +17,7 @@
 
 /**
  * The SIPCommPasswordFieldUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommPasswordFieldUI extends BasicPasswordFieldUI {
@@ -27,12 +27,14 @@ public static ComponentUI createUI(JComponent c)
         return new SIPCommPasswordFieldUI();
     }
 
+    @Override
     protected void paintSafely(Graphics g)
     {
         AntialiasingManager.activateAntialiasing(g);
         super.paintSafely(g);
     }
 
+    @Override
     protected void paintBackground(Graphics g)
     {
         JTextComponent c = this.getComponent();

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommPopupMenuUI.java
Patch:
@@ -12,7 +12,7 @@
 
 /**
  *  SIPCommPopupMenuUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommPopupMenuUI extends BasicPopupMenuUI

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommSpinnerUI.java
Patch:
@@ -19,13 +19,15 @@ public static ComponentUI createUI(JComponent c) {
         return new SIPCommSpinnerUI();
     }
 
+    @Override
     protected Component createNextButton()
     {
         Component c = createArrowButton(SwingConstants.NORTH);
             installNextButtonListeners(c);
             return c;
     }
 
+    @Override
     protected Component createPreviousButton()
     {
         Component c = createArrowButton(SwingConstants.SOUTH);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommTextAreaUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * SIPCommTextAreaUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommTextAreaUI
@@ -27,7 +27,8 @@ public static ComponentUI createUI(JComponent c)
         c.setOpaque(false);
         return new SIPCommTextAreaUI();
     }
-    
+
+    @Override
     protected void paintSafely(Graphics g)
     {
         AntialiasingManager.activateAntialiasing(g);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommTextPaneUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * SIPCommTextPaneUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommTextPaneUI
@@ -27,6 +27,7 @@ public static ComponentUI createUI(JComponent c)
         return new SIPCommTextPaneUI();
     }
 
+    @Override
     protected void paintSafely(Graphics g)
     {
         AntialiasingManager.activateAntialiasing(g);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommToolBarUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * SIPCommToolBarUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommToolBarUI
@@ -30,6 +30,7 @@ public static ComponentUI createUI(JComponent x)
         return new SIPCommToolBarUI();
     }
 
+    @Override
     public void paint(Graphics g, JComponent c)
     {
         AntialiasingManager.activateAntialiasing(g);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommToolTipUI.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * SIPCommToolTipUI implementation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class SIPCommToolTipUI
@@ -28,6 +28,7 @@ public static ComponentUI createUI(JComponent c)
         return new SIPCommToolTipUI();
     }
 
+    @Override
     public void paint(Graphics g, JComponent c)
     {
         AntialiasingManager.activateAntialiasing(g);

File: src/net/java/sip/communicator/impl/gui/main/GeneralDialPadDialog.java
Patch:
@@ -396,6 +396,7 @@ public void loadSkin()
          * @see JComponent#getUIClassID
          * @see UIDefaults#getUI
          */
+        @Override
         public String getUIClassID()
         {
             return uiClassID;

File: src/net/java/sip/communicator/impl/gui/main/UINotificationGroup.java
Patch:
@@ -32,7 +32,7 @@ public class UINotificationGroup
     private final String groupDisplayName;
 
     /**
-     * 
+     *
      * @param groupName the name of the group to which this notification belongs
      * @param groupDisplayName the display name of the group to which this
      */

File: src/net/java/sip/communicator/impl/gui/main/account/Account.java
Patch:
@@ -186,7 +186,7 @@ public boolean isEnabled()
 
     /**
      * Returns the current presence status of the given protocol provider.
-     * 
+     *
      * @param protocolProvider the protocol provider which status we're looking
      * for.
      * @return the current presence status of the given protocol provider.
@@ -299,6 +299,7 @@ public JCheckBox getEnableCheckBox()
      *
      * @return the string representation of this account
      */
+    @Override
     public String toString()
     {
         return protocolProvider.getAccountID().getDisplayName();

File: src/net/java/sip/communicator/impl/gui/main/account/AccountList.java
Patch:
@@ -506,6 +506,7 @@ protected Object construct()
          * Called on the event dispatching thread (not on the worker thread)
          * after the <code>construct</code> method has returned.
          */
+        @Override
         protected void finished()
         {
             AccountList.this.repaint();

File: src/net/java/sip/communicator/impl/gui/main/account/AccountListCellRenderer.java
Patch:
@@ -14,9 +14,9 @@
 import net.java.sip.communicator.plugin.desktoputil.*;
 
 /**
- * The <tt>AccountListCellRenderer</tt> is the cell renderer used from the 
+ * The <tt>AccountListCellRenderer</tt> is the cell renderer used from the
  * {@link AccountList}.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class AccountListCellRenderer
@@ -155,6 +155,7 @@ public Component getListCellRendererComponent(JList list, Object value,
      * when a cell is selected.
      * @param g the <tt>Graphics</tt> object
      */
+    @Override
     public void paintComponent(Graphics g)
     {
         super.paintComponent(g);

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -325,6 +325,7 @@ public void serviceChanged(ServiceEvent event)
     /**
      * Implements the <tt>SIPCommDialog</tt> close method.
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         summaryPage.dispose();

File: src/net/java/sip/communicator/impl/gui/main/account/EmptyAccountRegistrationForm.java
Patch:
@@ -128,7 +128,7 @@ public Component getSimpleForm()
 
     /**
      * Returns the advanced registration form.
-     * 
+     *
      * @return the advanced registration form
      */
     public Component getAdvancedForm()

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationRequestedDialog.java
Patch:
@@ -111,7 +111,7 @@ public AuthorizationRequestedDialog(MainFrame mainFrame,
 
         infoTextArea.setText(
             GuiActivator.getResources().getI18NString(
-                "service.gui.AUTHORIZATION_REQUESTED_INFO", 
+                "service.gui.AUTHORIZATION_REQUESTED_INFO",
                 new String[]{contact.getDisplayName()}));
 
         this.infoTextArea.setFont(infoTextArea.getFont().deriveFont(Font.BOLD));
@@ -280,6 +280,7 @@ else if (name.equals("ignore"))
      * @param isEscaped indicates if the window was closed by pressing the Esc
      * key
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         this.ignoreButton.doClick();

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationResponseDialog.java
Patch:
@@ -168,6 +168,7 @@ public void actionPerformed(ActionEvent e)
      * @param isEscaped indicates if the window was closed by pressing the Esc
      * key
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         this.dispose();

File: src/net/java/sip/communicator/impl/gui/main/authorization/RequestAuthorizationDialog.java
Patch:
@@ -21,7 +21,7 @@
 /**
  * The <tt>RequestAuthorisationDialog</tt> is a <tt>JDialog</tt> that is
  * shown when user is trying to add a contact, which requires authorization.
- * 
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */
@@ -101,7 +101,7 @@ public RequestAuthorizationDialog(  MainFrame mainFrame,
         this.mainPanel.setPreferredSize(new Dimension(400, 230));
 
         infoTextArea.setText(GuiActivator.getResources().getI18NString(
-            "service.gui.REQUEST_AUTHORIZATION_MSG", 
+            "service.gui.REQUEST_AUTHORIZATION_MSG",
             new String[]{contact.getDisplayName()}));
 
         this.infoTextArea.setFont(Constants.FONT.deriveFont(Font.BOLD, 12f));
@@ -221,6 +221,7 @@ public String getRequestReason()
      * @param isEscaped indicates if the window was closed by pressing the Esc
      * key
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         this.cancelButton.doClick();

File: src/net/java/sip/communicator/impl/gui/main/call/CallButton.java
Patch:
@@ -18,7 +18,7 @@
 import net.java.sip.communicator.util.skin.*;
 
 /**
- * 
+ *
  * @author Yana Stamcheva
  */
 public class CallButton

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -34,7 +34,7 @@ public class CallDialog
      * Finds a <tt>Container</tt> which is an ancestor of a specific
      * <tt>Component</tt>, has a set <tt>preferredSize</tt> and is closest to
      * the specified <tt>Component</tt> up the ancestor hierarchy.
-     * 
+     *
      * @param component the <tt>Component</tt> whose ancestor hierarchy is to be
      * searched upwards
      * @return a <tt>Container</tt>, if any, which is an ancestor of the
@@ -201,6 +201,7 @@ public void actionPerformed(ActionEvent ev)
      * <tt>CallDialog</tt> prepares the <tt>CallPanel</tt> it contains for
      * garbage collection.
      */
+    @Override
     public void dispose()
     {
         super.dispose();
@@ -454,6 +455,7 @@ public JFrame getFrame()
      * needed.
      * @return minimum size.
      */
+    @Override
     public Dimension getMinimumSize()
     {
         Dimension minSize = super.getMinimumSize();

File: src/net/java/sip/communicator/impl/gui/main/call/CallHistoryButton.java
Patch:
@@ -58,7 +58,7 @@ public class CallHistoryButton
     private boolean isNotificationsView = false;
 
     /**
-     * The tool tip shown by default over the history button. 
+     * The tool tip shown by default over the history button.
      */
     private final static String callHistoryToolTip
         = GuiActivator.getResources().getI18NString(

File: src/net/java/sip/communicator/impl/gui/main/call/CallStatusPanel.java
Patch:
@@ -36,6 +36,7 @@ public CallStatusPanel(LayoutManager layout)
      * Custom paint for the call status panel.
      * @param g the <tt>Graphics</tt> object
      */
+    @Override
     public void paintComponent(Graphics g)
     {
         super.paintComponent(g);

File: src/net/java/sip/communicator/impl/gui/main/call/CallTitlePanel.java
Patch:
@@ -14,7 +14,7 @@
  * The panel, containing the title name of the call peer or member. It defines
  * its background color depending on the specified in initialization background
  * color.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class CallTitlePanel
@@ -39,6 +39,7 @@ public CallTitlePanel(LayoutManager layout)
      * Sets the background color of this panel.
      * @param bgColor the background color of this panel
      */
+    @Override
     public void setBackground(Color bgColor)
     {
         this.backgroundColor = bgColor;
@@ -49,6 +50,7 @@ public void setBackground(Color bgColor)
      * the background color previously set.
      * @param g the <tt>Graphics</tt> object to use for painting
      */
+    @Override
     public void paintComponent(Graphics g)
     {
         super.paintComponent(g);

File: src/net/java/sip/communicator/impl/gui/main/call/CallToolBar.java
Patch:
@@ -74,7 +74,7 @@ public CallToolBar(boolean fullScreen, boolean incomingCall)
         setBorder(
                 BorderFactory.createEmptyBorder(
                         TOOL_BAR_BORDER,
-                        TOOL_BAR_BORDER, 
+                        TOOL_BAR_BORDER,
                         TOOL_BAR_BORDER,
                         TOOL_BAR_BORDER));
         setLayout(new FlowLayout(FlowLayout.CENTER, TOOL_BAR_X_GAP, 0));
@@ -83,7 +83,7 @@ public CallToolBar(boolean fullScreen, boolean incomingCall)
     /**
      * Determines whether this <tt>CallToolBar</tt> is displayed in full-screen
      * or windowed mode.
-     * 
+     *
      * @return <tt>true</tt> if this <tt>CallToolBar</tt> is displayed in
      * full-screen mode or <tt>false</tt> for windowed mode
      */

File: src/net/java/sip/communicator/impl/gui/main/call/CallTransferHandler.java
Patch:
@@ -93,6 +93,7 @@ public CallTransferHandler(CallConference callConference)
      * otherwise
      * @throws NullPointerException if <code>support</code> is {@code null}
      */
+    @Override
     public boolean canImport(JComponent comp, DataFlavor[] flavor)
     {
         for (DataFlavor f : flavor)
@@ -116,6 +117,7 @@ public boolean canImport(JComponent comp, DataFlavor[] flavor)
      * @return  true if the data was inserted into the component and false
      * otherwise
      */
+    @Override
     public boolean importData(JComponent comp, Transferable t)
     {
         String callee = null;

File: src/net/java/sip/communicator/impl/gui/main/call/ChooseCallAccountDialog.java
Patch:
@@ -66,6 +66,7 @@ public ChooseCallAccountDialog(
         {
             private static final long serialVersionUID = 0L;
 
+            @Override
             public Component getListCellRendererComponent(
                 JList jlist, Object obj, int i,
                 boolean flag, boolean flag1)
@@ -117,6 +118,7 @@ public void callButtonPressed()
     /**
      * Indicates that the conference call button has been pressed.
      */
+    @Override
     public void mergeCallButtonPressed()
     {
     }

File: src/net/java/sip/communicator/impl/gui/main/call/CloseLocalVisualComponentButton.java
Patch:
@@ -66,6 +66,7 @@ public CloseLocalVisualComponentButton(UIVideoHandler2 uiVideoHandler)
         addMouseListener(this);
     }
 
+    @Override
     public void paint(Graphics g)
     {
         g.setColor(Color.GRAY);

File: src/net/java/sip/communicator/impl/gui/main/call/DesktopSharingButton.java
Patch:
@@ -90,6 +90,7 @@ else if(!ConfigurationUtils.hasEnabledVideoFormat(
     /**
      * Shares the desktop with the peers in the current call.
      */
+    @Override
     public void buttonPressed()
     {
         if (call != null)

File: src/net/java/sip/communicator/impl/gui/main/call/DialPanel.java
Patch:
@@ -134,6 +134,7 @@ public void mouseReleased(MouseEvent e)
      *
      * @param g the <tt>Graphics</tt> object used for painting
      */
+    @Override
     public void paintComponent(Graphics g)
     {
         // do the superclass behavior first

File: src/net/java/sip/communicator/impl/gui/main/call/DialpadDialog.java
Patch:
@@ -88,6 +88,7 @@ private static class BackgroundPanel extends JPanel
          *
          * @param g a reference to the currently valid <tt>Graphics</tt> object
          */
+        @Override
         public void paintComponent(Graphics g)
         {
             super.paintComponent(g);

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -70,6 +70,7 @@ public HoldButton(Call call, boolean selected)
     /**
      * Holds on or off the associated <tt>Call</tt> when this button is clicked.
      */
+    @Override
     public void buttonPressed()
     {
         if (call != null)

File: src/net/java/sip/communicator/impl/gui/main/call/InputVolumeControlButton.java
Patch:
@@ -129,11 +129,13 @@ public InputVolumeControlButton(Call call,
         addMouseListener(new MouseAdapter()
         {
             TimerTask timerTask;
+            @Override
             public void mousePressed(MouseEvent mouseevent)
             {
                 Timer timer = new Timer();
                 timerTask = new TimerTask()
                 {
+                    @Override
                     public void run()
                     {
                         showSliderMenu();
@@ -143,6 +145,7 @@ public void run()
                 timer.schedule(timerTask, 1000);
             }
 
+            @Override
             public void mouseReleased(MouseEvent mouseevent)
             {
                 if (!sliderMenuIsVisible)

File: src/net/java/sip/communicator/impl/gui/main/call/LocalVideoButton.java
Patch:
@@ -73,6 +73,7 @@ public LocalVideoButton(Call call, boolean selected)
     /**
      * Enables or disables local video when the button is toggled/untoggled.
      */
+    @Override
     public void buttonPressed()
     {
         /*

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPanel.java
Patch:
@@ -257,7 +257,7 @@ private JComponent createTopComponent()
              * Set the background color of the center panel. However, that color
              * depends on whether this view is displayed on full-screen or
              * windowed mode (because it is common for full-screen mode to have
-             * a black background). 
+             * a black background).
              */
             peerPanel.setOpaque(!isFullScreen());
             peerPanel.setBackground(macPanelBackground);

File: src/net/java/sip/communicator/impl/gui/main/call/ParanoiaTimerSecurityPanel.java
Patch:
@@ -111,6 +111,7 @@ public void run()
      *
      * @param evt the security event of which we're notified
      */
+    @Override
     public void securityOn(CallPeerSecurityOnEvent evt)
     {
         timer.cancel();
@@ -121,13 +122,15 @@ public void securityOn(CallPeerSecurityOnEvent evt)
      *
      * @param evt the security event of which we're notified
      */
+    @Override
     public void securityOff(CallPeerSecurityOffEvent evt) {}
 
     /**
      * Indicates that the security is time-outed, is not supported by the
      * other end.
      * @param evt Details about the event that caused this message.
      */
+    @Override
     public void securityTimeout(CallPeerSecurityTimeoutEvent evt)
     {
         timer.cancel();

File: src/net/java/sip/communicator/impl/gui/main/call/ResizeVideoButton.java
Patch:
@@ -104,6 +104,7 @@ public ResizeVideoButton(Call call, boolean selected)
     /**
      * Shares the desktop with the peers in the current call.
      */
+    @Override
     public void buttonPressed()
     {
         if (call != null)

File: src/net/java/sip/communicator/impl/gui/main/call/ShowHideVideoButton.java
Patch:
@@ -73,6 +73,7 @@ public ShowHideVideoButton(UIVideoHandler2 uiVideoHandler, boolean selected)
      * Toggles the display of the visual <tt>Component</tt> which depicts the
      * video streaming from the local peer/user to the remote peer(s).
      */
+    @Override
     public void buttonPressed()
     {
         uiVideoHandler.setLocalVideoVisible(

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallDialog.java
Patch:
@@ -20,7 +20,7 @@
 /**
  * Represents a <tt>Dialog</tt> which allows specifying the target contact
  * address of a transfer-call operation.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class TransferCallDialog

File: src/net/java/sip/communicator/impl/gui/main/call/UIPhoneUtil.java
Patch:
@@ -103,6 +103,7 @@ public List<UIContactDetail> getAdditionalNumbers()
                                     null,
                                     pnd)
                             {
+                                @Override
                                 public PresenceStatus getPresenceStatus()
                                 {
                                     return null;

File: src/net/java/sip/communicator/impl/gui/main/call/UIVideoHandler2.java
Patch:
@@ -84,7 +84,7 @@ public UIVideoHandler2(CallConference callConference)
      * <tt>callConference</tt>. Adding or removing <tt>Call</tt>s modifies the
      * list of <tt>CallPeer</tt>s associated with <tt>callConference</tt> which
      * in turn may result in the adding or removing of visual
-     * <tt>Component</tt>s depicting video. 
+     * <tt>Component</tt>s depicting video.
      *
      * @param ev a <tt>PropertyChangeEvent</tt> which specifies the
      * <tt>Call</tt> which was added to or removed from the list of
@@ -246,7 +246,7 @@ protected void onVideoEvent(VideoEvent ev)
      * peer(s) is to be made visible in the user interface. The indicator does
      * not determine whether the local peer/user is actually streaming video to
      * the remote peer(s).
-     * 
+     *
      * @param localVideoVisible <tt>true</tt> to have the visual
      * <tt>Component</tt> depicting the video of the local peer/user streaming
      * to the remote peer(s) visible in the user interface; otherwise,

File: src/net/java/sip/communicator/impl/gui/main/call/VolumeControlSlider.java
Patch:
@@ -126,6 +126,7 @@ public JPopupMenu getPopupMenu()
      * Makes this Component displayable by connecting it to a native screen
      * resource. Starts the thread loop to change volume.
      */
+    @Override
     public void addNotify()
     {
         super.addNotify();
@@ -150,6 +151,7 @@ public void addNotify()
      *  Makes this Component undisplayable by destroying it native screen
      *  resource. Stops the thread loop to change volume.
      */
+    @Override
     public void removeNotify()
     {
         super.removeNotify();
@@ -207,6 +209,7 @@ public SetVolumeThread(final VolumeControl volumeControl)
         /**
          * Updates and sets the volume if changed.
          */
+        @Override
         public void run()
         {
             while(this.run)

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceParticipantPanel.java
Patch:
@@ -139,7 +139,7 @@ public abstract class BasicConferenceParticipantPanel<T>
      */
     private SoundLevelIndicator soundIndicator;
 
-    
+
     /**
      * The status bar of the participant panel.
      */
@@ -552,7 +552,7 @@ public void run()
                 parentWindow.pack();
             errorMessageComponent.repaint();
         }
-        
+
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceInviteDialog.java
Patch:
@@ -265,6 +265,7 @@ private void initAccountSelectorPanel(
         {
             private static final long serialVersionUID = 0L;
 
+            @Override
             public Component getListCellRendererComponent(JList list,
                 Object value, int index, boolean isSelected,
                 boolean cellHasFocus)

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferencePeerViewListener.java
Patch:
@@ -18,14 +18,14 @@ public interface ConferencePeerViewListener
 {
     /**
      * Indicates that the peer panel was added.
-     * 
+     *
      * @param ev the event.
      */
     public void peerViewAdded(ConferencePeerViewEvent ev);
-    
+
     /**
      * Indicates that the peer panel was removed.
-     * 
+     *
      * @param ev the event.
      */
     public void peerViewRemoved(ConferencePeerViewEvent ev);

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ProtocolProviderSelectorBox.java
Patch:
@@ -243,6 +243,7 @@ private class SelectorMenu extends SIPCommMenu
 
         Image image = ImageLoader.getImage(ImageLoader.DOWN_ARROW_ICON);
 
+        @Override
         public void paintComponent(Graphics g)
         {
             super.paintComponent(g);

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ThumbnailConferenceCallPanel.java
Patch:
@@ -32,7 +32,7 @@ public class ThumbnailConferenceCallPanel
      * @param callConference the <tt>CallConference</tt> to be depicted by the
      * new instance
      * @param uiVideoHandler the utility which is to aid the new instance in
-     * dealing with the video-related information 
+     * dealing with the video-related information
      */
     public ThumbnailConferenceCallPanel(CallPanel callPanel,
                                         CallConference callConference,

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatBuffer.java
Patch:
@@ -44,6 +44,7 @@ private void recalculateBuffer() {
      * @return <code>true</code> (as per the general contract of the
      * Collection.add)
      */
+    @Override
     public boolean add(E o) {
         this.recalculateBuffer();
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatChangeListener.java
Patch:
@@ -12,7 +12,7 @@
  *
  * @author Damian Minkov
  */
-public interface ChatChangeListener 
+public interface ChatChangeListener
 {
     /**
      * @param panel the current visible chat panel

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -456,6 +456,7 @@ private class KickParticipantThread extends Thread
             this.reason = reason;
         }
 
+        @Override
         public void run()
         {
             try
@@ -526,6 +527,7 @@ private class BanParticipantThread extends Thread
             this.reason = reason;
         }
 
+        @Override
         public void run()
         {
             try

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationContainer.java
Patch:
@@ -12,22 +12,22 @@
  * The <tt>ChatConversationContainer</tt> is used as an abstraction of the
  * conversation area, which is included in both the chat window and the history
  * window.
- * 
+ *
  * @author Yana Stamcheva
  */
 public interface ChatConversationContainer
 {
     /**
      * Returns the window, where this chat conversation container is contained.
      * (the chat window, the history window, etc)
-     * 
+     *
      * @return the window, where this chat conversation container is contained.
      */
     public Window getConversationContainerWindow();
 
     /**
      * Sets the given status message to this conversation container.
-     * 
+     *
      * @param statusMessage the status message to set
      */
     public void addTypingNotification(String statusMessage);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatHistoryListener.java
Patch:
@@ -9,7 +9,7 @@
 /**
  * The <tt>ChatHistoryListener</tt> is notified each time the chat history of
  * a <tt>ChatPanel</tt> changes.
- * 
+ *
  * @author Yana Stamcheva
  */
 public interface ChatHistoryListener

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatOperationReasonDialog.java
Patch:
@@ -64,9 +64,9 @@ public ChatOperationReasonDialog(String title, String message)
      * @param title the title of this dialog
      * @param message the message shown in this dialog
      * @param okButtonName the custom name of the ok button
-     * @param showReasonLabel specify if we want the "Reason:" label 
+     * @param showReasonLabel specify if we want the "Reason:" label
      */
-    public ChatOperationReasonDialog(Frame chatWindow, String title, 
+    public ChatOperationReasonDialog(Frame chatWindow, String title,
         String message, String okButtonName, boolean showReasonLabel)
     {
         super(chatWindow, title, message, okButtonName, false);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatSessionChangeListener.java
Patch:
@@ -15,9 +15,9 @@ public interface ChatSessionChangeListener
     /**
      * Called when the current {@link ChatTransport} has
      * changed.
-     * 
-     * @param chatSession the {@link ChatSession} it's current 
-     * {@link ChatTransport} has changed 
+     *
+     * @param chatSession the {@link ChatSession} it's current
+     * {@link ChatTransport} has changed
      */
     public void currentChatTransportChanged(ChatSession chatSession);
 }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransferHandler.java
Patch:
@@ -95,6 +95,7 @@ public ChatTransferHandler(ChatPanel chatPanel)
      * otherwise
      * @throws NullPointerException if <code>support</code> is {@code null}
      */
+    @Override
     public boolean canImport(JComponent comp, DataFlavor flavor[])
     {
         for(DataFlavor f: flavor)
@@ -116,6 +117,7 @@ public boolean canImport(JComponent comp, DataFlavor flavor[])
      * @return  true if the data was inserted into the component and false
      * otherwise
      */
+    @Override
     @SuppressWarnings("unchecked") //the case is taken care of
     public boolean importData(JComponent comp, Transferable t)
     {

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransportSelectorBox.java
Patch:
@@ -397,6 +397,7 @@ private class SelectorMenu
 
         Image image = ImageLoader.getImage(ImageLoader.DOWN_ARROW_ICON);
 
+        @Override
         public void paintComponent(Graphics g)
         {
             super.paintComponent(g);

File: src/net/java/sip/communicator/impl/gui/main/chat/StatusPanel.java
Patch:
@@ -15,7 +15,7 @@
 /**
  * The <tt>StatusPanel</tt> is the panel shown on the bottom of the chat
  * window and containing the typing notification messages.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class StatusPanel
@@ -78,7 +78,7 @@ public void setStatusMessage(String statusMessage)
 
     /**
      * Returns the height of the default status label font.
-     * 
+     *
      * @return the height of the default status label font.
      */
     private int getFontHeight()

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatContactRoleIcon.java
Patch:
@@ -12,7 +12,7 @@
 import net.java.sip.communicator.service.protocol.*;
 
 /**
- * Allows to determine which icon should be chosen for the chat contact 
+ * Allows to determine which icon should be chosen for the chat contact
  * currently participating in a chatroom, regarding to his associated role.
  *
  * @author Valentin Martinet

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomSubjectPanel.java
Patch:
@@ -23,7 +23,7 @@
 /**
  * The panel containing the subject of the chat room and the configuration
  * button.
- * 
+ *
  * @author Yana Stamcheva
  * @author Lubomir Marinov
  * @author Adam Netocny
@@ -114,7 +114,7 @@ public String getSubject()
     /**
      * Sets the (chat room) subject to be displayed in this
      * <tt>ChatRoomSubjectPanel</tt>.
-     * 
+     *
      * @param subject the (chat room) subject to be displayed in this
      * <tt>ChatRoomSubjectPanel</tt>
      */

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryMenu.java
Patch:
@@ -16,7 +16,7 @@
 
 /**
  * The <tt>HistoryMenu</tt> is the main menu in the history window.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class HistoryMenu

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/ChatFileMenu.java
Patch:
@@ -20,7 +20,7 @@
 /**
  * The <tt>FileMenu</tt> is the menu in the chat window menu bar that contains
  * my chat rooms, history and close.
- * 
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */
@@ -76,6 +76,7 @@ public ChatFileMenu(ChatWindow chatWindow)
      *
      * @param e the <tt>ActionEvent</tt> that notified us
      */
+    @Override
     public void actionPerformed(ActionEvent e)
     {
         super.actionPerformed(e);
@@ -129,6 +130,7 @@ else if (itemText.equalsIgnoreCase("close"))
     /**
      * Reloads menu icons.
      */
+    @Override
     public void loadSkin()
     {
         super.loadSkin();

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/ChatRightButtonMenu.java
Patch:
@@ -21,7 +21,7 @@
  * The <tt>ChatRightButtonMenu</tt> appears when the user makes a right button
  * click on the chat window conversation area (where sent and received messages
  * are displayed).
- *  
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */
@@ -42,7 +42,7 @@ public class ChatRightButtonMenu
 
     /**
      * Creates an instance of <tt>ChatRightButtonMenu</tt>.
-     *  
+     *
      * @param chatConvPanel The conversation panel, where this menu will apear.
      */
     public ChatRightButtonMenu(ChatConversationPanel chatConvPanel)

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/ChatToolsMenu.java
Patch:
@@ -93,6 +93,7 @@ private void initValues()
      * selected.
      * @param e the <tt>ActionEvent</tt> that notified us
      */
+    @Override
     public void actionPerformed(ActionEvent e)
     {
         super.actionPerformed(e);

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/EditMenu.java
Patch:
@@ -20,7 +20,7 @@
 /**
  * The <tt>EditMenu</tt> is the menu in the chat window menu bar, which contains
  * cut, copy and paste.
- * 
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/MessageWindowMenuBar.java
Patch:
@@ -1,6 +1,6 @@
 /*
  * Jitsi, the OpenSource Java VoIP and Instant Messaging client.
- * 
+ *
  * Distributable under LGPL license. See terms of license at gnu.org.
  */
 package net.java.sip.communicator.impl.gui.main.chat.menus;
@@ -22,7 +22,7 @@
 /**
  * The <tt>MessageWindowMenuBar</tt> is the menu bar in the chat window where
  * all menus are added.
- * 
+ *
  * @author Yana Stamcheva
  * @author Lyubomir Marinov
  */
@@ -45,7 +45,7 @@ public class MessageWindowMenuBar
 
     /**
      * Initializes a new <tt>MessageWindowMenuBar</tt> instance.
-     * 
+     *
      * @param parentWindow the ChatWindow which is to be the parent of the new
      * instance
      */

File: src/net/java/sip/communicator/impl/gui/main/chat/toolBars/MainToolBar.java
Patch:
@@ -532,7 +532,7 @@ public ChatToolbarButton getHistoryButton()
 
     /**
      * Get the smileys box.
-     * 
+     *
      * @return the smileys box
      */
     public SmileysSelectorBox getSmileysBox()
@@ -781,6 +781,7 @@ protected Object construct()
          * Called on the event dispatching thread (not on the worker thread)
          * after the <code>construct</code> method has returned.
          */
+        @Override
         protected void finished()
         {
             callButton.setEnabled(isCallEnabled);

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/AdHocChatRoomListChangeListener.java
Patch:
@@ -8,7 +8,7 @@
 
 /**
  * Listener that dispatches events coming from the ad-hoc chat room list.
- * 
+ *
  * @author Valentin Martinet
  */
 public interface AdHocChatRoomListChangeListener

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListChangeEvent.java
Patch:
@@ -13,7 +13,7 @@
 /**
  * Parent class for gui chat room events indicating addition and removal of
  * chat rooms in the gui chat rooms list.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class ChatRoomListChangeEvent
@@ -67,6 +67,7 @@ public ChatRoomWrapper getSourceChatRoom()
      *
      * @return  A String representation of this <tt>GuiChatRoomEvent</tt>.
      */
+    @Override
     public String toString()
     {
         StringBuffer buff

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListChangeListener.java
Patch:
@@ -7,7 +7,7 @@
 package net.java.sip.communicator.impl.gui.main.chatroomslist;
 
 /**
- * 
+ *
  * @author Yana Stamcheva
  */
 public interface ChatRoomListChangeListener

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListUI.java
Patch:
@@ -38,7 +38,7 @@ public class ChatRoomListUI
 
     /**
      * Creates the scroll panel containing the chat rooms list.
-     * 
+     *
      * @param parentDialog Currently not used
      */
     public ChatRoomListUI(ChatRoomListDialog parentDialog)
@@ -132,7 +132,7 @@ public void mouseEntered(MouseEvent e)
 
     public void mouseExited(MouseEvent e)
     {}
-    
+
     public void mouseReleased(MouseEvent e)
     {}
 

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomRightButtonMenu.java
Patch:
@@ -128,7 +128,7 @@ else if (itemName.equals("joinChatRoom"))
             if (nickName != null)
                 conferenceManager.joinChatRoom(chatRoomWrapper, nickName, null);
             else
-                conferenceManager.joinChatRoom(chatRoomWrapper);    
+                conferenceManager.joinChatRoom(chatRoomWrapper);
         }
         else if (itemName.equals("openChatRoom"))
         {
@@ -265,7 +265,7 @@ private JMenuItem createMenuItem(
 
         return menuItem;
     }
-    
+
     private String getNickname()
     {
         String nickName = null;

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableModel.java
Patch:
@@ -57,7 +57,7 @@ public class ChatRoomTableModel
 
     /**
      * Creates new model for the supplied table.
-     * 
+     *
      * @param parentTable the parent table.
      */
     public ChatRoomTableModel(JTable parentTable)
@@ -70,7 +70,7 @@ public ChatRoomTableModel(JTable parentTable)
         /*
          * XXX The chatRoomList instance will surely outlive this instance so it
          * is essential to call the removeChatRoomProviderWrapperListener method
-         * on it in order to prevent this instance from leaking. 
+         * on it in order to prevent this instance from leaking.
          */
         chatRoomList.addChatRoomProviderWrapperListener(this);
 
@@ -154,7 +154,7 @@ public int getRowCount()
     }
 
     /**
-     * Returns the number of columns in the model. 
+     * Returns the number of columns in the model.
      *
      * @return the number of columns in the model
      */

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/CreateChatRoomWizard.java
Patch:
@@ -12,8 +12,8 @@
 
 /**
  * The <tt>CreateChatRoomWizard</tt> is the wizard through which the user could
- * create its own chat room. 
- * 
+ * create its own chat room.
+ *
  * @author Yana Stamcheva
  */
 public class CreateChatRoomWizard
@@ -28,7 +28,7 @@ public class CreateChatRoomWizard
 
     /**
      * Creates an instance of <tt>CreateChatRoomWizard</tt>.
-     *  
+     *
      * @param mainFrame the main application window
      */
     public CreateChatRoomWizard(MainFrame mainFrame)

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/NewChatRoom.java
Patch:
@@ -14,7 +14,7 @@
  * The <tt>NewChatRoom</tt> is meant to be used from the
  * <tt>CreateChatRoomWizard</tt>, to collect information concerning the new chat
  * room.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class NewChatRoom
@@ -24,7 +24,7 @@ public class NewChatRoom
    private String chatRoomName;
 
    private List<String> userList;
-   
+
    private String invitationMessage = "";
 
    public String getInvitationMessage()
@@ -41,7 +41,7 @@ public List<String> getUserList()
    {
        if(userList == null || userList.size() < 1)
            return new LinkedList<String>();
-       
+
        return userList;
    }
 

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomDialog.java
Patch:
@@ -47,7 +47,7 @@ public class JoinChatRoomDialog
 
     /**
      * Creates an instance of <tt>JoinChatRoomDialog</tt>.
-     * 
+     *
      * @param provider the <tt>ChatRoomProviderWrapper</tt>, which will be the chat
      * server for the newly created chat room
      */
@@ -83,7 +83,7 @@ public JoinChatRoomDialog(ChatRoomProviderWrapper provider)
         this.getContentPane().add(searchPanel, BorderLayout.CENTER);
         this.getContentPane().add(buttonsPanel, BorderLayout.SOUTH);
     }
-    
+
     /**
      * Handles the <tt>ActionEvent</tt>. Depending on the user choice creates
      * the desired chat room in a separate thread.
@@ -111,6 +111,7 @@ public void actionPerformed(ActionEvent e)
      * @param escaped indicates if the window was closed by pressing the Esc
      * key
      */
+    @Override
     protected void close(boolean escaped)
     {
         this.cancelButton.doClick();

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigFormList.java
Patch:
@@ -13,7 +13,7 @@
 
 /**
  * The list containing all <tt>ConfigurationForm</tt>s.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class ConfigFormList
@@ -42,7 +42,7 @@ public ConfigFormList(ConfigurationFrame configFrame)
     }
 
     /**
-     * Adds a new <tt>ConfigurationForm</tt> to this list. 
+     * Adds a new <tt>ConfigurationForm</tt> to this list.
      * @param configForm The <tt>ConfigurationForm</tt> to add.
      */
     public void addConfigForm(ConfigurationForm configForm)
@@ -65,7 +65,7 @@ public void addConfigForm(ConfigurationForm configForm)
     }
 
     /**
-     * Removes a <tt>ConfigurationForm</tt> from this list. 
+     * Removes a <tt>ConfigurationForm</tt> from this list.
      * @param configForm The <tt>ConfigurationForm</tt> to remove.
      */
     public void removeConfigForm(ConfigurationForm configForm)

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigurationFrame.java
Patch:
@@ -233,6 +233,7 @@ public void showFormContent(ConfigFormDescriptor configFormDescriptor)
      *
      * @param isVisible specifies whether the frame is to be visible or not.
      */
+    @Override
     public void setVisible(final boolean isVisible)
     {
         if(!SwingUtilities.isEventDispatchThread())
@@ -261,6 +262,7 @@ public void run()
      * @param isEscaped specifies whether the close was triggered by pressing
      *            the escape key.
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         this.setVisible(false);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -80,7 +80,7 @@ public class AddContactDialog
     /**
      * Creates an instance of <tt>AddContactDialog</tt> that represents a dialog
      * that adds a new contact to an already existing meta contact.
-     * 
+     *
      * @param parentWindow the parent window of this dialog
      */
     public AddContactDialog(Frame parentWindow)
@@ -663,6 +663,7 @@ private void addRenameListener(
         GuiActivator.getContactListService().addMetaContactListListener(
             new MetaContactListAdapter()
             {
+                @Override
                 public void metaContactAdded(MetaContactEvent evt)
                 {
                     if (evt.getSourceMetaContact().getContact(
@@ -672,6 +673,7 @@ public void metaContactAdded(MetaContactEvent evt)
                     }
                 }
 
+                @Override
                 public void protoContactAdded(ProtoContactEvent evt)
                 {
                     if (metaContact != null

File: src/net/java/sip/communicator/impl/gui/main/contactlist/CommonRightButtonMenu.java
Patch:
@@ -22,7 +22,7 @@
  * The GroupRightButtonMenu is the menu, opened when user clicks with the
  * right mouse button on a group in the contact list. Through this menu the
  * user could add a contact to a group.
- * 
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */
@@ -42,7 +42,7 @@ public class CommonRightButtonMenu
 
     /**
      * Creates an instance of GroupRightButtonMenu.
-     * 
+     *
      * @param mainFrame The parent <tt>MainFrame</tt> window.
      */
     public CommonRightButtonMenu(MainFrame mainFrame)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListModel.java
Patch:
@@ -528,7 +528,7 @@ private void initGroupsStatus(MetaContactGroup group)
         while (subgroups.hasNext())
         {
             MetaContactGroup subgroup = subgroups.next();
-            
+
             this.initGroupsStatus(subgroup);
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -110,6 +110,7 @@ public void initList(MetaContactListService contactListService)
         this.contactList.addContactListListener(this);
         this.addMouseListener(new MouseAdapter()
         {
+            @Override
             public void mousePressed(MouseEvent e)
             {
                 if ((e.getModifiers() & InputEvent.BUTTON3_MASK) != 0)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListSearchKeyDispatcher.java
Patch:
@@ -44,7 +44,7 @@ public class ContactListSearchKeyDispatcher
      * The container of the contact list.
      */
     private final ContactListContainer contactListContainer;
-    
+
     /**
      * Creates an instance of <tt>MainKeyDispatcher</tt>.
      * @param keyManager the parent <tt>KeyboardFocusManager</tt>

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -599,6 +599,7 @@ public int getIconWidth()
      * Returns the preferred size of this component.
      * @return the preferred size of this component
      */
+    @Override
     public Dimension getPreferredSize()
     {
         Dimension preferredSize = new Dimension();

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactProtocolButton.java
Patch:
@@ -10,15 +10,15 @@
  * contactlist, which corresponds to a specific protocol contact. This
  * button allows opening a chat for a given "meta contact" by specifing
  * the exact protocol contact to use for the chat.
- *  
+ *
  * @author Yana Stamcheva
  */
 public class ContactProtocolButton
     extends SIPCommButton
 {
 
     private Contact protocolContact;
-    
+
     /**
      * Creates an instance of ContactProtocolButton.
      * @param bgImage The background image of the button.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/DefaultTreeContactList.java
Patch:
@@ -82,6 +82,7 @@ public DefaultTreeContactList()
         // on Mac Leopard.
         addMouseListener(new MouseAdapter()
         {
+            @Override
             public void mouseReleased(MouseEvent e)
             {
                 if(myCachedSelectionEvent == null)
@@ -152,6 +153,7 @@ public boolean isContactActive(MetaContact metaContact)
      *
      * @return The customized tooltip.
      */
+    @Override
     public JToolTip createToolTip()
     {
         Point currentMouseLocation = MouseInfo.getPointerInfo().getLocation();
@@ -282,6 +284,7 @@ public void loadSkin()
      * @see JComponent#getUIClassID
      * @see UIDefaults#getUI
      */
+    @Override
     public String getUIClassID()
     {
         return uiClassID;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GenericUIContactImpl.java
Patch:
@@ -342,6 +342,7 @@ public void setContactDetails(  Map <Class<? extends OperationSet>,
      * component.
      * @return the corresponding <tt>ContactNode</tt>
      */
+    @Override
     public ContactNode getContactNode()
     {
         return contactNode;
@@ -351,6 +352,7 @@ public ContactNode getContactNode()
      * Sets the corresponding <tt>ContactNode</tt>.
      * @param contactNode the corresponding <tt>ContactNode</tt>
      */
+    @Override
     public void setContactNode(ContactNode contactNode)
     {
         this.contactNode = contactNode;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/InviteUIContact.java
Patch:
@@ -59,6 +59,7 @@ public InviteUIContact( UIContact uiContact,
      * @return a list of <tt>UIContactDetail</tt>s supporting the given
      * <tt>OperationSet</tt> class
      */
+    @Override
     public List<UIContactDetail> getContactDetailsForOperationSet(
         Class<? extends OperationSet> opSetClass)
     {
@@ -102,6 +103,7 @@ public List<UIContactDetail> getContactDetailsForOperationSet(
      *
      * @return a list of all contained <tt>UIContactDetail</tt>s
      */
+    @Override
     public List<UIContactDetail> getContactDetails()
     {
         return sourceUIContact.getContactDetails();
@@ -115,6 +117,7 @@ public List<UIContactDetail> getContactDetails()
      * @return the default <tt>ContactDetail</tt> to use for any operations
      * depending to the given <tt>OperationSet</tt> class
      */
+    @Override
     public UIContactDetail getDefaultContactDetail(
         Class<? extends OperationSet> opSetClass)
     {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MetaContactRightButtonMenu.java
Patch:
@@ -1510,6 +1510,7 @@ private void requestAuthorization(final Contact contact)
 
         new Thread()
         {
+            @Override
             public void run()
             {
                 int returnCode = dialog.getReturnCode();

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameContactPanel.java
Patch:
@@ -1,6 +1,6 @@
 /*
  * Jitsi, the OpenSource Java VoIP and Instant Messaging client.
- * 
+ *
  * Distributable under LGPL license. See terms of license at gnu.org.
  */
 package net.java.sip.communicator.impl.gui.main.contactlist;
@@ -18,7 +18,7 @@
 /**
  * The <tt>RenameContactPanel</tt> is where the user could change the name of a
  * meta contact.
- * 
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */
@@ -90,7 +90,7 @@ public RenameContactPanel(String oldName)
 
     /**
      * Returns the new name entered by the user.
-     * 
+     *
      * @return the new name entered by the user.
      */
     public String getNewName()

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameGroupPanel.java
Patch:
@@ -1,6 +1,6 @@
 /*
  * Jitsi, the OpenSource Java VoIP and Instant Messaging client.
- * 
+ *
  * Distributable under LGPL license. See terms of license at gnu.org.
  */
 package net.java.sip.communicator.impl.gui.main.contactlist;
@@ -18,7 +18,7 @@
 /**
  * The <tt>RenameGroupPanel</tt> is where the user could change the name of a
  * meta contact group.
- * 
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */
@@ -88,7 +88,7 @@ public RenameGroupPanel(String groupName)
 
     /**
      * Returns the new name entered by the user.
-     * 
+     *
      * @return the new name entered by the user.
      */
     public String getNewName()

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchField.java
Patch:
@@ -141,6 +141,7 @@ public void textRemoved()
      * Do not need this for the moment.
      * @param e the <tt>DocumentEvent</tt> that notified us
      */
+    @Override
     public void changedUpdate(DocumentEvent e) {}
 
     /**
@@ -259,6 +260,7 @@ public void loadSkin()
      * @see JComponent#getUIClassID
      * @see UIDefaults#getUI
      */
+    @Override
     public String getUIClassID()
     {
         return uiClassID;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -785,6 +785,7 @@ public void run()
     /**
      * Removes all entries in this contact list.
      */
+    @Override
     public void removeAll()
     {
         treeModel.clear();
@@ -948,6 +949,7 @@ public void setFilter(ContactListFilter filter)
             this.filter = filter;
         }
 
+        @Override
         public void run()
         {
             while (true)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/UIContactDetailImpl.java
Patch:
@@ -14,7 +14,7 @@
 import net.java.sip.communicator.service.protocol.*;
 
 /**
- * The <tt>UIContactDetail</tt> implementation 
+ * The <tt>UIContactDetail</tt> implementation
  *
  * @author Yana Stamcheva
  */
@@ -71,7 +71,7 @@ public UIContactDetailImpl(
         String category,
         Collection<String> labels,
         ImageIcon statusIcon,
-        Map<Class<? extends OperationSet>, ProtocolProviderService> 
+        Map<Class<? extends OperationSet>, ProtocolProviderService>
                                                         preferredProviders,
         Map<Class<? extends OperationSet>, String> preferredProtocols,
         Object descriptor)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/UIContactImpl.java
Patch:
@@ -73,5 +73,6 @@ public byte[] getAvatar()
      *
      * @return the display name of this <tt>UIContact</tt>
      */
+    @Override
     public abstract String getDisplayName();
 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/UnknownContactPanel.java
Patch:
@@ -252,6 +252,7 @@ public void loadSkin()
      *
      * @param isVisible indicates if this panel should be shown or hidden
      */
+    @Override
     public void setVisible(boolean isVisible)
     {
         if (isVisible)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addgroup/CreateGroupDialog.java
Patch:
@@ -52,7 +52,7 @@ public class CreateGroupDialog
     /**
      * Creates an instance of <tt>CreateGroupDialog</tt> that represents a dialog
      * that creates a new contact group.
-     * 
+     *
      * @param parentWindow the parent dialog
      */
     public CreateGroupDialog(Dialog parentWindow)
@@ -63,7 +63,7 @@ public CreateGroupDialog(Dialog parentWindow)
     /**
      * Creates an instance of <tt>CreateGroupDialog</tt> that represents a dialog
      * that creates a new contact group.
-     * 
+     *
      * @param parentWindow the parent frame
      */
     public CreateGroupDialog(Frame parentWindow)
@@ -257,6 +257,7 @@ public MetaContactGroup getNewMetaGroup()
      * @param isEscaped indicates if the window has been closed by pressing the
      * Esc button.
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         this.cancelButton.doClick();

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addgroup/CreateGroupPanel.java
Patch:
@@ -17,7 +17,7 @@
 
 /**
  * The <tt>CreateGroupPanel</tt> is the form for creating a group.
- *  
+ *
  * @author Yana Stamcheva
  * @author Adam Netocny
  */
@@ -105,13 +105,13 @@ public void requestFocusInField()
 
     /**
      * Shows an error message below the create group text field.
-     * 
+     *
      * @param msg the message to show
      */
     public void showErrorMessage(String msg)
     {
         errorLabel.setText("*" + msg);
-        
+
         errorLabel.setVisible(true);
     }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaContactListSource.java
Patch:
@@ -198,6 +198,7 @@ public MetaContactQuery queryMetaContactSource(final Pattern filterPattern)
 
         new Thread()
         {
+            @Override
             public void run()
             {
                 int resultCount = 0;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/ProtocolContactSourceServiceImpl.java
Patch:
@@ -15,7 +15,7 @@
 import net.java.sip.communicator.service.protocol.*;
 
 /**
- * The <tt>ProtocolContactSourceServiceImpl</tt> 
+ * The <tt>ProtocolContactSourceServiceImpl</tt>
  *
  * @author Yana Stamcheva
  */
@@ -73,7 +73,7 @@ public int getType()
 
     /**
      * Returns a user-friendly string that identifies this contact source.
-     * 
+     *
      * @return the display name of this contact source
      */
     public String getDisplayName()
@@ -179,6 +179,7 @@ protected boolean phoneNumberMatches(String phoneNumber)
             return false;
         }
 
+        @Override
         public void run()
         {
             Iterator<MetaContact> contactListIter

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/StringContactSourceServiceImpl.java
Patch:
@@ -59,7 +59,7 @@ public int getType()
 
     /**
      * Returns a user-friendly string that identifies this contact source.
-     * 
+     *
      * @return the display name of this contact source
      */
     public String getDisplayName()

File: src/net/java/sip/communicator/impl/gui/main/contactlist/notifsource/NotificationContactSource.java
Patch:
@@ -319,6 +319,7 @@ public void actionPerformed(final UIContactDetail contactDetail,
         {
             new Thread()
             {
+                @Override
                 public void run()
                 {
                     try

File: src/net/java/sip/communicator/impl/gui/main/login/DefaultSecurityAuthority.java
Patch:
@@ -127,7 +127,7 @@ public UserCredentials obtainCredentials(
     /**
      * Sets the userNameEditable property, which indicates if the user name
      * could be changed by user or not.
-     * 
+     *
      * @param isUserNameEditable indicates if the user name could be changed by
      * user
      */
@@ -139,7 +139,7 @@ public void setUserNameEditable(boolean isUserNameEditable)
     /**
      * Indicates if the user name is currently editable, i.e. could be changed
      * by user or not.
-     * 
+     *
      * @return <code>true</code> if the user name could be changed,
      * <code>false</code> - otherwise.
      */

File: src/net/java/sip/communicator/impl/gui/main/menus/AutoAnswerMenu.java
Patch:
@@ -342,7 +342,7 @@ public void run()
         for(int i = 0; i < parentMenu.getItemCount(); i++)
         {
             JMenuItem c = parentMenu.getItem(i);
-            
+
             if (!(c instanceof AutoAnswerMenuItem))
                 continue;
 
@@ -938,6 +938,7 @@ && getAutoAnswerItemCount(parentMenu) == 1)
          * @param isEscaped indicates if this frame has been closed by
          * pressing the escape
          */
+        @Override
         protected void close(boolean isEscaped)
         {
             dispose();
@@ -953,7 +954,7 @@ private void loadValues()
                 .getOperationSet(OperationSetBasicAutoAnswer.class);
             OperationSetAdvancedAutoAnswer opSetAdvanced = providerService
                 .getOperationSet(OperationSetAdvancedAutoAnswer.class);
-            
+
             if(opset == null)
                 return;
 

File: src/net/java/sip/communicator/impl/gui/main/menus/HelpMenu.java
Patch:
@@ -18,12 +18,12 @@
 
 /**
  * The <tt>HelpMenu</tt> is a menu in the main application menu bar.
- * 
+ *
  * @author Yana Stamcheva
  * @author Thomas Hofer
  * @author Lyubomir Marinov
  */
-public class HelpMenu 
+public class HelpMenu
     extends SIPCommMenu
     implements ActionListener
 {
@@ -36,7 +36,7 @@ public class HelpMenu
 
     /**
      * Creates an instance of <tt>HelpMenu</tt>.
-     * 
+     *
      * @param mainFrame the parent window
      */
     public HelpMenu(MainFrame mainFrame)

File: src/net/java/sip/communicator/impl/gui/main/menus/MainMenu.java
Patch:
@@ -21,7 +21,7 @@
  * modifying the menuBackground.png in the resources/images/impl/gui/common
  * folder.
  * </p>
- * 
+ *
  * @author Yana Stamcheva
  * @author Lubomir Marinov
  */

File: src/net/java/sip/communicator/impl/gui/main/menus/SIPCommWindowMenuBar.java
Patch:
@@ -109,7 +109,7 @@ private static boolean isTransparent(Image image)
 
     /**
      * Paints the MENU_BACKGROUND image on the background of this container.
-     * 
+     *
      * @param g the <tt>Graphics</tt> object that does the painting
      */
     @Override

File: src/net/java/sip/communicator/impl/gui/main/presence/AccountStatusPanel.java
Patch:
@@ -370,6 +370,7 @@ public boolean hasSelectedMenus()
      * Paints this component.
      * @param g the <tt>Graphics</tt> object used for painting
      */
+    @Override
     public void paintComponent(Graphics g)
     {
         super.paintComponent(g);
@@ -559,6 +560,7 @@ public void loadSkin()
      * @see JComponent#getUIClassID
      * @see UIDefaults#getUI
      */
+    @Override
     public String getUIClassID()
     {
         if(ConfigurationUtils.isTransparentWindowEnabled())

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -32,7 +32,7 @@
  * <p>
  * By default the <tt>GlobalStatusSelectorBox</tt> will show the most connected
  * status of all registered accounts.
- * 
+ *
  * @author Yana Stamcheva
  * @author Lubomir Marinov
  * @author Adam Netocny
@@ -448,7 +448,7 @@ private void updateGlobalStatus()
 
     /**
      * Sets the systray icon corresponding to the given status.
-     * 
+     *
      * @param status the status, for which we're setting the systray icon.
      */
     private void setSystrayIcon(int status)
@@ -636,6 +636,7 @@ public void loadSkin()
      * @see JComponent#getUIClassID
      * @see UIDefaults#getUI
      */
+    @Override
     public String getUIClassID()
     {
         return uiClassID;

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -149,6 +149,7 @@ else if ((onlineStatus != null
      * @param actionListener The <tt>ActionListener</tt>, which handles the
      * case, when the item is selected.
      */
+    @Override
     public void addItem(String text, Icon icon, ActionListener actionListener)
     {
         JCheckBoxMenuItem item = new JCheckBoxMenuItem(text, icon);

File: src/net/java/sip/communicator/impl/gui/main/presence/SimpleStatusMenu.java
Patch:
@@ -21,7 +21,7 @@
  * The <tt>SimpleStatusSelectorBox</tt> is a <tt>SIPCommMenu</tt> that contains
  * two statuses ONLINE and OFFLINE. It's used to represent the status of a
  * protocol provider which doesn't support presence operation set.
- * 
+ *
  * @author Yana Stamcheva
  * @author Lubomir Marinov
  * @author Adam Netocny
@@ -41,7 +41,7 @@ public class SimpleStatusMenu
 
     /**
      * Creates an instance of <tt>SimpleStatusMenu</tt>.
-     * 
+     *
      * @param protocolProvider the protocol provider
      */
     public SimpleStatusMenu(ProtocolProviderService protocolProvider)
@@ -135,6 +135,7 @@ public void actionPerformed(ActionEvent e)
     /**
      * Stops the timer that manages the connecting animated icon.
      */
+    @Override
     public void updateStatus()
     {
         String tooltip = this.getToolTipText();

File: src/net/java/sip/communicator/impl/gui/utils/InviteContactListFilter.java
Patch:
@@ -35,6 +35,7 @@ public InviteContactListFilter(ContactList sourceContactList)
      * Applies this filter to the default contact source.
      * @param filterQuery the query that tracks this filter.
      */
+    @Override
     public void applyFilter(FilterQuery filterQuery)
     {
         filterQuery.setMaxResultShown(-1);

File: src/net/java/sip/communicator/impl/gui/utils/InviteContactTransferHandler.java
Patch:
@@ -133,6 +133,7 @@ protected Transferable createTransferable(JComponent component)
      * otherwise
      * @throws NullPointerException if <code>support</code> is {@code null}
      */
+    @Override
     public boolean canImport(JComponent comp, DataFlavor flavor[])
     {
         // Dropping is only enabled in the destination contact list.
@@ -163,6 +164,7 @@ public boolean canImport(JComponent comp, DataFlavor flavor[])
      * @return  true if the data was inserted into the component and false
      * otherwise
      */
+    @Override
     public boolean importData(JComponent comp, Transferable t)
     {
         if (t.isDataFlavorSupported(uiContactDataFlavor))

File: src/net/java/sip/communicator/impl/gui/utils/InviteDialog.java
Patch:
@@ -148,6 +148,7 @@ public InviteDialog (String title, boolean enableReason)
              * Removes all other selections.
              * @param e the <tt>FocusEvent</tt> that notified us
              */
+            @Override
             public void focusGained(FocusEvent e)
             {
                 srcContactList.removeSelection();
@@ -278,6 +279,7 @@ public void addCancelButtonListener(ActionListener l)
      * @param isEscaped indicates if this <tt>close</tt> is provoked by an
      * escape
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         this.cancelButton.doClick();

File: src/net/java/sip/communicator/impl/gui/utils/OneChoiceInviteDialog.java
Patch:
@@ -114,6 +114,7 @@ public OneChoiceInviteDialog (String title)
              * Removes all other selections.
              * @param e the <tt>FocusEvent</tt> that notified us
              */
+            @Override
             public void focusGained(FocusEvent e)
             {
                 contactList.removeSelection();
@@ -213,6 +214,7 @@ public void addCancelButtonListener(ActionListener l)
      * @param isEscaped indicates if this <tt>close</tt> is provoked by an
      * escape
      */
+    @Override
     protected void close(boolean isEscaped)
     {
         this.cancelButton.doClick();

File: src/net/java/sip/communicator/impl/gui/utils/SoundProperties.java
Patch:
@@ -12,7 +12,7 @@
 
 /**
  * Manages the access to the properties file containing all sounds paths.
- * 
+ *
  * @author Yana Stamcheva
  */
 public final class SoundProperties

File: src/net/java/sip/communicator/impl/keybindings/KeybindingSetImpl.java
Patch:
@@ -49,6 +49,7 @@ class KeybindingSetImpl
      * @return mapping of keystrokes to the string representation of the actions
      *         they perform
      */
+    @Override
     public LinkedHashMap<KeyStroke, String> getBindings()
     {
         return new LinkedHashMap<KeyStroke, String>(this.bindings);
@@ -60,6 +61,7 @@ public LinkedHashMap<KeyStroke, String> getBindings()
      *
      * @param newBindings new keybindings to be held
      */
+    @Override
     public void setBindings(Map<KeyStroke, String> newBindings)
     {
         if (!this.bindings.equals(newBindings))
@@ -75,6 +77,7 @@ public void setBindings(Map<KeyStroke, String> newBindings)
      *
      * @return binding category
      */
+    @Override
     public Category getCategory()
     {
         return this.category;

File: src/net/java/sip/communicator/impl/ldap/LdapContactQuery.java
Patch:
@@ -276,6 +276,7 @@ else if(evt.getCause() == LdapEvent.LdapEventCause.SEARCH_AUTH_ERROR)
             /* show authentication window to obtain new credentials */
             new Thread()
             {
+                @Override
                 public void run()
                 {
                     LdapDirectorySettingsImpl ldapSettings =

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.awt.*;
 import java.util.*;
-import java.util.List;
 
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferencePeerPanel.java
Patch:
@@ -225,7 +225,7 @@ public ConferencePeerPanel(
         // We initialize the status bar for call peers only.
         initStatusBar(callPeer);
 
-        callPeerMenu = new CallPeerMenu(callPeer);
+        callPeerMenu = new CallPeerMenu(callPeer, callRenderer);
 
         SIPCommMenuBar menuBar = new SIPCommMenuBar();
 

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCall.java
Patch:
@@ -191,7 +191,8 @@ private void removeCallPeer(CallPeerChangeEvent evt)
 
         try
         {
-            fireCallPeerEvent(callPeer, CallPeerEvent.CALL_PEER_REMOVED);
+            fireCallPeerEvent(callPeer, CallPeerEvent.CALL_PEER_REMOVED, 
+                (evt.getReasonString() != null));
         }
         finally
         {

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandlerSipImpl.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.protocol.sip;
 
-import ch.imvs.sdes4j.srtp.*;
-
 import java.net.*;
 import java.util.*;
 
@@ -24,6 +22,8 @@
 import org.jitsi.service.neomedia.device.*;
 import org.jitsi.service.neomedia.format.*;
 
+import ch.imvs.sdes4j.srtp.*;
+
 /**
  * The media handler class handles all media management for a single
  * <tt>CallPeer</tt>. This includes initializing and configuring streams,

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -225,7 +225,8 @@ public MainFrame()
 
         clKeyDispatcher = new ContactListSearchKeyDispatcher(   keyManager,
                                                                 searchField,
-                                                                this);
+                                                                this,
+                                                                menu);
         keyManager.addKeyEventDispatcher(clKeyDispatcher);
 
         /*

File: src/net/java/sip/communicator/impl/gui/utils/InviteDialog.java
Patch:
@@ -235,7 +235,8 @@ public void actionPerformed(ActionEvent e)
         ContactListSearchKeyDispatcher clKeyDispatcher
                         = new ContactListSearchKeyDispatcher(   keyManager,
                                                                 searchField,
-                                                                this);
+                                                                this,
+                                                                null);
 
         clKeyDispatcher.setContactList(srcContactList);
 

File: src/net/java/sip/communicator/impl/gui/utils/OneChoiceInviteDialog.java
Patch:
@@ -138,7 +138,8 @@ public void focusGained(FocusEvent e)
         ContactListSearchKeyDispatcher clKeyDispatcher
                         = new ContactListSearchKeyDispatcher(   keyManager,
                                                                 searchField,
-                                                                this);
+                                                                this,
+                                                                null);
 
         clKeyDispatcher.setContactList(contactList);
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -1290,7 +1290,7 @@ private void initializeUserInterfaceHierarchy()
          * buttons which accept a Call as an argument should be changed to take
          * into account the whole CallConference.
          */
-        Call aCall = this.callConference.getCalls().get(0);
+        Call aCall = callConference.getCalls().get(0);
 
         chatButton
             = new CallToolBarButton(
@@ -1351,6 +1351,7 @@ private void initializeUserInterfaceHierarchy()
                     false);
         remoteLevel
             = new OutputVolumeControlButton(
+                    callConference,
                     ImageLoader.VOLUME_CONTROL_BUTTON,
                     false,
                     true)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.event.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.addgroup.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;

File: src/net/java/sip/communicator/impl/protocol/dict/ContactDictImpl.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.protocol.dict;
 
-import java.util.*;
-
 import net.java.dict4j.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/protocol/gibberish/ContactGibberishImpl.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.protocol.gibberish;
 
-import java.util.*;
-
 import net.java.sip.communicator.service.protocol.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/rss/ContactRssImpl.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.io.*;
 import java.net.*;
-import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
 

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ContactZeroconfImpl.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.impl.protocol.zeroconf;
 
 import java.net.*;
-import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/service/gui/AuthenticationWindowService.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.service.gui;
 
-import javax.swing.*;
 
 /**
  * Creates and show authentication window, normally to fill in username and

File: src/net/java/sip/communicator/impl/neomedia/DeviceConfigurationComboBoxModel.java
Patch:
@@ -6,10 +6,8 @@
  */
 package net.java.sip.communicator.impl.neomedia;
 
-import java.awt.*;
 import java.beans.*;
 import java.util.*;
-import java.util.List;
 
 import javax.media.*;
 import javax.swing.*;
@@ -85,7 +83,6 @@ public class DeviceConfigurationComboBoxModel
      * @param type the device - audio/video
      */
     public DeviceConfigurationComboBoxModel(
-            Component parent,
             DeviceConfiguration deviceConfiguration,
             int type)
     {

File: src/net/java/sip/communicator/impl/protocol/jabber/FailoverConnectionMonitor.java
Patch:
@@ -242,6 +242,9 @@ public void run()
                 if(isConnectedToPrimary(currentRecords))
                     return;
 
+                // Clear DNS cache.
+                NetworkUtils.clearDefaultDNSCache();
+
                 SRVRecord srv = getPrimaryServerRecord(currentRecords);
 
                 ConnectionConfiguration confConn = new ConnectionConfiguration(

File: src/net/java/sip/communicator/impl/protocol/jabber/FailoverConnectionMonitor.java
Patch:
@@ -237,7 +237,7 @@ public void run()
                 // moved to first place, go out of failover state
                 SRVRecord[] currentRecords =
                     NetworkUtils.getSRVRecords(
-                        "xmpp-client", "tcp", serviceName);
+                        "xmpp-client", "tcp", serviceName, false);
 
                 if(isConnectedToPrimary(currentRecords))
                     return;

File: src/net/java/sip/communicator/impl/neomedia/AudioDeviceConfigurationListener.java
Patch:
@@ -72,7 +72,7 @@ public void propertyChange(PropertyChangeEvent ev)
          * The list of available capture, notification and/or playback devices
          * has changes.
          */
-        if(DeviceConfiguration.PROP_AUDIO_SYSTEM_DEVICES.equals(propertyName))
+        if (DeviceConfiguration.PROP_AUDIO_SYSTEM_DEVICES.equals(propertyName))
         {
             @SuppressWarnings("unchecked")
             List<CaptureDeviceInfo> oldDevices

File: src/net/java/sip/communicator/impl/gui/main/call/conference/AudioConferenceCallPanel.java
Patch:
@@ -97,7 +97,9 @@ public AudioConferenceCallPanel(
         scrollPane = new JScrollPane();
         scrollPane.setHorizontalScrollBarPolicy(
                 JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
-        scrollPane.setViewport(new MyViewport());
+//        Temporarily disables the custom viewport, as we believe the issues it
+//        was fixing are now fixed by calling pack() on the parent window.
+//        scrollPane.setViewport(new MyViewport());
         scrollPane.setViewportView(mainPanel);
 
         scrollPane.setOpaque(false);

File: src/net/java/sip/communicator/util/ConfigurationUtils.java
Patch:
@@ -267,7 +267,7 @@ public class ConfigurationUtils
     /**
      * whether to show the status changed message in chat history area.
      */
-    private static boolean showStatusChangedInChat = true;
+    private static boolean showStatusChangedInChat = false;
 
     /**
      * When enabled, allow to use the additional phone numbers

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCallPeer.java
Patch:
@@ -605,7 +605,7 @@ public final boolean isJitsiVideoBridge()
 
     /**
      * Determines whether we are currently streaming video toward whoever this
-     * <tt>CallPeerSipImpl</tt> represents.
+     * <tt>MediaAwareCallPeer</tt> represents.
      *
      * @return <tt>true</tt> if we are currently streaming video toward this
      *  <tt>CallPeer</tt> and  <tt>false</tt> otherwise.

File: src/net/java/sip/communicator/impl/version/VersionImpl.java
Patch:
@@ -36,7 +36,7 @@ public class VersionImpl
      * number changes when a relatively extensive set of new features and
      * possibly rearchitecturing have been applied to the Jitsi.
      */
-    public static final int VERSION_MINOR = 2;
+    public static final int VERSION_MINOR = 3;
 
     /**
      * The version minor field. Default value is VERSION_MINOR.

File: src/net/java/sip/communicator/impl/credentialsstorage/AESCrypto.java
Patch:
@@ -165,7 +165,8 @@ public String decrypt(String ciphertext) throws CryptoException
         try
         {
             decryptCipher.init(Cipher.DECRYPT_MODE, key);
-            return new String(decryptCipher.doFinal(Base64.decode(ciphertext)));
+            return new String(decryptCipher.doFinal(Base64.decode(ciphertext)),
+                "UTF-8");
         }
         catch (BadPaddingException e)
         {

File: src/net/java/sip/communicator/plugin/addrbook/macosx/MacOSXAddrBookContactQuery.java
Patch:
@@ -1204,6 +1204,7 @@ private ContactDetail setCapabilities(
                     ProtocolNames.AIM);
             break;
         case kABEmailProperty:
+            supportedOpSets.add(OperationSetBasicTelephony.class);
             break;
         case kABICQInstantProperty:
             supportedOpSets.add(OperationSetBasicInstantMessaging.class);

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceInviteDialog.java
Patch:
@@ -302,7 +302,7 @@ public void actionPerformed(ActionEvent e)
                             .getSelectedItem());
 
                     if (isVideoBridge)
-                        destContactList.applyDefaultFilter();
+                        destContactList.removeAll();
                 }
             }
         });

File: src/net/java/sip/communicator/impl/gui/utils/InviteDialog.java
Patch:
@@ -404,6 +404,7 @@ private Component createDestContactListComponent()
         destContactList
             = GuiActivator.getUIService().createContactListComponent(this);
 
+        destContactList.removeAllContactSources();
         destContactList.setContactButtonsVisible(false);
         destContactList.setRightButtonMenuEnabled(false);
         destContactList.setMultipleSelectionEnabled(true);

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetVideoTelephonySipImpl.java
Patch:
@@ -127,7 +127,7 @@ public Call createVideoCall(String uri)
     public Call createVideoCall(Contact callee)
         throws OperationFailedException
     {
-        return createVideoCall(callee, (ContactResource) null);
+        return createVideoCall(callee, null);
     }
 
     /**
@@ -378,4 +378,4 @@ public boolean processResponse(ResponseEvent responseEvent)
             return true;
         }
     }
-}
+}
\ No newline at end of file

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -160,7 +160,8 @@ public void modifyAccount(ProtocolProviderService protocolProvider)
     public AccountRegistrationWizard getProtocolWizard(
                                     ProtocolProviderService protocolProvider)
     {
-        AccountRegistrationWizard res = registeredWizards.get(protocolProvider.getProtocolDisplayName());
+        AccountRegistrationWizard res
+            = registeredWizards.get(protocolProvider.getProtocolDisplayName());
 
         // compatibility check, some protocols have changed name
         // and when they have those name saved in configuration

File: src/net/java/sip/communicator/plugin/otr/OtrContactMenu.java
Patch:
@@ -217,7 +217,8 @@ public void globalPolicyChanged()
      */
     private void buildMenu()
     {
-        separateMenu.removeAll();
+        if(separateMenu != null)
+            separateMenu.removeAll();
 
         OtrPolicy policy = OtrActivator.scOtrEngine.getContactPolicy(contact);
 

File: src/net/java/sip/communicator/plugin/otr/OtrContactMenu.java
Patch:
@@ -217,6 +217,8 @@ public void globalPolicyChanged()
      */
     private void buildMenu()
     {
+        separateMenu.removeAll();
+
         OtrPolicy policy = OtrActivator.scOtrEngine.getContactPolicy(contact);
 
         JMenuItem endOtr = new JMenuItem();

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/MessageWindowMenuBar.java
Patch:
@@ -116,6 +116,7 @@ public void dispose()
     {
         pluginContainer.dispose();
         helpMenu.dispose();
+        optionsMenu.dispose();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/ProtocolContactSourceServiceImpl.java
Patch:
@@ -224,9 +224,9 @@ private void addResultContact(MetaContact metaContact)
 
                 if (queryString == null
                     || queryString.length() <= 0
-                    || metaContact.getDisplayName().startsWith(queryString)
-                    || contactAddress.startsWith(queryString)
-                    || contactDisplayName.startsWith(queryString))
+                    || metaContact.getDisplayName().contains(queryString)
+                    || contactAddress.contains(queryString)
+                    || contactDisplayName.contains(queryString))
                 {
                     ContactDetail contactDetail
                         = new ContactDetail(contactAddress);

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetServerStoredContactInfoIcqImpl.java
Patch:
@@ -115,10 +115,10 @@ public Iterator<GenericDetail> getDetails(
     public Iterator<GenericDetail> getAllDetailsForContact(Contact contact)
     {
         assertConnected();
-        
+
         List<GenericDetail> res
             = infoRetreiver.getContactDetails(contact.getAddress());
-        
+
         if(contact.getImage() != null)
         {
             res.add(new ServerStoredDetails.ImageDetail(

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -2240,7 +2240,7 @@ public void run()
                         GuiActivator.getResources().getI18NString(
                                 "service.gui.ERROR"),
                         e.getMessage(),
-                        ErrorDialog.ERROR)
+                        e)
                     .showDialog();
             }
         }

File: src/net/java/sip/communicator/plugin/demuxcontactsource/DemuxContactSource.java
Patch:
@@ -309,7 +309,7 @@ private SourceContact createSourceContact(  SourceContact sourceContact,
                                                 sourceContact.getDisplayName(),
                                                 contactDetails);
 
-            genericContact.setDisplayDetails(contactDetail.getDetail());
+            genericContact.setDisplayDetails(sourceContact.getDisplayDetails());
             genericContact.setPresenceStatus(sourceContact.getPresenceStatus());
             genericContact.setImage(sourceContact.getImage());
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -472,7 +472,7 @@ else if (di != null)
             else
             {
                 ProtocolProviderServiceJabberImpl.throwOperationFailedException(
-                        "Failed to create a call",
+                        "Failed to create a call to " + fullCalleeURI,
                         OperationFailedException.INTERNAL_ERROR,
                         t,
                         logger);

File: src/net/java/sip/communicator/service/protocol/media/MediaHandler.java
Patch:
@@ -909,7 +909,8 @@ MediaStream initStream(
         }
         else
         {
-            // this is a reinit
+            if (logger.isDebugEnabled())
+                logger.debug("Reinitializing stream: " + stream);
         }
 
         return

File: src/net/java/sip/communicator/util/NetworkUtils.java
Patch:
@@ -720,7 +720,7 @@ public int compare(String array1[], String array2[])
                 // Second tries to define the priority with the NAPTR
                 // preference.
                 int preference
-                    = Integer.parseInt(array1[4]) - Integer.parseInt(array2[4]);
+                    = Integer.parseInt(array1[3]) - Integer.parseInt(array2[3]);
                 if(preference != 0)
                 {
                     return preference;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -17,7 +17,6 @@
 import javax.swing.tree.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.contactsource.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.notifsource.*;
 import net.java.sip.communicator.impl.gui.utils.*;
@@ -996,6 +995,7 @@ public void run()
     public void setDefaultFilter(ContactListFilter filter)
     {
         this.defaultFilter = filter;
+        this.currentFilter = defaultFilter;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -89,7 +89,7 @@ public ContactListPane(MainFrame mainFrame)
      */
     public void initList(MetaContactListService contactListService)
     {
-        this.contactList = new TreeContactList();
+        this.contactList = new TreeContactList(mainFrame);
         // We should first set the contact list to the GuiActivator, so that
         // anybody could get it from there.
         GuiActivator.setContactList(contactList);

File: src/net/java/sip/communicator/service/gui/UIService.java
Patch:
@@ -459,9 +459,11 @@ public SecurityAuthority getDefaultSecurityAuthority(
     /**
      * Creates a contact list component.
      *
+     * @param clContainer the parent contact list container
      * @return the created <tt>ContactList</tt>
      */
-    public ContactList createContactListComponent();
+    public ContactList createContactListComponent(
+        ContactListContainer clContainer);
 
     /**
      * Returns a collection of all currently in progress calls.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -2319,7 +2319,7 @@ public void valueChanged(TreeSelectionEvent e)
             if (selectedContact != null)
             {
                 fireContactListEvent(
-                    selectedContact, ContactListEvent.GROUP_SELECTED, 0);
+                    selectedContact, ContactListEvent.CONTACT_SELECTED, 0);
             }
         }
     }

File: src/net/java/sip/communicator/plugin/notificationconfiguration/NotificationsTable.java
Patch:
@@ -266,7 +266,6 @@ public int getRowCount()
     public void setSelectedRow(int row)
     {
         notifTable.setRowSelectionInterval(row, row);
-        configPanel.setNotificationEntry(getNotificationEntry(row));
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/ExternalContactSource.java
Patch:
@@ -63,7 +63,7 @@ public class ExternalContactSource
     /**
      * The list of action buttons for this source service.
      */
-    private static Map<ContactAction<ContactSourceService>, SIPCommButton>
+    private Map<ContactAction<ContactSourceService>, SIPCommButton>
                                     customServiceActionButtons;
 
     private final JTree contactListTree;

File: src/net/java/sip/communicator/impl/protocol/sip/sdp/SdpUtils.java
Patch:
@@ -166,7 +166,7 @@ public static SessionDescription createSessionDescription(
 
             //o
             if (userName == null)
-                userName = "sip-communicator";
+                userName = "jitsi.org";
 
             Origin o = sdpFactory.createOrigin(
                 userName, 0, 0, "IN", addrType, localAddress.getHostAddress());

File: src/net/java/sip/communicator/impl/globalshortcut/NativeKeyboardHookDelegate.java
Patch:
@@ -39,6 +39,7 @@ public interface NativeKeyboardHookDelegate
      *
      * @param keycode keycode received
      * @param modifiers modifiers received (ALT or CTRL + letter, ...)
+     * @param onRelease this parameter is true if the shortcut is released
      */
-    public void receiveKey(int keycode, int modifiers);
+    public void receiveKey(int keycode, int modifiers, boolean onRelease);
 }

File: src/net/java/sip/communicator/impl/keybindings/KeybindingsServiceImpl.java
Patch:
@@ -338,7 +338,7 @@ public Map<String, List<AWTKeyStroke>> getGlobalShortcutFromConfiguration()
         String propName = null;
         String propName2 = null;
         String names[] = new String[]{"answer", "hangup", "answer_hangup",
-            "contactlist", "mute"};
+            "contactlist", "mute", "push_to_talk"};
         Object configured = configService.getProperty(
             "net.java.sip.communicator.impl.keybinding.global.configured");
 
@@ -396,7 +396,6 @@ public Map<String, List<AWTKeyStroke>> getGlobalShortcutFromConfiguration()
             }
             gBindings.put(name, kss);
         }
-
         return gBindings;
     }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/ExternalContactSource.java
Patch:
@@ -236,9 +236,9 @@ private void initActionButton(final ContactAction<SourceContact> ca)
 
             actionButton.setIconImage(
                 new ImageIcon(ca.getIcon()).getImage());
-            actionButton.setRolloverImage(
+            actionButton.setRolloverIcon(
                 new ImageIcon(ca.getRolloverIcon()).getImage());
-            actionButton.setPressedImage(
+            actionButton.setPressedIcon(
                 new ImageIcon(ca.getPressedIcon()).getImage());
 
             actionButton.addActionListener(new ActionListener()

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaContactListSource.java
Patch:
@@ -707,7 +707,7 @@ public void run()
 
             ContactListFilter currentFilter
                 = GuiActivator.getContactList().getCurrentFilter();
-    
+
             if (currentFilter.isMatching(uiContact))
                 GuiActivator.getContactList()
                     .addContact(uiContact, newUIGroup, true, true);
@@ -1052,9 +1052,9 @@ private static void initCustomActionButtons()
 
                     actionButton.setIconImage(
                         new ImageIcon(ca.getIcon()).getImage());
-                    actionButton.setRolloverImage(
+                    actionButton.setRolloverIcon(
                         new ImageIcon(ca.getRolloverIcon()).getImage());
-                    actionButton.setPressedImage(
+                    actionButton.setPressedIcon(
                         new ImageIcon(ca.getPressedIcon()).getImage());
 
                     actionButton.addActionListener(new ActionListener()

File: src/net/java/sip/communicator/impl/gui/main/contactlist/notifsource/NotificationContactSource.java
Patch:
@@ -234,9 +234,9 @@ private static void initCustomActionButtons()
 
                     actionButton.setIconImage(
                         new ImageIcon(ca.getIcon()).getImage());
-                    actionButton.setRolloverImage(
+                    actionButton.setRolloverIcon(
                         new ImageIcon(ca.getRolloverIcon()).getImage());
-                    actionButton.setPressedImage(
+                    actionButton.setPressedIcon(
                         new ImageIcon(ca.getPressedIcon()).getImage());
 
                     actionButton.addActionListener(new ActionListener()

File: src/net/java/sip/communicator/impl/gui/main/call/UIVideoHandler2.java
Patch:
@@ -185,8 +185,8 @@ protected void localVideoStreamingPropertyChange(PropertyChangeEvent ev)
     /**
      * {@inheritDoc}
      *
-     * Overrides {@link Observer#notifyObservers(Object)} to force the super to
-     * notify the added <tt>Observer</tt>s regardless of the <tt>changed</tt>
+     * Overrides {@link Observable#notifyObservers(Object)} to force the super
+     * to notify the added <tt>Observer</tt>s regardless of the <tt>changed</tt>
      * state of this <tt>Observable</tt> which <tt>UIVideoHandler2</tt> does not
      * use at the time of this writing.
      */

File: src/net/java/sip/communicator/impl/gui/main/call/conference/VideoConferenceCallPanel.java
Patch:
@@ -583,6 +583,9 @@ else if (cmcParticipant == conferenceMember)
         }
     }
 
+    /**
+     * {@inheritDoc}
+     */
     protected ConferenceCallPeerRenderer updateViewFromModel(
             ConferenceCallPeerRenderer callPeerPanel,
             CallPeer callPeer)

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -166,6 +166,8 @@ private synchronized CallSipImpl createOutgoingCall(
         throws OperationFailedException
     {
         CallSipImpl call = createOutgoingCall();
+        if (logger.isInfoEnabled())
+            logger.info("Creating outgoing call to " + calleeAddress);
 
         if (conference != null)
             call.setConference(conference);

File: src/net/java/sip/communicator/service/protocol/CallConference.java
Patch:
@@ -49,7 +49,7 @@ public class CallConference
      * telephony conference-related state
      * @return the number of <tt>CallPeer</tt>s associated with the
      * <tt>Call</tt>s participating in the telephony conference-related state
-     * of the specified <tt>call</tt>
+     * of the specified <tt>Call</tt>
      */
     public static int getCallPeerCount(Call call)
     {
@@ -199,7 +199,7 @@ protected void onCallPeerConferenceEvent(CallPeerConferenceEvent ev)
      * The list of <tt>CallPeerConferenceListener</tt>s added to the
      * <tt>CallPeer</tt>s associated with the <tt>CallPeer</tt>s participating
      * in this telephony conference via
-     * {@link #addCallPeerConferenceListener</tt>}.
+     * {@link #addCallPeerConferenceListener}.
      */
     private final List<CallPeerConferenceListener> callPeerConferenceListeners
         = new LinkedList<CallPeerConferenceListener>();

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCall.java
Patch:
@@ -155,7 +155,7 @@ protected void addCallPeer(T callPeer)
      * Removes <tt>callPeer</tt> from the list of peers in this call. The method
      * has no effect if there was no such peer in the call.
      *
-     * @param ev the event containing the <tt>CallPeer</tt> leaving the call and
+     * @param evt the event containing the <tt>CallPeer</tt> leaving the call and
      * the reason (if any) for the <tt>CallPeerChangeEvent</tt>. Use the event
      * as the cause for the call state change event.
      */

File: src/net/java/sip/communicator/service/protocol/media/MediaHandler.java
Patch:
@@ -1327,11 +1327,11 @@ private void setLocalSSRC(MediaType mediaType, long localSSRC)
     }
 
     /**
-     * Sets the last-known local SSRC of the <tt>MediaStream</tt> of a specific
+     * Sets the last-known remote SSRC of the <tt>MediaStream</tt> of a specific
      * <tt>MediaType</tt>.
      *
      * @param mediaType the <tt>MediaType</tt> of the <tt>MediaStream</tt> to
-     * set the last-known local SSRC of
+     * set the last-known remote SSRC of
      * @param remoteSSRC the last-known remote SSRC of the <tt>MediaStream</tt>
      * of the specified <tt>mediaType</tt>
      */

File: src/net/java/sip/communicator/impl/contactlist/MetaContactImpl.java
Patch:
@@ -941,7 +941,7 @@ public void addDetail(String name, String value)
 
         List<String> values = details.get(name);
 
-        if(values == null)
+        if (values == null)
         {
             values = new ArrayList<String>();
             details.put(name, values);
@@ -963,7 +963,7 @@ public void removeDetail(String name, String value)
             return;
 
         List<String> values = details.get(name);
-        if(values == null)
+        if (values == null)
             return;
 
         values.remove(value);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GroupNode.java
Patch:
@@ -40,7 +40,7 @@ public class GroupNode
     /**
      * The corresponding <tt>UIGroup</tt>.
      */
-    private final UIGroupImpl group;
+    private final UIGroup group;
 
     /**
      * The <tt>ContactListNode</tt> <tt>Comparator</tt> used to sort the list of

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetVideoBridgeImpl.java
Patch:
@@ -189,9 +189,9 @@ private void processColibriConferenceIQ(ColibriConferenceIQ conferenceIQ)
                              * the conferenceIQ from reaching the CallJabberImpl
                              * instance which it was meant for.
                              */
-                            callJabberImpl.processColibriConferenceIQ(
-                                    conferenceIQ);
-                            break;
+                            if (callJabberImpl.processColibriConferenceIQ(
+                                    conferenceIQ))
+                                break;
                         }
                     }
                 }

File: src/net/java/sip/communicator/impl/protocol/jabber/RawUdpTransportManager.java
Patch:
@@ -65,6 +65,8 @@ public RawUdpTransportManager(CallPeerJabberImpl callPeer)
      * Closes a specific <tt>StreamConnector</tt> associated with a specific
      * <tt>MediaType</tt>. If this <tt>TransportManager</tt> has a reference to
      * the specified <tt>streamConnector</tt>, it remains.
+     * Also expires the <tt>ColibriConferenceIQ.Channel</tt> associated with
+     * the closed <tt>StreamConnector</tt>.
      *
      * @param mediaType the <tt>MediaType</tt> associated with the specified
      * <tt>streamConnector</tt>

File: src/net/java/sip/communicator/impl/protocol/jabber/TransportManagerJabberImpl.java
Patch:
@@ -312,5 +312,7 @@ protected ContentPacketExtension removeContent(
      */
     public void close()
     {
+        for (MediaType mediaType : MediaType.values())
+            closeStreamConnector(mediaType);
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -122,7 +122,8 @@ public HistoryWindow(Object historyContact)
         this.historyContact = historyContact;
 
         chatConvPanel = new ChatConversationPanel(this);
-
+        chatConvPanel.getChatTextPane()
+            .setTransferHandler(new ExtendedTransferHandler());
         this.progressBar = new JProgressBar(
             HistorySearchProgressListener.PROGRESS_MINIMUM_VALUE,
             HistorySearchProgressListener.PROGRESS_MAXIMUM_VALUE);

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -1578,7 +1578,7 @@ else if (ev instanceof PropertyChangeEvent)
                 PropertyChangeEvent pcev = (PropertyChangeEvent) ev;
 
                 tryStopCallTimer
-                    = (CallConference.CALLS.equals(pcev)
+                    = (CallConference.CALLS.equals(pcev.getPropertyName())
                             && (pcev.getOldValue() instanceof Call)
                             && (pcev.getNewValue() == null));
             }

File: src/net/java/sip/communicator/impl/gui/utils/PluginContainer.java
Patch:
@@ -111,7 +111,7 @@ protected void addComponentToContainer(
     private synchronized void addPluginComponent(PluginComponent c)
     {
         if (logger.isInfoEnabled())
-            logger.info("Will add following plugin component: " + c);
+            logger.info("Will add plugin component: " + c);
 
         /*
          * Try to respect positionIndex of PluginComponent to some extent:

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetVideoBridgeImpl.java
Patch:
@@ -190,7 +190,7 @@ private void processColibriConferenceIQ(ColibriConferenceIQ conferenceIQ)
                              * instance which it was meant for.
                              */
                             callJabberImpl.processColibriConferenceIQ(
-                                conferenceIQ);
+                                    conferenceIQ);
                             break;
                         }
                     }

File: src/net/java/sip/communicator/impl/protocol/jabber/RawUdpTransportManager.java
Patch:
@@ -533,7 +533,7 @@ public void startCandidateHarvest(
                         mediaTypes.add(rtpDesc);
                 }
             }
-            if (mediaTypes.size() != 0)
+            if (!mediaTypes.isEmpty())
             {
                 /*
                  * We are about to request the channel allocations for

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCallPeer.java
Patch:
@@ -589,7 +589,7 @@ public V getProtocolProvider()
      * telephony conference organized by the local user/peer utilizing the Jitsi
      * VideoBridge server-side technology; otherwise, <tt>false</tt>
      */
-    private boolean isJitsiVideoBridge()
+    public final boolean isJitsiVideoBridge()
     {
         Call call = getCall();
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -463,8 +463,6 @@ else if (messageType.equals(Chat.OUTGOING_MESSAGE))
         }
         else if (messageType.equals(Chat.HISTORY_INCOMING_MESSAGE))
         {
-            this.lastIncomingMsgTimestamp = System.currentTimeMillis();
-
             chatString = ChatHtmlUtils.createIncomingMessageTag(
                 lastMessageUID,
                 contactName,

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetVideoBridgeImpl.java
Patch:
@@ -61,7 +61,7 @@ public OperationSetVideoBridgeImpl(
      * Implements {@link PacketFilter}. Determines whether this instance is
      * interested in a specific {@link Packet}.
      * <tt>OperationSetVideoBridgeImpl</tt> returns <tt>true</tt> if the
-     * specified <tt>packet</tt> is a {@link net.java.sip.communicator.impl.protocol.jabber.extensions.colibri.ColibriConferenceIQ}; otherwise,
+     * specified <tt>packet</tt> is a {@link ColibriConferenceIQ}; otherwise,
      * <tt>false</tt>. 
      *
      * @param packet the <tt>Packet</tt> to be determined whether this instance
@@ -262,7 +262,7 @@ else if (t instanceof ThreadDeath)
      * Implements {@link RegistrationStateChangeListener}. Notifies this
      * instance that there has been a change in the <tt>RegistrationState</tt>
      * of {@link #protocolProvider}. Subscribes this instance to
-     * {@link net.java.sip.communicator.impl.protocol.jabber.extensions.colibri.ColibriConferenceIQ}s as soon as <tt>protocolProvider</tt> is
+     * {@link ColibriConferenceIQ}s as soon as <tt>protocolProvider</tt> is
      * registered and unsubscribes it as soon as <tt>protocolProvider</tt> is
      * unregistered.
      */

File: src/net/java/sip/communicator/impl/protocol/jabber/RawUdpTransportManager.java
Patch:
@@ -325,7 +325,7 @@ public MediaStreamTarget getStreamTarget(MediaType mediaType)
                                             channel.getRTPPort()),
                                     new InetSocketAddress(
                                             channel.getHost(),
-                                            channel.getRTPPort()));
+                                            channel.getRTCPPort()));
                     }
 
                     break;
@@ -336,7 +336,7 @@ public MediaStreamTarget getStreamTarget(MediaType mediaType)
     }
 
     /**
-     * Gets the {@link net.java.sip.communicator.impl.protocol.jabber.extensions.colibri.ColibriConferenceIQ.Channel} which belongs to a content
+     * Gets the {@link ColibriConferenceIQ.Channel} which belongs to a content
      * associated with a specific <tt>MediaType</tt> and is to be either locally
      * or remotely used.
      * <p>

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/CandidatePacketExtension.java
Patch:
@@ -30,7 +30,7 @@ public class CandidatePacketExtension extends AbstractPacketExtension
     public static final int RTP_COMPONENT_ID = 1;
 
     /**
-     * The "component" ID for RTP components.
+     * The "component" ID for RTCP components.
      */
     public static final int RTCP_COMPONENT_ID = 2;
 

File: src/net/java/sip/communicator/plugin/addrbook/msoutlook/MsOutlookAddrBookContactSourceService.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.plugin.addrbook.msoutlook;
 
-import java.util.*;
 import java.util.regex.*;
 
 import net.java.sip.communicator.plugin.addrbook.*;

File: src/net/java/sip/communicator/plugin/desktoputil/ErrorDialog.java
Patch:
@@ -191,7 +191,7 @@ public ErrorDialog( Frame owner,
     {
         this(owner, title, message);
 
-        if (showStackTrace)
+        if (showStackTrace && e != null)
         {
             this.setTitle(title);
 

File: src/net/java/sip/communicator/impl/globalshortcut/GlobalShortcutActivator.java
Patch:
@@ -142,7 +142,7 @@ public void stop(BundleContext bundleContext)
                 logger.debug("GlobalShortcut Service ... [UNREGISTERED]");
         }
 
-        bundleContext = null;
+        GlobalShortcutActivator.bundleContext = null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -1482,8 +1482,7 @@ private void reloadComponents(java.awt.Container container)
                     if (jpm instanceof Skinnable)
                         ((Skinnable) jpm).loadSkin();
 
-                    if (jpm instanceof java.awt.Container)
-                        reloadComponents((java.awt.Container) jpm);
+                    reloadComponents(jpm);
                 }
             }
 

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceCallPanel.java
Patch:
@@ -362,11 +362,11 @@ protected void updateViewFromModel(CallPeer callPeer)
         ConferenceCallPeerRenderer newCallPeerPanel
             = updateViewFromModel(oldCallPeerPanel, callPeer);
 
-        if (newCallPeerPanel != oldCallPeerPanel)
+        if (oldCallPeerPanel != newCallPeerPanel)
         {
             if (oldCallPeerPanel != null)
             {
-                callPeerPanels.remove(oldCallPeerPanel);
+                callPeerPanels.remove(callPeer);
                 try
                 {
                     viewForModelRemoved(oldCallPeerPanel, callPeer);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -1417,18 +1417,18 @@ private class MetaContactChatCreateRunnable
         /**
          * The source meta contact.
          */
-        private MetaContact metaContact;
+        private final MetaContact metaContact;
 
         /**
          * The protocol contact used for creating chat panel.
          */
-        private Contact protocolContact;
+        private final Contact protocolContact;
 
         /**
          * The message ID of the message to be excluded from
          * newly created chat panel.
          */
-        private String escapedMessageID;
+        private final String escapedMessageID;
 
         /**
          * Creates chat.

File: src/net/java/sip/communicator/impl/gui/main/chat/history/DatesListRenderer.java
Patch:
@@ -29,8 +29,6 @@ public class DatesListRenderer
     private JLabel label = new JLabel();
     private boolean isSelected;
 
-    private Calendar calendar = Calendar.getInstance();
-
     public DatesListRenderer()
     {
         super(new BorderLayout());

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaContactListSource.java
Patch:
@@ -66,7 +66,7 @@ public class MetaContactListSource
      * The initial result count below which we insert all filter results
      * directly to the contact list without firing events.
      */
-    private final int INITIAL_CONTACT_COUNT = 30;
+    private static final int INITIAL_CONTACT_COUNT = 30;
 
     /**
      * The list of action buttons for this meta contact.

File: src/net/java/sip/communicator/impl/gui/main/menus/FileMenu.java
Patch:
@@ -15,7 +15,6 @@
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.account.*;
 import net.java.sip.communicator.impl.gui.main.chatroomslist.*;
-import net.java.sip.communicator.impl.gui.main.configforms.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.addgroup.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/ldap/LdapPersonFoundImpl.java
Patch:
@@ -92,7 +92,7 @@ public class LdapPersonFoundImpl
     public LdapPersonFoundImpl(LdapDirectoryImpl server, String dn,
             LdapQuery query)
     {
-        if(server == null | query == null | dn==null)
+        if(server == null || query == null || dn == null)
             throw new NullPointerException();
         this.server = server;
         this.query = query;

File: src/net/java/sip/communicator/impl/packetlogging/PacketLoggingServiceImpl.java
Patch:
@@ -650,7 +650,7 @@ private int computeChecksum(byte[] data)
     /**
      * The data we receive and that we will dump in a file.
      */
-    private class Packet
+    private static class Packet
     {
         /**
          * The protocol logging this packet.

File: src/net/java/sip/communicator/impl/protocol/dict/OperationSetPersistentPresenceDictImpl.java
Patch:
@@ -523,7 +523,7 @@ public void subscribe(ContactGroup parent, String contactIdentifier) throws
      * act upon the request, and return the response.
      *
      * @param request the authorization request that we'd like to deliver to the
-     * desination <tt>contact</tt>.
+     * destination <tt>contact</tt>.
      * @param contact the <tt>Contact</tt> to notify
      *
      * @return the <tt>AuthorizationResponse</tt> that has been given or

File: src/net/java/sip/communicator/impl/protocol/icq/AdHocChatRoomIcqImpl.java
Patch:
@@ -79,9 +79,9 @@ public class AdHocChatRoomIcqImpl
      */
     private static final String HTML_MIME_TYPE = "text/html";
 
-    private final String defaultHtmlStartTag = "<HTML>";
+    private static final String defaultHtmlStartTag = "<HTML>";
 
-    private final String defaultHtmlEndTag = "</HTML>";
+    private static final String defaultHtmlEndTag = "</HTML>";
 
     /**
      * Chat room name.

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -550,9 +550,9 @@ void reregister(int authReasonCode)
             {
                 // Checks if an error has occurred during login, if so we fire
                 // it here in order to avoid a deadlock which occurs in
-                // reconnect plugin. The deadlock is cause we fired an event during
-                // login process and have locked initializationLock and we cannot
-                // unregister from reconnect, cause unregister method
+                // reconnect plugin. The deadlock is cause we fired an event
+                // during login process and have locked initializationLock and
+                // we cannot unregister from reconnect, cause unregister method
                 // also needs this lock.
                 if(eventDuringLogin != null)
                 {

File: src/net/java/sip/communicator/impl/protocol/jabber/ScServiceDiscoveryManager.java
Patch:
@@ -209,7 +209,7 @@ private void updateEntityCapsVersion()
     {
         // If a XMPPConnection is the managed one, see that the new version is
         // updated
-        if ((connection instanceof XMPPConnection) && (capsManager != null))
+        if ((connection != null) && (capsManager != null))
             capsManager.calculateEntityCapsVersion(getOwnDiscoverInfo());
     }
 

File: src/net/java/sip/communicator/impl/protocol/mock/MockBasicInstantMessaging.java
Patch:
@@ -22,12 +22,12 @@ public class MockBasicInstantMessaging
     /**
      * The currently valid persistent presence operation set..
      */
-    private MockPersistentPresenceOperationSet opSetPersPresence = null;
+    private final MockPersistentPresenceOperationSet opSetPersPresence;
 
     /**
      * The protocol provider that created us.
      */
-    private MockProvider parentProvider = null;
+    private final MockProvider parentProvider;
 
     /**
      * Creates an instance of this operation set keeping a reference to the

File: src/net/java/sip/communicator/impl/protocol/mock/MockOperationSetFileTransfer.java
Patch:
@@ -13,7 +13,7 @@
 import net.java.sip.communicator.service.protocol.event.*;
 
 /**
- * A mock implementation of a basic telephony opearation set
+ * A mock implementation of a basic telephony operation set
  *
  * @author Damian Minkov
  */
@@ -24,14 +24,14 @@ public class MockOperationSetFileTransfer
     /**
      * A list of listeners registered for file transfer events.
      */
-    private Vector<FileTransferListener> fileTransferListeners
+    private final Vector<FileTransferListener> fileTransferListeners
         = new Vector<FileTransferListener>();
 
     /**
      * A reference to the <tt>ProtocolProviderServiceSipImpl</tt> instance
      * that created us.
      */
-    private MockProvider protocolProvider = null;
+    private final MockProvider protocolProvider;
 
     public MockOperationSetFileTransfer(MockProvider protocolProvider)
     {

File: src/net/java/sip/communicator/impl/protocol/rss/OperationSetBasicInstantMessagingRssImpl.java
Patch:
@@ -46,15 +46,15 @@ public class OperationSetBasicInstantMessagingRssImpl
      * The value corresponding to the time in ms
      * of the RSS refreshing period (here 5min)
      */
-    private final int PERIOD_REFRESH_RSS = 300000;
+    private static final int PERIOD_REFRESH_RSS = 300000;
 
     /**
      * The value corresponding to the time in ms that we wait before the
      * initial refresh RSS when starting the application. Ideally this should
      * be less than <tt>PERIOD_REFRESH_RSS</tt> but more than a minute in order
      * to prevent from overloading the system on startup.
      */
-    private final int INITIAL_RSS_LOAD_DELAY = 150000;
+    private static final int INITIAL_RSS_LOAD_DELAY = 150000;
 
     /**
      * The localised message that we should show to the user before we remove

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -228,7 +228,7 @@ private static enum WatcherStatus
         private final String value;
 
         /**
-         * Creates <>tt WatcherStatus</tt>
+         * Creates <tt>WatcherStatus</tt>
          * @param v value.
          */
         WatcherStatus(String v)

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetTypingNotificationsSipImpl.java
Patch:
@@ -56,12 +56,12 @@ public class OperationSetTypingNotificationsSipImpl
     /**
      * The content type of the sent message.
      */
-    private final String CONTENT_TYPE = "application/im-iscomposing+xml";
+    private static final String CONTENT_TYPE = "application/im-iscomposing+xml";
 
     /**
      * The subtype of the message.
      */
-    private final String CONTENT_SUBTYPE = "im-iscomposing+xml";
+    private static final String CONTENT_SUBTYPE = "im-iscomposing+xml";
 
     // isComposing elements and attributes
     /**

File: src/net/java/sip/communicator/impl/protocol/yahoo/ContactYahooImpl.java
Patch:
@@ -204,9 +204,8 @@ public byte[] getImage(boolean retrieveIfNecessary)
      */
     protected void setImage(byte[] image)
     {
-        if(logger.isDebugEnabled())
-            if (logger.isInfoEnabled())
-                logger.info("setting image " + image);
+        if (logger.isInfoEnabled())
+            logger.info("setting image " + image);
 
         this.image = image;
     }

File: src/net/java/sip/communicator/impl/protocol/yahoo/YahooActivator.java
Patch:
@@ -43,7 +43,8 @@ public class YahooActivator
      */
     public void start(BundleContext context) throws Exception
     {
-        this.bundleContext = context;
+        bundleContext = context;
+
         Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.YAHOO);
 

File: src/net/java/sip/communicator/impl/protocol/zeroconf/OperationSetBasicInstantMessagingZeroconfImpl.java
Patch:
@@ -27,12 +27,12 @@ public class OperationSetBasicInstantMessagingZeroconfImpl
     /**
      * The currently valid persistent presence operation set..
      */
-    private OperationSetPersistentPresenceZeroconfImpl opSetPersPresence = null;
+    private final OperationSetPersistentPresenceZeroconfImpl opSetPersPresence;
 
     /**
      * The protocol provider that created us.
      */
-    private ProtocolProviderServiceZeroconfImpl parentProvider = null;
+    private final ProtocolProviderServiceZeroconfImpl parentProvider;
 
     /**
      * Creates an instance of this operation set keeping a reference to the

File: src/net/java/sip/communicator/impl/protocol/zeroconf/jmdns/DNSCache.java
Patch:
@@ -78,7 +78,6 @@ class DNSCache
      */
     public static class CacheNode
     {
-        private static Logger logger = Logger.getLogger(CacheNode.class.toString());
         private DNSEntry value;
         private CacheNode next;
 

File: src/net/java/sip/communicator/impl/sparkle/SparkleActivator.java
Patch:
@@ -137,7 +137,7 @@ public void start(BundleContext bundleContext) throws Exception
      */
     public void stop(BundleContext bundleContext) throws Exception
     {
-        bundleContext = null;
+        SparkleActivator.bundleContext = null;
         if (logger.isInfoEnabled())
             logger.info("Sparkle Plugin ...[Stopped]");
     }

File: src/net/java/sip/communicator/util/GuiUtils.java
Patch:
@@ -42,9 +42,9 @@ public class GuiUtils
      */
     public static final long MILLIS_PER_DAY = 24 * MILLIS_PER_HOUR;
 
-    // These mappings map a character (key) to a specific digit that should replace it for
-    // normalization purposes. Non-European digits that may be used in phone numbers are mapped to a
-    // European equivalent.
+    // These mappings map a character (key) to a specific digit that should
+    // replace it for normalization purposes. Non-European digits that may be
+    // used in phone numbers are mapped to a European equivalent.
     private static final Map<Character, Character> DIGIT_MAPPINGS;
 
     /**

File: test/net/java/sip/communicator/slick/netaddr/TestNetworkAddressManagerService.java
Patch:
@@ -140,8 +140,8 @@ public void testDummyTest()
     }
 
     /**
-     * This test will specify all local address one by one as "prefered address"
-     * and  test the returned address.
+     * This test will specify all local address one by one as "preferred
+     * address" and  test the returned address.
      *
      * @throws java.lang.Exception if anything goes wrong.
      */
@@ -272,7 +272,7 @@ public void testBadStun() throws Exception
 */
 
     /**
-     * Set the configuration to IPv4 pref if the network is not behind a nat
+     * Set the configuration to IPv4 pref if the network is not behind a NAT
      * if not it does nothing
      * and watch if the result of "NetworkAddressManagerService.getlocalhost()
      * is a valid (public) IPv4 address

File: test/net/java/sip/communicator/slick/protocol/gibberish/TestOperationSetPersistentPresence.java
Patch:
@@ -564,9 +564,9 @@ private class SubscriptionEventCollector implements SubscriptionListener
 
         /**
          * Blocks until at least one event is received or until waitFor
-         * miliseconds pass (whicever happens first).
+         * milliseconds pass (whichever happens first).
          *
-         * @param waitFor the number of miliseconds that we should be waiting
+         * @param waitFor the number of milliseconds that we should be waiting
          * for an event before simply bailing out.
          */
         public void waitForEvent(long waitFor)

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetMultiUserChat.java
Patch:
@@ -330,8 +330,8 @@ private class ParticipantStatusEventCollector
         public void memberPresenceChanged(
                         ChatRoomMemberPresenceChangeEvent evt)
         {
-            synchronized(this)
-            {
+//            synchronized(this)
+//            {
 //                logger.debug(
 //                    "Collected evt("+collectedEvents.size()+")= "+event);
 //
@@ -340,7 +340,7 @@ public void memberPresenceChanged(
 //                    this.collectedEvents.add(event);
 //                    notifyAll();
 //                }
-            }
+//            }
         }
 
 

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestOperationSetPresence.java
Patch:
@@ -930,7 +930,7 @@ public AuthorizationResponse processAuthorisationRequest(
 //            try{
 //                opset.subscribe(sourceContact.getAddress());
 //            }catch(Exception ex){}
-            
+
             return
                 new AuthorizationResponse(AuthorizationResponse.ACCEPT, "");
         }

File: src/net/java/sip/communicator/impl/protocol/icq/IncomingFileTransferRequestIcqImpl.java
Patch:
@@ -16,7 +16,6 @@
 import net.kano.joscar.rvcmd.*;
 import net.kano.joustsim.oscar.oscar.service.icbm.ft.*;
 
-
 /**
  * Icq implementation of the incoming file transfer request
  *
@@ -40,7 +39,7 @@ public class IncomingFileTransferRequestIcqImpl
     private OperationSetFileTransferIcqImpl fileTransferOpSet;
 
     /**
-     * The icq file transfer request received
+     * The ICQ file transfer request received
      */
     private IncomingFileTransfer incomingFileTransfer = null;
 
@@ -73,7 +72,7 @@ public IncomingFileTransferRequestIcqImpl(
     }
 
     /**
-     * Uniquie ID that is identifying the request and then the FileTransfer
+     * Unique ID that is identifying the request and then the FileTransfer
      * if the request has been accepted.
      *
      * @return the id.

File: src/net/java/sip/communicator/plugin/desktoputil/PriorityTable.java
Patch:
@@ -61,7 +61,6 @@ public PriorityTable(
 
         ResourceManagementService resources = DesktopUtilActivator.getResources();
         String key;
-        String i18NresourcesKey;
 
         table = new JTable();
         table.setShowGrid(false);

File: src/net/java/sip/communicator/impl/gui/main/account/EmptyAccountRegistrationWizardPage.java
Patch:
@@ -150,7 +150,7 @@ public void commitPage()
      * Empty interface method implementation, unused in the case of the
      * {@link EmptyAccountRegistrationWizardPage}
      */
-    public void changedUpdate(@SuppressWarnings("unused") DocumentEvent e)
+    public void changedUpdate(DocumentEvent e)
     {
     }
 

File: src/net/java/sip/communicator/impl/gui/main/menus/AutoAnswerMenu.java
Patch:
@@ -49,7 +49,7 @@ public AutoAnswerMenu()
 
         loadSkin();
 
-        this.registerMenuItems(this);
+        registerMenuItems(this);
     }
 
     /**

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -428,9 +428,9 @@ public void waitForEvent(long waitFor)
         }
 
 
-        //the follwoing methods only have dummy implementations here as they
-        //do not interest us. complete implementatios are provider in the
-        //basic instant messaging operation set.
+        // The following methods only have dummy implementations here as they do
+        // not interest us. Complete implementations are provided in the basic
+        // instant messaging operation set.
         public void buddyInfoUpdated(IcbmService service, Screenname buddy,
                                      IcbmBuddyInfo info){}
         public void conversationClosed(Conversation c){}

File: test/net/java/sip/communicator/slick/protocol/sip/TestAccountUninstallation.java
Patch:
@@ -141,7 +141,7 @@ public void testInstallationPersistency() throws Exception
             = fixture.findProtocolProviderBundle(fixture.provider1);
 
         //set the global providerBundle reference that we will be using
-        //in the last series of tests (Account uninstallation persistency)
+        //in the last series of tests (Account uninstallation persistence)
         SipSlickFixture.providerBundle = providerBundle;
 
         assertNotNull("Couldn't find a bundle for the tested provider"

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsSourceService.java
Patch:
@@ -9,7 +9,6 @@
 import java.util.regex.*;
 
 import net.java.sip.communicator.impl.googlecontacts.configform.*;
-import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.contactsource.*;
 import net.java.sip.communicator.service.googlecontacts.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceParticipantPanel.java
Patch:
@@ -17,7 +17,6 @@
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.service.resources.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 
 import org.jitsi.service.neomedia.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatContactListModel.java
Patch:
@@ -22,7 +22,7 @@
  * @author Lyubomir Marinov
  */
 public class ChatContactListModel
-    extends AbstractListModel<ChatContact<?>>
+    extends AbstractListModel
 {
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListModel.java
Patch:
@@ -18,7 +18,7 @@
  * @author Yana Stamcheva
  */
 public class ChatRoomListModel
-    extends AbstractListModel<Object>
+    extends AbstractListModel
 {
     private final ChatRoomList chatRoomList;
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListCellRenderer.java
Patch:
@@ -16,7 +16,6 @@
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListModel.java
Patch:
@@ -22,7 +22,7 @@
  * @author Lyubomir Marinov
  */
 public class ContactListModel
-    extends AbstractListModel<Object>
+    extends AbstractListModel
 {
     private final MetaContactListService contactList;
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GenericUIContactImpl.java
Patch:
@@ -16,8 +16,6 @@
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 
-import net.java.sip.communicator.util.*;
-
 /**
  * A generic full implementation of the <tt>UIContact</tt> interface.
  *

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -14,7 +14,6 @@
 import javax.swing.text.html.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.plugin.desktoputil.presence.*;

File: src/net/java/sip/communicator/impl/gui/main/presence/avatar/imagepicker/EditPanel.java
Patch:
@@ -15,7 +15,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
-import net.java.sip.communicator.util.*;
 
 /**
  * The <tt>EditPanel</tt> manage the image size and the clipper component

File: src/net/java/sip/communicator/impl/gui/main/presence/avatar/imagepicker/ImagePickerDialog.java
Patch:
@@ -16,7 +16,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
-import net.java.sip.communicator.util.*;
 
 /**
  * Dialog in which we can load an image from file or take new one by using

File: src/net/java/sip/communicator/impl/neomedia/DeviceConfigurationComboBoxModel.java
Patch:
@@ -27,7 +27,7 @@
  * @author Damian Minkov
  */
 public class DeviceConfigurationComboBoxModel
-    implements ComboBoxModel<Object>,
+    implements ComboBoxModel,
                PropertyChangeListener
 {
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerGTalkImpl.java
Patch:
@@ -11,7 +11,6 @@
 
 import net.java.sip.communicator.impl.protocol.jabber.extensions.gtalk.*;
 import net.java.sip.communicator.impl.protocol.jabber.extensions.jingle.*;
-import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/FailoverConnectionMonitor.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/jinglesdp/JingleUtils.java
Patch:
@@ -13,7 +13,6 @@
 import net.java.sip.communicator.impl.protocol.jabber.extensions.jingle.*;
 import net.java.sip.communicator.impl.protocol.jabber.extensions.jingle.ContentPacketExtension.CreatorEnum;
 import net.java.sip.communicator.impl.protocol.jabber.extensions.jingle.ContentPacketExtension.SendersEnum;
-import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.protocol.media.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/protocol/sip/AddressResolverImpl.java
Patch:
@@ -14,7 +14,6 @@
 import javax.sip.*;
 import javax.sip.address.*;
 
-import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackSharing.java
Patch:
@@ -18,7 +18,6 @@
 import javax.sip.header.*;
 import javax.sip.message.*;
 
-import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.netaddr.event.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;

File: src/net/java/sip/communicator/impl/protocol/sip/net/RFC5922Matcher.java
Patch:
@@ -14,7 +14,6 @@
 import javax.sip.address.*;
 
 import net.java.sip.communicator.impl.protocol.sip.*;
-import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.certificate.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/protocol/sip/sdp/SdpUtils.java
Patch:
@@ -15,7 +15,6 @@
 import javax.sip.header.*;
 
 import net.java.sip.communicator.impl.protocol.sip.*;
-import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.media.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/plugin/addrbook/AddrBookActivator.java
Patch:
@@ -10,7 +10,6 @@
 
 import net.java.sip.communicator.service.contactsource.*;
 import net.java.sip.communicator.service.gui.*;
-import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;
 

File: src/net/java/sip/communicator/plugin/contactinfo/ContactInfoDetailsPanel.java
Patch:
@@ -29,7 +29,6 @@
 import net.java.sip.communicator.service.protocol.ServerStoredDetails.MiddleNameDetail;
 import net.java.sip.communicator.service.protocol.ServerStoredDetails.PhoneNumberDetail;
 import net.java.sip.communicator.service.protocol.ServerStoredDetails.TimeZoneDetail;
-import net.java.sip.communicator.util.*;
 
 /**
  * The right side panel of ContactInfoDialog. Shows one tab of a summary of

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigurationPanel.java
Patch:
@@ -448,14 +448,14 @@ private Component createSendMessagePanel()
         sendMessageLabel.setText(
             Resources.getString("plugin.generalconfig.SEND_MESSAGES_WITH"));
 
-        ComboBoxModel<String> sendMessageComboBoxModel
-            = new DefaultComboBoxModel<String>(
+        ComboBoxModel sendMessageComboBoxModel
+            = new DefaultComboBoxModel(
                     new String[]
                             {
                                 ConfigurationUtils.ENTER_COMMAND,
                                 ConfigurationUtils.CTRL_ENTER_COMMAND
                             });
-        final JComboBox<String> sendMessageComboBox = new JComboBox<String>();
+        final JComboBox sendMessageComboBox = new JComboBox();
         sendMessagePanel.add(sendMessageComboBox);
         sendMessageComboBox.setModel(sendMessageComboBoxModel);
         sendMessageComboBox.setSelectedItem(

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListModel.java
Patch:
@@ -19,10 +19,10 @@
  * display it in <tt>ContactList</tt> as a list instead of a tree.
  *
  * @author Yana Stamcheva
- * @author Lubomir Marinov
+ * @author Lyubomir Marinov
  */
 public class ContactListModel
-    extends AbstractListModel
+    extends AbstractListModel<Object>
 {
     private final MetaContactListService contactList;
 

File: src/net/java/sip/communicator/impl/neomedia/DeviceConfigurationComboBoxModel.java
Patch:
@@ -27,7 +27,7 @@
  * @author Damian Minkov
  */
 public class DeviceConfigurationComboBoxModel
-    implements ComboBoxModel,
+    implements ComboBoxModel<Object>,
                PropertyChangeListener
 {
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -1126,7 +1126,7 @@ private String processLinksAndHTMLChars(String message,
             if (processHTMLChars)
             {
                 fromPrevEndToStart = 
-                        ChatHtmlUtils.escapeHTMLChars(fromPrevEndToStart);
+                    GuiUtils.escapeHTMLChars(fromPrevEndToStart);
             }
             msgBuffer.append(fromPrevEndToStart);
             prevEnd = m.end();
@@ -1147,7 +1147,7 @@ private String processLinksAndHTMLChars(String message,
         String fromPrevEndToEnd = message.substring(prevEnd);
 
         if (processHTMLChars)
-            fromPrevEndToEnd = ChatHtmlUtils.escapeHTMLChars(fromPrevEndToEnd);
+            fromPrevEndToEnd = GuiUtils.escapeHTMLChars(fromPrevEndToEnd);
         msgBuffer.append(fromPrevEndToEnd);
 
         return msgBuffer.toString();
@@ -1690,7 +1690,7 @@ public String processMeCommand(ChatMessage chatMessage)
         String endHeaderTag = "</I></B></DIV>";
 
         chatString +=
-            ChatHtmlUtils.escapeHTMLChars("*** " + chatMessage.getContactName()
+            GuiUtils.escapeHTMLChars("*** " + chatMessage.getContactName()
                 + " " + message.substring(4))
                 + endHeaderTag;
 

File: src/net/java/sip/communicator/impl/gui/main/UINotification.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.main;
 
-import java.util.*;
-
 /**
  * The <tt>UINotification</tt> class represents a notification received in the
  * user interface. This could be a missed call, voicemail, email notification or

File: src/net/java/sip/communicator/impl/gui/main/call/AbstractCallToggleButton.java
Patch:
@@ -15,7 +15,6 @@
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.resources.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/call/OutputVolumeControlButton.java
Patch:
@@ -15,7 +15,6 @@
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.resources.*;
-import net.java.sip.communicator.util.*;
 
 import org.jitsi.service.neomedia.*;
 

File: src/net/java/sip/communicator/impl/ldap/LdapActivator.java
Patch:
@@ -10,7 +10,6 @@
 
 import net.java.sip.communicator.service.contactsource.*;
 import net.java.sip.communicator.service.ldap.*;
-import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 
 import org.jitsi.service.resources.*;

File: src/net/java/sip/communicator/plugin/desktoputil/AuthenticationWindow.java
Patch:
@@ -11,7 +11,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;
 
 import org.jitsi.util.*;

File: src/net/java/sip/communicator/plugin/desktoputil/FramedImage.java
Patch:
@@ -10,7 +10,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 
 /**

File: src/net/java/sip/communicator/plugin/desktoputil/MasterPasswordInputDialog.java
Patch:
@@ -10,8 +10,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.util.*;
-
 import org.jitsi.service.resources.*;
 
 /**

File: src/net/java/sip/communicator/plugin/desktoputil/PopupNotificationPanel.java
Patch:
@@ -11,7 +11,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;
 import net.java.sip.communicator.util.skin.*;
 

File: src/net/java/sip/communicator/plugin/desktoputil/PriorityTable.java
Patch:
@@ -7,12 +7,11 @@
 
 import java.awt.*;
 import java.awt.event.*;
+
 import javax.swing.*;
 import javax.swing.event.*;
 import javax.swing.table.*;
 
-import net.java.sip.communicator.util.*;
-
 import org.jitsi.service.resources.*;
 
 /**

File: src/net/java/sip/communicator/plugin/desktoputil/SIPCommFrame.java
Patch:
@@ -17,7 +17,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.service.keybindings.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;
 
 import org.jitsi.service.configuration.*;

File: src/net/java/sip/communicator/plugin/desktoputil/SIPCommScrollPane.java
Patch:
@@ -13,7 +13,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 
 import org.jitsi.util.*;

File: src/net/java/sip/communicator/plugin/desktoputil/SoundLevelIndicator.java
Patch:
@@ -10,7 +10,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 
 import org.jitsi.service.resources.*;

File: src/net/java/sip/communicator/plugin/desktoputil/plaf/SIPCommTabbedPaneEnhancedUI.java
Patch:
@@ -22,7 +22,6 @@
 import javax.swing.text.*;
 
 import net.java.sip.communicator.plugin.desktoputil.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 
 /**

File: src/net/java/sip/communicator/plugin/desktoputil/plaf/SIPCommTabbedPaneUI.java
Patch:
@@ -23,9 +23,8 @@
 import javax.swing.plaf.basic.*;
 import javax.swing.text.*;
 
-import net.java.sip.communicator.util.*;
-import net.java.sip.communicator.util.skin.*;
 import net.java.sip.communicator.plugin.desktoputil.*;
+import net.java.sip.communicator.util.skin.*;
 
 /**
  * SIPCommTabbedPaneUI implementation.

File: src/net/java/sip/communicator/plugin/desktoputil/wizard/EncodingsPanel.java
Patch:
@@ -20,7 +20,6 @@
 import org.jitsi.service.neomedia.codec.*;
 import org.jitsi.service.resources.*;
 
-
 /**
  * The encodings configuration panel (used in the account configuration wizards)
  * 

File: src/net/java/sip/communicator/plugin/aimaccregwizz/AimAccRegWizzActivator.java
Patch:
@@ -64,7 +64,7 @@ public void start(Object dependentService)
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/branding/BrandingActivator.java
Patch:
@@ -119,7 +119,7 @@ public void setBundleContext(BundleContext context)
      * This activator depends on UIService.
      * @return the class name of uiService.
      */
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/facebookaccregwizz/FacebookAccRegWizzActivator.java
Patch:
@@ -94,7 +94,7 @@ public void start(Object dependentService)
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigPluginActivator.java
Patch:
@@ -195,7 +195,7 @@ public void start(Object dependentService)
      * @return
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/GoogleTalkAccRegWizzActivator.java
Patch:
@@ -71,7 +71,7 @@ public void start(Object dependentService)
      * @return
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/icqaccregwizz/IcqAccRegWizzActivator.java
Patch:
@@ -69,7 +69,7 @@ public void start(Object dependentService)
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/ippiaccregwizz/IppiAccRegWizzActivator.java
Patch:
@@ -95,7 +95,7 @@ public void run()
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/iptelaccregwizz/IptelAccRegWizzActivator.java
Patch:
@@ -71,7 +71,7 @@ public void start(Object dependentService)
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccRegWizzActivator.java
Patch:
@@ -77,7 +77,7 @@ public void start(Object dependentService)
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/msnaccregwizz/MsnAccRegWizzActivator.java
Patch:
@@ -68,7 +68,7 @@ public void start(Object dependentService)
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccRegWizzActivator.java
Patch:
@@ -76,7 +76,7 @@ public void start(Object dependentService)
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/YahooAccRegWizzActivator.java
Patch:
@@ -68,7 +68,7 @@ public void start(Object dependentService)
      * @return the ui service class.
      */
     @Override
-    public Class getDependentServiceClass()
+    public Class<?> getDependentServiceClass()
     {
         return UIService.class;
     }

File: src/net/java/sip/communicator/impl/callhistory/CallHistorySourceContact.java
Patch:
@@ -304,7 +304,8 @@ public List<ContactDetail> getContactDetails(
      * @return a list of all <tt>ContactDetail</tt>s corresponding to the given
      * category
      */
-    public List<ContactDetail> getContactDetails(String category)
+    public List<ContactDetail> getContactDetails(
+        ContactDetail.Category category)
         throws OperationNotSupportedException
     {
         // We don't support category for call history details, so we return null.

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -1654,7 +1654,7 @@ else if(d instanceof MobilePhoneDetail)
                                 localizedType =
                                     GuiActivator.getResources().
                                         getI18NString(
-                                            "service.gui.PHONE");
+                                            "service.gui.HOME");
                             }
 
                             phones.add(pnd.getNumber());

File: src/net/java/sip/communicator/impl/gui/main/call/ChooseCallAccountPopupMenu.java
Patch:
@@ -284,7 +284,7 @@ else if (opSetClass.equals(
 
         String category = telephonyContact.getCategory();
 
-        if (category != null && category.equals(ContactDetail.CATEGORY_PHONE))
+        if (category != null && category.equals(ContactDetail.Category.Phone))
         {
             int index = findPhoneItemIndex();
             if (index < 0)
@@ -299,7 +299,7 @@ else if (opSetClass.equals(
                 category = ((ContactMenuItem) lastComp).getCategory();
 
             if (category != null
-                && category.equals(ContactDetail.CATEGORY_PHONE))
+                && category.equals(ContactDetail.Category.Phone))
                 addSeparator();
 
             add(contactItem);
@@ -322,7 +322,7 @@ private int findPhoneItemIndex()
             {
                 String category = ((ContactMenuItem) c).getCategory();
                 if (category == null
-                    || !category.equals(ContactDetail.CATEGORY_PHONE))
+                    || !category.equals(ContactDetail.Category.Phone))
                 continue;
             }
             else if (c instanceof JSeparator)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1955,7 +1955,7 @@ else if (details.size() > 1)
                 final ContactDetail detail = detailsIter.next();
 
                 JMenuItem addMenuItem
-                    = new JMenuItem(detail.getContactAddress());
+                    = new JMenuItem(detail.getDetail());
                 ((JMenu) addContactComponentTmp).add(addMenuItem);
 
                 addMenuItem.addActionListener(new ActionListener()
@@ -1995,7 +1995,7 @@ public static void showAddContactDialog(ContactDetail contactDetail)
         if (preferredProvider != null)
             dialog.setSelectedAccount(preferredProvider);
 
-        dialog.setContactAddress(contactDetail.getContactAddress());
+        dialog.setContactAddress(contactDetail.getDetail());
         dialog.setVisible(true);
     }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaUIContact.java
Patch:
@@ -549,7 +549,7 @@ else if(d instanceof MobilePhoneDetail)
                         localizedType =
                             GuiActivator.getResources().
                                 getI18NString(
-                                    "service.gui.PHONE");
+                                    "service.gui.HOME");
                     }
 
                     tip.addLine(null, (pnd.getNumber() +

File: src/net/java/sip/communicator/plugin/demuxcontactsource/DemuxContactSource.java
Patch:
@@ -282,7 +282,7 @@ private SourceContact createSourceContact(  SourceContact sourceContact,
                                             sourceContact.getDisplayName(),
                                             contactDetails);
 
-            genericContact.setDisplayDetails(contactDetail.getContactAddress());
+            genericContact.setDisplayDetails(contactDetail.getDetail());
 
             return genericContact;
         }

File: src/net/java/sip/communicator/plugin/phonenumbercontactsource/PhoneNumberContactQuery.java
Patch:
@@ -169,7 +169,7 @@ else if(d instanceof MobilePhoneDetail)
                         {
                             localizedType =
                                 PNContactSourceActivator.getResources()
-                                .getI18NString("service.gui.PHONE");
+                                .getI18NString("service.gui.HOME");
                         }
 
                         String contactName = contact.getDisplayName();

File: src/net/java/sip/communicator/service/contactsource/GenericSourceContact.java
Patch:
@@ -115,13 +115,14 @@ public List<ContactDetail> getContactDetails(
      * @return a list of all <tt>ContactDetail</tt>s corresponding to the given
      * category
      */
-    public List<ContactDetail> getContactDetails(String category)
+    public List<ContactDetail> getContactDetails(
+        ContactDetail.Category category)
     {
         List<ContactDetail> contactDetails = new LinkedList<ContactDetail>();
 
         for (ContactDetail contactDetail : getContactDetails())
         {
-            String detailCategory = contactDetail.getCategory();
+            ContactDetail.Category detailCategory = contactDetail.getCategory();
             if (detailCategory != null && detailCategory.equals(category))
                 contactDetails.add(contactDetail);
         }

File: src/net/java/sip/communicator/service/contactsource/SourceContact.java
Patch:
@@ -70,7 +70,8 @@ public List<ContactDetail> getContactDetails(
      * @throws OperationNotSupportedException if categories aren't supported
      * for call history records
      */
-    public List<ContactDetail> getContactDetails(String category)
+    public List<ContactDetail> getContactDetails(
+                                            ContactDetail.Category category)
         throws OperationNotSupportedException;
 
     /**

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistration.java
Patch:
@@ -8,8 +8,8 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.plugin.desktoputil.wizard.*;
 import net.java.sip.communicator.service.protocol.*;
+import net.java.sip.communicator.util.wizard.*;
 
 /**
  * The <tt>JabberAccountRegistration</tt> is used to store all user input data

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistration.java
Patch:
@@ -7,7 +7,7 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.plugin.desktoputil.wizard.*;
+import net.java.sip.communicator.util.wizard.*;
 /**
  * The <tt>SIPAccountRegistration</tt> is used to store all user input data
  * through the <tt>SIPAccountRegistrationWizard</tt>.

File: src/net/java/sip/communicator/impl/googlecontacts/configform/GoogleContactsConfigForm.java
Patch:
@@ -12,9 +12,8 @@
 import javax.swing.*;
 import javax.swing.event.*;
 
-import org.jitsi.util.swing.*;
-
 import net.java.sip.communicator.impl.googlecontacts.*;
+import net.java.sip.communicator.plugin.desktoputil.*;
 import net.java.sip.communicator.service.googlecontacts.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/plugin/certconfig/CertConfigPanel.java
Patch:
@@ -199,8 +199,9 @@ public void actionPerformed(ActionEvent e)
         }
         if (e.getSource() == rdoUseJava)
         {
-            CertConfigActivator.getConfigService().removeProperty(
-                CertificateService.PNAME_TRUSTSTORE_TYPE);
+            CertConfigActivator.getConfigService().setProperty(
+                CertificateService.PNAME_TRUSTSTORE_TYPE,
+                "meta:default");
             CertConfigActivator.getConfigService().removeProperty(
                 CertificateService.PNAME_TRUSTSTORE_FILE);
             CertConfigActivator.getCredService().removePassword(

File: src/net/java/sip/communicator/impl/sysactivity/SystemActivityNotificationsServiceImpl.java
Patch:
@@ -635,8 +635,7 @@ else if(OSUtils.IS_ANDROID)
 
                 if(className != null)
                     currentRunningManager = (SystemActivityManager)
-                        Class.forName(SYSTEM_ACTIVITY_MANAGER_LINUX_CLASS)
-                            .newInstance();
+                        Class.forName(className).newInstance();
             }
             catch(Throwable t)
             {

File: src/net/java/sip/communicator/plugin/addrbook/macosx/MacOSXAddrBookContactQuery.java
Patch:
@@ -738,6 +738,9 @@ private ContactDetail setCapabilities(
         Map<Class<? extends OperationSet>, String> preferredProtocols
             = new HashMap<Class<? extends OperationSet>, String>();
 
+        // can be added as contacts
+        supportedOpSets.add(OperationSetPersistentPresence.class);
+
         switch (property)
         {
         case kABAIMInstantProperty:

File: src/net/java/sip/communicator/plugin/addrbook/msoutlook/MsOutlookAddrBookContactQuery.java
Patch:
@@ -354,9 +354,11 @@ private boolean onMailUser(long iUnknown)
         if (matches)
         {
             List<Class<? extends OperationSet>> supportedOpSets
-                = new ArrayList<Class<? extends OperationSet>>(1);
+                = new ArrayList<Class<? extends OperationSet>>(2);
 
             supportedOpSets.add(OperationSetBasicTelephony.class);
+            // can be added as contacts
+            supportedOpSets.add(OperationSetPersistentPresence.class);
 
             List<ContactDetail> contactDetails
                 = new LinkedList<ContactDetail>();

File: src/net/java/sip/communicator/service/protocol/media/MediaHandler.java
Patch:
@@ -89,8 +89,10 @@ public void securityMessageReceived(
                     String message, String i18nMessage, int severity)
             {
                 for (SrtpListener listener : getSrtpListeners())
+                {
                     listener.securityMessageReceived(
                             message, i18nMessage, severity);
+                }
             }
 
             public void securityTimeout(int sessionType)

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferencePeerPanel.java
Patch:
@@ -169,7 +169,7 @@ public ConferencePeerPanel(
                         + "DISABLE_SOUND_LEVEL_INDICATORS",
                 false))
         {
-        call.addLocalUserSoundLevelListener(soundLevelListener);
+            call.addLocalUserSoundLevelListener(soundLevelListener);
         }
     }
 

File: src/net/java/sip/communicator/impl/shutdowntimeout/ShutdownTimeout.java
Patch:
@@ -109,7 +109,7 @@ public void run()
                                      + shutDownTimeout + "ms.");
                         wait(shutDownTimeout);
                         logger.error("Failed to gently shutdown. Forcing exit.");
-                        System.exit(SYSTEM_EXIT_CODE);
+                        Runtime.getRuntime().halt(SYSTEM_EXIT_CODE);
                     }catch (InterruptedException ex){
                         if (logger.isDebugEnabled())
                             logger.debug("Interrupted shutdown timer.");

File: src/net/java/sip/communicator/impl/sysactivity/NetworkManagerListenerImpl.java
Patch:
@@ -38,7 +38,7 @@ public class NetworkManagerListenerImpl
     /**
      * Make only one instance.
      */
-    private NetworkManagerListenerImpl()
+    public NetworkManagerListenerImpl()
     {
         try
         {

File: src/net/java/sip/communicator/impl/neomedia/AbstractDeviceConfigurationListener.java
Patch:
@@ -8,13 +8,11 @@
 
 import java.beans.*;
 import java.util.*;
-import javax.media.*;
 
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.notification.*;
 import net.java.sip.communicator.service.systray.event.*;
 
-import org.jitsi.impl.neomedia.device.*;
 import org.jitsi.service.resources.*;
 import org.osgi.framework.*;
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatHtmlUtils.java
Patch:
@@ -742,8 +742,6 @@ private static String createEditedAt(long date)
                 + ")";
     }
 
-
-
     /**
      * Escapes special HTML characters such as &lt;, &gt;, &amp; and &quot; in
      * the specified message.
@@ -757,6 +755,8 @@ public static String escapeHTMLChars(String message)
                 .replace("&", "&amp;")
                 .replace("<", "&lt;")
                 .replace(">", "&gt;")
-                .replace("\"", "&quot;");
+                .replace("\"", "&quot;")
+                .replace("'", "&#x27;")
+                .replace("/", "&#x2F;");
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/call/DTMFHandler.java
Patch:
@@ -18,7 +18,6 @@
 import net.java.sip.communicator.service.resources.*;
 import net.java.sip.communicator.util.*;
 
-import org.jitsi.service.audionotifier.*;
 import org.jitsi.service.protocol.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/call/SelectScreenDialog.java
Patch:
@@ -290,6 +290,7 @@ private static JComponent createVideoContainer(Component noVideoComponent)
     private static class ComboRenderer
         extends DefaultListCellRenderer
     {
+        @Override
         public Component getListCellRendererComponent(JList list, Object value,
             int index, boolean isSelected, boolean cellHasFocus)
         {

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceInviteDialog.java
Patch:
@@ -13,8 +13,6 @@
 
 import javax.swing.*;
 
-import com.sun.org.apache.bcel.internal.generic.*;
-
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.contactsource.*;
@@ -24,7 +22,6 @@
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
-// disambiguation
 
 /**
  * The invite dialog is the one shown when the user clicks on the conference

File: src/net/java/sip/communicator/impl/gui/utils/PluginContainer.java
Patch:
@@ -224,6 +224,8 @@ public Iterable<PluginComponent> getPluginComponents()
      */
     private void initPluginComponents()
     {
+        GuiActivator.getUIService().addPluginComponentListener(this);
+
         // Look for PluginComponents registered in the OSGi BundleContext.
         ServiceReference[] serRefs = null;
 
@@ -256,8 +258,6 @@ private void initPluginComponents()
                 addPluginComponent(component);
             }
         }
-
-        GuiActivator.getUIService().addPluginComponentListener(this);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/IceUdpTransportManager.java
Patch:
@@ -668,7 +668,7 @@ public PacketExtension createTransport(IceMediaStream stream)
 
         for(Component component : stream.getComponents())
         {
-            for(Candidate candidate : component.getLocalCandidates())
+            for(Candidate<?> candidate : component.getLocalCandidates())
                 trans.addCandidate(createCandidate(candidate));
         }
 
@@ -685,7 +685,7 @@ public PacketExtension createTransport(IceMediaStream stream)
      * @return a new {@link CandidatePacketExtension} corresponding to the state
      * of the <tt>candidate</tt> candidate.
      */
-    private CandidatePacketExtension createCandidate(Candidate candidate)
+    private CandidatePacketExtension createCandidate(Candidate<?> candidate)
     {
         CandidatePacketExtension packet = new CandidatePacketExtension();
 

File: src/net/java/sip/communicator/service/protocol/AbstractCallPeer.java
Patch:
@@ -253,9 +253,8 @@ public void addConferenceMember(ConferenceMember conferenceMember)
     protected ConferenceMember findConferenceMember(long ssrc)
     {
         List<ConferenceMember> members = getConferenceMembers();
-        int memberCount = members.size();
 
-        for (int i = 0; i < memberCount; i++)
+        for (int i = 0, memberCount = members.size(); i < memberCount; i++)
         {
             ConferenceMember member = members.get(i);
 

File: src/net/java/sip/communicator/service/protocol/media/DynamicRTPExtensionsRegistry.java
Patch:
@@ -192,7 +192,7 @@ private byte nextExtensionID()
             {
                 throw new IllegalStateException(
                     "Impossible to map more than the 255 already mapped "
-                    +" RTP extensions");
+                        +" RTP extensions");
             }
 
             byte extID = nextExtensionMapping++;

File: src/net/java/sip/communicator/service/protocol/media/TransportManager.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.service.protocol.media;
 
 import java.net.*;
-import java.util.*;
 
 import net.java.sip.communicator.service.netaddr.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/gui/main/menus/ToolsMenu.java
Patch:
@@ -520,7 +520,9 @@ else if (videoBridgeProviderCount > 1)
          */
         protected void finished()
         {
-            videoBridgeMenuItem.setEnabled((Boolean)get());
+            Boolean enabled = (Boolean) get();
+            if (enabled != null)
+                videoBridgeMenuItem.setEnabled(enabled);
         }
     }
 

File: src/net/java/sip/communicator/plugin/update/UpdateActivator.java
Patch:
@@ -237,8 +237,8 @@ public void run()
             mUpdateExecutor = Executors.newSingleThreadScheduledExecutor();
             mUpdateExecutor.scheduleAtFixedRate(updateRunnable,
                                                 hoursToWait,
-                                                24,
-                                                TimeUnit.HOURS);
+                                                24*60*60,
+                                                TimeUnit.SECONDS);
         }
     }
 

File: src/net/java/sip/communicator/plugin/otr/ScOtrKeyManagerListener.java
Patch:
@@ -9,11 +9,10 @@
 import net.java.sip.communicator.service.protocol.*;
 
 /**
- * 
- * @author George Politis
  *
+ * @author George Politis
  */
 public interface ScOtrKeyManagerListener
 {
-    public abstract void contactVerificationStatusChanged(Contact contact);
+    public void contactVerificationStatusChanged(Contact contact);
 }

File: src/net/java/sip/communicator/util/AbstractServiceDependentActivator.java
Patch:
@@ -68,7 +68,7 @@ public void start(BundleContext bundleContext)
      * The class of the service which this activator is interested in.
      * @return the class name.
      */
-    public abstract Class getDependentServiceClass();
+    public abstract Class<?> getDependentServiceClass();
 
     /**
      * Setting context to the activator, as soon as we have one.

File: src/net/java/sip/communicator/impl/gui/main/call/DesktopSharingButton.java
Patch:
@@ -64,7 +64,6 @@ public DesktopSharingButton(Call call, boolean fullScreen, boolean selected)
         OperationSetDesktopSharingServer desktopSharing
                 = call.getProtocolProvider().getOperationSet(
                 OperationSetDesktopSharingServer.class);
-        System.err.println("DOHH"+desktopSharing);
 
         if (desktopSharing == null)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerGTalkImpl.java
Patch:
@@ -105,14 +105,14 @@ public synchronized void answer()
         {
             getMediaHandler().getTransportManager().
                 wrapupConnectivityEstablishment();
-            answer = getMediaHandler().generateSessionAccept(true, false);
+            answer = getMediaHandler().generateSessionAccept(true);
         }
         catch(IllegalArgumentException e)
         {
             sessAcceptedWithNoCands = new SessionIQ();
 
             // HACK apparently FreeSwitch need to have accept before
-            answer = getMediaHandler().generateSessionAccept(false, false);
+            answer = getMediaHandler().generateSessionAccept(false);
 
             SessionIQ response
                 = GTalkPacketFactory.createSessionAccept(
@@ -548,7 +548,7 @@ protected synchronized void processSessionInitiate(SessionIQ sessionInitIQ)
 
         try
         {
-            getMediaHandler().processOffer(description, false);
+            getMediaHandler().processOffer(description);
         }
         catch(Exception ex)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -1491,7 +1491,9 @@ public void parseContactPhotoPresence(Packet packet)
             }
             catch(XMPPException ex)
             {
-                logger.info("Can not retrieve vCard from: " + packet.getFrom(), ex);
+                logger.info("Can not retrieve vCard from: " + packet.getFrom());
+                if(logger.isTraceEnabled())
+                    logger.trace("vCard retrieval exception was: ", ex);
             }
         }
     }

File: src/net/java/sip/communicator/service/protocol/AccountID.java
Patch:
@@ -497,7 +497,8 @@ public List<String> getEncryptionProtocols(boolean enabled)
 
         for(int i = 0; i < tmp.length; ++i)
         {
-            encryptionProtocolList.add(tmp[i]);
+            if(tmp[i] != null && tmp[i].trim().length() > 0 )
+                encryptionProtocolList.add(tmp[i]);
         }
 
         return encryptionProtocolList;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDTMFJabberImpl.java
Patch:
@@ -12,8 +12,8 @@
 import net.java.sip.communicator.service.protocol.OperationFailedException;
 import net.java.sip.communicator.util.*;
 
-import org.jitsi.impl.neomedia.codec.*;
 import org.jitsi.service.neomedia.*;
+import org.jitsi.service.neomedia.codec.*;
 import org.jitsi.service.neomedia.format.*;
 import org.jitsi.service.protocol.*;
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetDTMFSipImpl.java
Patch:
@@ -13,8 +13,8 @@
 import net.java.sip.communicator.service.protocol.OperationFailedException;
 import net.java.sip.communicator.util.*;
 
-import org.jitsi.impl.neomedia.codec.*;
 import org.jitsi.service.neomedia.*;
+import org.jitsi.service.neomedia.codec.*;
 import org.jitsi.service.neomedia.format.*;
 import org.jitsi.service.protocol.*;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerGTalkImpl.java
Patch:
@@ -105,14 +105,14 @@ public synchronized void answer()
         {
             getMediaHandler().getTransportManager().
                 wrapupConnectivityEstablishment();
-            answer = getMediaHandler().generateSessionAccept(true);
+            answer = getMediaHandler().generateSessionAccept(true, false);
         }
         catch(IllegalArgumentException e)
         {
             sessAcceptedWithNoCands = new SessionIQ();
 
             // HACK apparently FreeSwitch need to have accept before
-            answer = getMediaHandler().generateSessionAccept(false);
+            answer = getMediaHandler().generateSessionAccept(false, false);
 
             SessionIQ response
                 = GTalkPacketFactory.createSessionAccept(
@@ -548,7 +548,7 @@ protected synchronized void processSessionInitiate(SessionIQ sessionInitIQ)
 
         try
         {
-            getMediaHandler().processOffer(description);
+            getMediaHandler().processOffer(description, false);
         }
         catch(Exception ex)
         {

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -2351,8 +2351,10 @@ public void run()
                 while (peerIter.hasNext())
                     peers.add(peerIter.next());
             }
+
             if (conference != null)
                 peers.addAll(conference.getCallPeers());
+
             if (peer != null)
                 peers.add(peer);
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -215,7 +215,7 @@ public class OperationSetPresenceSipImpl
     /**
      * Watcher status from the watchers info list.
      */
-    private enum WatcherStatus
+    private static enum WatcherStatus
     {
         PENDING("pending"),
         ACTIVE("active"),
@@ -225,7 +225,7 @@ private enum WatcherStatus
         /**
          * The value.
          */
-        private String value;
+        private final String value;
 
         /**
          * Creates <>tt WatcherStatus</tt>

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackProperties.java
Patch:
@@ -13,7 +13,6 @@
 import javax.net.ssl.*;
 
 import net.java.sip.communicator.impl.protocol.sip.net.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;
 
 import org.jitsi.util.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -114,7 +114,7 @@ else if (sourceContactList.getDefaultFilter()
             if (sourceContactList.getDefaultFilter()
                     .equals(TreeContactList.presenceFilter)
                 && GuiActivator.getConfigurationService().getBoolean(
-                    DISABLE_CALL_HISTORY_SEARCH_PROP, true)
+                    DISABLE_CALL_HISTORY_SEARCH_PROP, false)
                 && filterSource.getContactSourceService().getType()
                     == ContactSourceService.HISTORY_TYPE)
                 continue;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -551,7 +551,7 @@ public Component getListCellRendererComponent(  JList list,
      */
     public void bringToFront()
     {
-        this.bringToFront();
+        super.toFront();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactJabberImpl.java
Patch:
@@ -193,7 +193,7 @@ public void setImage(byte[] imgBytes)
     @Override
     public int hashCode()
     {
-        return getAddress().hashCode();
+        return getAddress().toLowerCase().hashCode();
     }
 
     /**

File: src/net/java/sip/communicator/impl/notification/SoundNotificationHandlerImpl.java
Patch:
@@ -80,7 +80,7 @@ private void play(
         {
             UIService uiService = NotificationActivator.getUIService();
 
-            if(uiService.getInProgressCalls().size() > 0)
+            if(!uiService.getInProgressCalls().isEmpty())
                 return;
         }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/coin/MediaPacketExtension.java
Patch:
@@ -93,6 +93,7 @@ public class MediaPacketExtension
     public MediaPacketExtension(String id)
     {
         super(NAMESPACE, ELEMENT_NAME);
+
         setAttribute(ID_ATTR_NAME, id);
     }
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetTelephonyConferencingSipImpl.java
Patch:
@@ -469,6 +469,7 @@ private void getMediaXML(
 
                 if (direction == null)
                     direction = MediaDirection.INACTIVE;
+
                 // <status>
                 append(xml, "<", ELEMENT_STATUS, ">");
                 xml.append(direction.toString());

File: src/net/java/sip/communicator/impl/gui/main/SingleWindowContainer.java
Patch:
@@ -76,8 +76,7 @@ public SingleWindowContainer()
         setPreferredSize(new Dimension(620, 580));
 
         tabbedPane = new ConversationTabbedPane();
-        contactPhotoPanel = new ContactPhotoPanel(
-            GuiActivator.getUIService().getMainFrame());
+        contactPhotoPanel = new ContactPhotoPanel();
 
         add(createToolbar(), BorderLayout.NORTH);
         tabbedPane.addChangeListener(this);

File: src/net/java/sip/communicator/impl/gui/main/call/DialPanel.java
Patch:
@@ -136,7 +136,7 @@ public void mouseReleased(MouseEvent e)
      */
     public void paintComponent(Graphics g)
     {
-     // do the superclass behavior first
+        // do the superclass behavior first
         super.paintComponent(g);
 
         Graphics2D g2 = (Graphics2D) g;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -698,8 +698,7 @@ else if (o instanceof FileRecord)
                 FileRecord fileRecord = (FileRecord) o;
 
                 FileHistoryConversationComponent component
-                    = new FileHistoryConversationComponent(
-                        chatContainer.getFrame(), fileRecord);
+                    = new FileHistoryConversationComponent(fileRecord);
 
                 conversationPanel.addComponent(component);
             }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -114,7 +114,7 @@ public ChatWindow()
 
         menuBar = new MessageWindowMenuBar(this);
 
-        contactPhotoPanel = new ContactPhotoPanel(this);
+        contactPhotoPanel = new ContactPhotoPanel();
 
         this.setJMenuBar(menuBar);
 

File: src/net/java/sip/communicator/impl/gui/main/chat/filetransfer/FileTransferConversationComponent.java
Patch:
@@ -181,9 +181,9 @@ public abstract class FileTransferConversationComponent
     /**
      * Creates a file conversation component.
      */
-    public FileTransferConversationComponent(Window parentWindow)
+    public FileTransferConversationComponent()
     {
-        imageLabel = new FileImageLabel(parentWindow);
+        imageLabel = new FileImageLabel();
 
         constraints.gridx = 0;
         constraints.gridy = 0;

File: src/net/java/sip/communicator/impl/gui/main/chat/filetransfer/ReceiveFileConversationComponent.java
Patch:
@@ -61,8 +61,6 @@ public ReceiveFileConversationComponent(
         final IncomingFileTransferRequest request,
         final Date date)
     {
-        super(chatPanel.getChatContainer().getFrame());
-
         this.chatPanel = chatPanel;
         this.fileTransferOpSet = opSet;
         this.fileTransferRequest = request;

File: src/net/java/sip/communicator/impl/gui/main/chat/filetransfer/SendFileConversationComponent.java
Patch:
@@ -49,8 +49,6 @@ public SendFileConversationComponent(   ChatPanel chatPanel,
                                             String toContactName,
                                             final File file)
     {
-        super(chatPanel.getChatContainer().getFrame());
-
         this.parentChatPanel = chatPanel;
         this.toContactName = toContactName;
         this.file = file;

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -340,8 +340,7 @@ else if (o instanceof FileRecord)
                         = fileRecord.getContact().getProtocolProvider();
 
                     FileHistoryConversationComponent component
-                        = new FileHistoryConversationComponent(
-                            this, fileRecord);
+                        = new FileHistoryConversationComponent(fileRecord);
 
                     chatConvPanel.addComponent(component);
                 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/DefaultContactList.java
Patch:
@@ -128,8 +128,7 @@ public JToolTip createToolTip()
 
         Object element = getModel().getElementAt(index);
 
-        ExtendedTooltip tip = new ExtendedTooltip(
-            GuiActivator.getUIService().getMainFrame(), true);
+        ExtendedTooltip tip = new ExtendedTooltip(true);
 
         if (element instanceof MetaContact)
         {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaUIContact.java
Patch:
@@ -408,8 +408,7 @@ else if (protoContact.getStatusMessage() != null
      */
     public ExtendedTooltip getToolTip()
     {
-        ExtendedTooltip tip = new ExtendedTooltip(
-            GuiActivator.getUIService().getMainFrame(), true);
+        ExtendedTooltip tip = new ExtendedTooltip(true);
 
         byte[] avatarImage = metaContact.getAvatar();
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/ShowMoreContact.java
Patch:
@@ -152,8 +152,7 @@ public ImageIcon getStatusIcon()
      */
     public ExtendedTooltip getToolTip()
     {
-        ExtendedTooltip tooltip = new ExtendedTooltip(
-            GuiActivator.getUIService().getMainFrame(), false);
+        ExtendedTooltip tooltip = new ExtendedTooltip(false);
 
         tooltip.setTitle(GuiActivator.getResources()
             .getI18NString("service.gui.SHOW_MORE_TOOLTIP"));

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/SourceUIContact.java
Patch:
@@ -374,8 +374,7 @@ public JPopupMenu getRightButtonMenu()
      */
     public ExtendedTooltip getToolTip()
     {
-        ExtendedTooltip tip = new ExtendedTooltip(
-            GuiActivator.getUIService().getMainFrame(), true);
+        ExtendedTooltip tip = new ExtendedTooltip(true);
 
         byte[] avatarImage = sourceContact.getImage();
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/notifsource/NotificationContact.java
Patch:
@@ -256,8 +256,7 @@ else if (protocolProvider.isRegistered())
      */
     public ExtendedTooltip getToolTip()
     {
-        ExtendedTooltip tip = new ExtendedTooltip(
-            GuiActivator.getUIService().getMainFrame(), true);
+        ExtendedTooltip tip = new ExtendedTooltip(true);
 
         ImageIcon avatarImage = getAvatar(true, 64, 64);
 

File: src/net/java/sip/communicator/impl/gui/utils/InviteContactListFilter.java
Patch:
@@ -47,6 +47,9 @@ public void applyFilter(FilterQuery filterQuery)
         {
             filterSources.addAll(sourceContactList
                 .getContactSources(ContactSourceService.SEARCH_TYPE));
+
+            filterSources.addAll(sourceContactList
+                .getContactSources(ContactSourceService.HISTORY_TYPE));
         }
 
         Iterator<UIContactSource> filterSourceIter = filterSources.iterator();

File: src/net/java/sip/communicator/plugin/notificationwiring/NotificationManager.java
Patch:
@@ -218,7 +218,7 @@ private void registerDefaultNotifications()
         // Register dial notifications.
         SoundNotificationAction dialSoundHandler
             = new SoundNotificationAction(
-                    SoundProperties.DIALING, 0, false, true, false);
+                    SoundProperties.DIALING, -1, false, true, false);
 
         notificationService.registerDefaultNotificationForEvent(
                 DIALING,

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -114,7 +114,6 @@ else if (sourceContactList.getDefaultFilter()
         // Closes this filter to indicate that we finished adding queries to it.
         if (filterQuery.isRunning())
             filterQuery.close();
-
         else if (!sourceContactList.isEmpty())
             sourceContactList.selectFirstContact();
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -2026,7 +2026,9 @@ public void serviceChanged(ServiceEvent event)
                 break;
             }
 
-            if(changed)
+            // We don't need to refresh the filter if this is the presence
+            // filter, because it doesn't depend on any contact sources.
+            if(changed && !currentFilter.equals(presenceFilter))
             {
                 if(currentFilter.equals(defaultFilter))
                     applyDefaultFilter();

File: src/net/java/sip/communicator/impl/gui/main/chat/history/DatesPanel.java
Patch:
@@ -34,9 +34,9 @@ public class DatesPanel
     private final DefaultListModel listModel = new DefaultListModel();
 
     private final HistoryWindow historyWindow;
-    
+
     private int lastSelectedIndex = -1;
-    
+
     /**
      * Creates an instance of <tt>DatesPanel</tt>.
      *

File: src/net/java/sip/communicator/impl/gui/main/call/CallInfoFrame.java
Patch:
@@ -327,7 +327,8 @@ private void constructPeerInfo(CallPeer callPeer, StringBuffer stringBuffer)
                         resources.getI18NString(
                             "service.gui.callinfo.ICE_STATE"),
                         resources.getI18NString(
-                            "service.gui.callinfo.ICE_STATE." + iceState)));
+                            "service.gui.callinfo.ICE_STATE."
+                                + iceState.toUpperCase())));
                 }
 
                 stringBuffer.append("<br/>");

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -534,7 +534,7 @@ public void typingNotificationDeliveryFailed(TypingNotificationEvent evt)
 
         MetaContact metaContact = GuiActivator.getContactListService()
                 .findMetaContactByContact(evt.getSourceContact());
-        String contactName = metaContact.getDisplayName() + " ";
+        String contactName = metaContact.getDisplayName();
 
         if (contactName.equals(""))
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTypingNotificationsJabberImpl.java
Patch:
@@ -434,7 +434,7 @@ else if (ChatState.inactive.equals(state)
                 fireTypingNotificationsDeliveryFailedEvent(
                     sourceContact, evtCode);
             else  if(evtCode != STATE_UNKNOWN)
-                fireTypingNotificationsEvent(sourceContact, STATE_STOPPED);
+                fireTypingNotificationsEvent(sourceContact, evtCode);
             else
                 logger.warn("Unknown typing state!");
         }

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -990,7 +990,7 @@ public void mouseClicked(MouseEvent e)
             securityPanel.setBeginPoint(
                 new Point((int) newPoint.getX() + 15, 0));
             securityPanel.setBounds(
-                0, (int) newPoint.getY() - 5, this.getWidth(), 110);
+                0, (int) newPoint.getY() - 5, this.getWidth(), 130);
 
             glassPane.add(securityPanel);
             // Need to show the security panel explicitly in order to keep the

File: src/net/java/sip/communicator/util/swing/SIPCommTextField.java
Patch:
@@ -160,6 +160,7 @@ private void setDefaultText()
     {
         super.setText(defaultText);
         this.setForeground(defaultTextColor);
+        this.setCaretPosition(0);
     }
 
     /**

File: src/net/java/sip/communicator/util/swing/plaf/SIPCommTextFieldUI.java
Patch:
@@ -307,7 +307,7 @@ protected Rectangle getDeleteButtonRect()
      */
     protected Rectangle getVisibleEditorRect()
     {
-        if (!isDeleteButtonEnabled)
+        if (!isDeleteIconVisible)
         {
             return super.getVisibleEditorRect();
         }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListSearchKeyDispatcher.java
Patch:
@@ -86,7 +86,8 @@ public boolean dispatchKeyEvent(KeyEvent e)
                     .getSingleWindowContainer() != null)
                 && GuiActivator.getUIService()
                     .getSingleWindowContainer().containsFocus()
-            || keyManager.getFocusOwner() instanceof JTextComponent)
+            || (keyManager.getFocusOwner() != null
+                && keyManager.getFocusOwner() instanceof JTextComponent))
             return false;
 
         // Ctrl-Enter || Cmd-Enter typed when this window is the focused

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchField.java
Patch:
@@ -103,7 +103,7 @@ public void actionPerformed(ActionEvent e)
                 setText("");
 
                 if (SearchField.this.mainFrame != null)
-                    SearchField.this.mainFrame.requestFocusInCenterPanel();
+                    SearchField.this.mainFrame.requestFocusInContactList();
             }
         });
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -72,7 +72,7 @@ public class TreeContactList
     /**
      * Indicates if the right mouse button menu is enabled.
      */
-    private boolean isRightButtonMenuEnabled;
+    private boolean isRightButtonMenuEnabled = true;
 
     /**
      * A list of all contacts that are currently "active". An "active" contact

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -1930,8 +1930,10 @@ public Object construct() throws Exception
             {
                 ChatConversationPanel conversationPanel
                     = getChatConversationPanel();
+
                 Date firstMsgDate
                     = conversationPanel.getPageFirstMsgTimestamp();
+
                 Collection<Object> c = null;
 
                 if(firstMsgDate != null)

File: src/net/java/sip/communicator/impl/gui/main/chat/history/DatesPanel.java
Patch:
@@ -12,7 +12,6 @@
 import javax.swing.*;
 import javax.swing.event.*;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.lookandfeel.*;
 import net.java.sip.communicator.util.swing.*;
 

File: src/net/java/sip/communicator/util/swing/SwingWorker.java
Patch:
@@ -152,12 +152,12 @@ public Object get()
         {
             boolean interrupted = false;
 
-            while (!future.isDone())
+            do
             {
-                value = null;
                 try
                 {
                     value = future.get();
+                    break;
                 }
                 catch (CancellationException ce)
                 {
@@ -172,6 +172,7 @@ public Object get()
                     interrupted = true;
                 }
             }
+            while (true);
             if (interrupted) // propagate
                 Thread.currentThread().interrupt();
         }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -948,11 +948,10 @@ private void processJingleIQ(final JingleIQ jingleIQ)
 
             if(error != null)
             {
+                message += "\ncode=" + error.getCode()
+                    + " message=" + error.getMessage();
                 logger.error(" code=" + error.getCode()
                                 + " message=" + error.getMessage());
-
-                if (error.getMessage() != null)
-                    message = error.getMessage();
             }
 
             if (callPeer != null)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -906,7 +906,7 @@ private void appendChatMessage(ChatMessage chatMessage)
      * Passes the message to the contained <code>ChatConversationPanel</code>
      * for processing and replaces the specified message with this one.
      *
-     * @param chatMessage The message used as a correction.
+     * @param message The message used as a correction.
      */
     private void applyMessageCorrection(ChatMessage message)
     {

File: src/net/java/sip/communicator/service/protocol/media/CallPeerMediaHandler.java
Patch:
@@ -1657,7 +1657,7 @@ public List<MediaFormat> getLocallySupportedFormats(MediaDevice mediaDevice,
             QualityPreset receivePreset)
     {
         if(mediaDevice == null)
-            return new LinkedList<MediaFormat>();
+            return Collections.emptyList();
 
         boolean accountOverridesEncodings = false;
 

File: src/net/java/sip/communicator/impl/neomedia/MediaConfigurationImpl.java
Patch:
@@ -41,8 +41,8 @@
 public class MediaConfigurationImpl implements MediaConfigurationService
 {
     /**
-     * The <tt>Logger</tt> used by the <tt>MediaConfigurationImpl</tt> class for
-     * logging output.
+     * The <tt>Logger</tt> used by the <tt>MediaConfigurationServiceImpl</tt>
+     * class for logging output.
      */
     private static final Logger logger
         = Logger.getLogger(MediaConfigurationImpl.class);

File: src/net/java/sip/communicator/service/protocol/media/CallPeerMediaHandler.java
Patch:
@@ -1652,7 +1652,7 @@ public List<MediaFormat> getLocallySupportedFormats(MediaDevice mediaDevice,
         boolean accountOverridesEncodings = false;
         EncodingConfiguration encodingConfiguration
                 = ProtocolMediaActivator.getMediaService()
-                            .getNewEncodingConfiguration();;
+                            .getNewEncodingConfiguration();
         
         Map<String, String> properties 
                 = getPeer().getProtocolProvider()

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -1117,7 +1117,6 @@ public void callStateChanged(CallChangeEvent evt)
         call.addCallChangeListener(callChangeListener);
         try
         {
-            dialog.setModal(true);
             dialog.pack();
             dialog.setVisible(true);
         }

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryContactSource.java
Patch:
@@ -291,6 +291,6 @@ public int getType()
      */
     public int getIndex()
     {
-        return 0;
+        return -1;
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -114,6 +114,7 @@ else if (sourceContactList.getDefaultFilter()
         // Closes this filter to indicate that we finished adding queries to it.
         if (filterQuery.isRunning())
             filterQuery.close();
+
         else if (!sourceContactList.isEmpty())
             sourceContactList.selectFirstContact();
     }

File: src/net/java/sip/communicator/impl/neomedia/MediaConfigurationImpl.java
Patch:
@@ -633,7 +633,6 @@ private Component createControls(int type)
      * <tt>MediaType.VIDEO</tt>
      * @return The component for encodings configuration.
      */
-    @Override
     public Component createEncodingControls(MediaType mediaType,
             EncodingConfiguration encodingConfiguration,
             boolean autoUpdateConfig)

File: src/net/java/sip/communicator/impl/gui/main/account/AccountList.java
Patch:
@@ -312,7 +312,8 @@ private void dispatchEventToCheckBox(MouseEvent event)
         Account account = (Account) getModel().getElementAt(mouseIndex);
 
         if (logger.isTraceEnabled())
-            logger.trace("Account list: element at mouse index:" + account);
+            logger.trace("Account list: element at mouse index:"
+                    + account.getName());
 
         AccountListCellRenderer renderer
             = (AccountListCellRenderer) getCellRenderer()

File: src/net/java/sip/communicator/impl/gui/main/contactlist/notifsource/NotificationContact.java
Patch:
@@ -32,7 +32,7 @@
  * @author Yana Stamcheva
  */
 public class NotificationContact
-    extends  UIContact
+    extends  UIContactImpl
     implements  RegistrationStateChangeListener,
                 ProviderPresenceStatusListener
 {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/notifsource/NotificationGroup.java
Patch:
@@ -25,7 +25,7 @@
  * @author Yana Stamcheva
  */
 public class NotificationGroup
-    extends UIGroup
+    extends UIGroupImpl
 {
     /**
      * The type of the notification message, identifying this group.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -635,7 +635,7 @@ private void addLabels(int nameLabelGridWidth)
         constraints.fill = GridBagConstraints.NONE;
         constraints.gridx = 1;
         constraints.gridy = 1;
-        constraints.weightx = 0f;
+        constraints.weightx = 1f;
         constraints.weighty = 0f;
         constraints.gridwidth = nameLabelGridWidth;
         constraints.gridheight = 1;
@@ -669,7 +669,7 @@ private void initDisplayDetails(UIContact contact)
         constraints.fill = GridBagConstraints.NONE;
         constraints.gridx = 1;
         constraints.gridy = 1;
-        constraints.weightx = 0f;
+        constraints.weightx = 1f;
         constraints.weighty = 0f;
         constraints.gridwidth = 1;
         constraints.gridheight = 1;

File: src/net/java/sip/communicator/impl/gui/main/SingleWindowContainer.java
Patch:
@@ -73,13 +73,13 @@ public SingleWindowContainer()
         super(new BorderLayout());
         setPreferredSize(new Dimension(620, 580));
 
-        add(createToolbar(), BorderLayout.NORTH);
-
         tabbedPane = new ConversationTabbedPane();
-        tabbedPane.addChangeListener(this);
         contactPhotoPanel = new ContactPhotoPanel(
             GuiActivator.getUIService().getMainFrame());
 
+        add(createToolbar(), BorderLayout.NORTH);
+        tabbedPane.addChangeListener(this);
+
         add(tabbedPane);
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -496,8 +496,9 @@ public Iterable<ContentPacketExtension> generateSessionAccept()
 
             //let's now see what was the format we announced as first and
             //configure the stream with it.
+            String contentName = ourContent.getName();
             ContentPacketExtension theirContent
-                = this.remoteContentMap.get(ourContent.getName());
+                = this.remoteContentMap.get(contentName);
             RtpDescriptionPacketExtension theirDescription
                 = JingleUtils.getRtpDescription(theirContent);
             MediaFormat format = null;
@@ -560,7 +561,7 @@ public Iterable<ContentPacketExtension> generateSessionAccept()
 
             // create the corresponding stream...
             initStream(
-                    ourContent.getName(),
+                    contentName,
                     connector,
                     dev,
                     format,

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerGTalkImpl.java
Patch:
@@ -13,7 +13,6 @@
 import net.java.sip.communicator.impl.protocol.jabber.extensions.jingle.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
-import net.java.sip.communicator.service.protocol.media.*;
 import net.java.sip.communicator.util.*;
 
 import org.jivesoftware.smack.packet.*;

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCall.java
Patch:
@@ -205,7 +205,7 @@ protected void addCallPeer(T callPeer)
             if(getCallPeersVector().isEmpty())
             {
                 callPeer.getMediaHandler().setLocalUserAudioLevelListener(
-                                localAudioLevelDelegator);
+                        localAudioLevelDelegator);
             }
         }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -1145,14 +1145,14 @@ public void openChat(ChatPanel chatPanel, boolean setSelected)
 
         if(getExtendedState() != JFrame.ICONIFIED)
         {
-            if(ConfigurationManager.isAutoPopupNewMessage() || setSelected)
+            if (ConfigurationManager.isAutoPopupNewMessage() || setSelected)
             {
                 if (!isVisible())
                     setVisible(true);
 
                 toFront();
             }
-            else
+            else if (!isWindowVisible)
             {
                 setFocusableWindowState(false);
                 setVisible(true);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -385,8 +385,7 @@ public void actionPerformed(ActionEvent e)
                     GuiActivator.getResources().getI18NString(
                     "service.gui.ADD_CONTACT_ERROR_TITLE"),
                     GuiActivator.getResources().getI18NString(
-                            "service.gui.ADD_CONTACT_NOT_CONNECTED",
-                            new String[]{contactAddress}),
+                            "service.gui.ADD_CONTACT_NOT_CONNECTED"),
                     ErrorDialog.WARNING)
                 .showDialog();
 

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferencePeerPanel.java
Patch:
@@ -82,7 +82,7 @@ public class ConferencePeerPanel
     /**
      * The component showing the security details.
      */
-    private SecurityPanel securityPanel;
+    private SecurityPanel<?> securityPanel;
 
     /**
      * The call peer adapter.
@@ -309,7 +309,7 @@ public void securityTimeout(CallPeerSecurityTimeoutEvent evt)
         {
             try
             {
-                AbstractCallPeer peer = (AbstractCallPeer)evt.getSource();
+                CallPeer peer = (CallPeer) evt.getSource();
                 OperationSetBasicTelephony<?> telephony
                     = peer.getProtocolProvider().getOperationSet(
                             OperationSetBasicTelephony.class);

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -16,7 +16,6 @@
 import javax.swing.*;
 import javax.swing.UIManager.LookAndFeelInfo;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.lookandfeel.*;
 import net.java.sip.communicator.impl.gui.main.*;

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardController.java
Patch:
@@ -12,8 +12,8 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.service.gui.*;
+import net.java.sip.communicator.util.swing.*;
 
 /**
  * This class is responsible for reacting to events generated by pushing any

File: src/net/java/sip/communicator/impl/gui/main/call/CallTransferHandler.java
Patch:
@@ -14,7 +14,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/main/call/ChooseCallAccountPopupMenu.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransferHandler.java
Patch:
@@ -16,7 +16,6 @@
 import javax.swing.text.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.contactsource.*;
 import net.java.sip.communicator.service.contactlist.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomSubjectPanel.java
Patch:
@@ -12,7 +12,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -10,7 +10,6 @@
 import java.util.concurrent.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.history.*;
 import net.java.sip.communicator.impl.gui.main.chatroomslist.*;
@@ -22,7 +21,8 @@
 import net.java.sip.communicator.service.protocol.globalstatus.*;
 import net.java.sip.communicator.util.*;
 
-import org.jdesktop.swingworker.*;
+import net.java.sip.communicator.util.swing.*;
+import org.jdesktop.swingworker.SwingWorker;
 import org.jitsi.service.resources.*;
 import org.osgi.framework.*;
 // Java 1.6 has javax.swing.SwingWorker so we have to disambiguate.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -16,7 +16,6 @@
 import javax.swing.tree.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.contactsource.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListUtils.java
Patch:
@@ -7,10 +7,10 @@
 package net.java.sip.communicator.impl.gui.main.contactlist;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.swing.*;
 
 public class ContactListUtils
 {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MetaContactListManager.java
Patch:
@@ -13,6 +13,7 @@
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.protocol.*;
+import net.java.sip.communicator.util.swing.*;
 
 /**
  * The <tt>MetaContactListManager</tt> is the class through which we make

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MetaContactRightButtonMenu.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.authorization.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SourceContactRightButtonMenu.java
Patch:
@@ -14,7 +14,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.contactsource.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -15,6 +15,7 @@
 import net.java.sip.communicator.service.protocol.globalstatus.*;
 import net.java.sip.communicator.util.*;
 
+import net.java.sip.communicator.util.swing.*;
 import org.osgi.framework.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/menus/ToolsMenu.java
Patch:
@@ -12,7 +12,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.call.*;

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusServiceImpl.java
Patch:
@@ -6,11 +6,11 @@
 package net.java.sip.communicator.impl.gui.main.presence;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.login.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.globalstatus.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.swing.*;
 import org.jitsi.service.configuration.*;
 
 import java.util.*;

File: src/net/java/sip/communicator/plugin/dnsconfig/DnssecPanel.java
Patch:
@@ -14,7 +14,6 @@
 import javax.swing.plaf.basic.*;
 import javax.swing.table.*;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.dns.*;
 import net.java.sip.communicator.util.swing.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -389,6 +389,8 @@ protected void windowClosing(WindowEvent e)
 
     /**
      * Returns the next date from the history.
+     * When <tt>date</tt> is the last one, we return the current date,
+     * means we are loading today messages (till now).
      * 
      * @param date The date which indicates where to start.
      * @return the date after the given date
@@ -408,8 +410,7 @@ public Date getNextDateFromHistory(Date date)
             }
         }
 
-        long ts = System.currentTimeMillis();
-        return new Date(ts - ts % (24*60*60*1000));
+        return new Date(System.currentTimeMillis());
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/media/CallPeerMediaHandler.java
Patch:
@@ -1018,7 +1018,7 @@ private void callPropertyChange(PropertyChangeEvent event)
                 if (oldValue != newValue)
                 {
                     stream.setDevice(newValue);
-                    registerAudioLevelListeners((AudioMediaStream)stream);
+                    registerAudioLevelListeners((AudioMediaStream) stream);
                 }
             }
         }

File: src/net/java/sip/communicator/impl/neomedia/device/DeviceConfiguration.java
Patch:
@@ -108,7 +108,7 @@ public class DeviceConfiguration
     /**
      * The default value for video maximum bandwidth.
      */
-    public static final int DEFAULT_VIDEO_MAX_BANDWIDTH = 100;
+    public static final int DEFAULT_VIDEO_MAX_BANDWIDTH = 256;
 
     /**
      * The default video width.
@@ -885,7 +885,7 @@ public void setVideoMaxBandwidth(int videoMaxBandwidth)
      * Gets the frame rate set on this <tt>DeviceConfiguration</tt>.
      *
      * @return the frame rate set on this <tt>DeviceConfiguration</tt>. The
-     * default value is {@link #DEFAULT_FRAME_RATE}
+     * default value is {@link #DEFAULT_VIDEO_FRAMERATE}
      */
     public int getFrameRate()
     {

File: src/net/java/sip/communicator/plugin/generalconfig/autoaway/AutoAwayWatcher.java
Patch:
@@ -174,6 +174,9 @@ private void changeProtocolsToAway()
                     .getOperationSet(
                             OperationSetPresence.class);
 
+            if(presence == null)
+                continue;
+
             PresenceStatus status = presence
                     .getPresenceStatus();
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetContactCapabilitiesJabberImpl.java
Patch:
@@ -58,7 +58,7 @@ public class OperationSetContactCapabilitiesJabberImpl
             = new HashMap<Class<? extends OperationSet>, String[]>();
 
     /**
-     * The <tt>Map</tt> which associates specific additionnal
+     * The <tt>Map</tt> which associates specific additional
      * <tt>OperationSet</tt> class with the capabilities to be supported by a
      * <tt>Contact</tt> in order to consider the <tt>Contact</tt> to possess the
      * respective <tt>OperationSet</tt> capability.

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetContactCapabilities.java
Patch:
@@ -20,7 +20,7 @@
  * @param <T> the type of the <tt>ProtocolProviderService</tt> implementation
  * providing the <tt>AbstractOperationSetContactCapabilities</tt> implementation
  *
- * @author Lubomir Marinov
+ * @author Lyubomir Marinov
  */
 public abstract class AbstractOperationSetContactCapabilities<
         T extends ProtocolProviderService>
@@ -152,7 +152,7 @@ protected void fireContactCapabilitiesEvent(
      * the specified <tt>opsetClass</tt> in the <tt>Map</tt> returned by
      * {@link #getSupportedOperationSets(Contact)} and returns the associated
      * <tt>OperationSet</tt>. Since the implementation is suboptimal due to the
-     * temporary <tt>Map</tt> allocations and loopups, extenders are advised to
+     * temporary <tt>Map</tt> allocations and lookups, extenders are advised to
      * override {@link #getOperationSet(Contact, Class, boolean)}.
      *
      * @param <U> the type extending <tt>OperationSet</tt> for which the
@@ -188,7 +188,7 @@ public <U extends OperationSet> U getOperationSet(
      * the specified <tt>opsetClass</tt> in the <tt>Map</tt> returned by
      * {@link #getSupportedOperationSets(Contact)} and returns the associated
      * <tt>OperationSet</tt>. Since the implementation is suboptimal due to the
-     * temporary <tt>Map</tt> allocations and loopups, extenders are advised to
+     * temporary <tt>Map</tt> allocations and lookups, extenders are advised to
      * override.
      *
      * @param <U> the type extending <tt>OperationSet</tt> for which the

File: src/net/java/sip/communicator/service/protocol/OperationSetContactCapabilities.java
Patch:
@@ -17,7 +17,7 @@
  * associated protocol provider to be capabilities possessed by the
  * <tt>Contact</tt> in question.
  *
- * @author Lubomir Marinov
+ * @author Lyubomir Marinov
  */
 public interface OperationSetContactCapabilities
     extends OperationSet

File: src/net/java/sip/communicator/impl/neomedia/MediaConfiguration.java
Patch:
@@ -57,21 +57,21 @@ public class MediaConfiguration
      * should be disabled, i.e. not visible to the user.
      */
     private static final String DEVICES_DISABLED_PROP
-        = "net.java.sip.communicator.impl.neomedia.DEVICES_CONFIG_DISABLED";
+        = "net.java.sip.communicator.impl.neomedia.devicesconfig.DISABLED";
 
     /**
      * Indicates if the Audio/Video encodings configuration tab
      * should be disabled, i.e. not visible to the user.
      */
     private static final String ENCODINGS_DISABLED_PROP
-        = "net.java.sip.communicator.impl.neomedia.ENCODINGS_CONFIG_DISABLED";
+        = "net.java.sip.communicator.impl.neomedia.encodingsconfig.DISABLED";
 
      /**
      * Indicates if the Video/More Settings configuration tab
      * should be disabled, i.e. not visible to the user.
      */
     private static final String VIDEO_MORE_SETTINGS_DISABLED_PROP
-        = "net.java.sip.communicator.impl.neomedia.VIDEO_MORE_SETTINGS_CONFIG_DISABLED";
+        = "net.java.sip.communicator.impl.neomedia.videomoresettingsconfig.DISABLED";
 
     /**
      * The bundle context.

File: src/net/java/sip/communicator/impl/neomedia/NeomediaActivator.java
Patch:
@@ -72,21 +72,21 @@ public class NeomediaActivator
      * not visible to the user.
      */
     private static final String H264_CONFIG_DISABLED_PROP
-        = "net.java.sip.communicator.impl.neomedia.H264_CONFIG_DISABLED";
+        = "net.java.sip.communicator.impl.neomedia.h264config.DISABLED";
 
     /**
      * Indicates if the ZRTP configuration form should be disabled, i.e.
      * not visible to the user.
      */
     private static final String ZRTP_CONFIG_DISABLED_PROP
-        = "net.java.sip.communicator.impl.neomedia.ZRTP_CONFIG_DISABLED";
+        = "net.java.sip.communicator.impl.neomedia.zrtpconfig.DISABLED";
 
     /**
      * Indicates if the call recording config form should be disabled, i.e.
      * not visible to the user.
      */
     private static final String CALL_RECORDING_CONFIG_DISABLED_PROP
-        = "net.java.sip.communicator.impl.neomedia.CALL_RECORDING_CONFIG_DISABLED";
+        = "net.java.sip.communicator.impl.neomedia.callrecordingconfig.DISABLED";
 
     /**
      * The context in which the one and only <tt>NeomediaActivator</tt> instance

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigPluginActivator.java
Patch:
@@ -87,7 +87,7 @@ public class GeneralConfigPluginActivator
      */
     private static final String SIP_CONFIG_DISABLED_PROP
         =
-        "net.java.sip.communicator.plugin.generalconfig.SIP_CONFIG_DISABLED";
+        "net.java.sip.communicator.plugin.generalconfig.sipconfig.DISABLED";
 
     /**
      * Starts this bundle.

File: src/net/java/sip/communicator/plugin/otr/OtrActivator.java
Patch:
@@ -33,7 +33,7 @@ public class OtrActivator
      * not visible to the user.
      */
     private static final String OTR_CHAT_CONFIG_DISABLED_PROP
-        = "net.java.sip.communicator.impl.neomedia.OTR_CHAT_CONFIG_DISABLED";
+        = "net.java.sip.communicator.plugin.otr.otrchatconfig.DISABLED";
 
     /**
      * The {@link BundleContext} of the {@link OtrActivator}.

File: src/net/java/sip/communicator/plugin/securityconfig/SecurityConfigActivator.java
Patch:
@@ -72,7 +72,7 @@ public class SecurityConfigActivator
      * not visible to the user.
      */
     private static final String MASTER_PASSWORD_DISABLED_PROP
-        = "net.java.sip.communicator.plugin.securityconfig.MASTER_PASSWORD_DISABLED";
+        = "net.java.sip.communicator.plugin.securityconfig.masterpasswordconfig.DISABLED";
 
     /**
      * Starts this plugin.

File: src/net/java/sip/communicator/plugin/update/UpdateActivator.java
Patch:
@@ -45,7 +45,7 @@ public class UpdateActivator
      * "checking for updates" menu entry is disabled.
      */
     private static final String CHECK_FOR_UPDATES_MENU_DISABLED_PROP
-        = "net.java.sip.communicator.plugin.update.CHECK_FOR_UPDATES_MENU_DISABLED";
+        = "net.java.sip.communicator.plugin.update.checkforupdatesmenu.DISABLED";
 
     /**
      * Reference to the <tt>BrowserLauncherService</tt>.

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -106,15 +106,15 @@ public class UIServiceImpl
 
     private LoginManager loginManager;
 
-    private ChatWindowManager chatWindowManager
+    private final ChatWindowManager chatWindowManager
         = new ChatWindowManager();
 
-    private ConferenceChatManager conferenceChatManager
+    private final ConferenceChatManager conferenceChatManager
         = new ConferenceChatManager();
 
     private ConfigurationFrame configurationFrame;
 
-    private HistoryWindowManager historyWindowManager
+    private final HistoryWindowManager historyWindowManager
         = new HistoryWindowManager();
 
     private SingleWindowContainer singleWindowContainer;

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomList.java
Patch:
@@ -38,7 +38,7 @@ public class ChatRoomList
     /**
      * All ChatRoomProviderWrapperListener change listeners registered so far.
      */
-    private List<ChatRoomProviderWrapperListener> providerChangeListeners
+    private final List<ChatRoomProviderWrapperListener> providerChangeListeners
         = new ArrayList<ChatRoomProviderWrapperListener>();
 
     /**
@@ -372,7 +372,7 @@ public synchronized void addChatRoomProviderWrapperListener(
     public synchronized void removeChatRoomProviderWrapperListener(
         ChatRoomProviderWrapperListener listener)
     {
-        providerChangeListeners.add(listener);
+        providerChangeListeners.remove(listener);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerJabberImpl.java
Patch:
@@ -948,7 +948,7 @@ else if(senders == SendersEnum.none)
         }
         else
         {
-            if(senders == SendersEnum.both)
+            if(senders == SendersEnum.both || senders == null)
             {
                 senders
                     = isInitiator

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetServerStoredAccountInfoJabberImpl.java
Patch:
@@ -60,8 +60,8 @@ protected OperationSetServerStoredAccountInfoJabberImpl(
      * @return a java.util.Iterator over all details that are instances or
      * descendants of the specified class.
      */
-    public Iterator<GenericDetail> getDetailsAndDescendants(
-        Class<? extends GenericDetail> detailClass)
+    public <T extends GenericDetail> Iterator<T> getDetailsAndDescendants(
+        Class<T> detailClass)
     {
         assertConnected();
 

File: src/net/java/sip/communicator/impl/protocol/sip/ContactGroupSipImpl.java
Patch:
@@ -416,7 +416,7 @@ public ContactSipImpl findContactByID(String id)
                 return mContact;
         }
 
-        //if we didn't find it here, let's try in the subougroups
+        //if we didn't find it here, let's try in the subgroups
         Iterator<ContactGroup> groupsIter = subgroups();
 
         while( groupsIter.hasNext() )

File: src/net/java/sip/communicator/service/protocol/OperationSetServerStoredAccountInfo.java
Patch:
@@ -60,8 +60,8 @@ public interface OperationSetServerStoredAccountInfo
      * @return a java.util.Iterator over all details that are instances or
      * descendants of the specified class.
      */
-    public Iterator<GenericDetail> getDetailsAndDescendants(
-        Class<? extends GenericDetail> detailClass);
+    public <T extends GenericDetail> Iterator<T> getDetailsAndDescendants(
+        Class<T> detailClass);
 
     /**
      * Returns an iterator over all details that are instances of exactly the

File: src/net/java/sip/communicator/service/protocol/OperationSetServerStoredContactInfo.java
Patch:
@@ -48,9 +48,9 @@ public interface OperationSetServerStoredContactInfo
      * @return a java.util.Iterator over all details that are instances or
      * descendants of the specified class.
      */
-    public Iterator<GenericDetail> getDetailsAndDescendants(
+    public <T extends GenericDetail> Iterator<T> getDetailsAndDescendants(
         Contact contact,
-        Class<? extends GenericDetail> detailClass);
+        Class<T> detailClass);
 
     /**
      * Returns an iterator over all details that are instances of exactly the

File: src/net/java/sip/communicator/impl/callhistory/CallHistorySourceContact.java
Patch:
@@ -129,7 +129,9 @@ private void initPeerDetails()
                         preferredProvider.getOperationSet(
                                 OperationSetPresence.class);
 
-                    Contact contact = opSetPres.findContactByID(peerAddress);
+                    Contact contact = null;
+                    if(opSetPres != null)
+                        contact = opSetPres.findContactByID(peerAddress);
 
                     OperationSetContactCapabilities opSetCaps =
                         preferredProvider.getOperationSet(

File: src/net/java/sip/communicator/plugin/update/Update.java
Patch:
@@ -851,7 +851,7 @@ private static void windowsUpdate()
 
             Version ver = getCurrentVersion();
 
-            if(ver.isPreRelease())
+            if(ver.isNightly())
                 deltaTarget = ver.getNightlyBuildID();
             else
                 deltaTarget = String.valueOf(ver.getVersionRevision());

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -856,8 +856,8 @@ private String processKeyword(  String message,
         }
 
         Matcher m
-            = Pattern
-                .compile(keyword, Pattern.CASE_INSENSITIVE).matcher(message);
+            = Pattern.compile(Pattern.quote(keyword), Pattern.CASE_INSENSITIVE)
+                .matcher(message);
         StringBuffer msgBuffer = new StringBuffer();
         int prevEnd = 0;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -2341,7 +2341,8 @@ public void processPacket(Packet packet)
 
             // Check if the MUCUser informs that the invitee
             // has declined the invitation
-            if (mucUser.getDecline() != null
+            if (mucUser != null
+                && mucUser.getDecline() != null
                 && ((org.jivesoftware.smack.packet.Message) packet).getType()
                     != org.jivesoftware.smack.packet.Message.Type.error)
             {

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceParticipantPanel.java
Patch:
@@ -270,10 +270,10 @@ private void initPeerDetailsPanel()
 
         peerDetailsPanel.add(imageLabel, constraints);
 
-        constraints.fill = GridBagConstraints.HORIZONTAL;
+        constraints.fill = GridBagConstraints.BOTH;
         constraints.gridx = 1;
         constraints.gridy = 0;
-        constraints.weightx = 1;
+        constraints.weightx = 1f;
         constraints.weighty = 0;
         constraints.insets = new Insets(5, 20, 5, 20);
 

File: src/net/java/sip/communicator/impl/gui/main/call/UIVideoHandler.java
Patch:
@@ -455,6 +455,7 @@ public void videoRemoved(VideoEvent event)
         {
             CallPanel callContainer = callRenderer.getCallContainer();
             if (callContainer.isConference()
+                && callPeer.getCall() != null
                 && !CallManager.isVideoStreaming(callPeer.getCall())
                 && callContainer.isVideoConferenceInterfaceEnabled())
             {

File: src/net/java/sip/communicator/impl/neomedia/MediaServiceImpl.java
Patch:
@@ -916,8 +916,8 @@ public Object getVideoPreviewComponent(
                  */
                 if ((preferredWidth < 128) || (preferredHeight < 96))
                 {
-                    preferredHeight = 128;
-                    preferredWidth = 96;
+                    preferredWidth = 128;
+                    preferredHeight = 96;
                 }
                 VideoMediaStreamImpl.selectVideoSize(
                         dataSource,

File: src/net/java/sip/communicator/impl/globalshortcut/GlobalShortcutServiceImpl.java
Patch:
@@ -374,6 +374,7 @@ public synchronized void reloadGlobalShortcuts()
         {
             if(entry.getKey().equals("answer") ||
                 entry.getKey().equals("hangup") ||
+                entry.getKey().equals("answer_hangup") ||
                 entry.getKey().equals("mute"))
             {
                 for(AWTKeyStroke e : entry.getValue())

File: src/net/java/sip/communicator/impl/keybindings/KeybindingsServiceImpl.java
Patch:
@@ -336,8 +336,8 @@ public Map<String, List<AWTKeyStroke>> getGlobalShortcutFromConfiguration()
         String shortcut2 = null;
         String propName = null;
         String propName2 = null;
-        String names[] = new String[]{"answer", "hangup", "contactlist",
-            "mute"};
+        String names[] = new String[]{"answer", "hangup", "answer_hangup",
+            "contactlist", "mute"};
         Object configured = configService.getProperty(
             "net.java.sip.communicator.impl.keybinding.global.configured");
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/caps/EntityCapsManager.java
Patch:
@@ -999,7 +999,6 @@ public boolean isValid(DiscoverInfo discoverInfo)
         {
             return
                 (discoverInfo != null)
-                    && getNodeVer().equals(discoverInfo.getNode())
                     && !hash.equals("")
                     && ver.equals(
                             capsToHash(

File: src/net/java/sip/communicator/impl/neomedia/device/PulseAudioSystem.java
Patch:
@@ -116,7 +116,7 @@ public void run()
                         PA.context_connect(
                                 context,
                                 null,
-                                PA.CONTEXT_NOFAIL,
+                                PA.CONTEXT_NOFLAGS,
                                 0);
 
                         try

File: src/net/java/sip/communicator/impl/neomedia/device/DeviceConfiguration.java
Patch:
@@ -65,7 +65,7 @@ public class DeviceConfiguration
     private static final String[] CUSTOM_RENDERERS
         = new String[]
         {
-            ".audio.PulseAudioRenderer",
+            OSUtils.IS_LINUX ? ".audio.PulseAudioRenderer" : null,
             ".audio.PortAudioRenderer",
             ".video.JAWTRenderer"
         };
@@ -731,6 +731,8 @@ private void registerCustomRenderers()
 
         for (String customRenderer : CUSTOM_RENDERERS)
         {
+            if (customRenderer == null)
+                continue;
             if (customRenderer.startsWith("."))
             {
                 customRenderer

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -180,8 +180,6 @@ public class OneToOneCallPeerPanel
      */
     private final JLabel photoLabel;
 
-    private boolean localVideoVisible = true;
-
     private final UIVideoHandler videoHandler;
 
     /**
@@ -1162,7 +1160,7 @@ public void setLocalVideoVisible(boolean isVisible)
      */
     public boolean isLocalVideoVisible()
     {
-        return localVideoVisible;
+        return videoHandler.isLocalVideoVisible();
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/conference/AudioMixingPushBufferStream.java
Patch:
@@ -232,10 +232,12 @@ private static int[] mix(
             int[] inputStreamSamples = inputSamples[0];
 
             if (inputStreamSamples != null)
+            {
                 System.arraycopy(
                         inputStreamSamples, 0,
                         outputSamples, 0,
                         inputStreamSamples.length);
+            }
             return outputSamples;
         }
 
@@ -252,7 +254,6 @@ private static int[] mix(
 
         for (int[] inputStreamSamples : inputSamples)
         {
-
             if (inputStreamSamples == null)
                 continue;
 

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -733,7 +733,7 @@ public void securityOn(CallPeerSecurityOnEvent evt)
             && !isSecurityLowPriority
             && (!((ZrtpControl) srtpControl).isSecurityVerified() 
                 || ((ZrtpSecurityPanel) securityPanel).isZidAorMismatch()))
-
+        {
             setSecurityPanelVisible(true);
         }
 

File: src/net/java/sip/communicator/impl/neomedia/conference/AudioMixerPushBufferStream.java
Patch:
@@ -712,7 +712,7 @@ else if (inputData instanceof byte[])
                 logger.trace(
                         "Read inputFormat with sampleSizeInBits "
                             + inputSampleSizeInBits
-                            + ". Will convert to sampleSizeInBits"
+                            + ". Will convert to sampleSizeInBits "
                             + outputSampleSizeInBits);
 
             byte[] inputSamples = (byte[]) inputData;

File: src/net/java/sip/communicator/impl/neomedia/device/MediaDeviceSession.java
Patch:
@@ -1409,7 +1409,7 @@ protected void setCaptureDeviceFormat(
         if (format instanceof AudioFormat)
         {
             AudioFormat audioFormat = (AudioFormat) format;
-            int channels = Format.NOT_SPECIFIED; // audioFormat.getChannels();
+            int channels = Format.NOT_SPECIFIED;
             double sampleRate
                 = OSUtils.IS_ANDROID
                     ? audioFormat.getSampleRate()

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameContactDialog.java
Patch:
@@ -143,7 +143,7 @@ public void run()
         }
         else if (name.equals("clear"))
         {
-            clist.clearDisplayNameUserDefined(metaContact);
+            clist.clearUserDefinedDisplayName(metaContact);
         }
         this.dispose();
     }

File: src/net/java/sip/communicator/impl/neomedia/transform/zrtp/ZRTPTransformEngine.java
Patch:
@@ -1425,8 +1425,6 @@ public void handleGoClear()
 
     /**
      * Sets the RTP connector using this ZRTP engine
-     * (This method should be changed to an addConnector to a connector array
-     *  managed by the engine for implementing multistream mode)
      *
      * @param connector the connector to set
      */

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -1472,7 +1472,7 @@ private byte[] getAvatar(ContactJabberImpl contact)
                 {
                     logger.debug(
                             "Cannot load image for contact "
-                                + this
+                                + contact
                                 + ": "
                                 + ex.getMessage(),
                             ex);

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryServiceImpl.java
Patch:
@@ -665,7 +665,7 @@ private void writeCall( CallRecordImpl callRecord,
                     .getStartTime().getTime()));
                 callPeerEndTime.append(String.valueOf(item.getEndTime()
                     .getTime()));
-                callPeerStates.append(item.getState().getLocalizedStateString());
+                callPeerStates.append(item.getState().getStateString());
             }
 
             historyWriter.addRecord(new String[] {

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -716,7 +716,8 @@ public void securityOn(CallPeerSecurityOnEvent evt)
                 = SecurityPanel.create(this, callPeer, srtpControl);
 
             if (srtpControl instanceof ZrtpControl)
-                ((ZrtpSecurityPanel)securityPanel).setSecurityStatusLabel(securityStatusLabel);
+                ((ZrtpSecurityPanel) securityPanel)
+                    .setSecurityStatusLabel(securityStatusLabel);
         }
 
         securityPanel.securityOn(evt);

File: src/net/java/sip/communicator/impl/gui/main/call/CallPeerAdapter.java
Patch:
@@ -102,7 +102,7 @@ else if (CallPeerState.isOnHold(newState))
             renderer.getCallPanel().updateHoldButtonState();
         }
 
-        renderer.setPeerState(newState, newStateString);
+        renderer.setPeerState(oldState, newState, newStateString);
 
         String reasonString = evt.getReasonString();
         if (reasonString != null)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -1024,14 +1024,14 @@ else if(d instanceof MobilePhoneDetail)
                                     localizedType = 
                                         GuiActivator.getResources().
                                             getI18NString(
-                                                "service.gui.MOBILE_PHONE");                                    
+                                                "service.gui.MOBILE_PHONE");
                                 }
                                 else
                                 {
                                     localizedType = 
                                         GuiActivator.getResources().
                                             getI18NString(
-                                                "service.gui.PHONE");                                    
+                                                "service.gui.PHONE");
                                 }
                                     
                                 phones.add(pnd.getNumber());

File: src/net/java/sip/communicator/impl/neomedia/transform/sdes/SDesControlImpl.java
Patch:
@@ -133,7 +133,8 @@ public void start(MediaType type)
         srtpListener.securityNegotiationStarted(
             type.equals(MediaType.AUDIO) ?
                 SecurityEventManager.AUDIO_SESSION
-                : SecurityEventManager.VIDEO_SESSION);
+                : SecurityEventManager.VIDEO_SESSION,
+                this);
 
         srtpListener.securityTurnedOn(
             type.equals(MediaType.AUDIO) ?

File: src/net/java/sip/communicator/impl/neomedia/transform/zrtp/SecurityEventManager.java
Patch:
@@ -441,7 +441,8 @@ public void securityNegotiationStarted()
         // make sure we don't throw any exception
         try
         {
-            this.securityListener.securityNegotiationStarted(sessionType);
+            this.securityListener
+                    .securityNegotiationStarted(sessionType, zrtpControl);
         }
         catch(Throwable t)
         {

File: src/net/java/sip/communicator/impl/neomedia/transform/zrtp/ZRTPTransformEngine.java
Patch:
@@ -901,7 +901,7 @@ public void srtpSecretsOn(String c, String s, boolean verified)
             securityEventManager.secureOn(c);
         }
 
-        if (securityEventManager != null && s != null)
+        if (securityEventManager != null && (s != null || verified))
         {
             securityEventManager.showSAS(s, verified);
         }

File: src/net/java/sip/communicator/service/neomedia/event/SrtpListener.java
Patch:
@@ -63,6 +63,7 @@ public void securityMessageReceived(String message,
      * Indicates that we started the process of securing the the connection.
      *
      * @param sessionType the type of the call session - audio or video.
+     * @param sender the control that initiated the event.
      */
-    public void securityNegotiationStarted(int sessionType);
+    public void securityNegotiationStarted(int sessionType, SrtpControl sender);
 }

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCallPeer.java
Patch:
@@ -697,11 +697,12 @@ public void securityTimeout(int sessionType)
      * offer to secure the connection.
      *
      * @param sessionType the type of the call session - audio or video.
+     * @param sender the security controller that caused the event
      */
-    public void securityNegotiationStarted(int sessionType)
+    public void securityNegotiationStarted(int sessionType, SrtpControl sender)
     {
         CallPeerSecurityNegotiationStartedEvent evt =
-            new CallPeerSecurityNegotiationStartedEvent(this, sessionType);
+            new CallPeerSecurityNegotiationStartedEvent(this, sessionType, sender);
         fireCallPeerSecurityNegotiationStartedEvent(evt);
     }
 

File: src/net/java/sip/communicator/service/protocol/media/MediaHandler.java
Patch:
@@ -111,10 +111,11 @@ public void securityTurnedOn(
                     listener.securityTurnedOn(sessionType, cipher, sender);
             }
 
-            public void securityNegotiationStarted(int sessionType)
+            public void securityNegotiationStarted(int sessionType,
+                                                    SrtpControl sender)
             {
                 for (SrtpListener listener : getSrtpListeners())
-                    listener.securityNegotiationStarted(sessionType);
+                    listener.securityNegotiationStarted(sessionType, sender);
             }
         };
 

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetTelephonyConferencing.java
Patch:
@@ -167,7 +167,7 @@ public Call createConfCall(String[] callees, CallGroup group)
 
         MediaAwareCallT call = createOutgoingCall();
 
-        if(group.getCalls().size() > 0)
+        if(group != null && group.getCalls().size() > 0)
         {
             group.addCall(call);
             call.setCallGroup(group);
@@ -191,10 +191,10 @@ public Call createConfCall(String[] callees, CallGroup group)
                 = inviteCalleeToCall(calleeAddress, call, wasConferenceFocus);
 
             // GTalk case
-            if (peer.getCall() != call)
+            if (group != null && peer.getCall() != call)
                 group.addCall(peer.getCall());
 
-            if (call.getCallGroup() == null)
+            if (group != null && call.getCallGroup() == null)
                 group.addCall(call);
         }
         return call;

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerGTalkImpl.java
Patch:
@@ -20,7 +20,7 @@
 import net.java.sip.communicator.util.*;
 
 /**
- * An Google Talk specific extension of the generic media handler.
+ * A Google Talk-specific extension of the generic media handler.
  *
  * @author Sebastien Vincent
  */

File: src/net/java/sip/communicator/service/protocol/AbstractCallPeer.java
Patch:
@@ -456,7 +456,7 @@ public CallPeerState getState()
      */
     public void setState(CallPeerState newState, String reason)
     {
-        this.setState(newState, reason, -1);
+        setState(newState, reason, -1);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCallPeer.java
Patch:
@@ -481,10 +481,8 @@ public void setState(CallPeerState newState, String reason, int reasonCode)
             {
                 // make sure whatever happens to close the media
                 if (CallPeerState.DISCONNECTED.equals(newState)
-                    || CallPeerState.FAILED.equals(newState))
-                {
+                        || CallPeerState.FAILED.equals(newState))
                     mediaHandler.close();
-                }
             }
         }
     }

File: src/net/java/sip/communicator/impl/neomedia/RTPConnectorTCPInputStream.java
Patch:
@@ -120,8 +120,7 @@ protected void receivePacket(DatagramPacket p)
         try
         {
             data = p.getData();
-            InputStream stream = socket.getInputStream();
-            len = stream.read(data);
+            len = socket.getInputStream().read(data);
         }
         catch(Exception e)
         {

File: src/net/java/sip/communicator/impl/neomedia/RawPacket.java
Patch:
@@ -515,10 +515,11 @@ public int getSSRC()
      *
      * @return RTP SSRC from source RTP packet
      */
-    public long GetRTCPSSRC()
+    public long getRTCPSSRC()
     {
         return (int)(readUnsignedIntAsLong(4) & 0xffffffff);
     }
+
     /**
      * Get RTP sequence number from a RTP packet
      *

File: src/net/java/sip/communicator/impl/neomedia/transform/srtp/SRTCPCryptoContext.java
Patch:
@@ -441,7 +441,7 @@ else if (policy.getEncType() == SRTPPolicy.AESF8_ENCRYPTION
      */
     public void processPacketAESCM(RawPacket pkt, int index)
     {
-        long ssrc = pkt.GetRTCPSSRC();
+        long ssrc = pkt.getRTCPSSRC();
 
         /* Compute the CM IV (refer to chapter 4.1.1 in RFC 3711):
         *

File: src/net/java/sip/communicator/impl/neomedia/transform/srtp/SRTPTransformEngine.java
Patch:
@@ -83,7 +83,7 @@ public PacketTransformer getRTCPTransformer()
     }
 
     /*
-     *  (non-Javadoc)
+     * (non-Javadoc)
      * @see net.java.sip.communicator.impl.media.transform.
      * TransformEngine#getRTPTransformer()
      */

File: src/net/java/sip/communicator/impl/neomedia/protocol/SourceStreamDelegate.java
Patch:
@@ -12,9 +12,10 @@
  * Implements a <tt>SourceStream</tt> which wraps a specific
  * <tt>SourceStream</tt>.
  *
- * @author Lubomir Marinov
  * @param <T> the very type of the <tt>SourceStream</tt> wrapped by
  * <tt>SourceStreamDelegate</tt>
+ *
+ * @author Lyubomir Marinov
  */
 public class SourceStreamDelegate<T extends SourceStream>
     implements SourceStream

File: src/net/java/sip/communicator/service/neomedia/DefaultTCPStreamConnector.java
Patch:
@@ -88,9 +88,9 @@ public void close()
             if (dataSocket != null)
                 dataSocket.close();
         }
-        catch(IOException e)
+        catch(IOException ioe)
         {
-            logger.debug("Error closing TCP socket", e);
+            logger.debug("Failed to close TCP socket", ioe);
         }
     }
 

File: src/net/java/sip/communicator/service/protocol/media/AbstractQualityControlWrapper.java
Patch:
@@ -23,7 +23,7 @@ public abstract class AbstractQualityControlWrapper<
     /**
      * The peer we are controlling.
      */
-    protected T peer;
+    protected final T peer;
 
     /**
      * The media quality control.
@@ -60,7 +60,7 @@ protected QualityControl getMediaQualityControl()
 
         MediaStream stream = peer.getMediaHandler().getStream(MediaType.VIDEO);
 
-        if(stream != null && stream instanceof VideoMediaStream)
+        if(stream instanceof VideoMediaStream)
             qualityControl = ((VideoMediaStream)stream).getQualityControl();
 
         return qualityControl;

File: src/net/java/sip/communicator/impl/neomedia/MediaServiceImpl.java
Patch:
@@ -1318,7 +1318,8 @@ public boolean isPartialStreaming(MediaDevice mediaDevice)
         MediaDeviceImpl dev = (MediaDeviceImpl)mediaDevice;
         CaptureDeviceInfo devInfo = dev.getCaptureDeviceInfo();
 
-        return devInfo.getName().startsWith("Partial desktop streaming");
+        return (devInfo != null
+                && devInfo.getName().startsWith("Partial desktop streaming"));
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerJabberImpl.java
Patch:
@@ -880,7 +880,9 @@ public void sendModifyVideoResolutionContent()
             return;
         }
 
-        content.setSenders(senders);
+        // if we are only receiving video senders is null
+        if(senders != null)
+            content.setSenders(senders);
 
         JingleIQ contentIQ = JinglePacketFactory
             .createContentModify(getProtocolProvider().getOurJID(),

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -324,6 +324,7 @@ public void dispose()
     {
         writeMessagePanel.dispose();
         chatSession.dispose();
+        conversationPanel.dispose();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -365,6 +365,8 @@ public void dispose()
         stoppedTypingTimer.removeActionListener(this);
         if (typingState != OperationSetTypingNotifications.STATE_STOPPED)
             stopTypingTimer();
+
+        scrollPane.dispose();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -747,6 +747,9 @@ else if(historyMenu.isPopupMenuVisible())
             GuiActivator.getUIService().getHistoryWindowManager()
                 .removeHistoryWindowForContact(historyContact);
 
+            datesPanel.dispose();
+            chatConvPanel.dispose();
+
             this.dispose();
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableDialog.java
Patch:
@@ -502,6 +502,7 @@ else if(sourceButton.equals(cancelButton))
     @Override
     protected void close(boolean isEscaped)
     {
+        chatRoomsTableUI.dispose();
         chatRoomTableDialog = null;
 
         dispose();

File: src/net/java/sip/communicator/plugin/keybindingchooser/globalchooser/GlobalShortcutDialog.java
Patch:
@@ -390,7 +390,7 @@ public ShortcutField(String text)
 
             this.setPreferredSize(new Dimension(200, 23));
             this.setUI(textFieldUI);
-            this.setBorder(null);
+            this.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 8));
             this.setOpaque(false);
 
             this.setDragEnabled(true);

File: src/net/java/sip/communicator/impl/gui/main/menus/AutoAnswerMenu.java
Patch:
@@ -549,7 +549,8 @@ public void actionPerformed(ActionEvent e)
                 if(noneRadio.isSelected())
                 {
                     opset.clear();
-                    opSetAdvanced.clear();
+                    if(opSetAdvanced != null)
+                        opSetAdvanced.clear();
                 }
                 else if(alwaysAnswerRadio.isSelected())
                 {

File: src/net/java/sip/communicator/impl/protocol/jabber/CallGTalkImpl.java
Patch:
@@ -136,7 +136,9 @@ public CallPeerGTalkImpl processGTalkInitiate(SessionIQ sessionIQ)
                 == 0)
         {
             //send an error response;
-            String reasonText = "Encryption required!";
+            String reasonText =
+                JabberActivator.getResources().getI18NString(
+                    "service.gui.security.encryption.required");
             SessionIQ errResp = GTalkPacketFactory.createSessionTerminate(
                 sessionIQ.getTo(),
                 sessionIQ.getFrom(),

File: src/net/java/sip/communicator/impl/protocol/jabber/CallJabberImpl.java
Patch:
@@ -192,7 +192,9 @@ public CallPeerJabberImpl processSessionInitiate(JingleIQ jingleIQ)
                 == 0)
         {
             //send an error response;
-            String reasonText = "Encryption required!";
+            String reasonText =
+                JabberActivator.getResources().getI18NString(
+                    "service.gui.security.encryption.required");
             JingleIQ errResp = JinglePacketFactory.createSessionTerminate(
                 jingleIQ.getTo(),
                 jingleIQ.getFrom(),

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetAutoAnswerSipImpl.java
Patch:
@@ -293,6 +293,7 @@ boolean preCallCheck(Request invite,
         catch (Throwable ex)
         {
             logger.error("Error while trying to send a request", ex);
+            return false;
         }
 
         return true;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetAutoAnswerJabberImpl.java
Patch:
@@ -130,14 +130,14 @@ public void clear()
      * @return <tt>true</tt> if we have processed and no further processing is
      *          needed, <tt>false</tt> otherwise.
      */
-    boolean followCallCheck(
-        AbstractCall<CallPeer, ProtocolProviderServiceJabberImpl> call)
+    boolean followCallCheck(AbstractCall call)
     {
         if(!answerUnconditional)
             return false;
 
         // we are here cause we satisfy the conditional,
         // or unconditional is true
+        @SuppressWarnings("unchecked")
         Iterator<? extends CallPeer> peers = call.getCallPeers();
 
         while (peers.hasNext())

File: src/net/java/sip/communicator/impl/gui/main/chat/ContactPhotoPanel.java
Patch:
@@ -126,7 +126,8 @@ public void setChatSession(ChatSession chatSession)
         // it sa mutlichat room which
         // cannot be saved with add contact dialog
         if (!chatSession.isDescriptorPersistent()
-            && !(chatSession instanceof ConferenceChatSession))
+            && !(chatSession instanceof ConferenceChatSession)
+            && !ConfigurationManager.isAddContactDisabled())
             this.add(addContactButton, 0);
         else
             this.remove(addContactButton);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -867,7 +867,8 @@ private void initButtonsPanel(UIContact uiContact)
             x += desktopSharingButton.getWidth();
         }
 
-        if (uiContact.getDescriptor() instanceof SourceContact)
+        if (uiContact.getDescriptor() instanceof SourceContact
+            && !ConfigurationManager.isAddContactDisabled())
         {
             constraints.anchor = GridBagConstraints.WEST;
             constraints.fill = GridBagConstraints.NONE;

File: src/net/java/sip/communicator/impl/protocol/jabber/ScServiceDiscoveryManager.java
Patch:
@@ -398,7 +398,8 @@ public void interceptPacket(Packet packet)
     }
 
     /**
-     * Returns a list of the Items {@link DiscoverItems.Item} defined in the
+     * Returns a list of the Items
+     * {@link org.jivesoftware.smackx.packet.DiscoverItems.Item} defined in the
      * node or in other words <tt>null</tt> since we don't support any.
      *
      * @return always <tt>null</tt> since we don't support items.
@@ -786,7 +787,7 @@ public void addEntityForRetrieve(String entityID,
                 {
                     entities.put(entityID, caps);
                     entities.notifyAll();
-                    
+
                     if(retrieverThread == null)
                     {
                         start();

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistration.java
Patch:
@@ -747,7 +747,7 @@ public String getAccountDisplayName()
     /**
      * Sets the account display name.
      *
-     * @param the account display name
+     * @param accountDisplayName the account display name
      */
     public void setAccountDisplayName(String accountDisplayName)
     {
@@ -766,8 +766,8 @@ public String getSmsServerAddress()
 
     /**
      * Sets the default sms server.
-     * 
-     * @param smsServerAddress the sms server to set as default
+     *
+     * @param serverAddress the sms server to set as default
      */
     public void setSmsServerAddress(String serverAddress)
     {

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/NewAccount.java
Patch:
@@ -35,7 +35,7 @@ public class NewAccount
      * @param userName the account user name
      * @param password the account password
      * @param serverAddress the server address to set
-     * @param serverPort the port to connect to
+     * @param port the port to connect to
      */
     public NewAccount(  String userName,
                         char[] password,

File: src/net/java/sip/communicator/plugin/loggingutils/LogsCollector.java
Patch:
@@ -56,6 +56,7 @@ public class LogsCollector
      * does it end with zip extension, is missing we add it.
      * @param destination the possible destination archived file
      * @param optional an optional file to be added to the archive.
+     * @return the resulting file in zip format
      */
     public static File collectLogs(File destination, File optional)
     {
@@ -235,7 +236,6 @@ private static void addCrashFilesToArchive(
         if(files == null)
             return;
 
-        byte[] buf = new byte[1024];
         // First check in working dir
         for(File f: files)
         {

File: src/net/java/sip/communicator/plugin/profiler4j/ProfilerActivator.java
Patch:
@@ -18,6 +18,9 @@
  */
 public class ProfilerActivator implements BundleActivator {
 
+    /**
+     * OSGi bundle context.
+     */
     public static BundleContext bundleContext;
 
     Logger logger = Logger.getLogger(ProfilerActivator.class);

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardActivator.java
Patch:
@@ -23,6 +23,9 @@ public class WhiteboardActivator implements BundleActivator
 {
     private static Logger logger = Logger.getLogger(WhiteboardActivator.class);
 
+    /**
+     * OSGi bundle context.
+     */
     public static BundleContext bundleContext;
 
     private WhiteboardSessionManager session;

File: src/net/java/sip/communicator/impl/callhistory/CallHistorySourceContact.java
Patch:
@@ -90,8 +90,7 @@ public CallHistorySourceContact(CallHistoryContactSource contactSource,
             + " " + CallHistoryActivator.getResources()
                 .getI18NString("service.gui.DURATION") + ": "
             + GuiUtils.formatTime(
-                GuiUtils.substractDates(
-            callRecord.getEndTime(), callRecord.getStartTime()));
+                    callRecord.getStartTime(), callRecord.getEndTime());
     }
 
     /**

File: src/net/java/sip/communicator/impl/globalshortcut/NativeKeyboardHook.java
Patch:
@@ -114,7 +114,6 @@ public synchronized void unregisterShortcut(int keycode,
      * Register a special key shortcut (for example key coming from headset).
      *
      * @param keycode keycode of the shortcut
-     * @param modifiers modifiers (CTRL, ALT, ...)
      * @return true if success, false otherwise
      */
     public synchronized boolean registerSpecial(int keycode)
@@ -129,7 +128,6 @@ public synchronized boolean registerSpecial(int keycode)
      * Unregister a special key shortcut (for example key coming from headset).
      *
      * @param keycode keycode of the shortcut
-     * @param modifiers modifiers (CTRL, ALT, ...)
      */
     public synchronized void unregisterSpecial(int keycode)
     {

File: src/net/java/sip/communicator/impl/history/HistoryImpl.java
Patch:
@@ -26,6 +26,9 @@ public class HistoryImpl
 {
     private static Logger log = Logger.getLogger(HistoryImpl.class);
 
+    /**
+     * The supported filetype.
+     */
     public static final String SUPPORTED_FILETYPE = "xml";
 
     private HistoryID id;

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/gsm/DePacketizer.java
Patch:
@@ -28,6 +28,9 @@ public String getName()
         return "GSM DePacketizer";
     }
 
+    /**
+     * Constructs a new <tt>DePacketizer</tt>.
+     */
     public DePacketizer()
     {
         super();

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/gsm/Encoder.java
Patch:
@@ -26,7 +26,6 @@ public class Encoder
     private static final int PCM_BYTES = 320;
     private static final int GSM_BYTES = 33;
     private int innerDataLength = 0;
-    private int inputDataLength = 0;
     byte[] innerContent;
 
     @Override
@@ -35,6 +34,9 @@ public String getName()
         return "GSM Encoder";
     }
 
+    /**
+     * Constructs a new <tt>Encoder</tt>.
+     */
     public Encoder()
     {
         super();
@@ -123,7 +125,6 @@ public int process(Buffer inputBuffer, Buffer outputBuffer)
         innerBuffer.setData(mergedContent);
         innerBuffer.setLength(mergedContent.length);
         innerDataLength = innerBuffer.getLength();
-        inputDataLength = inputBuffer.getLength();
 
         if (TRACE) dump("input ", inputBuffer);
 

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/gsm/Packetizer.java
Patch:
@@ -28,6 +28,9 @@ public String getName()
         return "GSM Packetizer";
     }
 
+    /**
+     * Constructs a new <tt>Packetizer</tt>.
+     */
     public Packetizer()
     {
         super();

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/ilbc/ilbc_common.java
Patch:
@@ -23,7 +23,6 @@ public static int LSF_check(    /* (o) 1 for stable lsf vectors and 0 for
                               table */
     {
        int k,n,m, Nit=2, change=0,pos;
-       float tmp;
        float eps=(float)0.039; /* 50 Hz */
        float eps2=(float)0.0195;
        float maxlsf=(float)3.14; /* 4000 Hz */
@@ -39,7 +38,6 @@ public static int LSF_check(    /* (o) 1 for stable lsf vectors and 0 for
                    if ((lsf[pos+1]-lsf[pos])<eps) {
 
                        if (lsf[pos+1]<lsf[pos]) {
-                           tmp=lsf[pos+1];
                            lsf[pos+1]= lsf[pos]+eps2;
                            lsf[pos]= lsf[pos+1]-eps2;
                        } else {

File: src/net/java/sip/communicator/impl/neomedia/transform/dtmf/DtmfTransformEngine.java
Patch:
@@ -275,7 +275,7 @@ else if(toneTransmissionState == ToneTransmissionState.END_REQUESTED)
             pktEnd = true;
             remainingsEndPackets = 2;
 
-            toneTransmissionState = ToneTransmissionState.END_SEQUENCE_INITIATED;            
+            toneTransmissionState = ToneTransmissionState.END_SEQUENCE_INITIATED;
         }
         else if(toneTransmissionState == ToneTransmissionState.END_SEQUENCE_INITIATED)
         {
@@ -320,7 +320,7 @@ public void startSending(DTMFRtpTone tone)
      * <tt>startSendingDTMF()</tt> method. Has no effect if no tone is currently
      * being sent.
      *
-     * @see AudioMediaStream#stopSendingDTMF()
+     * @see AudioMediaStream#stopSendingDTMF(DTMFMethod dtmfMethod)
      */
     public void stopSendingDTMF()
     {

File: src/net/java/sip/communicator/impl/protocol/msn/ContactMsnImpl.java
Patch:
@@ -302,7 +302,7 @@ public String getStatusMessage()
 
     /**
      * Changes the current status message of this contact.
-     * 
+     *
      * @param newStatusMessage the new message.
      */
     public void setStatusMessage(String newStatusMessage)

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -1070,7 +1070,7 @@ private void processInvite(SipProvider       sourceProvider,
 
                 //this is a brand new call (not a transferred one)
                 CallSipImpl call = new CallSipImpl(this);
-                MediaAwareCallPeer peer =
+                MediaAwareCallPeer<?,?,?> peer =
                     call.processInvite(sourceProvider, serverTransaction);
 
                 if(getProtocolProvider().getAccountID()
@@ -1081,7 +1081,7 @@ private void processInvite(SipProvider       sourceProvider,
                 {
                     // if in paranoia mode and we don't find any encryption
                     // fail peer/call send error with warning explaining why
-                    
+
                     peer.setState(
                         CallPeerState.FAILED,
                         "Encryption required!",

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1949,7 +1949,7 @@ public void sayError(ServerTransaction serverTransaction, int errorCode)
      * @param serverTransaction the transaction that we'd like to send an error
      * response in.
      * @param errorCode the code that the response should have.
-     *
+     * @param header SIP header
      * @throws OperationFailedException if we failed constructing or sending a
      * SIP Message.
      */

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/model/XmlUtils.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.impl.protocol.sip.xcap.model;
 
-import static net.java.sip.communicator.util.xml.XMLUtils.*;
 import org.w3c.dom.*;
 
 import java.util.*;

File: src/net/java/sip/communicator/impl/protocol/ssh/ContactTimerSSHImpl.java
Patch:
@@ -93,6 +93,8 @@ public void run()
     }
     /**
      * Creates a new instance of ContactTimerSSHImpl
+     *
+     * @param sshContact the <tt>Contact</tt>
      */
     public ContactTimerSSHImpl(ContactSSH sshContact)
     {

File: src/net/java/sip/communicator/plugin/addrbook/macosx/MacOSXAddrBookContactSourceService.java
Patch:
@@ -19,6 +19,9 @@
 public class MacOSXAddrBookContactSourceService
     extends AsyncContactSourceService
 {
+    /**
+     * the Mac OS X address book prefix.
+     */
     public static final String MACOSX_ADDR_BOOK_PREFIX
         = "net.java.sip.communicator.plugin.addrbook.MACOSX_ADDR_BOOK_PREFIX";
 

File: src/net/java/sip/communicator/plugin/addrbook/msoutlook/MsOutlookAddrBookContactSourceService.java
Patch:
@@ -21,6 +21,9 @@
 public class MsOutlookAddrBookContactSourceService
     extends AsyncContactSourceService
 {
+    /**
+     * The outlook address book prefix.
+     */
     public static final String OUTLOOK_ADDR_BOOK_PREFIX
         = "net.java.sip.communicator.plugin.addrbook.OUTLOOK_ADDR_BOOK_PREFIX";
 

File: src/net/java/sip/communicator/plugin/defaultresourcepack/DefaultLanguagePackImpl.java
Patch:
@@ -34,6 +34,9 @@ public class DefaultLanguagePackImpl
      */
     private Vector<Locale> availableLocales = new Vector<Locale>();
 
+    /**
+     * Constructor.
+     */
     public DefaultLanguagePackImpl()
     {
         // Finds all the files *.properties in the path : /resources/languages.

File: src/net/java/sip/communicator/service/callhistory/CallPeerRecord.java
Patch:
@@ -49,7 +49,6 @@ public CallPeerRecord(  String peerAddress,
                             Date endTime)
     {
         this.peerAddress = peerAddress;
-        this.displayName = displayName;
         this.startTime = startTime;
         this.endTime = endTime;
     }

File: src/net/java/sip/communicator/service/ldap/LdapDirectorySettings.java
Patch:
@@ -258,7 +258,7 @@ public interface LdapDirectorySettings
      * Sets the global prefix to be used when calling phones from this ldap
      * source.
      *
-     * @param the global prefix to be used when calling phones from this ldap
+     * @param prefix the global prefix to be used when calling phones from this ldap
      * source
      */
     public void setGlobalPhonePrefix(String prefix);

File: src/net/java/sip/communicator/service/neomedia/MediaStreamStats.java
Patch:
@@ -7,9 +7,6 @@
 package net.java.sip.communicator.service.neomedia;
 
 import net.sf.fmj.media.rtp.*;
-import java.util.*;
-import javax.media.rtp.*;
-import javax.media.rtp.rtcp.*;
 
 /**
  * Class used to compute stats concerning a MediaStream.

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetServerStoredAccountInfo.java
Patch:
@@ -69,6 +69,7 @@ public void removeServerStoredDetailsChangeListener(
      * Notify all listeners of the corresponding account detail
      * change event.
      *
+     * @param source the protocol provider service source
      * @param eventID the int ID of the event to dispatch
      * @param oldValue the value that the changed property had before the change
      *            occurred.

File: src/net/java/sip/communicator/service/protocol/event/DTMFReceivedEvent.java
Patch:
@@ -39,6 +39,8 @@ public class DTMFReceivedEvent
      * contact.
      *
      * @param source the <tt>Message</tt> whose reception this event represents.
+     * @param value dmtf tone value
+     * @param duration duration of the DTMF tone
      */
     public DTMFReceivedEvent(ProtocolProviderService source,
                              DTMFTone value,

File: src/net/java/sip/communicator/service/protocol/event/PresenceStatusListener.java
Patch:
@@ -15,6 +15,9 @@
 public interface PresenceStatusListener
     extends EventListener
 {
+    /**
+     * Callback the the contact presence status has changed.
+     */
     public void contactPresenceStatusChanged();
 
 }

File: src/net/java/sip/communicator/service/protocol/media/DynamicPayloadTypeRegistry.java
Patch:
@@ -55,6 +55,8 @@ public class DynamicPayloadTypeRegistry
 
     /**
      * Sets the override payload type numbers.
+     *
+     * @param mappings the override payload-type mappings.
      */
     public void setOverridePayloadTypeMappings(Map<Byte, String> mappings)
     {

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -1629,7 +1629,8 @@ public void callEnded(CallEvent event)
      */
     public void updateMergeButtonState()
     {
-        Collection<Call> calls = CallManager.getActiveCalls();
+        Collection<Call> calls = new ArrayList<Call>(
+            CallManager.getActiveCalls());
         java.util.List<CallGroup> groups = new java.util.ArrayList<CallGroup>();
         int cpt = 0;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/TransportManagerGTalkImpl.java
Patch:
@@ -394,7 +394,6 @@ else if(token.startsWith("password="))
     static Agent createAgent(ProtocolProviderServiceJabberImpl provider,
         boolean controlling)
     {
-
         Agent agent = new Agent(CompatibilityMode.GTALK);
         List<StunServerDescriptor> servers = null;
         boolean atLeastOneStunServer = false;

File: src/net/java/sip/communicator/plugin/keybindingchooser/globalchooser/GlobalShortcutDialog.java
Patch:
@@ -407,6 +407,9 @@ public void loadSkin()
         }
     }
 
+    /**
+     * A custom text field UI.
+     */
     public class ShortcutFieldUI
         extends SIPCommTextFieldUI
         implements Skinnable

File: src/net/java/sip/communicator/impl/certificate/CertificateServiceImpl.java
Patch:
@@ -425,7 +425,6 @@ public void handle(Callback[] callbacks)
                             {
                                 AuthenticationWindow aw =
                                     new AuthenticationWindow(
-                                        null,
                                         f.getName(),
                                         null,
                                         kt.getName(),

File: src/net/java/sip/communicator/impl/protocol/dict/ProtocolProviderServiceDictImpl.java
Patch:
@@ -313,7 +313,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (TCP).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolProviderServiceGibberishImpl.java
Patch:
@@ -302,7 +302,8 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (null as the transport
+     * protocol is unknown).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -431,7 +431,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (TCP).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/irc/ProtocolProviderServiceIrcImpl.java
Patch:
@@ -291,7 +291,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (TCP).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -572,8 +572,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1), or
-     * null the protocol is not connected.
+     * @return The transport protocol of this instance (TCP, TLS).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/mock/MockProvider.java
Patch:
@@ -214,7 +214,8 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (null as the transport
+     * protocol is unknown).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolProviderServiceMsnImpl.java
Patch:
@@ -263,7 +263,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (TCP).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/rss/ProtocolProviderServiceRssImpl.java
Patch:
@@ -245,7 +245,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (TCP).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1642,8 +1642,8 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1), or
-     * null the protocol is not connected.
+     * @return The transport protocol of this instance (UDP, TCP, TLS), or null
+     * if the transport protocol is unknown.
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/ssh/ProtocolProviderServiceSSHImpl.java
Patch:
@@ -634,7 +634,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (TCP).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/yahoo/ProtocolProviderServiceYahooImpl.java
Patch:
@@ -346,7 +346,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (TCP).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ProtocolProviderServiceZeroconfImpl.java
Patch:
@@ -272,7 +272,7 @@ public boolean isSignalingTransportSecure()
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (TCP).
      */
     public String getTransportType()
     {

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderService.java
Patch:
@@ -191,7 +191,8 @@ public void removeRegistrationStateChangeListener(
     /**
      * Returns the transport protocol of this instance.
      *
-     * @return The transport protocol of this instance (UDP, TCP, TLSv1).
+     * @return The transport protocol of this instance (UDP, TCP, TLS), or null
+     * if the transport protocol is unknown.
      */
     public String getTransportType();
 }

File: src/net/java/sip/communicator/impl/gui/main/call/CallInfoFrame.java
Patch:
@@ -186,9 +186,8 @@ private void constructCallInfo()
                     "service.gui.callinfo.IS_CONFERENCE_FOCUS"),
                 String.valueOf(isConfFocus)));
 
-        String preferredTransport = call.getProtocolProvider().getAccountID()
-            .getAccountPropertyString(
-                ProtocolProviderFactory.PREFERRED_TRANSPORT);
+        String preferredTransport =
+            call.getProtocolProvider().getTransportType();
 
         if (preferredTransport != null && preferredTransport.length() > 0)
             stringBuffer.append(getLineString(

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaUIContact.java
Patch:
@@ -423,7 +423,8 @@ private void loadTooltip(final ExtendedTooltip tip)
                 protocolContact.getProtocolProvider().getOperationSet(
                     OperationSetServerStoredContactInfo.class);
 
-            if(infoOpSet != null)
+            if(infoOpSet != null
+                && protocolContact.getProtocolProvider().isRegistered())
             {
                 Iterator<GenericDetail> details =
                     infoOpSet.requestAllDetailsForContact(protocolContact,

File: src/net/java/sip/communicator/impl/protocol/icq/InfoRetreiver.java
Patch:
@@ -154,9 +154,9 @@ protected List<GenericDetail> retrieveDetails(String uin)
             result = new LinkedList<GenericDetail>();
 
         // put even empty result to bypass further retrieve
-        retreivedDetails.put(uin, responseRetriever.result);
+        retreivedDetails.put(uin, result);
 
-        return responseRetriever.result;
+        return result;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -1963,6 +1963,7 @@ public void run()
                         fileTransferOpSet, request, date);
                 }
             });
+            return;
         }
 
         this.addActiveFileTransfer(request.getID(), request);

File: src/net/java/sip/communicator/impl/protocol/jabber/CallJabberImpl.java
Patch:
@@ -424,7 +424,9 @@ public void callAdded(CallGroupEvent evt)
         {
             setConferenceFocus(true);
             CallPeerJabberImpl callPeer = peers.next();
-            callPeer.sendCoinSessionInfo(true);
+
+            if(callPeer.getState() == CallPeerState.CONNECTED)
+                callPeer.sendCoinSessionInfo(true);
         }
 
         super.callAdded(evt);

File: src/net/java/sip/communicator/impl/protocol/sip/CallSipImpl.java
Patch:
@@ -419,17 +419,16 @@ public void setInitialQualityPreferences(QualityPreset qualityPreferences)
     public void callAdded(CallGroupEvent evt)
     {
         Iterator<CallPeerSipImpl> peers = getCallPeers();
+        setConferenceFocus(true);
 
         // reinvite peers to reflect conference focus
         while(peers.hasNext())
         {
-            setConferenceFocus(true);
             CallPeerSipImpl callPeer = peers.next();
 
             try
             {
-                if(callPeer.getDialog() != null &&
-                    callPeer.getDialog().getState() == DialogState.CONFIRMED)
+                if(callPeer.getState() == CallPeerState.CONNECTED)
                     callPeer.sendReInvite();
             }
             catch(OperationFailedException e)

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -518,7 +518,8 @@ public void actionPerformedOnHangupButton(boolean isCloseWait)
     {
         Call call = getCall();
 
-        this.callInfoFrame.dispose();
+        if (callInfoFrame != null)
+            callInfoFrame.dispose();
 
         if (call != null)
             CallManager.hangupCall(call);

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCall.java
Patch:
@@ -1084,7 +1084,6 @@ public void callAdded(CallGroupEvent evt)
 
             if(p instanceof MediaAwareCallPeer)
             {
-                System.out.println("p instanceof MediaAwareCallPeer");
                 CallPeerMediaHandler<?> mediaHandler =
                     ((MediaAwareCallPeer<?,?,?>)p).getMediaHandler();
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -1378,6 +1378,7 @@ public void run()
             ProtocolProviderService pps = call.getProtocolProvider();
             Iterator<? extends CallPeer> peers = call.getCallPeers();
             CallGroup group = null;
+
             if(existingCall != null)
             {
                 if(existingCall.getCallGroup() == null)

File: src/net/java/sip/communicator/impl/neomedia/transform/csrc/CsrcTransformEngine.java
Patch:
@@ -190,7 +190,6 @@ public void setCsrcAudioLevelAudioLevelExtensionID(byte           extID,
     {
         this.csrcAudioLevelExtID = extID;
         this.audioLevelDirection = dir;
-
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetVideoTelephony.java
Patch:
@@ -182,7 +182,7 @@ public void removeVideoListener(CallPeer peer, VideoListener listener)
      * @param allowed <tt>true</tt> if local video transmission is allowed and
      * <tt>false</tt> otherwise.
      *
-     *  @throws OperationFailedException if video initialization fails.
+     * @throws OperationFailedException if video initialization fails.
      */
     public void setLocalVideoAllowed(Call call, boolean allowed)
         throws OperationFailedException

File: src/net/java/sip/communicator/impl/protocol/jabber/CallJabberImpl.java
Patch:
@@ -246,7 +246,7 @@ else if(c.getName().equals(MediaType.VIDEO.toString()))
 
         // if this was the first peer we added in this call then the call is
         // new and we also need to notify everyone of its creation.
-        if(this.getCallPeerCount() == 1)
+        if(this.getCallPeerCount() == 1 && getCallGroup() == null)
             parentOpSet.fireCallEvent(CallEvent.CALL_RECEIVED, this,
                 directions);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -152,6 +152,7 @@ public Call createCall(String callee, CallGroup group)
         if(callPeer.getCall() != call)
         {
             // We may have a Google Talk call here
+            callPeer.getCall().setCallGroup(group);
             return callPeer.getCall();
         }
 
@@ -454,6 +455,7 @@ else if(di != null)
                 CallGTalkImpl callGTalk = new CallGTalkImpl(this);
                 MediaUseCase useCase = call.getMediaUseCase();
                 boolean isVideo = call.isLocalVideoAllowed(useCase);
+                callGTalk.setCallGroup(call.getCallGroup());
 
                 callGTalk.setLocalVideoAllowed(isVideo, useCase);
                 peer = callGTalk.initiateGTalkSession(fullCalleeURI,

File: src/net/java/sip/communicator/impl/protocol/sip/CallSipImpl.java
Patch:
@@ -428,7 +428,9 @@ public void callAdded(CallGroupEvent evt)
 
             try
             {
-                callPeer.sendReInvite();
+                if(callPeer.getDialog() != null &&
+                    callPeer.getDialog().getState() == DialogState.CONFIRMED)
+                    callPeer.sendReInvite();
             }
             catch(OperationFailedException e)
             {

File: src/net/java/sip/communicator/service/protocol/PhoneNumberI18nService.java
Patch:
@@ -18,7 +18,7 @@ public interface PhoneNumberI18nService
      * Normalizes a <tt>String</tt> phone number by converting alpha characters
      * to their respective digits on a keypad and then stripping non-digit
      * characters.
-     * 
+     *
      * @param phoneNumber a <tt>String</tt> which represents a phone number to
      * normalize
      * @return a <tt>String</tt> which is a normalized form of the specified
@@ -42,7 +42,7 @@ public interface PhoneNumberI18nService
      * Indicates if the given string is possibly a phone number.
      *
      * @param possibleNumber the string to be verified
-     * @return 
+     * @return true if the given string is a phone number, false otherwise
      */
     public boolean isPhoneNumber(String possibleNumber);
 }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -1253,6 +1253,9 @@ public boolean dispatchKeyEvent(KeyEvent e)
                 return false;
             }
 
+            if(getCurrentChat() == null)
+                return false;
+            
             ChatWritePanel chatWritePanel
                 = getCurrentChat().getChatWritePanel();
             JEditorPane chatWriteEditor = chatWritePanel.getEditorPane();

File: src/net/java/sip/communicator/impl/protocol/yahoo/ServerStoredContactListYahooImpl.java
Patch:
@@ -858,7 +858,9 @@ else if (authResponse.getResponseCode() == AuthorizationResponse.REJECT)
             {
                 logger.error("cannot send auth deny", ex);
             }
-            }
+
+            return;
+        }
 
         // else we accepted it
         try

File: src/net/java/sip/communicator/impl/neomedia/device/DeviceConfiguration.java
Patch:
@@ -559,10 +559,10 @@ public CaptureDeviceInfo getVideoCaptureDevice(MediaUseCase useCase)
             dev = videoCaptureDevice;
             break;
         case DESKTOP:
-            CaptureDeviceInfo devs[] =
-                getAvailableVideoCaptureDevices(MediaUseCase.DESKTOP);
+            CaptureDeviceInfo devs[]
+                = getAvailableVideoCaptureDevices(MediaUseCase.DESKTOP);
 
-            if(devs.length > 0)
+            if (devs.length > 0)
                 dev = devs[0];
             break;
         default:

File: src/net/java/sip/communicator/service/neomedia/AudioMediaStream.java
Patch:
@@ -65,16 +65,16 @@ public void setLocalUserAudioLevelListener(
      * @param tone the <tt>DTMFTone</tt> to start sending.
      * @param dtmfMethod The kind of DTMF used (RTP, SIP-INOF or INBAND).
      */
-    public void startSendingDTMF(DTMFTone tone, DTMFEnum dtmfMethod);
+    public void startSendingDTMF(DTMFTone tone, DTMFMethod dtmfMethod);
 
     /**
      * Interrupts transmission of a <tt>DTMFTone</tt> started with the
      * <tt>startSendingDTMF</tt> method. This method has no effect if no tone
      * is being currently sent.
      *
-     * @param tone the <tt>DTMFTone</tt> to start sending.
+     * @param dtmfMethod the <tt>DTMFMethod</tt> to stop sending.
      */
-    public void stopSendingDTMF(DTMFEnum dtmfMethod);
+    public void stopSendingDTMF(DTMFMethod dtmfMethod);
 
     /**
      * Registers a listener that would receive notification events if the

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -528,9 +528,7 @@ public Iterable<ContentPacketExtension> generateSessionAccept()
                 for(Map.Entry<String, String> f : adv.entrySet())
                 {
                     if(f.getKey().equals("imageattr"))
-                    {
                         supportQualityControls = true;
-                    }
                 }
             }
 

File: src/net/java/sip/communicator/service/neomedia/MediaService.java
Patch:
@@ -238,8 +238,9 @@ public MediaDevice getMediaDeviceForPartialDesktopStreaming(
      * @param x new x coordinate origin
      * @param y new y coordinate origin
      */
-    public void movePartialDesktopStreaming(MediaDevice mediaDevice, int x,
-            int y);
+    public void movePartialDesktopStreaming(
+            MediaDevice mediaDevice,
+            int x, int y);
 
     /**
      * If the <tt>MediaDevice</tt> corresponds to partial desktop streaming

File: src/net/java/sip/communicator/service/protocol/AdHocChatRoom.java
Patch:
@@ -92,8 +92,6 @@ public void removeParticipantPresenceListener(
      *
      * @return a <tt>List</tt> of <tt>Contact</tt>s instances
      * corresponding to all room members.
-     * @throws OperationFailedException if we fail retrieving the list of room
-     * participants.
      */
     public List<Contact> getParticipants();
 

File: src/net/java/sip/communicator/service/protocol/event/RemoteControlGrantedEvent.java
Patch:
@@ -4,7 +4,7 @@
 
 /**
  * Event that notify that remote control feature has been granted. This is used
- * in desktop sharing related usage. After rights beeing granted, local
+ * in desktop sharing related usage. After rights being granted, local
  * peer should notify keyboard and mouse events to remote peer.
  *
  * @author Sebastien Vincent

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContainer.java
Patch:
@@ -57,7 +57,7 @@ public interface ChatContainer
     public java.util.List<ChatPanel> getChats();
 
     /**
-     * Opens the specified <tt>ChatPanel</tt> and optinally brings it to the
+     * Opens the specified <tt>ChatPanel</tt> and optionally brings it to the
      * front.
      *
      * @param chatPanel the <tt>ChatPanel</tt> to be opened
@@ -127,6 +127,8 @@ public interface ChatContainer
 
     /**
      * Updates history buttons state.
+     *
+     * @param chatPanel
      */
     public void updateHistoryButtonState(ChatPanel chatPanel);
 }

File: src/net/java/sip/communicator/impl/contactlist/MclStorageManager.java
Patch:
@@ -1794,6 +1794,7 @@ public void metaContactGroupModified(MetaContactGroupEvent evt)
 
         switch (evt.getEventID())
         {
+        case MetaContactGroupEvent.CONTACT_GROUP_RENAMED_IN_META_GROUP:
         case MetaContactGroupEvent.CONTACT_GROUP_REMOVED_FROM_META_GROUP:
         case MetaContactGroupEvent.CONTACT_GROUP_ADDED_TO_META_GROUP:
             // the fact that a contact group was added or removed to a
@@ -1830,9 +1831,6 @@ public void metaContactGroupModified(MetaContactGroupEvent evt)
             mcGroupNode
                 .setAttribute(GROUP_NAME_ATTR_NAME, mcGroup.getGroupName());
             break;
-        case MetaContactGroupEvent.CONTACT_GROUP_RENAMED_IN_META_GROUP:
-            // proto group names are not stored so ignore.
-            break;
         }
 
         try

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -596,7 +596,7 @@ else if(e.getKeyCode() == KeyEvent.VK_TAB)
             ArrayList<String> contacts = new ArrayList<String>();
             while(iter.hasNext())
             {
-                ChatContact c = iter.next();
+                ChatContact<?> c = iter.next();
                 if(c.getName().length() >= (index-position) && 
                     c.getName().substring(0,index-position).equals(sequence))
                 {

File: src/net/java/sip/communicator/impl/neomedia/CallRecordingConfigForm.java
Patch:
@@ -29,7 +29,7 @@ public class CallRecordingConfigForm
                DocumentListener
 {
     /**
-     * Sesrial version UID.
+     * Serial version UID.
      */
     private static final long serialVersionUID = 0L;
 

File: src/net/java/sip/communicator/impl/neomedia/device/Video4Linux2Auto.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.impl.neomedia.device;
 
 import javax.media.*;
-import javax.media.format.*;
 
 import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
@@ -18,12 +17,13 @@
  * Discovers and registers <tt>CaptureDevice</tt>s which implement the Video for
  * Linux Two API Specification with JMF.
  *
- * @author Lubomir Marinov
+ * @author Lyubomir Marinov
  */
 public class Video4Linux2Auto
 {
     /**
-     * The <tt>Logger</tt>.
+     * The <tt>Logger</tt> used by the <tt>Video4Linux2Auto</tt> class and its
+     * instances for logging output.
      */
     private static final Logger logger =
             Logger.getLogger(Video4Linux2Auto.class);

File: src/net/java/sip/communicator/service/neomedia/SrtpControl.java
Patch:
@@ -71,10 +71,10 @@ public interface SrtpControl
     /**
      * Sets the <tt>RTPConnector</tt> which is to use or uses this SRTP engine.
      *
-     * @param newValue the <tt>RTPConnector</tt> which is to use or uses this
+     * @param connector the <tt>RTPConnector</tt> which is to use or uses this
      * SRTP engine
      */
-    public void setConnector(AbstractRTPConnector newValue);
+    public void setConnector(AbstractRTPConnector connector);
 
     /**
      * Indicates if the key exchange method is dependent on secure transport of

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1181,7 +1181,7 @@ private void dispatchEventToButtons(MouseEvent event)
         Component mouseComponent
             = renderer.findComponentAt(translatedX, translatedY);
 
-        if (logger.isDebugEnabled())
+        if (logger.isDebugEnabled() && mouseComponent != null)
             logger.debug("DISPATCH MOUSE EVENT TO COMPONENT: "
                     + mouseComponent.getClass().getName()
                     + " with bounds: " + mouseComponent.getBounds()

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCallPeer.java
Patch:
@@ -576,7 +576,6 @@ public void addConferenceMembersSoundLevelListener(
     {
         synchronized (conferenceMemberAudioLevelListeners)
         {
-
             if (conferenceMemberAudioLevelListeners.size() == 0)
             {
                 // if this is the first listener that's being registered with

File: src/net/java/sip/communicator/impl/neomedia/MediaServiceImpl.java
Patch:
@@ -614,7 +614,7 @@ public void actionPerformed(ActionEvent evt)
 
                 PortAudio.addDeviceChangedCallback(this);
             }
-            catch(Exception e)
+            catch(Throwable e)
             {
                 logger.info("Cannot create audio configuration panel", e);
             }

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetServerStoredContactInfoIcqImpl.java
Patch:
@@ -194,7 +194,7 @@ public void run()
                 List<GenericDetail> result =
                     infoRetreiver.retrieveDetails(contact.getAddress());
 
-                if(contact.getImage() != null)
+                if(contact.getImage() != null && result != null)
                 {
                     result.add(new ServerStoredDetails.ImageDetail(
                         "Image", contact.getImage()));
@@ -208,7 +208,7 @@ public void run()
                         listenersForDetails.remove(contact.getAddress());
                 }
 
-                if(listeners == null)
+                if(listeners == null || result == null)
                     return;
 
                 for(DetailsResponseListener l : listeners)

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetServerStoredContactInfoJabberImpl.java
Patch:
@@ -165,7 +165,7 @@ public void run()
                         listenersForDetails.remove(contact.getAddress());
                 }
 
-                if(listeners == null)
+                if(listeners == null || result == null)
                     return;
 
                 for(DetailsResponseListener l : listeners)

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -748,6 +748,7 @@ public void moveContact(ContactJabberImpl contact,
     void init()
     {
         this.roster = jabberProvider.getConnection().getRoster();
+        this.roster.setSubscriptionMode(Roster.SubscriptionMode.manual);
 
         initRoster();
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/keepalive/KeepAliveManager.java
Patch:
@@ -97,9 +97,9 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
             keepAliveSendTask = new KeepAliveSendTask();
 
             keepAliveCheckInterval =
-                2 * SmackConfiguration.getKeepAliveInterval();
+                SmackConfiguration.getKeepAliveInterval();
             if(keepAliveCheckInterval == 0)
-                keepAliveCheckInterval = 60000;
+                keepAliveCheckInterval = 30000;
             
             keepAliveTimer = new Timer("Jabber keepalive timer for <"
                 + parentProvider.getAccountID() + ">", true);

File: src/net/java/sip/communicator/impl/protocol/sip/ClientCapabilities.java
Patch:
@@ -380,7 +380,7 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
             {
                 String keepAliveMethod =
                     provider.getAccountID().getAccountPropertyString(
-                        ProtocolProviderServiceSipImpl.KEEP_ALIVE_METHOD);
+                        ProtocolProviderFactory.KEEP_ALIVE_METHOD);
 
                 if (logger.isTraceEnabled())
                     logger.trace("Keep alive method " + keepAliveMethod);
@@ -392,7 +392,7 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
 
                 int keepAliveInterval =
                     provider.getAccountID().getAccountPropertyInt(
-                        ProtocolProviderServiceSipImpl.KEEP_ALIVE_INTERVAL, -1);
+                        ProtocolProviderFactory.KEEP_ALIVE_INTERVAL, -1);
 
                 if (logger.isTraceEnabled())
                     logger.trace("Keep alive inerval is " + keepAliveInterval);

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/ConnectionPanel.java
Patch:
@@ -138,7 +138,7 @@ public void removeUpdate(DocumentEvent evt)
 
         JPanel checkBoxesPanel
             = new TransparentPanel(new GridLayout(0, 1, 10, 10));
-        checkBoxesPanel.add(sendKeepAliveBox);
+        //checkBoxesPanel.add(sendKeepAliveBox);
         checkBoxesPanel.add(gmailNotificationsBox);
         checkBoxesPanel.add(googleContactsBox);
         checkBoxesPanel.add(allowNonSecureBox);

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -294,8 +294,8 @@ protected ProtocolProviderService installAccount(
             accountProperties.put(ProtocolProviderFactory.PASSWORD, passwd);
         }
 
-        accountProperties.put("SEND_KEEP_ALIVE",
-                              String.valueOf(registration.isSendKeepAlive()));
+        //accountProperties.put("SEND_KEEP_ALIVE",
+        //                      String.valueOf(registration.isSendKeepAlive()));
 
         accountProperties.put("GMAIL_NOTIFICATIONS_ENABLED",
                     String.valueOf(registration.isGmailNotificationEnabled()));

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -476,13 +476,13 @@ else if(serverAddress == null &&
                 registration.getTlsClientCertificate());
 
         if(registration.getKeepAliveMethod() != null)
-            accountProperties.put("KEEP_ALIVE_METHOD",
+            accountProperties.put(ProtocolProviderFactory.KEEP_ALIVE_METHOD,
                 registration.getKeepAliveMethod());
         else
-            accountProperties.put("KEEP_ALIVE_METHOD",
+            accountProperties.put(ProtocolProviderFactory.KEEP_ALIVE_METHOD,
                 registration.getDefaultKeepAliveMethod());
 
-        accountProperties.put("KEEP_ALIVE_INTERVAL",
+        accountProperties.put(ProtocolProviderFactory.KEEP_ALIVE_INTERVAL,
             registration.getKeepAliveInterval());
 
         accountProperties.put("XIVO_ENABLE",

File: src/net/java/sip/communicator/impl/neomedia/MediaServiceImpl.java
Patch:
@@ -1250,6 +1250,8 @@ public Point getOriginForDesktopStreamingDevice(MediaDevice mediaDevice)
     {
         MediaDeviceImpl dev = (MediaDeviceImpl)mediaDevice;
         CaptureDeviceInfo devInfo = dev.getCaptureDeviceInfo();
+        if(devInfo == null)
+            return null;
         MediaLocator locator = devInfo.getLocator();
 
         if(!ImageStreamingAuto.LOCATOR_PROTOCOL.equals(locator.getProtocol()))

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -610,6 +610,9 @@ public ChatPanel getChat(Contact contact)
             = GuiActivator.getContactListService()
                 .findMetaContactByContact(contact);
 
+        if(metaContact == null)
+            return null;
+
         return chatWindowManager.getContactChat(metaContact, true);
     }
 

File: src/net/java/sip/communicator/impl/netaddr/NetworkAddressManagerServiceImpl.java
Patch:
@@ -542,7 +542,7 @@ public DatagramSocket createDatagramSocket(InetAddress laddr,
       *
       * @param listener the listener.
       */
-     public void addNetworkConfigurationChangeListener(
+     public synchronized void addNetworkConfigurationChangeListener(
          NetworkConfigurationChangeListener listener)
      {
          if(networkConfigurationWatcher == null)
@@ -557,7 +557,7 @@ public void addNetworkConfigurationChangeListener(
       *
       * @param listener the listener.
       */
-     public void removeNetworkConfigurationChangeListener(
+     public synchronized void removeNetworkConfigurationChangeListener(
          NetworkConfigurationChangeListener listener)
      {
         if(networkConfigurationWatcher != null)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -385,7 +385,7 @@ public Component getTreeCellRendererComponent(JTree tree, Object value,
 
             this.nameLabel.setText(displayName);
 
-            if(contactList.isContactActive(contact))
+            if(statusIcon != null && contactList.isContactActive(contact))
                 statusIcon.setImage(msgReceivedImage);
             else
                 statusIcon = contact.getStatusIcon();

File: src/net/java/sip/communicator/plugin/reconnectplugin/ReconnectPluginActivator.java
Patch:
@@ -413,8 +413,6 @@ private void handleProviderRemoved(ProtocolProviderService provider)
      */
     public synchronized void configurationChanged(ChangeEvent event)
     {
-        String ifaceName = (String)event.getSource();
-
         if(event.getType() == ChangeEvent.IFACE_UP)
         {
             // no connection so one is up, lets connect
@@ -438,10 +436,12 @@ public synchronized void configurationChanged(ChangeEvent event)
                 needsReconnection.clear();
             }
 
-            connectedInterfaces.add(ifaceName);
+            connectedInterfaces.add((String)event.getSource());
         }
         else if(event.getType() == ChangeEvent.IFACE_DOWN)
         {
+            String ifaceName = (String)event.getSource();
+
             connectedInterfaces.remove(ifaceName);
 
             // one is down and at least one more is connected

File: src/net/java/sip/communicator/impl/protocol/icq/ServerStoredContactListIcqImpl.java
Patch:
@@ -511,7 +511,7 @@ ContactIcqImpl createVolatileContact(Screenname screenname)
         {
             List<Buddy> emptyBuddies = new LinkedList<Buddy>();
             theVolatileGroup = new ContactGroupIcqImpl(
-                new VolatileGroup(), emptyBuddies, this, false);
+                new VolatileGroup(), emptyBuddies, this, false, false);
             theVolatileGroup.addContact(newVolatileContact);
 
             this.rootGroup.addSubGroup(theVolatileGroup);
@@ -575,7 +575,7 @@ ContactGroupIcqImpl createUnresolvedContactGroup(String groupName)
         //First create the new volatile contact;
         List<Buddy> emptyBuddies = new LinkedList<Buddy>();
         ContactGroupIcqImpl newUnresolvedGroup = new ContactGroupIcqImpl(
-                new VolatileGroup(groupName), emptyBuddies, this, false);
+                new VolatileGroup(groupName), emptyBuddies, this, false, true);
 
         this.rootGroup.addSubGroup(newUnresolvedGroup);
 
@@ -816,7 +816,7 @@ public void groupAdded(BuddyList list,
                 newGroup = new ContactGroupIcqImpl(
                       (MutableGroup) group
                     , buddies
-                    , ServerStoredContactListIcqImpl.this, true);
+                    , ServerStoredContactListIcqImpl.this, true, true);
 
                 //this is the first group so insert at 0.
                 rootGroup.addSubGroup(newGroup);

File: src/net/java/sip/communicator/util/dns/ParallelResolver.java
Patch:
@@ -553,8 +553,8 @@ public void run()
                     return;
 
                 //if there was a response we're only done if it is satisfactory
-                if(    localResponse == null
-                    || isResponseSatisfactory(localResponse))
+                if(    localResponse != null
+                    && isResponseSatisfactory(localResponse))
                 {
                     response = localResponse;
                     done = true;

File: src/net/java/sip/communicator/service/protocol/icqconstants/IcqStatusEnum.java
Patch:
@@ -135,6 +135,9 @@ public static byte[] loadIcon(String imagePath) {
         InputStream is = IcqStatusEnum.class.getClassLoader()
             .getResourceAsStream(imagePath);
 
+        if(is == null)
+            return null;
+
         byte[] icon = null;
         try {
             icon = new byte[is.available()];

File: src/net/java/sip/communicator/service/protocol/msnconstants/MsnStatusEnum.java
Patch:
@@ -141,6 +141,9 @@ public static byte[] loadIcon(String imagePath) {
         InputStream is = MsnStatusEnum.class.getClassLoader()
             .getResourceAsStream(imagePath);
 
+        if(is == null)
+            return null;
+
         byte[] icon = null;
         try {
             icon = new byte[is.available()];

File: src/net/java/sip/communicator/service/protocol/yahooconstants/YahooStatusEnum.java
Patch:
@@ -174,6 +174,9 @@ public static byte[] loadIcon(String imagePath) {
         InputStream is = YahooStatusEnum.class.getClassLoader()
             .getResourceAsStream(imagePath);
 
+        if(is == null)
+            return null;
+
         byte[] icon = null;
         try {
             icon = new byte[is.available()];

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MetaContactRightButtonMenu.java
Patch:
@@ -532,7 +532,8 @@ private void init()
             sendSmsItem.setName("sendSms");
         }
 
-        if (callContactMenu.getItemCount() > 1 || hasPhones)
+        if (callContactMenu.getItemCount() > 1 ||
+            (hasPhones && callContactMenu.getItemCount() > 0))
         {
             this.add(callContactMenu);
         }

File: src/net/java/sip/communicator/impl/configuration/ConfigurationServiceImpl.java
Patch:
@@ -1052,6 +1052,7 @@ private File getConfigurationFile(String extension, boolean create)
      * default when no specific <tt>ConfigurationStore</tt> <tt>Class</tt> is
      * determined as necessary
      */
+    @SuppressWarnings("unchecked")
     private static Class<? extends ConfigurationStore>
         getDefaultConfigurationStoreClass()
     {

File: src/net/java/sip/communicator/impl/configuration/DatabaseConfigurationStore.java
Patch:
@@ -15,6 +15,7 @@
  *
  * @author Lyubomir Marinov
  */
+@SuppressWarnings("rawtypes")
 public abstract class DatabaseConfigurationStore
     extends HashtableConfigurationStore<Hashtable>
 {

File: src/net/java/sip/communicator/impl/configuration/HashtableConfigurationStore.java
Patch:
@@ -13,6 +13,7 @@
  * @param <T> the hashtable extension
  * @author Lyubomir Marinov
  */
+@SuppressWarnings("rawtypes")
 public abstract class HashtableConfigurationStore<T extends Hashtable>
     implements ConfigurationStore
 {
@@ -112,6 +113,7 @@ public void removeProperty(String name)
      * specified name in this <tt>ConfigurationStore</tt>
      * @see ConfigurationStore#setNonSystemProperty(String, Object)
      */
+    @SuppressWarnings("unchecked")
     public void setNonSystemProperty(String name, Object value)
     {
         properties.put(name, value);

File: src/net/java/sip/communicator/impl/hid/HIDServiceImpl.java
Patch:
@@ -48,8 +48,9 @@ protected HIDServiceImpl()
         }
         catch(Throwable e)
         {
-            logger.error("Error when creating Robot/NativeKeyboard instance",
-                    e);
+            if(!GraphicsEnvironment.isHeadless())
+                logger.error(
+                    "Error when creating Robot/NativeKeyboard instance", e);
         }
     }
 

File: src/net/java/sip/communicator/impl/osdependent/SystemTray.java
Patch:
@@ -52,9 +52,9 @@ public static SystemTray getDefaultSystemTray()
             }
             catch (Exception ex)
             {
-                logger.error(
-                "Failed to initialize the java.awt.SystemTray implementation.",
-                ex);
+                if(!GraphicsEnvironment.isHeadless())
+                    logger.error("Failed to initialize java.awt.SystemTray",
+                        ex);
 
                 // We'll try org.jdesktop.jdic.tray then.
             }

File: src/net/java/sip/communicator/impl/osdependent/jdic/SystrayServiceJdicImpl.java
Patch:
@@ -8,6 +8,7 @@
 
 import com.apple.eawt.*;
 
+import java.awt.GraphicsEnvironment;
 import java.awt.Image;
 import java.awt.Toolkit;
 import java.awt.event.*;
@@ -133,7 +134,8 @@ public SystrayServiceJdicImpl()
             systray = SystemTray.getDefaultSystemTray();
         } catch (Throwable e)
         {
-            logger.error("Failed to create a systray!", e);
+            if(!GraphicsEnvironment.isHeadless())
+                logger.error("Failed to create a systray!", e);
         }
 
         if (systray != null)

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactJabberImpl.java
Patch:
@@ -359,6 +359,7 @@ void setResolved(RosterEntry entry)
             return;
 
         this.isResolved = true;
+        this.isPersistent = true;
         this.jid = entry.getUser();
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -1092,7 +1092,7 @@ private ContactJabberImpl addEntryToContactList(String rosterEntryID)
                     contact.setResolved(entry);
                     return contact;
                 }
-                else
+                else if(contact instanceof VolatileContactJabberImpl)
                 {
                     ContactGroup oldParentGroup =
                         contact.getParentContactGroup();
@@ -1109,6 +1109,8 @@ private ContactJabberImpl addEntryToContactList(String rosterEntryID)
                         fireContactRemoved(oldParentGroup, contact);
                     }
                 }
+                else
+                    return contact;
             }
 
             contact = new ContactJabberImpl(

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -248,7 +248,9 @@ private void initSmsLabel(final JPanel centerPanel)
             .getImage("service.gui.icons.SEND_SMS_SELECTED");
 
         smsLabel = new JLabel(smsIcon);
-        smsLabel.setVisible(true);
+
+        // We hide the sms label until we know if the chat supports sms.
+        smsLabel.setVisible(false);
 
         smsMenuItem = new JCheckBoxMenuItem(GuiActivator.getResources()
             .getI18NString("service.gui.VIA_SMS"));

File: src/net/java/sip/communicator/impl/protocol/msn/EventManager.java
Patch:
@@ -187,6 +187,7 @@ public void run()
             {
                 if(!connected && msnProvider.isRegistered())
                 {
+                    msnProvider.unregister(false);
                     msnProvider.fireRegistrationStateChanged(
                         msnProvider.getRegistrationState(),
                         RegistrationState.CONNECTION_FAILED,

File: src/net/java/sip/communicator/impl/globalshortcut/GlobalShortcutActivator.java
Patch:
@@ -199,6 +199,9 @@ public void registerListenerWithProtocolProviderService()
             e.printStackTrace();
         }
 
+        if(refs == null)
+            return;
+
         for(ServiceReference ref : refs)
         {
             ProtocolProviderService service =

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -554,8 +554,7 @@ public void subscribe(ContactGroup parent, String contactIdentifier)
                 "Argument is not an jabber contact group (group="
                             + parent + ")");
 
-        ssContactList.addContact(
-                        (ContactGroupJabberImpl)parent, contactIdentifier);
+        ssContactList.addContact(parent, contactIdentifier);
     }
 
     /**

File: src/net/java/sip/communicator/impl/globalshortcut/GlobalShortcutServiceImpl.java
Patch:
@@ -226,7 +226,7 @@ public void stop()
      * @param keycode keycode received
      * @param modifiers modifiers received (ALT or CTRL + letter, ...)
      */
-    public void receiveKey(int keycode, int modifiers)
+    public synchronized void receiveKey(int keycode, int modifiers)
     {
         synchronized(mapActions)
         {
@@ -282,7 +282,6 @@ private static int getModifiers(AWTKeyStroke keystroke)
         return ret;
     }
 
-
     /**
      * Reload global shortcuts.
      */

File: src/net/java/sip/communicator/impl/globalshortcut/UIShortcut.java
Patch:
@@ -43,6 +43,9 @@ public void shortcutReceived(GlobalShortcutEvent evt)
         {
             for(AWTKeyStroke ks : entry.getValue())
             {
+                if(ks == null)
+                    continue;
+
                 if(entry.getKey().equals("contactlist") &&
                     keystroke.getKeyCode() == ks.getKeyCode() &&
                     keystroke.getModifiers() == ks.getModifiers())

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -1012,7 +1012,7 @@ public void subscribe(ContactGroup parentGroup, String contactIdentifier)
                IllegalStateException,
                OperationFailedException
     {
-        this.subscribe(parentGroup, contactIdentifier);
+        this.subscribe(parentGroup, contactIdentifier, null);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -59,7 +59,7 @@ public class ChatWritePanel
 
     private final Timer typingTimer = new Timer(5 * 1000, this);
 
-    private int typingState = -1;
+    private int typingState = OperationSetTypingNotifications.STATE_STOPPED;
 
     private final WritePanelRightButtonMenu rightButtonMenu;
 

File: src/net/java/sip/communicator/impl/protocol/sip/ServerStoredContactListXivoImpl.java
Patch:
@@ -353,6 +353,7 @@ public void removeGroup(ContactGroupSipImpl group)
      * @param contactId   the sip id of the contact to create.
      * @param displayName the display name of the contact to create
      * @param persistent  specify whether created contact is persistent ot not.
+     * @param contactType the contact type to create, if missing null.
      * @return the newly created <tt>ContactSipImpl</tt>.
      * @throws OperationFailedException with code NETWORK_FAILURE if the
      *                                  operation if failed during network
@@ -362,7 +363,8 @@ public ContactSipImpl createContact(
             ContactGroupSipImpl parentGroup,
             String contactId,
             String displayName,
-            boolean persistent)
+            boolean persistent,
+            String contactType)
         throws OperationFailedException
     {
         throw new OperationFailedException("Modification not supported.",

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/model/XmlUtils.java
Patch:
@@ -51,9 +51,8 @@ public static void processAny(Element element, List<Element> any)
     {
         for (Element anyElement : any)
         {
-            Element importedElement =
-                    (Element) importNode(element.getOwnerDocument(),
-                            anyElement);
+            Node importedElement =
+                element.getOwnerDocument().importNode(anyElement, true);
             element.appendChild(importedElement);
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaContactListSource.java
Patch:
@@ -313,7 +313,6 @@ public boolean isMatching(Pattern filterPattern, MetaContactGroup metaGroup)
         return false;
     }
 
-    @Override
     public void contactPresenceStatusChanged(
         ContactPresenceStatusChangeEvent evt)
     {

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -511,7 +511,7 @@ public void addProtocolSupportedOperationSets(
             presence.addProviderPresenceStatusListener(
                 uiProviderPresenceListener);
             presence.addContactPresenceStatusListener(
-                GuiActivator.getContactList());
+                GuiActivator.getContactList().getMetaContactListSource());
         }
 
         // Obtain the basic instant messaging operation set.
@@ -644,7 +644,7 @@ public void removeProtocolSupportedOperationSets(
                 presence.removeProviderPresenceStatusListener(
                     uiProviderPresenceListener);
             presence.removeContactPresenceStatusListener(
-                    GuiActivator.getContactList());
+                GuiActivator.getContactList().getMetaContactListSource());
         }
 
         // Obtain the basic instant messaging operation set.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -61,9 +61,9 @@ public class SearchFilter
     /**
      * Creates an instance of <tt>SearchFilter</tt>.
      */
-    public SearchFilter()
+    public SearchFilter(MetaContactListSource contactListSource)
     {
-        this.mclSource = new MetaContactListSource();
+        this.mclSource = contactListSource;
     }
 
     /**

File: src/net/java/sip/communicator/impl/configuration/ConfigurationServiceImpl.java
Patch:
@@ -1069,7 +1069,7 @@ private File getConfigurationFile(String extension, boolean create)
             catch (ClassNotFoundException cnfe)
             {
             }
-            if (clazz != null
+            if ((clazz != null)
                     && ConfigurationStore.class.isAssignableFrom(clazz))
                 defaultConfigurationStoreClass
                     = (Class<? extends ConfigurationStore>) clazz;

File: src/net/java/sip/communicator/impl/fileaccess/FileAccessServiceImpl.java
Patch:
@@ -386,9 +386,7 @@ public File getDefaultDownloadDirectory()
         // would be the home directory (i.e. the Desktop folder).
         if (OSUtils.IS_WINDOWS && getMajorOSVersion() <= 5)
         {
-            FileSystemView fsv = FileSystemView.getFileSystemView();
-
-            downloadDir = fsv.getHomeDirectory();
+            downloadDir = FileSystemView.getFileSystemView().getHomeDirectory();
         }
         // For all other operating systems we return the Downloads folder.
         else

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/AbstractBufferCaptureDevice.java
Patch:
@@ -11,7 +11,7 @@
 import java.util.*;
 
 import javax.media.*;
-import javax.media.Controls;
+import javax.media.Controls; // disambiguation
 import javax.media.control.*;
 import javax.media.protocol.*;
 

File: src/net/java/sip/communicator/impl/netaddr/NetaddrActivator.java
Patch:
@@ -146,6 +146,9 @@ public void stop(BundleContext bundleContext)
             networkAMS.stop();
         if (logger.isInfoEnabled())
             logger.info("Network Address Manager Service ...[STOPPED]");
+
+        configurationService = null;
+        packetLoggingService = null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolIconJabberImpl.java
Patch:
@@ -149,6 +149,9 @@ public static byte[] loadIcon(String imagePath) {
         if(is == null)
             is = getResources().getImageInputStreamForPath(imagePath);
 
+        if(is == null)
+                return new byte[0];
+
         byte[] icon = null;
         try {
             icon = new byte[is.available()];

File: src/net/java/sip/communicator/impl/resources/ResourceManagementActivator.java
Patch:
@@ -46,6 +46,8 @@ public void start(BundleContext bc) throws Exception
     public void stop(BundleContext bc) throws Exception
     {
         bc.removeServiceListener(resPackImpl);
+
+        configService = null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/version/VersionActivator.java
Patch:
@@ -126,5 +126,7 @@ public static BundleContext getBundleContext()
     public void stop(BundleContext context) throws Exception
     {
         versionServReg.unregister();
+
+        configurationService = null;
     }
 }

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderActivator.java
Patch:
@@ -187,5 +187,8 @@ public void stop(BundleContext bundleContext)
 
         if (bundleContext.equals(ProtocolProviderActivator.bundleContext))
             ProtocolProviderActivator.bundleContext = null;
+
+        configurationService = null;
+        resourceService = null;
     }
 }

File: src/net/java/sip/communicator/service/protocol/media/ProtocolMediaActivator.java
Patch:
@@ -80,6 +80,9 @@ public void start(BundleContext context) throws Exception
      */
     public void stop(BundleContext context) throws Exception
     {
+        configurationService = null;
+        mediaService = null;
+        networkAddressManagerService = null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaContactListSource.java
Patch:
@@ -324,8 +324,6 @@ public boolean isMatching(Pattern filterPattern, MetaContactGroup metaGroup)
         }
         return false;
     }
-
-    @Override
     public void contactPresenceStatusChanged(
         ContactPresenceStatusChangeEvent evt)
     {

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -511,7 +511,7 @@ public void addProtocolSupportedOperationSets(
             presence.addProviderPresenceStatusListener(
                 uiProviderPresenceListener);
             presence.addContactPresenceStatusListener(
-                GuiActivator.getContactList());
+                GuiActivator.getContactList().getMetaContactListSource());
         }
 
         // Obtain the basic instant messaging operation set.
@@ -644,7 +644,7 @@ public void removeProtocolSupportedOperationSets(
                 presence.removeProviderPresenceStatusListener(
                     uiProviderPresenceListener);
             presence.removeContactPresenceStatusListener(
-                    GuiActivator.getContactList());
+                GuiActivator.getContactList().getMetaContactListSource());
         }
 
         // Obtain the basic instant messaging operation set.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -61,9 +61,9 @@ public class SearchFilter
     /**
      * Creates an instance of <tt>SearchFilter</tt>.
      */
-    public SearchFilter()
+    public SearchFilter(MetaContactListSource contactListSource)
     {
-        this.mclSource = new MetaContactListSource();
+        this.mclSource = contactListSource;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceFocusPanel.java
Patch:
@@ -576,7 +576,6 @@ private void initSecuritySettings()
         }
     }
 
-    @Override
     public UIVideoHandler getVideoHandler()
     {
         return videoHandler;

File: src/net/java/sip/communicator/impl/neomedia/codec/EncodingConfiguration.java
Patch:
@@ -205,7 +205,6 @@ public void initializeFormatPreferences()
         setEncodingPreference("DVI4", 8000, 300);
         setEncodingPreference("DVI4", 16000, 250);
         setEncodingPreference("G723", 8000, 150);
-        setEncodingPreference("G728", 8000, 100);
 
         setEncodingPreference("SILK", 12000, 0);
         setEncodingPreference("SILK", 8000, 0);

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -414,9 +414,9 @@ public abstract class ProtocolProviderFactory
     /**
      * The name of the property that indicates the AVP type.
      * <ul>
-     * <li>{@link #SAVP_OPTION_AVP}</li>
-     * <li>{@link #SAVP_OPTION_SAVP}</li>
-     * <li>{@link #SAVP_OPTION_AVP_OR_SAVP}</li>
+     * <li>{@link #SAVP_OFF}</li>
+     * <li>{@link #SAVP_MANDATORY}</li>
+     * <li>{@link #SAVP_OPTIONAL}</li>
      * </ul>
      */
     public static final String SAVP_OPTION = "SAVP_OPTION";

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1438,6 +1438,9 @@ protected void initialize(String screenname,
                 OperationSetGenericNotifications.class,
                 new OperationSetGenericNotificationsJabberImpl(this));
 
+            // let sufficient time for packet reply
+            SmackConfiguration.setPacketReplyTimeout(45000);
+
             isInitialized = true;
         }
     }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -288,7 +288,7 @@ else if(calleeAddress.endsWith(GOOGLE_VOICE_DOMAIN))
         int bestPriority = -1;
 
         if(!getProtocolProvider().getConnection().getRoster().contains(
-            calleeAddress) && !alwaysCallGtalk)
+            StringUtils.parseBareAddress(calleeAddress)) && !alwaysCallGtalk)
         {
             throw new OperationFailedException(
                 calleeAddress + " does not belong to our contact list",

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -1763,7 +1763,7 @@ private void handleProviderRemoved(
         //ignore if persistent presence is not supported.
         if(persPresOpSet != null)
         {
-            //we don't care about subscription and presence status events here 
+            //we don't care about subscription and presence status events here
             // any longer.
             persPresOpSet.removeContactPresenceStatusListener(this);
             persPresOpSet.removeSubscriptionListener(

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsActivator.java
Patch:
@@ -348,6 +348,7 @@ public void stop(BundleContext bundleContext)
      *
      * @param login login
      * @param password password
+     * @return a <tt>GoogleContactsSourceService</tt> instance
      */
     public static GoogleContactsSourceService enableContactSource(
                                                 String login, String password)
@@ -385,6 +386,7 @@ public static GoogleContactsSourceService enableContactSource(
      * <tt>GoogleContactsConnection</tt>.
      *
      * @param cnx <tt>GoogleContactsConnection</tt>
+     * @return a <tt>GoogleContactsSourceService</tt> instance
      */
     public static GoogleContactsSourceService enableContactSource(
                                                 GoogleContactsConnection cnx)

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsConnectionImpl.java
Patch:
@@ -166,17 +166,17 @@ public void setEnabled(boolean enabled)
     /**
      * Sets the google contacts prefix.
      *
-     * @param prefix the prefix to set
+     * @param prefix the phone number prefix to set
      */
     public void setPrefix(String prefix)
     {
         this.prefix = prefix;
     }
 
     /**
-     * Returns the google contacts prefix.
+     * Returns the google contacts phone number prefix.
      *
-     * @return the google contacts prefix
+     * @return the google contacts phone number prefix
      */
     public String getPrefix()
     {

File: src/net/java/sip/communicator/impl/googlecontacts/configform/GoogleContactsTableModel.java
Patch:
@@ -40,6 +40,7 @@ public class GoogleContactsTableModel
      *
      * @param cnx account
      * @param enabled if the account should be enabled
+     * @param prefix phone number prefix
      */
     public void addAccount( GoogleContactsConnection cnx,
                             boolean enabled,

File: src/net/java/sip/communicator/impl/ldap/LdapActivator.java
Patch:
@@ -191,6 +191,7 @@ public static PhoneNumberI18nService getPhoneNumberI18nService()
      * Enable contact source service with specified LDAP directory.
      *
      * @param ldapDir LDAP directory
+     * @return an LDAP <tt>ContactSourceService</tt> instance
      */
     public static ContactSourceService registerContactSource(
                                                         LdapDirectory ldapDir)

File: src/net/java/sip/communicator/impl/neomedia/MediaUtils.java
Patch:
@@ -15,7 +15,7 @@
 import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.format.*;
 import net.java.sip.communicator.service.neomedia.*;
-import net.java.sip.communicator.service.neomedia.device.ScreenDevice;
+import net.java.sip.communicator.service.neomedia.device.*;
 import net.java.sip.communicator.service.neomedia.format.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/neomedia/VideoMediaStreamImpl.java
Patch:
@@ -941,7 +941,7 @@ public void updateQualityControl(
                         new QualityPreset(res[0]));
                     qualityControl.setRemoteReceiveResolution(
                         res[1]);
-                    outputSize = res[1];    
+                    outputSize = res[1];
                     ((VideoMediaDeviceSession)getDeviceSession()).
                         setOutputSize(outputSize);
                 }

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerJabberImpl.java
Patch:
@@ -1201,7 +1201,7 @@ public void processTransportInfo(JingleIQ jingleIQ)
      */
     protected void sendTransportInfo(Iterable<ContentPacketExtension> contents)
     {
-        // if the call is cancelled, do not start sending candidates in
+        // if the call is canceled, do not start sending candidates in
         // transport-info
         if(cancelled)
             return;

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/MailThreadInfo.java
Patch:
@@ -253,12 +253,12 @@ public int getUnreadSenderCount()
      * Returns the sender that initiated the thread or the first sender in the
      * list if for some reason we couldn't determine the originator.
      *
+     * @param firstNameOnly use only first name
      * @return the sender that initiated the thread or the first sender in the
      * list if for some reason we couldn't determine the originator.
      */
     public String findOriginator(boolean firstNameOnly)
     {
-
         return null;
     }
 

File: src/net/java/sip/communicator/impl/protocol/sip/sdp/SdpUtils.java
Patch:
@@ -80,7 +80,7 @@ public static SessionDescription parseSdpString(String sdp)
      * Creates an Attribute object with the specified values.
      *
      * @param name the name of the attribute
-     * @param value the value of the attribute 
+     * @param value the value of the attribute
      *
      * @return Attribute
      */

File: src/net/java/sip/communicator/impl/sysactivity/SystemActivityNotifications.java
Patch:
@@ -163,7 +163,7 @@ public static void stop()
     /**
      * Returns the when was last input in milliseconds. The time when
      * there was any activity on the computer.
-     * @return
+     * @return the last input in milliseconds
      */
     public static native long getLastInput();
 

File: src/net/java/sip/communicator/impl/configuration/ConfigurationServiceImpl.java
Patch:
@@ -1069,7 +1069,8 @@ private File getConfigurationFile(String extension, boolean create)
             catch (ClassNotFoundException cnfe)
             {
             }
-            if (ConfigurationStore.class.isAssignableFrom(clazz))
+            if (clazz != null
+                    && ConfigurationStore.class.isAssignableFrom(clazz))
                 defaultConfigurationStoreClass
                     = (Class<? extends ConfigurationStore>) clazz;
         }

File: src/net/java/sip/communicator/impl/sysactivity/SystemActivityNotifications.java
Patch:
@@ -91,7 +91,7 @@ public class SystemActivityNotifications
         }
         catch(Throwable t)
         {
-            logger.error("Error init native functions", t);
+            logger.warn("Error init native functions, " + t.getMessage());
         }
     }
 

File: src/net/java/sip/communicator/plugin/advancedconfig/AdvancedConfigurationPanel.java
Patch:
@@ -392,7 +392,7 @@ public int getIndex()
      */
     public boolean isAdvanced()
     {
-        return true;
+        return false;
     }
 
     /**

File: src/net/java/sip/communicator/util/swing/AuthenticationWindow.java
Patch:
@@ -105,7 +105,7 @@ public AuthenticationWindow(String server,
                                 boolean isUserNameEditable,
                                 ImageIcon icon)
     {
-        this(null, server, isUserNameEditable, icon);
+        this(new JDialog(), server, isUserNameEditable, icon);
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/VideoMediaStreamImpl.java
Patch:
@@ -941,6 +941,9 @@ public void updateQualityControl(
                         new QualityPreset(res[0]));
                     qualityControl.setRemoteReceiveResolution(
                         res[1]);
+                    outputSize = res[1];    
+                    ((VideoMediaDeviceSession)getDeviceSession()).
+                        setOutputSize(outputSize);
                 }
             }
         }

File: src/net/java/sip/communicator/plugin/otr/ScOtrEngineImpl.java
Patch:
@@ -86,7 +86,7 @@ public void showWarning(SessionID sessionID, String warn)
 
         public void showError(SessionID sessionID, String err)
         {
-            showError(sessionID, err);
+            ScOtrEngineImpl.this.showError(sessionID, err);
         }
 
         public void injectMessage(SessionID sessionID, String messageText)

File: src/net/java/sip/communicator/impl/gui/main/SingleWindowContainer.java
Patch:
@@ -58,7 +58,7 @@ public class SingleWindowContainer
     /**
      * The contact photo panel.
      */
-    private final ContactPhotoPanel contactPhotoPanel = new ContactPhotoPanel();
+    private final ContactPhotoPanel contactPhotoPanel;
 
     /**
      * The main toolbar.
@@ -77,6 +77,8 @@ public SingleWindowContainer()
 
         tabbedPane = new ConversationTabbedPane();
         tabbedPane.addChangeListener(this);
+        contactPhotoPanel = new ContactPhotoPanel(
+            GuiActivator.getUIService().getMainFrame());
 
         add(tabbedPane);
     }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -648,7 +648,8 @@ else if (o instanceof FileRecord)
                 FileRecord fileRecord = (FileRecord) o;
 
                 FileHistoryConversationComponent component
-                    = new FileHistoryConversationComponent(fileRecord);
+                    = new FileHistoryConversationComponent(
+                        chatContainer.getFrame(), fileRecord);
 
                 conversationPanel.addComponent(component);
             }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -70,7 +70,7 @@ public class ChatWindow
     private final JPanel pluginPanelWest = new JPanel();
     private final JPanel pluginPanelEast = new JPanel();
 
-    private final ContactPhotoPanel contactPhotoPanel = new ContactPhotoPanel();
+    private final ContactPhotoPanel contactPhotoPanel;
 
     private final MessageWindowMenuBar menuBar;
 
@@ -111,6 +111,8 @@ public ChatWindow()
 
         menuBar = new MessageWindowMenuBar(this);
 
+        contactPhotoPanel = new ContactPhotoPanel(this);
+
         this.setJMenuBar(menuBar);
 
         toolbarPanel = createToolBar();

File: src/net/java/sip/communicator/impl/gui/main/chat/filetransfer/ReceiveFileConversationComponent.java
Patch:
@@ -61,6 +61,8 @@ public ReceiveFileConversationComponent(
         final IncomingFileTransferRequest request,
         final Date date)
     {
+        super(chatPanel.getChatContainer().getFrame());
+
         this.chatPanel = chatPanel;
         this.fileTransferOpSet = opSet;
         this.fileTransferRequest = request;

File: src/net/java/sip/communicator/impl/gui/main/chat/filetransfer/SendFileConversationComponent.java
Patch:
@@ -49,6 +49,8 @@ public SendFileConversationComponent(   ChatPanel chatPanel,
                                             String toContactName,
                                             final File file)
     {
+        super(chatPanel.getChatContainer().getFrame());
+
         this.parentChatPanel = chatPanel;
         this.toContactName = toContactName;
         this.file = file;

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -321,7 +321,8 @@ else if (o instanceof FileRecord)
                     FileRecord fileRecord = (FileRecord) o;
 
                     FileHistoryConversationComponent component
-                        = new FileHistoryConversationComponent(fileRecord);
+                        = new FileHistoryConversationComponent(
+                            this, fileRecord);
 
                     chatConvPanel.addComponent(component);
                 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/ShowMoreContact.java
Patch:
@@ -142,7 +142,8 @@ public ImageIcon getStatusIcon()
      */
     public ExtendedTooltip getToolTip()
     {
-        ExtendedTooltip tooltip = new ExtendedTooltip(false);
+        ExtendedTooltip tooltip = new ExtendedTooltip(
+            GuiActivator.getUIService().getMainFrame(), false);
 
         tooltip.setTitle(GuiActivator.getResources()
             .getI18NString("service.gui.SHOW_MORE_TOOLTIP"));

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/SourceUIContact.java
Patch:
@@ -303,7 +303,8 @@ public JPopupMenu getRightButtonMenu()
      */
     public ExtendedTooltip getToolTip()
     {
-        ExtendedTooltip tip = new ExtendedTooltip(true);
+        ExtendedTooltip tip = new ExtendedTooltip(
+            GuiActivator.getUIService().getMainFrame(), true);
 
         byte[] avatarImage = sourceContact.getImage();
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/notifsource/NotificationContact.java
Patch:
@@ -222,7 +222,8 @@ else if (protocolProvider.isRegistered())
      */
     public ExtendedTooltip getToolTip()
     {
-        ExtendedTooltip tip = new ExtendedTooltip(true);
+        ExtendedTooltip tip = new ExtendedTooltip(
+            GuiActivator.getUIService().getMainFrame(), true);
 
         ImageIcon avatarImage = getAvatar(true, 64, 64);
 

File: src/net/java/sip/communicator/plugin/pluginmanager/PluginListCellRenderer.java
Patch:
@@ -146,7 +146,7 @@ public Component getTableCellRendererComponent(JTable table, Object value,
     {
         Bundle bundle = (Bundle) value;
 
-        Dictionary<Object, Object> headers = bundle.getHeaders();
+        Dictionary<?, ?> headers = bundle.getHeaders();
         Object bundleName = headers.get(Constants.BUNDLE_NAME);
         Object bundleVersion = headers.get(Constants.BUNDLE_VERSION);
         Object bundleDescription = headers.get(Constants.BUNDLE_DESCRIPTION);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -1038,8 +1038,8 @@ private void setChatContactPhoto(ChatSession chatSession)
         if (chatAvatar != null && chatAvatar.length > 0)
         {
             contactPhotoIcon = ImageUtils.getScaledRoundedIcon(chatAvatar,
-                                                                10,
-                                                                10);
+                                                                128,
+                                                                128);
 
             if (contactPhotoIcon != null)
                 this.setIconImage(contactPhotoIcon.getImage());
@@ -1051,7 +1051,6 @@ private void setChatContactPhoto(ChatSession chatSession)
         }
     }
 
-
     /**
      * Implementation of {@link ExportedWindow#setParams(Object[])}.
      */

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/video4linux2/Video4Linux2.java
Patch:
@@ -41,6 +41,9 @@ public class Video4Linux2
     public static final int V4L2_PIX_FMT_RGB24
         = v4l2_fourcc('R', 'G', 'B', '3');
 
+    public static final int V4L2_PIX_FMT_BGR24
+        = v4l2_fourcc('B', 'G', 'R', '3');
+
     public static final int V4L2_PIX_FMT_UYVY
         = v4l2_fourcc('U', 'Y', 'V', 'Y');
 

File: src/net/java/sip/communicator/service/httputil/HttpUtils.java
Patch:
@@ -317,7 +317,7 @@ public static HTTPResponseResult postFile(String address,
             if(resEntity == null)
                 return null;
 
-            return new HTTPResponseResult(reqEntity, httpClient);
+            return new HTTPResponseResult(resEntity, httpClient);
         }
         catch(Throwable e)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -447,7 +447,7 @@ void reregister(int authReasonCode)
 
     /**
      * Indicates if the XMPP transport channel is using a TLS secured socket.
-     * 
+     *
      * @return True when TLS is used, false otherwise.
      */
     public boolean isSignalingTransportSecure()
@@ -1829,7 +1829,7 @@ public boolean isExtFeatureListSupported(String jid, String... extFeatures)
                 }
             }
 
-            return true;
+            return found;
         }
 
         return false;

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerGTalkImpl.java
Patch:
@@ -663,7 +663,7 @@ private static boolean isAndroid(String fullJID)
         if(idx != -1)
         {
             String res = fullJID.substring(idx + 1);
-            if(res.startsWith("android"))
+            if(res.startsWith("android") || res.startsWith("Vtok"))
             {
                 return true;
             }

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -331,7 +331,8 @@ else if (o instanceof FileRecord)
                     processedMessage = chatConvPanel.processMessage(
                             chatMessage, searchKeyword);
 
-                    chatConvPanel.appendMessageToEnd(processedMessage);
+                    chatConvPanel.appendMessageToEnd(processedMessage,
+                        ChatConversationPanel.TEXT_CONTENT_TYPE);
                 }
             }
         }

File: src/net/java/sip/communicator/impl/neomedia/RawPacket.java
Patch:
@@ -626,7 +626,7 @@ public int getExtensionLength()
                         + FIXED_HEADER_SIZE
                         + getCsrcCount()*4 + 2;
 
-        return ((buffer[extLenIndex] << 4) | buffer[extLenIndex + 1]) * 4;
+        return ((buffer[extLenIndex] << 8) | buffer[extLenIndex + 1]) * 4;
     }
 
     /**
@@ -690,7 +690,7 @@ public void addExtension(byte[] extBuff, int newExtensionLen)
         }
         // length field counts the number of 32-bit words in the extension
         int lengthInWords = (totalExtensionLen + 3)/4;
-        newBuffer[newBufferOffset++] = (byte)(lengthInWords >>4);
+        newBuffer[newBufferOffset++] = (byte)(lengthInWords >> 8);
         newBuffer[newBufferOffset++] = (byte)lengthInWords;
 
         // Copy the existing extension content if any.

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -1003,7 +1003,7 @@ private String processNewLines(String message)
             message
                 .replaceAll(
                     "\n",
-                    END_PLAINTEXT_TAG + "<BR>&#10;" + START_PLAINTEXT_TAG);
+                    END_PLAINTEXT_TAG + "<BR/>&#10;" + START_PLAINTEXT_TAG);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -803,9 +803,9 @@ public String getTextAsHtml()
 
         formattedString = extractFormattedText(formattedString);
 
-        if (formattedString.endsWith("<BR>"))
+        if (formattedString.endsWith("<BR/>"))
             formattedString = formattedString
-            .substring(0, formattedString.lastIndexOf("<BR>"));
+            .substring(0, formattedString.lastIndexOf("<BR/>"));
 
         return formattedString;
     }
@@ -888,7 +888,7 @@ private String extractFormattedText(String msgText)
     {
         String resultString = msgText.replaceAll("<p\\b[^>]*>", "");
 
-        return resultString.replaceAll("<\\/p>", "<BR>");
+        return resultString.replaceAll("<\\/p>", "<BR/>");
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -1242,8 +1242,5 @@ public void removeUpdate(DocumentEvent event)
             smsCharCountLabel.setText(String.valueOf(smsCharCount));
             smsNumberLabel.setText(String.valueOf(smsNumberCount));
         }
-
-        if (getText() == null || getText().length() <= 0)
-            initDefaultFontConfiguration();
     }
 }

File: src/net/java/sip/communicator/impl/neomedia/device/DirectShowAuto.java
Patch:
@@ -70,7 +70,8 @@ public DirectShowAuto() throws Exception
             else
             {
                 logger.warn("No support for this webcam: " +
-                        devices[i].getName() + "(no format supported)");
+                        devices[i].getName() + "(format " + pixelFormat +
+                        " not supported)");
                 continue;
             }
 

File: src/net/java/sip/communicator/impl/provdisc/dhcp/DHCPProvisioningDiscover.java
Patch:
@@ -55,7 +55,6 @@ public class DHCPProvisioningDiscover
      */
     private byte option = (byte)224;
 
-
     /**
      * List of <tt>ProvisioningListener</tt> that will be notified when
      * a provisioning URL is retrieved.
@@ -112,7 +111,7 @@ public String discoverProvisioningURL()
             inform.setYiaddr(InetAddress.getByAddress(zeroIPAddress));
             inform.setSiaddr(InetAddress.getByAddress(zeroIPAddress));
             inform.setGiaddr(InetAddress.getByAddress(zeroIPAddress));
-            inform.setChaddr(macAddress);
+            //inform.setChaddr(macAddress);
             inform.setDhcp(true);
             inform.setDHCPMessageType(DHCPConstants.DHCPINFORM);
 
@@ -149,7 +148,7 @@ public String discoverProvisioningURL()
                             p.setCiaddr(addr);
                             p.setChaddr(macAddress);
 
-                            byte msg[] = inform.serialize();
+                            byte msg[] = p.serialize();
                             DatagramPacket pkt = new DatagramPacket(msg,
                                     msg.length,
                                     InetAddress.getByAddress(broadcastIPAddr),

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -1243,7 +1243,7 @@ public void removeUpdate(DocumentEvent event)
             smsNumberLabel.setText(String.valueOf(smsNumberCount));
         }
 
-        if (getText() == null || getText().isEmpty())
+        if (getText() == null || getText().length() <= 0)
             initDefaultFontConfiguration();
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -1453,7 +1453,8 @@ public void messageDeliveryFailed(MessageDeliveryFailedEvent evt)
                     == MessageDeliveryFailedEvent.OFFLINE_MESSAGES_NOT_SUPPORTED)
             {
                 errorMsg = GuiActivator.getResources().getI18NString(
-                    "service.gui.MSG_DELIVERY_NOT_SUPPORTED");
+                    "service.gui.MSG_DELIVERY_NOT_SUPPORTED",
+                    new String[]{sourceContact.getDisplayName()});
             }
             else if (evt.getErrorCode()
                     == MessageDeliveryFailedEvent.NETWORK_FAILURE)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -374,7 +374,8 @@ public void messageDeliveryFailed(MessageDeliveryFailedEvent evt)
                 == MessageDeliveryFailedEvent.OFFLINE_MESSAGES_NOT_SUPPORTED)
         {
             errorMsg = GuiActivator.getResources().getI18NString(
-                    "service.gui.MSG_DELIVERY_NOT_SUPPORTED");
+                    "service.gui.MSG_DELIVERY_NOT_SUPPORTED",
+                    new String[] {sourceContact.getDisplayName()});
         }
         else if (evt.getErrorCode()
                 == MessageDeliveryFailedEvent.NETWORK_FAILURE)

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderFactorySipImpl.java
Patch:
@@ -178,7 +178,9 @@ public void modifyAccount(  ProtocolProviderService protocolProvider,
             // unregister provider before removing it.
             try
             {
-                if(protocolProvider.isRegistered())
+                // shutdown even if its not registered, a port maybe wrong
+                // shutdown will clean everything and we will start clean
+                //if(protocolProvider.isRegistered())
                 {
                     protocolProvider.shutdown();
                 }

File: src/net/java/sip/communicator/service/netaddr/event/ChangeEvent.java
Patch:
@@ -163,7 +163,9 @@ public String toString()
             case ADDRESS_UP : buff.append("Address up"); break;
         }
 
-        buff.append(", standby=" + standby);
+        buff.append(", standby=" + standby)
+            .append(", source=" + source)
+            .append(", address=" + address);
 
         return buff.toString();
     }

File: src/net/java/sip/communicator/impl/configuration/ConfigurationServiceImpl.java
Patch:
@@ -544,9 +544,7 @@ void start(BundleContext bc)
         this.started = true;
 
         // retrieve a reference to the FileAccessService
-        ServiceReference faServiceReference = bc.getServiceReference(
-                FileAccessService.class.getName());
-        this.faService = (FileAccessService) bc.getService(faServiceReference);
+        this.faService = ServiceUtils.getService(bc, FileAccessService.class);
 
         try
         {

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/renderer/video/JAWTRenderer.java
Patch:
@@ -216,6 +216,8 @@ public synchronized Component getComponent()
             componentClassName.append(JAWTRenderer.class.getName());
             if (USE_MACOSX_CALAYERS && OSUtils.IS_MAC)
                 componentClassName.append("Swing");
+            else if (OSUtils.IS_ANDROID)
+                componentClassName.append("Android");
             componentClassName.append("VideoComponent");
 
             Class<?> componentClass;

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/JingleIQProvider.java
Patch:
@@ -61,7 +61,7 @@ public JingleIQProvider()
         //<encryption/> provider
         providerManager.addExtensionProvider(
             EncryptionPacketExtension.ELEMENT_NAME,
-            EncryptionPacketExtension.NAMESPACE,
+            RtpDescriptionPacketExtension.NAMESPACE,
             new DefaultPacketExtensionProvider
                 <EncryptionPacketExtension>(EncryptionPacketExtension.class));
 

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceMemberPanel.java
Patch:
@@ -40,7 +40,7 @@ public class ConferenceMemberPanel
     public ConferenceMemberPanel(   CallRenderer callRenderer,
                                     ConferenceMember member)
     {
-        super(callRenderer);
+        super(callRenderer, false);
 
         this.member = member;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -874,6 +874,7 @@ private ConnectState connectAndLogin(
                 + connection.isConnected(),
                 new Exception("Trace possible duplicate connections: " +
                     getAccountID().getAccountAddress()));
+            disconnectAndCleanConnection();
         }
 
         connection = new XMPPConnection(confConn);

File: src/net/java/sip/communicator/impl/protocol/jabber/debugger/SmackPacketDebugger.java
Patch:
@@ -102,7 +102,8 @@ public void interceptPacket(Packet packet)
         try
         {
             if(packetLogging.isLoggingEnabled(
-                    PacketLoggingService.ProtocolName.JABBER))
+                    PacketLoggingService.ProtocolName.JABBER)
+                && packet != null && connection.getSocket() != null)
             {
                 packetLogging.logPacket(
                         PacketLoggingService.ProtocolName.JABBER,

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -404,6 +404,9 @@ protected ProtocolProviderService installAccount(
         accountProperties.put(ProtocolProviderFactory.IS_USE_UPNP,
                 String.valueOf(registration.isUseUPNP()));
 
+        accountProperties.put(ProtocolProviderFactory.IS_ALLOW_NON_SECURE,
+            String.valueOf(registration.isAllowNonSecure()));
+
         if (isModification())
         {
             providerFactory.modifyAccount(  protocolProvider,

File: src/net/java/sip/communicator/impl/protocol/jabber/debugger/SmackPacketDebugger.java
Patch:
@@ -136,7 +136,8 @@ public void processPacket(Packet packet)
         try
         {
             if(packetLogging.isLoggingEnabled(
-                    PacketLoggingService.ProtocolName.JABBER))
+                    PacketLoggingService.ProtocolName.JABBER)
+                && packet != null && connection.getSocket() != null)
             {
                 packetLogging.logPacket(
                     PacketLoggingService.ProtocolName.JABBER,

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolIconSipImpl.java
Patch:
@@ -185,6 +185,9 @@ public static byte[] loadIcon(String imagePath)
         {
             InputStream is = resources.getImageInputStreamForPath(imagePath);
 
+            if(is == null)
+                return null;
+
             try
             {
                 icon = new byte[is.available()];

File: src/net/java/sip/communicator/impl/resources/ResourceManagementServiceImpl.java
Patch:
@@ -502,7 +502,7 @@ public InputStream getImageInputStreamForPath(String path)
             }
         }
 
-        if (path != null)
+        if (path != null && imagePack != null)
             return imagePack.getClass().getClassLoader()
                     .getResourceAsStream(path);
 

File: src/net/java/sip/communicator/plugin/defaultresourcepack/DefaultResourcePackActivator.java
Patch:
@@ -71,7 +71,7 @@ public void start(BundleContext bc) throws Exception
             new DefaultSettingsPackImpl();
 
         Hashtable<String, String> setProps = new Hashtable<String, String>();
-        langProps.put(ResourcePack.RESOURCE_NAME,
+        setProps.put(ResourcePack.RESOURCE_NAME,
                       SettingsPack.RESOURCE_NAME_DEFAULT_VALUE);
 
         bundleContext.registerService(  SettingsPack.class.getName(),
@@ -82,7 +82,7 @@ public void start(BundleContext bc) throws Exception
             new DefaultSoundPackImpl();
 
         Hashtable<String, String> sndProps = new Hashtable<String, String>();
-        langProps.put(ResourcePack.RESOURCE_NAME,
+        sndProps.put(ResourcePack.RESOURCE_NAME,
                       SoundPack.RESOURCE_NAME_DEFAULT_VALUE);
 
         bundleContext.registerService(  SoundPack.class.getName(),

File: src/net/java/sip/communicator/impl/ldap/LdapDirectorySettingsImpl.java
Patch:
@@ -436,8 +436,8 @@ public String getGlobalPhonePrefix()
      * Sets the global prefix to be used when calling phones from this ldap
      * source.
      *
-     * @param the global prefix to be used when calling phones from this ldap
-     * source
+     * @param prefix the global prefix to be used when calling phones from this
+     * ldap source
      */
     public void setGlobalPhonePrefix(String prefix)
     {

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandlerSipImpl.java
Patch:
@@ -202,7 +202,8 @@ private Vector<MediaDescription> createMediaDescriptions()
                     {
                         // if we have setting for video preset lets
                         // send info for the desired framerate
-                        if(receiveQualityPreset != null
+                        if(mediaType.equals(MediaType.VIDEO)
+                           && receiveQualityPreset != null
                            && receiveQualityPreset.getFameRate() > 0)
                             md.setAttribute("framerate",
                                 // doing only int frame rate for now

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_A2NLSF.java
Patch:
@@ -241,9 +241,9 @@ static void SKP_Silk_A2NLSF(
                     ffrac += ylo / ( ( ylo - yhi ) >> ( 8 - BIN_DIV_STEPS_A2NLSF_FIX ) );
                 }
                 if(OVERSAMPLE_COSINE_TABLE!=0)
-                    NLSF[ root_ix ] = (int)Math.min( ( (int)k << 7 ) + ffrac, Silk_typedef.SKP_int16_MAX ); 
+                    NLSF[ root_ix ] = Math.min( ( k << 7 ) + ffrac, Silk_typedef.SKP_int16_MAX ); 
                 else
-                    NLSF[ root_ix ] = (int)Math.min( ( (int)k << 8 ) + ffrac, Silk_typedef.SKP_int16_MAX ); 
+                    NLSF[ root_ix ] = Math.min( ( k << 8 ) + ffrac, Silk_typedef.SKP_int16_MAX ); 
 
                 assert( NLSF[ root_ix ] >=     0 );
                 assert( NLSF[ root_ix ] <= 32767 );

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_CNG.java
Patch:
@@ -48,7 +48,7 @@ static void SKP_Silk_CNG_exc(
         
         for( i = 0; i < length; i++ ) {
             seed = Silk_SigProc_FIX.SKP_RAND( seed );
-            idx = ( int )( ( seed >> 24 ) & exc_mask );
+            idx = ( ( seed >> 24 ) & exc_mask );
             Silk_typedef.SKP_assert( idx >= 0 );
             Silk_typedef.SKP_assert( idx <= Silk_define.CNG_BUF_MASK_MAX );
             residual[ residual_offset+i ] = ( short )Silk_SigProc_FIX.SKP_SAT16( Silk_SigProc_FIX.SKP_RSHIFT_ROUND( Silk_macros.SKP_SMULWW( exc_buf_Q10[ idx ], Gain_Q16 ), 10 ) );
@@ -146,7 +146,7 @@ static void SKP_Silk_CNG(
             /* Convert CNG NLSF to filter representation */
             Silk_NLSF2A_stable.SKP_Silk_NLSF2A_stable( LPC_buf, psCNG.CNG_smth_NLSF_Q15, psDec.LPC_order );
 
-            Gain_Q26 = ( int )1 << 26; /* 1.0 */
+            Gain_Q26 = 1 << 26; /* 1.0 */
             
             /* Generate CNG signal, by synthesis filtering */
             if( psDec.LPC_order == 16 ) {

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_LPC_inv_pred_gain.java
Patch:
@@ -42,7 +42,7 @@ public class Silk_LPC_inv_pred_gain
         Anew_QA = Atmp_QA[ order & 1 ];
         /* Increase Q domain of the AR coefficients */
         for( k = 0; k < order; k++ ) {
-            Anew_QA[ k ] = ( (int)A_Q12[ k ] << (QA - 12) );
+            Anew_QA[ k ] = ( A_Q12[ k ] << (QA - 12) );
         }
 
         invGain_Q30[0] = ( 1 << 30 );
@@ -127,7 +127,7 @@ static int SKP_Silk_LPC_inverse_pred_gain_Q13(   /* O:   Returns 1 if unstable,
         Anew_QA = Atmp_QA[ order & 1 ];
         /* Increase Q domain of the AR coefficients */
         for( k = 0; k < order; k++ ) {
-            Anew_QA[ k ] = ( (int)A_Q13[ k ] <<( QA - 13 ));
+            Anew_QA[ k ] = ( A_Q13[ k ] <<( QA - 13 ));
         }
 
         invGain_Q30[0] = ( 1 << 30 );

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_LPC_stabilize.java
Patch:
@@ -9,7 +9,7 @@
 public class Silk_LPC_stabilize
 {
 
-    static final int LPC_STABILIZE_LPC_MAX_ABS_VALUE_Q16 =( ( (int)Short.MAX_VALUE ) << 4 );
+    static final int LPC_STABILIZE_LPC_MAX_ABS_VALUE_Q16 =( ( Short.MAX_VALUE ) << 4 );
 
     /**
      * LPC stabilizer, for a single input data vector.

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_LTP_scale_ctrl_FLP.java
Patch:
@@ -48,7 +48,7 @@ static void SKP_Silk_LTP_scale_ctrl_FLP(
         psEncCtrl.sCmn.LTP_scaleIndex = 0;
 
         /* Round the loss measure to whole pct */
-        round_loss = ( int )( psEnc.sCmn.PacketLoss_perc );
+        round_loss = ( psEnc.sCmn.PacketLoss_perc );
         round_loss = ( 0 > round_loss ? 0 : round_loss);
 
 
@@ -72,7 +72,7 @@ static void SKP_Silk_LTP_scale_ctrl_FLP(
                 psEncCtrl.sCmn.LTP_scaleIndex = 1;
             }
         }
-        psEncCtrl.LTP_scale = ( float)Silk_tables_other.SKP_Silk_LTPScales_table_Q14[ psEncCtrl.sCmn.LTP_scaleIndex ] / 16384.0f;
+        psEncCtrl.LTP_scale = Silk_tables_other.SKP_Silk_LTPScales_table_Q14[ psEncCtrl.sCmn.LTP_scaleIndex ] / 16384.0f;
 
     }
 }

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_MA.java
Patch:
@@ -185,7 +185,7 @@ static void SKP_Silk_LPC_analysis_filter(
             out32_Q12 = Silk_macros.SKP_SMLABB( out32_Q12, SB, B[ Order - 1 ] );
 
             /* Subtract prediction */
-            out32_Q12 = Silk_macros.SKP_SUB_SAT32( ( (int)in[ in_offset + k ] << 12 ), out32_Q12 );
+            out32_Q12 = Silk_macros.SKP_SUB_SAT32( ( in[ in_offset + k ] << 12 ), out32_Q12 );
 
             /* Scale to Q0 */
             out32 = Silk_SigProc_FIX.SKP_RSHIFT_ROUND( out32_Q12, 12 );

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_NLSF_MSVQ_decode.java
Patch:
@@ -42,7 +42,7 @@ static void SKP_Silk_NLSF_MSVQ_decode(
         
         /* Initialize with the codebook vector from stage 0 */
         for( i = 0; i < LPC_order; i++ ) {
-            pNLSF_Q15[ i ] = ( int )pCB_element[ pCB_element_offset + i ];
+            pNLSF_Q15[ i ] = pCB_element[ pCB_element_offset + i ];
         }
               
         for( s = 1; s < psNLSF_CB.nStages; s++ ) {

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_NLSF_stabilize.java
Patch:
@@ -99,7 +99,7 @@ static void SKP_Silk_NLSF_stabilize(
                 max_center_Q15 -= ( NDeltaMin_Q15[I] - ( NDeltaMin_Q15[I] >> 1 ) );
 
                 /* Move apart, sorted by value, keeping the same center frequency */
-                center_freq_Q15 = Silk_SigProc_FIX.SKP_LIMIT_32( Silk_SigProc_FIX.SKP_RSHIFT_ROUND( (int)NLSF_Q15[ NLSF_Q15_offset + I-1] + (int)NLSF_Q15[ NLSF_Q15_offset + I], 1 ),
+                center_freq_Q15 = Silk_SigProc_FIX.SKP_LIMIT_32( Silk_SigProc_FIX.SKP_RSHIFT_ROUND( NLSF_Q15[ NLSF_Q15_offset + I-1] + NLSF_Q15[ NLSF_Q15_offset + I], 1 ),
                         min_center_Q15, max_center_Q15 );
                 NLSF_Q15[ NLSF_Q15_offset + I-1] = center_freq_Q15 - ( NDeltaMin_Q15[I] >> 1 );
                 NLSF_Q15[ NLSF_Q15_offset + I] = NLSF_Q15[ NLSF_Q15_offset + I-1] + NDeltaMin_Q15[I];

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_NSQ.java
Patch:
@@ -103,7 +103,7 @@ static void SKP_Silk_NSQ(
             /* Noise shape parameters */
             assert( HarmShapeGain_Q14[ k ] >= 0 );
             HarmShapeFIRPacked_Q14  = ( HarmShapeGain_Q14[ k ] >> 2 );
-            HarmShapeFIRPacked_Q14 |= ( (int)( HarmShapeGain_Q14[ k ] >> 1 ) << 16 );
+            HarmShapeFIRPacked_Q14 |= ( ( HarmShapeGain_Q14[ k ] >> 1 ) << 16 );
 
 
             if( psEncCtrlC.sigtype == Silk_define.SIG_TYPE_VOICED ) {

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_NSQ_del_dec.java
Patch:
@@ -243,7 +243,7 @@ static void SKP_Silk_NSQ_del_dec(
             /* Noise shape parameters */
             assert( HarmShapeGain_Q14[ k ] >= 0 );
             HarmShapeFIRPacked_Q14  =                        ( HarmShapeGain_Q14[ k ] >> 2 );
-            HarmShapeFIRPacked_Q14 |= ( ( int )( HarmShapeGain_Q14[ k ] >> 1 ) << 16 );
+            HarmShapeFIRPacked_Q14 |= ( ( HarmShapeGain_Q14[ k ] >> 1 ) << 16 );
 
             SKP_Silk_nsq_del_dec_scale_states( NSQ, psDelDec, x_tmp, x_tmp_offset, x_sc_Q10, 
                 subfr_length, sLTP, sLTP_Q16, k, psEncC.nStatesDelayedDecision, smpl_buf_idx,

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_SigProc_FLP.java
Patch:
@@ -88,13 +88,13 @@ static int SKP_float2int(double x)
         int k;
         for (k = length-1; k >= 0; k--)
         {
-            out[out_offset+k] = (float)in[in_offset+k];
+            out[out_offset+k] = in[in_offset+k];
         }
     }
 
 //TODO:    #define SKP_round(x)        (SKP_float)((x)>=0 ? (SKP_int64)((x)+0.5) : (SKP_int64)((x)-0.5))
     static float SKP_round(float x)
     {
-        return (float)((x)>=0 ? (long)(x+0.5) : (long)(x-0.5));
+        return ((x)>=0 ? (long)(x+0.5) : (long)(x-0.5));
     }
 }

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_ana_filt_bank_1.java
Patch:
@@ -53,7 +53,7 @@ public class Silk_ana_filt_bank_1
         for( k = 0; k < N2; k++ ) 
         {
             /* Convert to Q10 */
-            in32 = (int)in[ in_offset + 2 * k ] << 10;
+            in32 = in[ in_offset + 2 * k ] << 10;
 
             /* All-pass section for even input sample */
             Y      = in32 - S[ S_offset + 0 ];
@@ -62,7 +62,7 @@ public class Silk_ana_filt_bank_1
             S[ S_offset + 0 ] = in32 + X;
 
             /* Convert to Q10 */
-            in32 = (int)in[ in_offset + 2 * k + 1 ] << 10;
+            in32 = in[ in_offset + 2 * k + 1 ] << 10;
 
             /* All-pass section for odd input sample, and add to output of previous section */
             Y      = in32 - S[ S_offset + 1 ];

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_decode_parameters.java
Patch:
@@ -225,7 +225,7 @@ static void SKP_Silk_decode_parameters(
         /***************/
         Silk_range_coder.SKP_Silk_range_decoder( Ix_ptr, 0, psRC, Silk_tables_other.SKP_Silk_Seed_CDF, 0, Silk_tables_other.SKP_Silk_Seed_offset );
         Ix = Ix_ptr[0];
-        psDecCtrl.Seed = ( int )Ix;
+        psDecCtrl.Seed = Ix;
         /*********************************************/
         /* Decode quantization indices of excitation */
         /*********************************************/

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_interpolate.java
Patch:
@@ -38,7 +38,7 @@ static void SKP_Silk_interpolate(
 
         for( i = 0; i < d; i++ ) 
         {
-            xi[ i ] = ( int )( ( int )x0[ i ] + ( ( ( int )x1[ i ] - ( int )x0[ i ] ) * ifact_Q2 >> 2 ) );
+            xi[ i ] = ( x0[ i ] + ( ( x1[ i ] - x0[ i ] ) * ifact_Q2 >> 2 ) );
         }
     }
 }

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_lowpass_short.java
Patch:
@@ -39,7 +39,7 @@ static void SKP_Silk_lowpass_short(
         
         state = S[ S_offset + 0 ];
         for( k = 0; k < len; k++ ) {    
-            in_tmp   = ( 768 * (int)in[in_offset + k] );    /* multiply by 0.75, going from Q15 to Q25 */
+            in_tmp   = ( 768 * in[in_offset + k] );    /* multiply by 0.75, going from Q15 to Q25 */
             out_tmp  = state + in_tmp;                      /* zero at nyquist                         */
             state    = in_tmp - ( out_tmp >> 1 );   /* pole                                    */
             out[ out_offset + k ] = out_tmp;

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_noise_shape_analysis_FLP.java
Patch:
@@ -103,7 +103,7 @@ public class Silk_noise_shape_analysis_FLP
             pitch_res_ptr_offset = pitch_res_offset;
             for( k = 0; k < Silk_define.FRAME_LENGTH_MS / 2; k++ ) 
             {
-                nrg = ( float )nSamples + ( float )Silk_energy_FLP.SKP_Silk_energy_FLP( pitch_res_ptr,pitch_res_ptr_offset, nSamples );
+                nrg = nSamples + ( float )Silk_energy_FLP.SKP_Silk_energy_FLP( pitch_res_ptr,pitch_res_ptr_offset, nSamples );
                 log_energy = Silk_main_FLP.SKP_Silk_log2( nrg );
                 if( k > 0 ) 
                 {
@@ -383,7 +383,7 @@ static void LPC_fit_int16(
             assert( false );
             for( i = 0; i < L; i++ ) 
             {
-                a[ i ] = ( float )0.0f;
+                a[ i ] = 0.0f;
             }
         }
     }

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_quant_LTP_gains_FLP.java
Patch:
@@ -116,7 +116,7 @@ static void SKP_Silk_quant_LTP_gains_FLP(
             }
 
             /* Break early in low-complexity mode if rate distortion is below threshold */
-            if( lowComplexity != 0 && ( rate_dist * 16384.0f < (float)Silk_tables_LTP.SKP_Silk_LTP_gain_middle_avg_RD_Q14 ) ) {
+            if( lowComplexity != 0 && ( rate_dist * 16384.0f < Silk_tables_LTP.SKP_Silk_LTP_gain_middle_avg_RD_Q14 ) ) {
                 break;
             }
         }

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_resampler.java
Patch:
@@ -51,7 +51,7 @@ static int gcd(int a, int b)
         int tmp;
         while( b > 0 ) 
         {
-            tmp = a - b * (int)(a/b);
+            tmp = a - b * (a/b);
             a   = b;
             b   = tmp;
         }

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_resampler_down2.java
Patch:
@@ -43,7 +43,7 @@ static void SKP_Silk_resampler_down2(
         /* Internal variables and state are in Q10 format */
         for( k = 0; k < len2; k++ ) {
             /* Convert to Q10 */
-            in32 = (int)in[ in_offset + 2 * k ] << 10;
+            in32 = in[ in_offset + 2 * k ] << 10;
 
             /* All-pass section for even input sample */
             Y      = in32 - S[ S_offset ];
@@ -52,7 +52,7 @@ static void SKP_Silk_resampler_down2(
             S[ S_offset ] = in32 + X;
 
             /* Convert to Q10 */
-            in32 = (int)in[ in_offset + 2 * k + 1 ] << 10;
+            in32 = in[ in_offset + 2 * k + 1 ] << 10;
 
             /* All-pass section for odd input sample, and add to output of previous section */
             Y      = in32 - S[ S_offset+1 ];

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_resampler_private_AR2.java
Patch:
@@ -43,7 +43,7 @@ static void SKP_Silk_resampler_private_AR2(
 
         for( k = 0; k < len; k++ ) 
         {
-            out32       = S[ S_offset ] + ( (int)in[ in_offset+k ] << 8 );
+            out32       = S[ S_offset ] + ( in[ in_offset+k ] << 8 );
             out_Q8[ out_Q8_offset+k ] = out32;
             out32       = out32 << 2;
             S[ S_offset   ]      = Silk_macros.SKP_SMLAWB( S[ S_offset+1 ], out32, A_Q14[ A_Q14_offset ] );

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_resampler_private_ARMA4.java
Patch:
@@ -47,7 +47,7 @@ static void SKP_Silk_resampler_private_ARMA4(
 
         for( k = 0; k < len; k++ )
         {
-            in_Q8  = (int)in[ in_offset+k ] << 8;
+            in_Q8  = in[ in_offset+k ] << 8;
 
             /* Outputs of first and second biquad */
             out1_Q8 = in_Q8 + ( S[ S_offset ] << 2 );

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_resampler_private_down4.java
Patch:
@@ -46,7 +46,7 @@ static void SKP_Silk_resampler_private_down4(
         for( k = 0; k < len4; k++ ) 
         {
             /* Add two input samples and convert to Q10 */
-            in32 = ( (int)in[ in_offset + 4 * k ] + (int)in[ in_offset + 4 * k + 1 ] ) << 9 ;
+            in32 = ( in[ in_offset + 4 * k ] + in[ in_offset + 4 * k + 1 ] ) << 9 ;
 
             /* All-pass section for even input sample */
             Y      = in32 - S[ S_offset ];
@@ -55,7 +55,7 @@ static void SKP_Silk_resampler_private_down4(
             S[ S_offset ] = in32 + X;
 
             /* Add two input samples and convert to Q10 */
-            in32 = ( (int)in[ in_offset + 4 * k + 2 ] + (int)in[ in_offset + 4 * k + 3 ] ) << 9;
+            in32 = ( in[ in_offset + 4 * k + 2 ] + in[ in_offset + 4 * k + 3 ] ) << 9;
 
             /* All-pass section for odd input sample */
             Y      = in32 - S[ S_offset+1 ];

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_resampler_private_up2_HQ.java
Patch:
@@ -48,7 +48,7 @@ static void SKP_Silk_resampler_private_up2_HQ(
         for( k = 0; k < len; k++ ) 
         {
             /* Convert to Q10 */
-            in32 = (int)in[ in_offset+k ] << 10;
+            in32 = in[ in_offset+k ] << 10;
 
             /* First all-pass section for even output sample */
             Y       = in32 - S[ S_offset ];

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_resampler_private_up4.java
Patch:
@@ -47,7 +47,7 @@ static void SKP_Silk_resampler_private_up4(
         for( k = 0; k < len; k++ ) 
         {
             /* Convert to Q10 */
-            in32 = (int)in[ in_offset+k ] << 10;
+            in32 = in[ in_offset+k ] << 10;
 
             /* All-pass section for even output sample */
             Y      = in32 - S[ S_offset + 0 ];

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_resampler_up2.java
Patch:
@@ -43,7 +43,7 @@ static void SKP_Silk_resampler_up2(
         for( k = 0; k < len; k++ ) 
         {
             /* Convert to Q10 */
-            in32 = (int)in[ in_offset+k ] << 10;
+            in32 = in[ in_offset+k ] << 10;
 
             /* All-pass section for even output sample */
             Y      = in32 - S[ S_offset + 0 ];

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_sort.java
Patch:
@@ -227,7 +227,7 @@ static void SKP_Silk_shell_insertion_sort_increasing(
         Silk_typedef.SKP_assert( L >= K );
         
         /* Calculate initial step size */
-        inc_Q16_tmp = ( (int)L << 15 );
+        inc_Q16_tmp = ( L << 15 );
 //        inc = SKP_RSHIFT( inc_Q16_tmp, 16 );
         inc = ( inc_Q16_tmp >> 16 );
 
@@ -292,7 +292,7 @@ static void SKP_Silk_shell_sort_increasing_all_values(
      
         /* Calculate initial step size */
 //        inc_Q16_tmp = SKP_LSHIFT( (int)L, 15 );
-        inc_Q16_tmp = ( (int)L << 15 );
+        inc_Q16_tmp = ( L << 15 );
 //        inc = SKP_RSHIFT( inc_Q16_tmp, 16 );
         inc = ( inc_Q16_tmp >> 16 );
 

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/silk/Silk_sum_sqr_shift.java
Patch:
@@ -58,7 +58,7 @@ static void SKP_Silk_sum_sqr_shift(
 //                nrg = (int)SKP_RSHIFT_uint( (SKP_uint32)nrg, 2 );
 //TODO:                
 //                nrg = (int)( ((long)nrg)&0xFFFFFFFFL >>> 2 );
-                nrg = (int)( (((long)nrg)&0xFFFFFFFFL) >>> 2 );
+                nrg = (int)( ((nrg)&0xFFFFFFFFL) >>> 2 );
                 shft = 2;
                 break;
             }
@@ -75,7 +75,7 @@ static void SKP_Silk_sum_sqr_shift(
 
             if( nrg < 0 ) {
                 /* Scale down */
-                nrg = (int)( nrg >>> 2 );
+                nrg = ( nrg >>> 2 );
                 shft += 2;
             }
         }

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberAccountID.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.plugin.jabberaccregwizz.*;
 import net.java.sip.communicator.service.credentialsstorage.*;
 import net.java.sip.communicator.service.protocol.*;
 

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolProviderServiceMsnImpl.java
Patch:
@@ -265,7 +265,8 @@ void unregister(boolean fireEvent)
             typingNotifications.setMessenger(null);
         }
 
-        if(fireEvent)
+        // if messenger is null we have already fired unregister
+        if(fireEvent && messenger != null)
             fireRegistrationStateChanged(
                 currRegState,
                 RegistrationState.UNREGISTERED,

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationForm.java
Patch:
@@ -406,7 +406,7 @@ public void loadAccount(AccountID accountID)
             accountProperties.get(ProtocolProviderFactory.IS_USE_GOOGLE_ICE);
         boolean isUseGoogleIce = Boolean.parseBoolean(
                 (useGoogleIce != null && useGoogleIce.length() != 0) ?
-                    useGoogleIce : "false");
+                    useGoogleIce : "true");
 
         iceConfigPanel.setUseGoogleIce(isUseGoogleIce);
 

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -289,7 +289,7 @@ public abstract class ProtocolProviderFactory
     /**
      * Indicates if Google ICE should be used.
      */
-    public static final String IS_USE_GOOGLE_ICE = "GOOGLE_ICE_ENABLED";
+    public static final String IS_USE_GOOGLE_ICE = "GTALK_ICE_ENABLED";
 
     /**
      * Indicates if STUN server should be automatically discovered.

File: src/net/java/sip/communicator/util/NetworkUtils.java
Patch:
@@ -1139,7 +1139,7 @@ private static class NetworkListener
          */
         public void configurationChanged(ChangeEvent event)
         {
-            if(event.getType() == ChangeEvent.IFACE_UP)
+            if(event.getType() == ChangeEvent.IFACE_UP && !event.isInitial())
             {
                 reloadDnsResolverConfig();
             }

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -2153,7 +2153,7 @@ public boolean isGTalkTesting()
                 , false) ||
                 accountID.getAccountPropertyBoolean(
                     ProtocolProviderFactory.IS_USE_GOOGLE_ICE,
-                    false));
+                    true));
     }
 
     UserCredentials getUserCredentials()

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/IceConfigPanel.java
Patch:
@@ -120,7 +120,7 @@ public IceConfigPanel()
         autoDiscoverBox.setSelected(true);
         defaultStunBox.setSelected(true);
 
-        googleIceBox.setSelected(false);
+        googleIceBox.setSelected(true);
 
         jnBox.setSelected(true);
         jnAutoDiscoverBox.setSelected(true);

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -656,7 +656,7 @@ public void enableButtons(boolean enable)
 
         if (!isLastConference)
         {
-            // Buttons would be enabled once the call has entered in state
+            // Buttsons would be enabled once the call has entered in state
             // connected.
             ProtocolProviderService protocolProvider
                 = call.getProtocolProvider();
@@ -681,6 +681,7 @@ public void enableButtons(boolean enable)
             {
                 videoButton.setEnabled(enable);
                 fullScreenButton.setEnabled(enable);
+                desktopSharingButton.setEnabled(enable);
             }
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/call/SelectScreenDialog.java
Patch:
@@ -134,6 +134,7 @@ public void actionPerformed(ActionEvent e)
         {
             public void actionPerformed(ActionEvent e)
             {
+                selectedDevice = null;
                 dispose();
             }
         });

File: src/net/java/sip/communicator/impl/gui/main/call/CallPeerAdapter.java
Patch:
@@ -133,7 +133,7 @@ else if (newState == CallPeerState.CONNECTED)
                     renderer.getCallPanel().startCallTimer();
 
                 // Enabling all buttons when the call is connected.
-                renderer.getCallPanel().enableButtons();
+                renderer.getCallPanel().enableButtons(true);
             }
             else
             {

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -1037,6 +1037,9 @@ private void handleLocalVideoStreamingChange(
             if (videoTelephony == null)
                 return;
 
+            if (callPeer == null || callPeer.getCall() == null)
+                return;
+
             if (videoTelephony.isLocalVideoStreaming(callPeer.getCall()))
             {
                 try

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceCallPanel.java
Patch:
@@ -105,6 +105,7 @@ public ConferenceCallPanel(CallPanel callPanel, Call c)
         this.addLocalCallPeer();
 
         Iterator<? extends CallPeer> iterator = this.call.getCallPeers();
+
         while (iterator.hasNext())
         {
             this.addCallPeerPanel(iterator.next());

File: src/net/java/sip/communicator/plugin/spellcheck/CheckerToggleButton.java
Patch:
@@ -80,10 +80,8 @@ public void setCurrentContactGroup(MetaContactGroup metaGroup)
 
     }
 
-    @Override
     public void setCurrentContact(Contact contact)
     {
-        // TODO Auto-generated method stub
 
     }
 }

File: src/net/java/sip/communicator/plugin/provisioning/ProvisioningForm.java
Patch:
@@ -338,6 +338,7 @@ public void stateChanged(ChangeEvent e)
                 dhcpButton.setEnabled(isSelected);
                 bonjourButton.setEnabled(isSelected);
                 manualButton.setEnabled(isSelected);
+                forgetPasswordButton.setEnabled(isSelected);
 
                 String provisioningMethod = null;
 

File: src/net/java/sip/communicator/impl/certificate/CertificateServiceImpl.java
Patch:
@@ -133,7 +133,7 @@ private void setTrustStore()
             System.setProperty("javax.net.ssl.trustStoreType",
                 trustStore);
             String password =
-                (String) credService.loadPassword(PNAME_TRUSTSTORE_PASSWORD);
+                credService.loadPassword(PNAME_TRUSTSTORE_PASSWORD);
             if(password != null)
             {
                 System.setProperty("javax.net.ssl.trustStorePassword",

File: src/net/java/sip/communicator/plugin/reconnectplugin/ReconnectPluginActivator.java
Patch:
@@ -113,12 +113,12 @@ public class ReconnectPluginActivator
     /**
      * Start of the delay interval when starting a reconnect.
      */
-    private static final int RECONNECT_DELAY_MIN = 8; // sec
+    private static final int RECONNECT_DELAY_MIN = 2; // sec
 
     /**
      * The end of the interval for the initial reconnect.
      */
-    private static final int RECONNECT_DELAY_MAX = 15; // sec
+    private static final int RECONNECT_DELAY_MAX = 5; // sec
 
     /**
      * Max value for growing the reconnect delay, all subsequent reconnects

File: src/net/java/sip/communicator/plugin/securityconfig/masterpassword/SavedPasswordsDialog.java
Patch:
@@ -16,7 +16,6 @@
 import javax.swing.event.*;
 import javax.swing.table.*;
 
-import com.sun.xml.internal.stream.*;
 import net.java.sip.communicator.plugin.securityconfig.*;
 import net.java.sip.communicator.service.configuration.*;
 import net.java.sip.communicator.service.credentialsstorage.*;

File: src/net/java/sip/communicator/impl/googlecontacts/configform/GoogleContactsConfigForm.java
Patch:
@@ -225,8 +225,9 @@ public void actionPerformed(ActionEvent e)
 
             if(ret == 1)
             {
-                GoogleContactsConnection cnx = settingsForm.getConnection();
-                tableModel.addAccount(cnx, true);
+                GoogleContactsConnectionImpl cnx
+                    = (GoogleContactsConnectionImpl) settingsForm.getConnection();
+                tableModel.addAccount(cnx, true, cnx.getPrefix());
                 new RefreshContactSourceThread(null, cnx).start();
                 GoogleContactsActivator.getGoogleContactsService().saveConfig(
                         cnx);

File: src/net/java/sip/communicator/plugin/ldap/LdapActivator.java
Patch:
@@ -56,7 +56,7 @@ public void start(BundleContext bundleContext)
         Dictionary<String, String> properties =
             new Hashtable<String, String>();
         properties.put( ConfigurationForm.FORM_TYPE,
-                        ConfigurationForm.ADVANCED_TYPE);
+                        ConfigurationForm.CONTACT_SOURCE_TYPE);
 
         bundleContext.registerService(
             ConfigurationForm.class.getName(),
@@ -65,7 +65,7 @@ public void start(BundleContext bundleContext)
                 getClass().getClassLoader(),
                 "impl.ldap.PLUGIN_ICON",
                 "impl.ldap.CONFIG_FORM_TITLE",
-                2000, true),
+                2000, false),
             properties);
     }
 

File: src/net/java/sip/communicator/impl/neomedia/VideoMediaStreamImpl.java
Patch:
@@ -633,7 +633,8 @@ else if(key.equals("imageattr"))
                     {
                         outputSize = res[1];
 
-                        qualityControl.setRemoteSendMaxPreset(new QualityPreset(res[0]));
+                        qualityControl.setRemoteSendMaxPreset(
+                            new QualityPreset(res[0]));
                         qualityControl.setRemoteReceiveResolution(outputSize);
                         ((VideoMediaDeviceSession)getDeviceSession()).
                             setOutputSize(outputSize);

File: src/net/java/sip/communicator/service/protocol/media/CallPeerMediaHandler.java
Patch:
@@ -1379,7 +1379,7 @@ private void registerAudioLevelListeners(AudioMediaStream audioStream)
     private void registerDynamicPTsWithStream(MediaStream stream)
     {
         for (Map.Entry<MediaFormat, Byte> mapEntry
-                : dynamicPayloadTypes.getMappings().entrySet())
+                : getDynamicPayloadTypes().getMappings().entrySet())
         {
             byte pt = mapEntry.getValue();
             MediaFormat fmt = mapEntry.getKey();

File: src/net/java/sip/communicator/impl/neomedia/ZrtpControlImpl.java
Patch:
@@ -10,7 +10,6 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.impl.neomedia.transform.*;
 import net.java.sip.communicator.impl.neomedia.transform.zrtp.*;
 import net.java.sip.communicator.service.neomedia.*;
 import net.java.sip.communicator.service.neomedia.event.*;

File: src/net/java/sip/communicator/impl/neomedia/directshow/DSCaptureDevice.java
Patch:
@@ -36,9 +36,7 @@ public DSCaptureDevice(long ptr)
     {
         /* do not allow 0 pointer value */
         if(ptr == 0)
-        {
             throw new IllegalArgumentException("invalid ptr value (0)");
-        }
 
         this.ptr = ptr;
     }

File: src/net/java/sip/communicator/impl/neomedia/directshow/DSManager.java
Patch:
@@ -38,8 +38,8 @@ public class DSManager
     }
 
     /**
-     * Empty array of <tt>DSCaptureDevice</tt>s. Explicitely defined
-     * in order to avoid unnecessary allocations.
+     * Empty array of <tt>DSCaptureDevice</tt>s. Explicitly defined in order to
+     * avoid unnecessary allocations.
      */
     private static DSCaptureDevice[] EMPTY_DEVICES = new DSCaptureDevice[0];
 

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatSession.java
Patch:
@@ -205,7 +205,7 @@ public Collection<Object> getHistoryBeforeDate(Date date, int count)
             chatHistoryFilter,
             chatRoomWrapper.getChatRoom(),
             date,
-            ConfigurationManager.getChatHistorySize());
+            count);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/ServerStoredContactListSipImpl.java
Patch:
@@ -1099,7 +1099,8 @@ private RuleType getRule(SubHandlingType type)
 
         for (RuleType rule : presRules.getRules())
         {
-            if (rule.getActions().getSubHandling().equals(type))
+            SubHandlingType currType = rule.getActions().getSubHandling();
+            if (currType != null && currType.equals(type))
             {
                 return rule;
             }

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/Resources.java
Patch:
@@ -85,7 +85,8 @@ public static byte[] getImage(ImageID imageID)
      */
     public static InputStream getPropertyInputStream(String key)
     {
-        return getResources().getSettingsInputStream(key);
+        return getResources().getSettingsInputStream(key,
+                                        JabberAccRegWizzActivator.class);
     }
 
     public static ResourceManagementService getResources()

File: src/net/java/sip/communicator/impl/neomedia/MediaStreamImpl.java
Patch:
@@ -1134,12 +1134,11 @@ private void restartZrtpControl()
         AbstractRTPConnector rtpConnector = getRTPConnector();
 
         zrtpControl.setConnector(rtpConnector);
-
         if(rtpConnector instanceof RTPTransformUDPConnector)
             ((RTPTransformUDPConnector)rtpConnector)
                 .setEngine(createTransformEngineChain());
-        else if(rtpConnector instanceof RTPTransformUDPConnector)
-            ((RTPTransformUDPConnector)rtpConnector)
+        else if(rtpConnector instanceof RTPTransformTCPConnector)
+            ((RTPTransformTCPConnector)rtpConnector)
                 .setEngine(createTransformEngineChain());
 
         zrtpRestarted = true;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -176,7 +176,7 @@ public void messageDelivered(ChatRoomMessageDeliveredEvent evt)
             Message msg = evt.getMessage();
 
             chatPanel.addMessage(
-                sourceChatRoom.getParentProvider().getAccountID().getUserID(),
+                sourceChatRoom.getUserNickname(),
                 evt.getTimestamp(),
                 messageType,
                 msg.getContent(),
@@ -247,8 +247,6 @@ public void messageReceived(ChatRoomMessageReceivedEvent evt)
             messageContent,
             message.getContentType());
 
-        chatWindowManager.openChat(chatPanel, false);
-
         // Fire notification
         boolean fireChatNotification;
 
@@ -287,6 +285,8 @@ public void messageReceived(ChatRoomMessageReceivedEvent evt)
                 title,
                 messageContent);
         }
+
+        chatWindowManager.openChat(chatPanel, false);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCallPeer.java
Patch:
@@ -649,7 +649,7 @@ public void removeConferenceMembersSoundLevelListener(
     }
 
     /**
-     * Implements {@link CsrcAudioLevelListener#audioLevelsReceived(long[][])}
+     * Implements {@link CsrcAudioLevelListener#audioLevelsReceived(long[])}
      * so that we could deliver to {@link ConferenceMembersSoundLevelListener}s
      * the events corresponding to the audio level changes that are being
      * reported here.

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetContactCapabilitiesJabberImpl.java
Patch:
@@ -477,7 +477,8 @@ public void contactPresenceStatusChanged(
         ContactPresenceStatusChangeEvent evt)
     {
         // If the user goes offline we ensure to remove the caps node.
-        if (evt.getNewStatus().getStatus() < PresenceStatus.ONLINE_THRESHOLD)
+        if (capsManager != null
+            && evt.getNewStatus().getStatus() < PresenceStatus.ONLINE_THRESHOLD)
             capsManager.removeUserCapsNode(evt.getSourceContact().getAddress());
     }
 }

File: src/net/java/sip/communicator/util/NetworkUtils.java
Patch:
@@ -750,7 +750,7 @@ private static String getProtocolFromNAPTRRecords(String service)
             return "UDP";
         else if(service.equalsIgnoreCase("SIP+D2T"))
             return "TCP";
-        else if(service.equalsIgnoreCase("SIP+D2TS"))
+        else if(service.equalsIgnoreCase("SIPS+D2T"))
             return "TLS";
         else
             return null;

File: src/net/java/sip/communicator/impl/protocol/jabber/IceUdpTransportManager.java
Patch:
@@ -118,6 +118,9 @@ private Agent createIceAgent()
                 = JabberActivator.getProtocolProviderFactory().loadPassword(
                         accID);
 
+            if(provider.getUserCredentials() != null)
+                password = provider.getUserCredentials().getPasswordAsString();
+
             // ask for password if not saved
             if (password == null)
             {

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetVideoTelephonyJabberImpl.java
Patch:
@@ -127,12 +127,12 @@ protected Call createOutgoingVideoCall(String calleeAddress)
                     , OperationFailedException.INTERNAL_ERROR);
         }
 
-        MediaAwareCall<?, ?, ?> call = new CallJabberImpl(basicTelephony);
+        CallJabberImpl call = new CallJabberImpl(basicTelephony);
 
         /* enable video */
         call.setLocalVideoAllowed(true, getMediaUseCase());
         CallPeer callPeer =
-            basicTelephony.createOutgoingCall((CallJabberImpl)call, calleeAddress);
+            basicTelephony.createOutgoingCall(call, calleeAddress);
 
         // if call is a Google Talk ones, return the CallGTalkImpl
 

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccRegWizzActivator.java
Patch:
@@ -9,8 +9,6 @@
 
 import org.osgi.framework.*;
 
-import sun.reflect.ReflectionFactory.*;
-
 import net.java.sip.communicator.service.browserlauncher.*;
 import net.java.sip.communicator.service.configuration.*;
 import net.java.sip.communicator.service.gui.*;

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -10,7 +10,6 @@
 
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.resources.ImageID;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFieldUI.java
Patch:
@@ -8,15 +8,12 @@
 
 import java.awt.*;
 import java.awt.event.*;
-import java.util.List;
 
 import javax.swing.*;
 import javax.swing.text.*;
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.main.call.*;
-import net.java.sip.communicator.impl.gui.utils.*;
-import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.skin.*;
 import net.java.sip.communicator.util.swing.*;

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigurationPanel.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.event.*;
 
 import net.java.sip.communicator.plugin.generalconfig.autoaway.*;
-import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.systray.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;

File: src/net/java/sip/communicator/plugin/sip2sipaccregwizz/CreateSip2SipAccountForm.java
Patch:
@@ -16,8 +16,7 @@
 
 import org.json.*;
 
-import net.java.sip.communicator.plugin.ippiaccregwizz.CreateIppiAccountForm;
-import net.java.sip.communicator.plugin.ippiaccregwizz.IppiAccRegWizzActivator;
+import net.java.sip.communicator.plugin.ippiaccregwizz.*;
 import net.java.sip.communicator.plugin.sipaccregwizz.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -511,6 +511,8 @@ else if(serverAddress == null &&
             accountProperties.put(
                     ProtocolProviderFactory.VOICEMAIL_URI,
                     registration.getVoicemailURI());
+        else if(isModification())
+            accountProperties.put(ProtocolProviderFactory.VOICEMAIL_URI, "");
 
         if(isModification())
         {

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceCallPanel.java
Patch:
@@ -138,9 +138,9 @@ private void addLocalCallPeer()
 
         call.addLocalUserSoundLevelListener(new SoundLevelListener()
         {
-            public void soundLevelChanged(SoundLevelChangeEvent evt)
+            public void soundLevelChanged(Object source, int level)
             {
-                localPeerPanel.fireLocalUserSoundLevelChanged(evt.getLevel());
+                localPeerPanel.fireLocalUserSoundLevelChanged(level);
             }
         });
 

File: src/net/java/sip/communicator/impl/neomedia/AudioMediaStreamImpl.java
Patch:
@@ -373,10 +373,10 @@ public int getLastMeasuredAudioLevel(long ssrc)
      * method is meant for use primarily by the transform engine handling
      * incoming RTP packets (currently <tt>CsrcTransformEngine</tt>).
      *
-     * @param audioLevels a bi-dimensional array mapping CSRC IDs to audio
-     * levels.
+     * @param audioLevels a array mapping CSRC IDs to audio levels in
+     * consecutive elements.
      */
-    public void fireConferenceAudioLevelEvent(final long[][] audioLevels)
+    public void fireConferenceAudioLevelEvent(final long[] audioLevels)
     {
         CsrcAudioLevelListener csrcAudioLevelListener
             = this.csrcAudioLevelListener;

File: src/net/java/sip/communicator/service/neomedia/event/CsrcAudioLevelListener.java
Patch:
@@ -23,8 +23,8 @@ public interface CsrcAudioLevelListener
      * taking part in a conference call.
      *
      * @param audioLevels the new set of levels for the various contributing
-     * sources in the conference call.
+     * sources in the conference call
      */
-    public void audioLevelsReceived(final long[][] audioLevels);
+    public void audioLevelsReceived(final long[] audioLevels);
 
 }

File: src/net/java/sip/communicator/impl/neomedia/MediaUtils.java
Patch:
@@ -177,7 +177,7 @@ public class MediaUtils
             = new HashMap<String, String>();
         String packetizationMode = "packetization-mode";
         Map<String, String> h264AdvancedAttributes
-        = new HashMap<String, String>();
+            = new HashMap<String, String>();
 
         h264FormatParams.put(packetizationMode, "1");
         /*
@@ -192,7 +192,6 @@ public class MediaUtils
 
         h264AdvancedAttributes.put("imageattr", createImageAttr(null, res));
 
-        /* XXX temporary disable packetization mode 1 due to some problems
         // packetization-mode=1
         addMediaFormats(
             MediaFormat.RTP_PAYLOAD_TYPE_UNKNOWN,
@@ -201,7 +200,6 @@ public class MediaUtils
             Constants.H264_RTP,
             h264FormatParams,
             h264AdvancedAttributes);
-        */
         // packetization-mode=0
         /*
          * XXX At the time of this writing,

File: src/net/java/sip/communicator/impl/neomedia/format/MediaFormatImpl.java
Patch:
@@ -113,15 +113,16 @@ public static MediaFormatImpl<? extends Format> createInstance(
                         formatParameters,
                         advancedAttrs);
         }
-        if (format instanceof VideoFormat)
+        else if (format instanceof VideoFormat)
             return
                 new VideoMediaFormatImpl(
                         (VideoFormat) format,
                         clockRate,
                         -1,
                         formatParameters,
                         advancedAttrs);
-        return null;
+        else
+            return null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -689,7 +689,7 @@ public void metaContactAdded(MetaContactEvent evt)
                     if (evt.getSourceMetaContact().getContact(
                             contactAddress, protocolProvider) != null)
                     {
-                        renameContact(metaContact, displayName);
+                        renameContact(evt.getSourceMetaContact(), displayName);
                     }
                 }
 

File: src/net/java/sip/communicator/impl/protocol/sip/ClientCapabilities.java
Patch:
@@ -384,7 +384,9 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
 
                 if (logger.isTraceEnabled())
                     logger.trace("Keep alive method " + keepAliveMethod);
-                if(keepAliveMethod == null ||
+                // options is default keep-alive, if property is missing
+                // then options is used
+                if(keepAliveMethod != null &&
                     !keepAliveMethod.equalsIgnoreCase("options"))
                     return;
 

File: src/net/java/sip/communicator/impl/protocol/sip/SipRegistrarConnection.java
Patch:
@@ -476,8 +476,7 @@ public void processOK(ClientTransaction clientTransatcion,
                     KEEP_ALIVE_METHOD);
 
             if((keepAliveMethod != null &&
-                keepAliveMethod.equalsIgnoreCase("register"))
-                || keepAliveMethod == null )
+                keepAliveMethod.equalsIgnoreCase("register")))
             {
                 int registrationInterval =
                     sipProvider.getAccountID().getAccountPropertyInt(

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistration.java
Patch:
@@ -22,7 +22,7 @@ public class SIPAccountRegistration
 
     public static String DEFAULT_SUBSCRIBE_EXPIRES = "3600";
 
-    private String defaultKeepAliveMethod = "REGISTER";
+    private String defaultKeepAliveMethod = "OPTIONS";
 
     public static String DEFAULT_KEEP_ALIVE_INTERVAL = "25";
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -638,7 +638,8 @@ else if(mode.equals(Presence.Mode.away))
         {
             // on the phone a special status
             // which is away with custom status message
-            if(presence.getStatus().contains(JabberStatusEnum.ON_THE_PHONE))
+            if(presence.getStatus() != null
+                && presence.getStatus().contains(JabberStatusEnum.ON_THE_PHONE))
                 return jabberStatusEnum.getStatus(JabberStatusEnum.ON_THE_PHONE);
             else
                 return jabberStatusEnum.getStatus(JabberStatusEnum.AWAY);

File: src/net/java/sip/communicator/service/protocol/jabberconstants/JabberStatusEnum.java
Patch:
@@ -58,7 +58,7 @@ public class JabberStatusEnum
      * On The Phone Chat status.
      * Indicates that the user is talking to the phone.
      */
-    public static final String ON_THE_PHONE = "On The Phone";
+    public static final String ON_THE_PHONE = "On the phone";
 
     /**
      * The Free For Chat status. Indicates that the user is eager to

File: src/net/java/sip/communicator/plugin/provisioning/ProvisioningActivator.java
Patch:
@@ -161,8 +161,7 @@ public void start(BundleContext bundleContext) throws Exception
                 2000, true),
             properties);
 
-        String method = getConfigurationService().getString(
-                PROVISIONING_METHOD_PROP);
+        String method = getProvisioningMethod();
 
         if(method == null || method.equals("NONE"))
         {

File: src/net/java/sip/communicator/plugin/provisioning/ProvisioningActivator.java
Patch:
@@ -195,8 +195,7 @@ public void start(BundleContext bundleContext) throws Exception
         if(url == null)
         {
             /* try to see if provisioning URL is stored in properties */
-            url = getConfigurationService().getString(
-                    PROPERTY_PROVISIONING_URL);
+            url = getProvisioningUri();
         }
 
         if(url != null)

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1346,8 +1346,8 @@ public ContactHeader getContactHeader(SipURI intendedDestination)
 
             //if we are using tcp, make sure that we include the port of the
             //socket that we are actually using and not that of LP
-            if (ListeningPoint.TCP.equalsIgnoreCase(transport))
-                //|| ListeningPoint.TLS.equalsIgnoreCase(transport))
+            if (ListeningPoint.TCP.equalsIgnoreCase(transport)
+                || ListeningPoint.TLS.equalsIgnoreCase(transport))
             {
                 InetSocketAddress localSockAddr
                     = sipStackSharing.getLocalAddressForDestination(

File: src/net/java/sip/communicator/impl/neomedia/VideoMediaStreamImpl.java
Patch:
@@ -20,6 +20,7 @@
 import net.java.sip.communicator.impl.neomedia.transform.*;
 import net.java.sip.communicator.service.neomedia.*;
 import net.java.sip.communicator.service.neomedia.QualityControl; // disambiguation
+import net.java.sip.communicator.service.neomedia.control.*;
 import net.java.sip.communicator.service.neomedia.control.KeyFrameControl; // disambiguation
 import net.java.sip.communicator.service.neomedia.device.*;
 import net.java.sip.communicator.service.neomedia.format.*;
@@ -870,7 +871,7 @@ public QualityControl getQualityControl()
      * @author Lyubomir Marinov
      */
     private class KeyFrameControlImpl
-        implements KeyFrameControl
+        extends KeyFrameControlAdapter
     {
     }
 

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/BaseHttpXCapClient.java
Patch:
@@ -209,8 +209,8 @@ protected XCapHttpResponse get(URI uri)
                 // for debug purposes print only xmls
                 // skip the icon queries
                 if(contentBytes != null && result.getContentType() != null
-                        && !result.getContentType().equalsIgnoreCase
-                        (PresContentClient.CONTENT_TYPE))
+                        && !result.getContentType()
+                                .startsWith(PresContentClient.CONTENT_TYPE))
                     contenString = new String(contentBytes);
                 else
                     contenString = "";

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/XCapClientImpl.java
Patch:
@@ -400,7 +400,7 @@ public ContentType getPresContent(String imageName)
                         resourceId.toString());
                 throw new XCapException(errorMessage);
             }
-            if (!contentType.equals(PresContentClient.CONTENT_TYPE))
+            if (!contentType.startsWith(PresContentClient.CONTENT_TYPE))
             {
                 String errorMessage = String.format(
                         "XCAP server returns invalid PresContent content type: %1s",
@@ -628,7 +628,7 @@ private String getResource(XCapResourceId resourceId, String contentType)
                 return null;
             }
 
-            if (!contentType.equals(response.getContentType()))
+            if (!response.getContentType().startsWith(contentType))
             {
                 String errorMessage = String.format(
                         "XCAP server returns invalid content type: %1s",

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigurationPanel.java
Patch:
@@ -623,7 +623,7 @@ private Component createNormalizeNumberCheckBox()
     {
         JPanel checkBoxPanel = new TransparentPanel(new BorderLayout());
 
-        JCheckBox formatPhoneNumber = new JCheckBox("",
+        SIPCommCheckBox formatPhoneNumber = new SIPCommCheckBox("",
             ConfigurationManager.isNormalizePhoneNumber());
 
         formatPhoneNumber.setAlignmentY(Component.TOP_ALIGNMENT);

File: src/net/java/sip/communicator/impl/protocol/jabber/TransportManagerGTalkImpl.java
Patch:
@@ -810,10 +810,10 @@ else if(ext.getNamespace().equals(
                 candidates.addAll(
                     GTalkPacketFactory.createCandidates("video_rtp", stream));
             }
-        }
 
-        /* send candidates */
-        candidatesSender.sendCandidates(candidates);
+            /* send candidates */
+            candidatesSender.sendCandidates(candidates);
+        }
     }
 
     /**

File: src/net/java/sip/communicator/plugin/contactinfo/ContactInfoDetailsPanel.java
Patch:
@@ -488,7 +488,8 @@ else if (detail instanceof TimeZoneDetail)
         }
 
         // Add users status message to extended details if it exists
-        if(!contact.getStatusMessage().isEmpty())
+        String statusMessage = contact.getStatusMessage();
+        if(statusMessage != null && statusMessage.length() > 0)
         {
             detailLabel = new JLabel();
             HTMLTextPane detailValuePane = new HTMLTextPane();
@@ -506,7 +507,7 @@ else if (detail instanceof TimeZoneDetail)
             detailLabel.setText(Resources.getString(
                 "plugin.contactinfo.USER_STATUS_MESSAGE") + ": ");
 
-            detailValuePane.setText(contact.getStatusMessage());
+            detailValuePane.setText(statusMessage);
         }
 
         // If the contact's protocol supports web info, give them a button to

File: src/net/java/sip/communicator/impl/neomedia/MediaConfiguration.java
Patch:
@@ -12,8 +12,7 @@
 import javax.media.*;
 import javax.media.MediaException; // disambiguation
 import javax.swing.*;
-import javax.swing.border.BevelBorder;
-import javax.swing.border.EtchedBorder;
+import javax.swing.border.*;
 import javax.swing.event.*;
 import javax.swing.table.*;
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/AddContactDialog.java
Patch:
@@ -18,6 +18,7 @@
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.addgroup.*;
+import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.contactlist.event.*;
 import net.java.sip.communicator.service.gui.*;
@@ -495,7 +496,8 @@ else if (value instanceof ProtocolProviderService)
                             .getIcon(ProtocolIcon.ICON_SIZE_16x16));
 
                     if (protocolImg != null)
-                        this.setIcon(new ImageIcon(protocolImg));
+                        this.setIcon(ImageLoader.getIndexedProtocolIcon(
+                                protocolImg, provider));
 
                     this.setText(provider.getAccountID().getDisplayName());
                 }

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCall.java
Patch:
@@ -720,7 +720,7 @@ private void updateRecorderMuteState(Recorder recorder)
             if(!iter.next().isMute())
             {
                 // one peer is not muted so we unmute.
-                recorder.setMute(true);
+                recorder.setMute(false);
                 return;
             }
         }

File: src/net/java/sip/communicator/plugin/otr/OtrContactMenu.java
Patch:
@@ -77,7 +77,7 @@ public OtrContactMenu(Contact contact, boolean inMacOSXScreenMenuBar)
         this.contact = contact;
         this.inMacOSXScreenMenuBar = inMacOSXScreenMenuBar;
 
-        this.setText(contact.getDisplayName());
+        this.setText(contact.getAddress());
 
         /*
          * Setup populating this JMenu on demand because it's not always

File: src/net/java/sip/communicator/plugin/sip2sipaccregwizz/Sip2SipAccountRegistrationWizard.java
Patch:
@@ -123,7 +123,6 @@ public byte[] getPageImage()
             .getImageInBytes(PAGE_IMAGE);
     }
 
-
     /**
      * Implements the <code>AccountRegistrationWizard.getProtocolName</code>
      * method. Returns the protocol name for this wizard.

File: src/net/java/sip/communicator/service/gui/ExtendedAccountRegistrationWizard.java
Patch:
@@ -11,7 +11,7 @@
  *
  * @author Yana Stamcheva
  */
-public interface ExtendedAccountRegistrationWizard
+public abstract class ExtendedAccountRegistrationWizard
     extends AccountRegistrationWizard
 {
     /**
@@ -20,10 +20,10 @@ public interface ExtendedAccountRegistrationWizard
      * @return <tt>true</tt> if a sign up form is supported by this wizard,
      * <tt>false</tt> - otherwise
      */
-    public boolean isSignupSupported();
+    public abstract boolean isSignupSupported();
 
     /**
      * Sets the create account view of this registration wizard.
      */
-    public void setCreateAccountView();
+    public abstract void setCreateAccountView();
 }

File: src/net/java/sip/communicator/impl/contactlist/MetaContactImpl.java
Patch:
@@ -278,8 +278,9 @@ public Contact getContact(String contactAddress,
     {
         for (Contact contact : protoContacts)
         {
-            if(   contact.getProtocolProvider() == ownerProvider
-               && contact.getAddress().equals(contactAddress))
+            if(contact.getProtocolProvider() == ownerProvider
+               && (contact.getAddress().equals(contactAddress)
+                    || contact.equals(contactAddress)))
                 return contact;
         }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -608,7 +608,9 @@ private void connectAndLogin(SecurityAuthority authority,
                     }
                     catch(NumberFormatException ex)
                     {
-                        throw new OperationFailedException("Wrong port",
+                        throw new OperationFailedException("Wrong proxy port, "
+                                + globalProxyPortStr
+                                + " does not represent an integer",
                             OperationFailedException.INVALID_ACCOUNT_PROPERTIES,
                             ex);
                     }

File: src/net/java/sip/communicator/impl/protocol/sip/SipRegistrarConnection.java
Patch:
@@ -937,7 +937,8 @@ else if (response.getStatusCode() == Response.INTERVAL_TOO_BRIEF)
         }
         else if ( response.getStatusCode() >= 400 )
         {
-            logger.error("Received an error response.");
+            logger.error("Received an error response ("
+                    + response.getStatusCode() + ")" );
 
             int registrationStateReason =
                 RegistrationStateChangeEvent.REASON_NOT_SPECIFIED;

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -974,7 +974,7 @@ else if (isAncestor(videoContainer, visualComponent))
             videoContainer.add(video, VideoLayout.CENTER_REMOTE, 0);
 
             callRenderer.getCallContainer()
-                .addRemoteVideoSpecificComponents();
+                .addRemoteVideoSpecificComponents(callPeer);
         }
         else
         {

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -133,7 +133,7 @@ public class ProtocolProviderServiceIcqImpl
      */
     public RegistrationState getRegistrationState()
     {
-        if(getAimConnection() == null)
+        if(getAimConnection() == null || lastRegistrationState == null)
             return RegistrationState.UNREGISTERED;
 
         return lastRegistrationState;

File: src/net/java/sip/communicator/impl/protocol/sip/SipApplicationData.java
Patch:
@@ -93,7 +93,7 @@ public static Object getApplicationData(Object container, String key)
     {
         if (container == null)
         {
-            logger.warn("container is null");
+            logger.debug("container is null");
             return null;
         }
         if (key == null)

File: src/net/java/sip/communicator/impl/protocol/jabber/jinglesdp/JingleUtils.java
Patch:
@@ -132,8 +132,8 @@ public static MediaFormat payloadTypeToMediaFormat(
                             pt,
                             payloadType.getName(),
                             (double)payloadType.getClockrate(),
-                            -1,
                             payloadType.getChannels(),
+                            -1,
                             paramsMap,
                             null);
 

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -136,9 +136,7 @@ public RegistrationState getRegistrationState()
         if(getAimConnection() == null)
             return RegistrationState.UNREGISTERED;
 
-        State connState = getAimConnection().getState();
-
-        return joustSimStateToRegistrationState(connState);
+        return lastRegistrationState;
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -921,8 +921,8 @@ void firePresenceStatusChanged(Presence presence)
                 String userID
                     = StringUtils.parseBareAddress(presence.getFrom());
 
-                if (logger.isInfoEnabled())
-                    logger.info("Received a status update for buddy=" + userID);
+                if (logger.isDebugEnabled())
+                    logger.debug("Received a status update for buddy=" + userID);
 
                 // all contact statuses that are received from all its resources
                 // ordered by priority

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1077,8 +1077,8 @@ public void run()
      */
     public FilterQuery applyFilter(ContactListFilter filter)
     {
-        if (logger.isInfoEnabled())
-            logger.info("Contact list filter applied: " + filter);
+        if (logger.isDebugEnabled())
+            logger.debug("Contact list filter applied: " + filter);
 
         if (currentFilterQuery != null && !currentFilterQuery.isCanceled())
             currentFilterQuery.cancel();

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -106,7 +106,8 @@ private class TargetAddress
     /**
      * The timer executing tasks on specified intervals
      */
-    private final Timer keepAliveTimer = new Timer();
+    private final Timer keepAliveTimer =
+        new Timer("Jabber keepalive timer", true);
 
     /**
      * Indicates the time of the last Mailbox report that we received from

File: src/net/java/sip/communicator/impl/protocol/msn/EventManager.java
Patch:
@@ -177,7 +177,7 @@ public void sessionTimeout(Session socketSession) throws Exception
         synchronized (this)
         {
             if (this.connectionTimer == null)
-                this.connectionTimer = new Timer();
+                this.connectionTimer = new Timer("Msn connection timer", true);
             connectionTimer = this.connectionTimer;
         }
 

File: src/net/java/sip/communicator/impl/growlnotification/GrowlNotificationActivator.java
Patch:
@@ -67,7 +67,7 @@ public void start(BundleContext bc) throws Exception
 
         handler = new GrowlNotificationServiceImpl();
 
-        if (handler.isGrowlInstalled())
+        if (handler.isGrowlInstalled() && handler.isGrowlRunning())
         {
             handler.start(bc);
             bc.registerService(PopupMessageHandler.class.getName(), handler, null);

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -61,8 +61,9 @@ public LoginManager(MainFrame mainFrame)
      */
     public void login(ProtocolProviderService protocolProvider)
     {
-        SecurityAuthorityImpl secAuth
-            = new SecurityAuthorityImpl(protocolProvider);
+        SecurityAuthority secAuth
+            = GuiActivator.getUIService()
+                .getDefaultSecurityAuthority(protocolProvider);
 
         mainFrame.getAccountStatusPanel().startConnecting(protocolProvider);
 

File: src/net/java/sip/communicator/impl/osdependent/jdic/StatusSimpleSelector.java
Patch:
@@ -100,7 +100,7 @@ public void actionPerformed(ActionEvent evt)
                 new ProviderRegistration(provider).start();
             }
         }
-        else 
+        else
         {
             RegistrationState registrationState
                 = provider.getRegistrationState();

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/gtalk/SessionIQProvider.java
Patch:
@@ -102,7 +102,6 @@ public SessionIQProvider()
      *
      * @throws Exception if an error occurs parsing the XML.
      */
-    @Override
     public IQ parseIQ(XmlPullParser parser) throws Exception
     {
         SessionIQ sessionIQ = new SessionIQ();

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/portaudio/PortAudioStream.java
Patch:
@@ -144,7 +144,6 @@ protected Format doGetFormat()
      * @throws IOException if anything goes wrong while reading media data from
      * this <tt>PullBufferStream</tt> into the specified <tt>buffer</tt>
      */
-    @Override
     public void read(Buffer buffer)
         throws IOException
     {

File: src/net/java/sip/communicator/impl/neomedia/format/MediaFormatFactoryImpl.java
Patch:
@@ -252,7 +252,8 @@ public MediaFormat createMediaFormat(String              encoding,
             //formatParameters.putAll(mediaFormat.getFormatParameters());
             formatParameters.putAll(formatParams);
         }
-        else if(mediaFormat != null && (advancedParams != null ) &&
+
+        if(mediaFormat != null && (advancedParams != null ) &&
                 !advancedParams.isEmpty())
         {
             recreate = true;

File: src/net/java/sip/communicator/impl/neomedia/device/DeviceConfiguration.java
Patch:
@@ -226,9 +226,9 @@ public class DeviceConfiguration
     private int frameRate = -1;
 
     /**
-     * The default frame rate.
+     * The default frame rate, -1 unlimited.
      */
-    public static final int DEFAULT_FRAME_RATE = 20;
+    public static final int DEFAULT_FRAME_RATE = -1;
 
     /**
      * The property we use to store the settings for maximum allowed video

File: src/net/java/sip/communicator/impl/neomedia/device/VideoMediaDeviceSession.java
Patch:
@@ -188,7 +188,9 @@ protected DataSource createCaptureDevice()
                 if ((maxSupportedFrameRate > 0)
                         && (frameRate > maxSupportedFrameRate))
                     frameRate = maxSupportedFrameRate;
-                frameRateControl.setFrameRate(frameRate);
+
+                if(frameRate > 0)
+                    frameRateControl.setFrameRate(frameRate);
             }
 
             /*

File: src/net/java/sip/communicator/impl/neomedia/device/VideoMediaDeviceSession.java
Patch:
@@ -34,7 +34,6 @@
 public class VideoMediaDeviceSession
     extends MediaDeviceSession
 {
-
     /**
      * The <tt>Logger</tt> used by the <tt>VideoMediaDeviceSession</tt> class
      * and its instances for logging output.

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -74,7 +74,7 @@ public class CallPeerMediaHandlerJabberImpl
      * Creates a new handler that will be managing media streams for
      * <tt>peer</tt>.
      *
-     * @param peer that <tt>CallPeerSipImpl</tt> instance that we will be
+     * @param peer that <tt>CallPeerJabberImpl</tt> instance that we will be
      * managing media for.
      */
     public CallPeerMediaHandlerJabberImpl(CallPeerJabberImpl peer)

File: src/net/java/sip/communicator/impl/protocol/jabber/JingleNodesHarvester.java
Patch:
@@ -6,7 +6,7 @@
  */
 package net.java.sip.communicator.impl.protocol.jabber;
 
-import java.net.DatagramSocket;
+import java.net.*;
 import java.util.*;
 
 import org.ice4j.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/UriHandlerJabberImpl.java
Patch:
@@ -16,7 +16,6 @@
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
-
 /**
  * The jabber implementation of the URI handler. This class handles xmpp URIs by
  * trying to establish a chat with them or add you to a chatroom.

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/AbstractPullBufferCaptureDevice.java
Patch:
@@ -348,7 +348,7 @@ protected Object getStreamSyncRoot()
      */
     public PullBufferStream[] getStreams()
     {
-        return impl.getStreams(AbstractPullBufferStream.class);
+        return impl.getStreams(PullBufferStream.class);
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/AbstractPushBufferCaptureDevice.java
Patch:
@@ -369,7 +369,7 @@ protected Object getStreamSyncRoot()
      */
     public PushBufferStream[] getStreams()
     {
-        return impl.getStreams(AbstractPushBufferStream.class);
+        return impl.getStreams(PushBufferStream.class);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberAccountID.java
Patch:
@@ -180,6 +180,6 @@ public boolean isUPNPEnabled()
     {
         return getAccountPropertyBoolean(
                 ProtocolProviderFactory.IS_USE_UPNP,
-                false);
+                true);
     }
 }

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/IceConfigPanel.java
Patch:
@@ -116,7 +116,7 @@ public IceConfigPanel()
         jnBox.setSelected(true);
         jnAutoDiscoverBox.setSelected(true);
 
-        //upnpBox.setSelected(true);
+        upnpBox.setSelected(true);
 
         JPanel checkBoxPanel = new TransparentPanel(new GridLayout(0, 1));
         checkBoxPanel.add(iceBox);

File: src/net/java/sip/communicator/impl/neomedia/MediaStreamImpl.java
Patch:
@@ -2120,7 +2120,7 @@ public void update(RemoteEvent remoteEvent)
                         new StringBuilder(StatisticsEngine.RTP_STAT_PREFIX);
 
                 buff.append("Received a report for ")
-                    .append(getFormat().getMediaType().toString())
+                    .append(getFormat() != null ? getFormat().getMediaType().toString() : "")
                     .append(" stream SSRC:")
                     .append(getLocalSourceID())
                     .append(" [packet count:")
@@ -2232,7 +2232,7 @@ private void printFlowStatistics(RTPManager rtpManager)
                     new StringBuilder(StatisticsEngine.RTP_STAT_PREFIX);
 
             buff.append("call stats for outgoing ")
-                .append(getFormat().getMediaType())
+                .append(getFormat() != null ? getFormat().getMediaType() : "")
                 .append(" stream SSRC:")
                 .append(getLocalSourceID())
                     .append("\n").append(StatisticsEngine.RTP_STAT_PREFIX)

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopStreamingJabberImpl.java
Patch:
@@ -168,6 +168,7 @@ public void setLocalVideoAllowed(Call call, boolean allowed)
     {
         ((CallJabberImpl)call).setLocalVideoAllowed(allowed,
                 MediaUseCase.DESKTOP);
+        ((CallJabberImpl)call).setVideoDevice(null);
         MediaDevice device = ((CallJabberImpl)call).getDefaultDevice(
                 MediaType.VIDEO);
         size = (((VideoMediaFormat)device.getFormat()).getSize());
@@ -303,7 +304,7 @@ public void movePartialDesktopStreaming(Call call, int x,
             }
         }
     }
-    
+
     /**
      * Get origin of the screen.
      *

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetDesktopStreamingSipImpl.java
Patch:
@@ -195,7 +195,7 @@ public void setLocalVideoAllowed(Call call, boolean allowed)
         throws OperationFailedException
     {
         ((CallSipImpl)call).setLocalVideoAllowed(allowed, MediaUseCase.DESKTOP);
-
+        ((CallSipImpl)call).setVideoDevice(null);
         MediaDevice device = ((CallSipImpl)call).getDefaultDevice(
                 MediaType.VIDEO);
         size = (((VideoMediaFormat)device.getFormat()).getSize());
@@ -313,7 +313,7 @@ public Point getOrigin()
     {
         return origin;
     }
-    
+
     /**
      * Get origin of the screen.
      *

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationForm.java
Patch:
@@ -400,6 +400,7 @@ public void loadAccount(AccountID accountID)
 
         iceConfigPanel.setAutoDiscoverJingleNodes(isUseAutoDiscoverJN);
 
+        iceConfigPanel.removeAllJingleNodes();
         for (int i = 0; i < JingleNodeDescriptor.MAX_JN_RELAY_COUNT ; i ++)
         {
             JingleNodeDescriptor jn

File: src/net/java/sip/communicator/launcher/BrowserLauncher.java
Patch:
@@ -53,6 +53,7 @@ public LaunchBrowser(String url)
          * FileProtocolHandler to do so, on Linux, loops through a list of
          * known browsers until we find one that seems to work.
          */
+        @SuppressWarnings("deprecation")
         public void run()
         {
             try

File: src/net/java/sip/communicator/util/swing/SIPCommTextField.java
Patch:
@@ -259,6 +259,9 @@ public void setForegroundColor(Color c)
     public void setDefaultTextColor(Color c)
     {
         defaultTextColor = c;
+
+        if (isDefaultTextVisible)
+            setForeground(defaultTextColor);
     }
 
     /**

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationForm.java
Patch:
@@ -77,7 +77,7 @@ void init()
                                 connectionPanel);
 
         if (iceConfigPanel.getParent() != tabbedPane)
-            tabbedPane.addTab(Resources.getString("service.gui.PRESENCE"),
+            tabbedPane.addTab(Resources.getString("service.gui.ICE"),
                                 iceConfigPanel);
 
         if (tabbedPane.getParent() != this)
@@ -367,6 +367,7 @@ public void loadAccount(AccountID accountID)
 
         iceConfigPanel.setUseDefaultStunServer(isUseDefaultStun);
 
+        iceConfigPanel.removeAllStunServer();
         for (int i = 0; i < StunServerDescriptor.MAX_STUN_SERVER_COUNT; i ++)
         {
             StunServerDescriptor stunServer

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -910,7 +910,9 @@ public void paintComponent(Graphics g)
                 g.drawImage(
                     arrowImage,
                     textWidth + 2*IMAGE_INDENT + 2,
-                    (this.getHeight() - arrowImage.getHeight(null)) / 2 + 3,
+                    getX()
+                        + (this.getHeight() - arrowImage.getHeight(null)) / 2
+                        + 1,
                     null);
             }
             finally

File: src/net/java/sip/communicator/impl/googlecontacts/GoogleContactsServiceImpl.java
Patch:
@@ -485,7 +485,7 @@ public static byte[] downloadPhoto(ILink photoLink,
         }
         catch(Exception e)
         {
-            logger.info("Failed to retrieve photo of the contact", e);
+            logger.debug("Failed to retrieve photo of the contact", e);
         }
         return null;
     }

File: src/net/java/sip/communicator/impl/neomedia/ArrayIOUtils.java
Patch:
@@ -7,10 +7,10 @@
 package net.java.sip.communicator.impl.neomedia;
 
 /**
- * Implements functionality aiding the reading and writing of <tt>byte</tt>
- * arrays and primitive types such as <tt>short</tt>.
+ * Implements functionality aiding the reading and writing in little endian of
+ * <tt>byte</tt> arrays and primitive types such as <tt>short</tt>.
  *
- * @author Lubomir Marinov
+ * @author Lyubomir Marinov
  */
 public class ArrayIOUtils
 {

File: src/net/java/sip/communicator/plugin/ldap/configform/LdapConfigForm.java
Patch:
@@ -375,14 +375,15 @@ public static class RefreshContactSourceThread
          */
         public void run()
         {
+            LdapService service = LdapActivator.getLdapService();
             if(oldLdap != null)
             {
-                LdapActivator.disableContactSource(oldLdap);
+                service.removeContactSource(oldLdap);
             }
 
             if(newLdap != null)
             {
-                LdapActivator.enableContactSource(newLdap);
+                service.createContactSource(newLdap);
             }
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationRequestedDialog.java
Patch:
@@ -140,7 +140,6 @@ public AuthorizationRequestedDialog(MainFrame mainFrame, Contact contact,
         this.rejectButton.setName("reject");
         this.ignoreButton.setName("ignore");
 
-        this.getRootPane().setDefaultButton(acceptButton);
         this.acceptButton.addActionListener(this);
         this.rejectButton.addActionListener(this);
         this.ignoreButton.addActionListener(this);

File: src/net/java/sip/communicator/service/protocol/media/MediaAwareCall.java
Patch:
@@ -425,7 +425,7 @@ public void removeLocalUserSoundLevelListener(SoundLevelListener l)
     {
         synchronized(localUserAudioLevelListeners)
         {
-            localUserAudioLevelListeners.add(l);
+            localUserAudioLevelListeners.remove(l);
 
             if (localUserAudioLevelListeners.isEmpty())
             {

File: src/net/java/sip/communicator/impl/gui/main/call/InputVolumeControlButton.java
Patch:
@@ -91,8 +91,8 @@ public InputVolumeControlButton(Call call,
         this(   call,
                 ImageLoader.MICROPHONE,
                 ImageLoader.MUTE_BUTTON,
-                true,
                 fullScreen,
+                true,
                 selected);
     }
 

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -1643,8 +1643,8 @@ public void mouseReleased(MouseEvent event)
             if (!closeButton.isVisible())
             {
                 Component c = (Component) event.getSource();
-                closeButton.setLocation( 
-                    c.getX() + c.getWidth() - closeButton.getWidth() - 3, 
+                closeButton.setLocation(
+                    c.getX() + c.getWidth() - closeButton.getWidth() - 3,
                     c.getY() + 3);
                 closeButton.setVisible(true);
             }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopSharingClientJabberImpl.java
Patch:
@@ -137,6 +137,7 @@ public void sendKeyboardEvent(CallPeer callPeer, KeyEvent event)
         inputIQ.setFrom(parentProvider.getOurJID());
         inputIQ.setTo(callPeer.getAddress());
         inputIQ.addRemoteControl(payload);
+
         parentProvider.getConnection().sendPacket(inputIQ);
     }
 

File: src/net/java/sip/communicator/service/protocol/event/CallChangeEvent.java
Patch:
@@ -114,6 +114,8 @@ public Call getSourceCall()
     /**
      * The event which was the cause for current event, like last peer
      * removed from call will hangup current call, if any, otherwise is null.
+     *
+     * @return <tt>CallPeerChangeEvent</tt> that represents the cause
      */
     public CallPeerChangeEvent getCause()
     {

File: src/net/java/sip/communicator/service/protocol/event/SubscriptionEvent.java
Patch:
@@ -93,6 +93,8 @@ public SubscriptionEvent( Contact source,
      * is located
      * @param eventID one of the SUBSCRIPTION_XXX static fields indicating the
      * nature of the event.
+     * @param errorCode the error code
+     * @param errorReason the error reason string
      */
     public SubscriptionEvent( Contact source,
                        ProtocolProviderService provider,

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetBasicTelephony.java
Patch:
@@ -78,6 +78,7 @@ public void fireCallEvent(int eventID, Call sourceCall)
      *
      * @param eventID the ID of the event to dispatch
      * @param sourceCall the call on which the event has occurred.
+     * @param mediaTypes list of media types
      */
     public void fireCallEvent(int eventID, Call sourceCall,
                   List<MediaType> mediaTypes)

File: src/net/java/sip/communicator/util/launchutils/SipCommunicatorLock.java
Patch:
@@ -703,7 +703,7 @@ private static class LockServerConnectionProcessor extends Thread
          * would handle parameters received through the
          * <tt>connectionSocket</tt>.
          *
-         * @param connectedSocket
+         * @param connectionSocket
          *            the socket that we will be using to read arguments from
          *            the remote SIP Communicator instance.
          */

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/BaseHttpXCapClient.java
Patch:
@@ -420,6 +420,8 @@ private DefaultHttpClient createHttpClient()
             org.apache.http.conn.ssl.SSLSocketFactory ssf
                 = new org.apache.http.conn.ssl.SSLSocketFactory(
                         ctx, new HostNameResolverImpl());
+            ssf.setHostnameVerifier(org.apache.http.conn.ssl.SSLSocketFactory
+                .ALLOW_ALL_HOSTNAME_VERIFIER);
             sr.register(new Scheme("https", ssf, 443));
         }
         catch(Throwable e)

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/XCapClientImpl.java
Patch:
@@ -121,7 +121,7 @@ public void putResourceLists(ResourceListsType resourceLists)
             }
             String xml = ResourceListsParser.toXml(resourceLists);
             XCapResource resource = new XCapResource(resourceId, xml,
-                    XCapCapsClient.CONTENT_TYPE);
+                    ResourceListsClient.RESOURCE_LISTS_CONTENT_TYPE);
             // Put resource-lists to the server
             putResource(resource);
         }

File: src/net/java/sip/communicator/util/swing/MasterPasswordInputDialog.java
Patch:
@@ -65,7 +65,7 @@ private MasterPasswordInputDialog()
         this.setModal(true);
         this.setResizable(false);
 
-        JPanel mainPanel = new JPanel(new BorderLayout(10, 10));
+        JPanel mainPanel = new TransparentPanel(new BorderLayout(10, 10));
         mainPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
 
         mainPanel.add(createIconComponent(), BorderLayout.WEST);
@@ -260,7 +260,7 @@ public void keyTyped(KeyEvent arg0)
      */
     private static Component createIconComponent()
     {
-        JPanel wrapIconPanel = new JPanel(new BorderLayout());
+        JPanel wrapIconPanel = new TransparentPanel(new BorderLayout());
 
         JLabel iconLabel = new JLabel();
 

File: src/net/java/sip/communicator/plugin/ippiaccregwizz/IppiAccountRegistrationWizard.java
Patch:
@@ -212,7 +212,7 @@ protected SIPAccountCreationFormService getCreateAccountService()
      */
     protected String getUsernameLabel()
     {
-        return Resources.getString("plugin.ippiaccregwizz.USERNAME");
+        return Resources.getString("plugin.sip2sipaccregwizz.USERNAME");
     }
 
     /**

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/GoogleTalkAccountRegistrationWizard.java
Patch:
@@ -83,6 +83,7 @@ public Object getSimpleForm()
      */
     private void setPredefinedProperties(JabberAccountRegistration reg)
     {
+        reg.setDefaultUserSufix("gmail.com");
         reg.setServerAddress("talk.google.com");
 
         reg.setServerOverridden(true);
@@ -141,7 +142,7 @@ public String getProtocolDescription()
      */
     public String getUserNameExample()
     {
-        return "Ex: johnsmith@gmail.com";
+        return "Ex: johnsmith@gmail.com or johnsmith";
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/PreCallDialog.java
Patch:
@@ -136,7 +136,7 @@ private Window createPreCallWindow( String title,
 
             if (accounts != null)
             {
-                accountsCombo = new JComboBox();
+                accountsCombo = new JComboBox(accounts);
             }
         }
 

File: src/net/java/sip/communicator/service/protocol/AccountManager.java
Patch:
@@ -18,7 +18,7 @@
 /**
  * Represents an implementation of <tt>AccountManager</tt> which loads the
  * accounts in a separate thread.
- * 
+ *
  * @author Lubomir Marinov
  * @author Yana Stamcheva
  */
@@ -484,7 +484,7 @@ private void runInLoadStoredAccountsThread()
      * implementation tracks the registrations of
      * <tt>ProtocolProviderFactory</tt> services in order to queue them for
      * loading their stored accounts.
-     * 
+     *
      * @param serviceEvent the <tt>ServiceEvent</tt> containing the event
      *            data
      */

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -475,6 +475,9 @@ public WizardContainer getWizardContainer()
      */
     public JabberAccountRegistration getRegistration()
     {
+        if (registration == null)
+            registration = new JabberAccountRegistration();
+
         return registration;
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1909,7 +1909,7 @@ private void registerGoogleContactsSource()
     {
         if(accountID.getAccountPropertyBoolean(
                 "GOOGLE_CONTACTS_ENABLED",
-                false))
+                true))
         {
             logger.info("Register Google Contacts service as contact source");
             GoogleContactsService googleService =
@@ -1935,7 +1935,7 @@ private void unregisterGoogleContactsSource()
     {
         if(accountID.getAccountPropertyBoolean(
                 "GOOGLE_CONTACTS_ENABLED",
-                false))
+                true))
         {
             logger.info("Unregister Google Contacts service as contact source");
 

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/ConnectionPanel.java
Patch:
@@ -137,6 +137,8 @@ public void removeUpdate(DocumentEvent evt)
         checkBoxesPanel.add(gmailNotificationsBox);
         checkBoxesPanel.add(googleContactsBox);
 
+        // default for new account
+        googleContactsBox.setSelected(true);
         advancedOpPanel.add(checkBoxesPanel, BorderLayout.NORTH);
         advancedOpPanel.add(labelsAdvOpPanel, BorderLayout.WEST);
         advancedOpPanel.add(valuesAdvOpPanel, BorderLayout.CENTER);

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/renderer/video/JAWTRenderer.java
Patch:
@@ -65,7 +65,7 @@ public class JAWTRenderer
      * The indicator which determines whether <tt>CALayer</tt>-based painting is
      * to be performed by <tt>JAWTRenderer</tt> on Mac OS X.
      */
-    private static final boolean USE_MACOSX_CALAYERS = true;
+    private static final boolean USE_MACOSX_CALAYERS = false;
 
     static
     {

File: src/net/java/sip/communicator/launcher/SIPCommunicator.java
Patch:
@@ -186,7 +186,7 @@ private static void setScHomeDir(String osName)
                             + "Library" + File.separator
                             + "Application Support";
                 if (name == null)
-                    name = "SIP Communicator";
+                    name = "Jitsi";
             }
             else if (osName.startsWith("Windows"))
             {
@@ -199,7 +199,7 @@ else if (osName.startsWith("Windows"))
                 if (location == null)
                     location = System.getenv("APPDATA");
                 if (name == null)
-                    name = "SIP Communicator";
+                    name = "Jitsi";
             }
 
             /* If there're no OS specifics, use the defaults. */

File: src/net/java/sip/communicator/impl/certificate/CertificateVerificationActivator.java
Patch:
@@ -25,7 +25,7 @@ public class CertificateVerificationActivator
     /**
      * The bundle context for this bundle.
      */
-    static BundleContext bundleContext;
+    protected static BundleContext bundleContext;
 
     /**
      * The configuration service.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -789,6 +789,8 @@ public void run()
         if ((!currentFilter.equals(presenceFilter)
             || !groupNode.isCollapsed()))
             this.expandGroup(groupNode);
+        else
+            this.expandGroup(treeModel.getRoot());
     }
 
     /**

File: src/net/java/sip/communicator/plugin/ldap/LdapContactQuery.java
Patch:
@@ -70,8 +70,6 @@ protected String normalizePhoneNumber(String phoneNumber)
         PhoneNumberI18nService phoneNumberI18nService
             = LdapActivator.getPhoneNumberI18nService();
 
-        System.out.println("PhoneNumberService: " +
-                (phoneNumberI18nService != null));
         return
             (phoneNumberI18nService == null)
                 ? phoneNumber

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandlerSipImpl.java
Patch:
@@ -370,6 +370,7 @@ private Vector<MediaDescription> createMediaDescriptionsForAnswer(
                 //we'll disable it and move on.
                 answerDescriptions.add(
                         SdpUtils.createDisablingAnswer(mediaDescription));
+                continue;
             }
 
             List<MediaFormat> remoteFormats = SdpUtils.extractFormats(

File: src/net/java/sip/communicator/service/contactsource/AbstractContactQuery.java
Patch:
@@ -210,8 +210,6 @@ public void setStatus(int status)
                 eventType = ContactQueryStatusEvent.QUERY_ERROR;
                 break;
             case QUERY_IN_PROGRESS:
-                eventType = ContactQueryStatusEvent.QUERY_IN_PROGRESS;
-                break;
             default:
                 throw new IllegalArgumentException("status");
             }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopSharingServerJabberImpl.java
Patch:
@@ -130,7 +130,7 @@ public Call createVideoCall(String uri, MediaDevice device)
 
         size = (((VideoMediaFormat)call.getDefaultDevice(
                 MediaType.VIDEO).getFormat()).getSize());
-        origin = null;
+        origin = getOriginForMediaDevice(device);
         return call;
     }
 
@@ -159,7 +159,7 @@ public Call createVideoCall(Contact callee, MediaDevice device)
 
         size = (((VideoMediaFormat)call.getDefaultDevice(
                 MediaType.VIDEO).getFormat()).getSize());
-        origin = null;
+        origin = getOriginForMediaDevice(device);
         return call;
     }
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetDesktopSharingServerSipImpl.java
Patch:
@@ -171,7 +171,7 @@ public Call createVideoCall(String uri, MediaDevice device)
 
         size = (((VideoMediaFormat)call.getDefaultDevice(MediaType.VIDEO).
                 getFormat()).getSize());
-        origin = null;
+        origin = getOriginForMediaDevice(device);
         return call;
     }
 
@@ -200,7 +200,7 @@ public Call createVideoCall(Contact callee, MediaDevice device)
 
         size = (((VideoMediaFormat)call.getDefaultDevice(MediaType.VIDEO).
                 getFormat()).getSize());
-        origin = null;
+        origin = getOriginForMediaDevice(device);
         return call;
     }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -145,7 +145,7 @@ public TreeContactList()
 
         GuiActivator.getContactListService().addMetaContactListListener(this);
 
-        treeModel = new ContactListTreeModel();
+        treeModel = new ContactListTreeModel(this);
 
         setTreeModel(treeModel);
 

File: src/net/java/sip/communicator/impl/neomedia/RTPConnectorInputStream.java
Patch:
@@ -271,7 +271,8 @@ public void run()
 
             if(RTPConnectorOutputStream.logPacket(numberOfPackets)
                 && NeomediaActivator.getPacketLogging().isLoggingEnabled(
-                    PacketLoggingService.ProtocolName.RTP))
+                    PacketLoggingService.ProtocolName.RTP) &&
+                socket.getLocalAddress() != null)
             {
                 NeomediaActivator.getPacketLogging()
                     .logPacket(

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPanel.java
Patch:
@@ -272,6 +272,7 @@ private Component createFullScreenButtonBar()
         ShowHideVideoButton showHideButton = new ShowHideVideoButton(
             call, true, callContainer.isShowHideVideoButtonSelected());
         showHideButton.setPeerRenderer(peerPanel);
+        showHideButton.setEnabled(callContainer.isVideoButtonSelected());
 
         Component[] buttons
             = new Component[]

File: src/net/java/sip/communicator/impl/gui/main/call/DesktopSharingFrame.java
Patch:
@@ -515,7 +515,9 @@ private static JLabel createResizeLabel(final JFrame frame,
         {
             public void mouseDragged(MouseEvent e)
             {
-                Point p = e.getLocationOnScreen();
+                Point p = e.getPoint();
+                SwingUtilities.convertPointToScreen(p, resizeLabel);
+
                 Point regionLocation = sharingRegion.getLocationOnScreen();
 
                 int sharingWidth = (int) ( p.getX()

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -268,7 +268,7 @@ private void init()
         videoButton = new LocalVideoButton(call);
         showHideVideoButton = new ShowHideVideoButton(call);
 
-        showHideVideoButton.setPeerRenderer(((OneToOneCallPanel) callPanel)
+        showHideVideoButton.setPeerRenderer(((CallRenderer) callPanel)
             .getCallPeerRenderer(call.getCallPeers().next()));
 
         // When the local video is enabled/disabled we ensure that the show/hide

File: src/net/java/sip/communicator/impl/history/HistoryReaderImpl.java
Patch:
@@ -7,6 +7,7 @@
 package net.java.sip.communicator.impl.history;
 
 import java.util.*;
+import java.util.regex.*;
 
 import org.w3c.dom.*;
 
@@ -689,7 +690,8 @@ static boolean matchKeyword(String value, String[] keywords,
 
             for (int i = 0; i < keywords.length; i++)
             {
-                if(!value.matches(regexpStart + keywords[i] + REGEXP_END))
+                if(!value.matches(
+                    regexpStart + Pattern.quote(keywords[i]) + REGEXP_END))
                     return false;
             }
 

File: src/net/java/sip/communicator/impl/gui/main/call/DesktopSharingFrame.java
Patch:
@@ -294,6 +294,7 @@ protected void paintComponent(Graphics g)
             SHARING_REGION_INDENT, SHARING_REGION_INDENT));
 
         frame.setContentPane(contentPane);
+        ComponentMover.registerComponent(frame);
 
         if (TransparentFrame.isTranslucencySupported)
             frame.setAlwaysOnTop(true);

File: src/net/java/sip/communicator/impl/protocol/sip/EventPackageSubscriber.java
Patch:
@@ -782,8 +782,8 @@ else if ((statusCode != Response.OK)
                  subscription.setTimerTask(refreshTask);
 
                  int refreshDelay = expHeader.getExpires();
-                 // try to keep a margin
-                 if (refreshDelay >= refreshMargin)
+                 // try to keep a margin if the refresh delay allows it
+                 if (refreshDelay >= (2*refreshMargin))
                      refreshDelay -= refreshMargin;
                  timer.schedule(refreshTask, refreshDelay * 1000);
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -242,7 +242,7 @@ private enum WatcherStatus
          *
          * @return the <tt>String</tt> representation of this status
          */
-        public String getValue() 
+        public String getValue()
         {
             return this.value;
         }
@@ -1214,8 +1214,8 @@ public boolean processResponse(ResponseEvent responseEvent)
                 this.republishTask = new RePublishTask();
 
                 int republishDelay = expires.getExpires();
-                // keep a margin
-                if (republishDelay >= REFRESH_MARGIN)
+                // try to keep a margin if the refresh delay allows it
+                if (republishDelay >= (2*REFRESH_MARGIN))
                     republishDelay -= REFRESH_MARGIN;
                 timer.schedule(this.republishTask, republishDelay * 1000);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopSharingServerJabberImpl.java
Patch:
@@ -286,7 +286,7 @@ public void setLocalVideoAllowed(Call call,
         throws OperationFailedException
     {
         ((CallJabberImpl)call).setLocalInputEvtAware(allowed);
-        super.setLocalVideoAllowed(call, allowed);
+        super.setLocalVideoAllowed(call, mediaDevice, allowed);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopStreamingJabberImpl.java
Patch:
@@ -183,9 +183,11 @@ public void setLocalVideoAllowed(Call call,
                                      boolean allowed)
         throws OperationFailedException
     {
+        ((CallJabberImpl)call).setLocalVideoAllowed(allowed,
+                MediaUseCase.DESKTOP);
         ((CallJabberImpl)call).setVideoDevice(mediaDevice);
         size = ((VideoMediaFormat)mediaDevice.getFormat()).getSize();
-        super.setLocalVideoAllowed(call, allowed);
+        ((CallJabberImpl)call).modifyVideoContent(allowed);
     }
 
     /**

File: src/net/java/sip/communicator/util/NetworkUtils.java
Patch:
@@ -1036,7 +1036,7 @@ private static Lookup createLookup(String domain, int type)
 
                 int rslvrPort = SimpleResolver.DEFAULT_PORT;
 
-                //jsut in case someone said sth else ... and we want no errs
+                //just in case someone said sth else ... and we want no errs
                 try
                 {
                     rslvrPort = Integer.getInteger(

File: src/net/java/sip/communicator/impl/gui/main/SingleWindowContainer.java
Patch:
@@ -400,6 +400,9 @@ private Component createToolbar()
 
         mainToolBar = new MainToolBar(this);
 
+        // The toolbar would be only visible when a chat is opened.
+        mainToolBar.setVisible(false);
+
         boolean chatToolbarVisible = ConfigurationManager.isChatToolbarVisible();
         northPanel.setVisible(chatToolbarVisible);
 

File: src/net/java/sip/communicator/impl/gui/main/presence/AccountStatusPanel.java
Patch:
@@ -136,7 +136,7 @@ public AccountStatusPanel(MainFrame mainFrame)
         statusToolsPanel.add(statusMenuBar, BorderLayout.WEST);
 
         toolbarPluginPanel
-            = new TransparentPanel(new FlowLayout(FlowLayout.RIGHT));
+            = new TransparentPanel(new FlowLayout(FlowLayout.RIGHT, 0, 0));
 
         new PluginContainer(toolbarPluginPanel,
                             Container.CONTAINER_MAIN_TOOL_BAR);

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1664,7 +1664,7 @@ private class HostTrustManager
          */
         public X509Certificate[] getAcceptedIssuers()
         {
-            throw new UnsupportedOperationException();
+            return new X509Certificate[0];
         }
 
         /**

File: src/net/java/sip/communicator/impl/gui/main/SingleWindowContainer.java
Patch:
@@ -16,7 +16,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.main.call.*;
-import net.java.sip.communicator.impl.gui.main.call.CallDialog.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.toolBars.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -56,7 +56,10 @@ public void addCallPanel(CallPanel callPanel)
         callPanel.addCallTitleListener(this);
 
         if (!isVisible())
+        {
+            pack();
             setVisible(true);
+        }
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/AbstractCallToggleButton.java
Patch:
@@ -164,10 +164,10 @@ public AbstractCallToggleButton(
                 GuiActivator.getResources().getI18NString(toolTipTextKey));
         }
 
-        setSelected(selected);
-
         setModel(new CallToggleButtonModel(call));
 
+        setSelected(selected);
+
         // All items are now instantiated and could safely load the skin.
         loadSkin();
     }

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h264/JNIDecoder.java
Patch:
@@ -263,6 +263,7 @@ public synchronized int process(Buffer inBuffer, Buffer outBuffer)
 
         // Ask FFmpeg to decode.
         got_picture[0] = false;
+
         // TODO Take into account the offset of inputBuffer.
         FFmpeg.avcodec_decode_video(
                 avcontext,

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -711,7 +711,8 @@ else if (writePanelRightMenu.isVisible())
                 writePanelRightMenu.setVisible(false);
             }
             else if ((menuBar.getSelectedMenu() != null)
-                        || mainToolBar.getSmileysBox().isVisible())
+                        || mainToolBar.getSmileysBox()
+                            .getPopupMenu().isVisible())
             {
                 MenuSelectionManager.defaultManager().clearSelectedPath();
             }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/PresenceFilter.java
Patch:
@@ -214,6 +214,7 @@ private void addMatching(   MetaContactGroup metaGroup,
                     GuiActivator.getContactList().addContact(
                             MetaContactListSource.createUIContact(metaContact),
                             uiGroup,
+                            true,
                             true);
 
                     query.setInitialResultCount(resultCount);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -252,7 +252,8 @@ private void addSourceContact(  SourceContact sourceContact)
             GuiActivator.getContactList().addContact(
                 sourceUI.createUIContact(sourceContact),
                 sourceUI.getUIGroup(),
-                false);
+                false,
+                true);
         }
     }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaContactListSource.java
Patch:
@@ -207,6 +207,7 @@ private void queryMetaContactSource(Pattern filterPattern,
                     GuiActivator.getContactList().addContact(
                             MetaContactListSource.createUIContact(metaContact),
                             uiGroup,
+                            true,
                             true);
 
                     query.setInitialResultCount(resultCount);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/notifsource/NotificationContactSource.java
Patch:
@@ -8,11 +8,9 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.service.protocol.OperationSetMessageWaiting.MessageType;
 import net.java.sip.communicator.service.protocol.event.*;
-import net.java.sip.communicator.util.*;
 
 /**
  * The <tt>NotificationContactSource</tt> represents a contact source that would

File: src/net/java/sip/communicator/impl/gui/main/contactlist/notifsource/NotificationGroup.java
Patch:
@@ -237,7 +237,7 @@ public void messageWaitingNotify(MessageWaitingEvent event)
         if (contactList.getCurrentFilter().isMatching(contact))
         {
             if (isNew)
-                contactList.addContact(contact, this, true);
+                contactList.addContact(contact, this, true, true);
             else
                 contactList.refreshContact(contact);
         }

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardController.java
Patch:
@@ -146,6 +146,8 @@ public void run()
             }
             catch (Exception ex)
             {
+                wizard.stopCommittingPage();
+
                 //lots of things may fail on page next, like for example parameter
                 //validation or account initialization. If this is what happened here
                 //just show an error and leave everything on the same page so that

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegSummaryPage.java
Patch:
@@ -193,6 +193,8 @@ else if (e.getErrorCode()
                     GuiActivator.getResources()
                         .getI18NString("service.gui.USER_EXISTS_ERROR"));
             }
+            else
+                throw new RuntimeException(e.getMessage(), e);
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -3072,7 +3072,8 @@ public InetSocketAddress getIntendedDestination(String host)
      */
     public void registrationStateChanged(RegistrationStateChangeEvent event)
     {
-        if(event.getNewState() == RegistrationState.UNREGISTERED)
+        if(event.getNewState() == RegistrationState.UNREGISTERED ||
+           event.getNewState() == RegistrationState.CONNECTION_FAILED)
         {
             ProtocolProviderServiceSipImpl listener
                 = (ProtocolProviderServiceSipImpl) event.getProvider();

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -676,7 +676,7 @@ else if(state == ConnectState.STOP_TRYING)
 
                             // if it happens once again throw
                             // the original exception
-                            if(i == serverAddresses.size())
+                            if(i == serverAddresses.size() - 1)
                             {
                                 throw ex;
                             }

File: src/net/java/sip/communicator/plugin/reconnectplugin/ReconnectPluginActivator.java
Patch:
@@ -476,6 +476,9 @@ else if(event.getType() == ChangeEvent.IFACE_DOWN)
             {
                 // we must disconnect every pp and put all to be need of reconnecting
                 needsReconnection.addAll(autoReconnEnabledProviders.keySet());
+                // there can by and some that are currently going to reconnect
+                // must take care of them too, cause there is no net and they won't succeed
+                needsReconnection.addAll(currentlyReconnecting.keySet());
 
                 Iterator<ProtocolProviderService> iter =
                     needsReconnection.iterator();

File: src/net/java/sip/communicator/impl/protocol/sip/MethodProcessorAdapter.java
Patch:
@@ -13,7 +13,7 @@
  * no processing and exists only as a convenience to extenders so that they can
  * override the methods of interest.
  * 
- * @author Lubomir Marinov
+ * @author Lyubomir Marinov
  */
 public class MethodProcessorAdapter
     implements MethodProcessor

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1828,8 +1828,8 @@ public static void setSourceContactImage(   String contactString,
 
         // If we find that the contact is actually a number, we get rid of the
         // @ if it exists.
-        if (StringUtils.isNumber(contactString)
-            && atIndex >= 0)
+        if (atIndex >= 0
+            && StringUtils.isNumber(contactString.substring(0, atIndex)))
         {
             contactString = contactString.substring(0, atIndex);
         }

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -151,7 +151,9 @@ public void callEnded(CallEvent event)
             {
                 CallPanel callContainer = activeCalls.get(sourceCall);
 
-                callContainer.getCallWindow().close(callContainer);
+                activeCalls.remove(sourceCall);
+
+                callContainer.getCallWindow().closeWait(callContainer);
             }
         }
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -179,12 +179,12 @@ public class CallPanel
     /**
      * Sound local level label.
      */
-    private AbstractVolumeControlButton localLevel;
+    private InputVolumeControlButton localLevel;
 
     /**
      * Sound remote level label.
      */
-    private AbstractVolumeControlButton remoteLevel;
+    private OutputVolumeControlButton remoteLevel;
 
     /**
      * A collection of listeners, registered for call title change events.
@@ -266,6 +266,7 @@ private void init()
 
         localLevel = new InputVolumeControlButton(
                 call,
+                ImageLoader.MICROPHONE,
                 ImageLoader.MUTE_BUTTON,
                 false, true, false);
         remoteLevel = new OutputVolumeControlButton(

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.main.call;
 
-import java.awt.event.*;
 import java.util.*;
 
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -169,12 +169,12 @@ public class OneToOneCallPeerPanel
     /**
      * Sound local level label.
      */
-    private AbstractVolumeControlButton localLevel;
+    private InputVolumeControlButton localLevel;
 
     /**
      * Sound remote level label.
      */
-    private AbstractVolumeControlButton remoteLevel;
+    private OutputVolumeControlButton remoteLevel;
 
     /**
      * The center component.
@@ -370,6 +370,7 @@ private void createSoundLevelIndicators()
         localLevel = new InputVolumeControlButton(
                 callPeer.getCall(),
                 ImageLoader.MICROPHONE,
+                ImageLoader.MUTE_BUTTON,
                 false, false, false);
 
         remoteLevel = new OutputVolumeControlButton(

File: src/net/java/sip/communicator/impl/protocol/jabber/jinglesdp/JingleUtils.java
Patch:
@@ -116,6 +116,7 @@ public static MediaFormat payloadTypeToMediaFormat(
                     DynamicPayloadTypeRegistry ptRegistry)
     {
         byte pt = (byte)payloadType.getID();
+        boolean unknown = false;
 
         //convert params to a name:value map
         List<ParameterPacketExtension> params = payloadType.getParameters();
@@ -138,6 +139,7 @@ public static MediaFormat payloadTypeToMediaFormat(
         //we don't seem to know anything about this format
         if(format == null)
         {
+            unknown = true;
             format =
                 JabberActivator.getMediaService().getFormatFactory().
                     createUnknownMediaFormat(MediaType.AUDIO);
@@ -160,7 +162,7 @@ public static MediaFormat payloadTypeToMediaFormat(
                 && (ptRegistry.findFormat(pt) == null))
             ptRegistry.addMapping(format, pt);
 
-        return format;
+        return (unknown == false) ? format : null;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/SourceUIContact.java
Patch:
@@ -121,9 +121,9 @@ public ImageIcon getAvatar(boolean isSelected, int width, int height)
     {
         byte[] image = sourceContact.getImage();
 
-        if (image != null)
+        if ((image != null) && (image.length > 0))
         {
-            ImageIcon icon = new ImageIcon();
+            ImageIcon icon = new ImageIcon(image);
 
             if (icon.getIconWidth() > width || icon.getIconHeight() > height)
             {

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -340,8 +340,6 @@ public void removeChat(ChatPanel chatPanel)
             this.mainPanel.remove(chatPanel);
 
             chatCount --;
-
-            return;
         }
 
         //in the case of a tabbed chat window
@@ -702,8 +700,10 @@ protected void close(boolean isEscaped)
         if(isEscaped)
         {
             ChatPanel chatPanel = getCurrentChat();
+
             ChatRightButtonMenu chatRightMenu
                 = chatPanel.getChatConversationPanel().getRightButtonMenu();
+
             ChatWritePanel chatWritePanel = chatPanel.getChatWritePanel();
             WritePanelRightButtonMenu writePanelRightMenu
                 = chatWritePanel.getRightButtonMenu();

File: src/net/java/sip/communicator/impl/netaddr/NetworkConfigurationWatcher.java
Patch:
@@ -192,7 +192,8 @@ && hasValidAddress(networkInterface))
                     isAfterStandby = false;
                 }
 
-                last = curr;
+                // save the last time that we checked
+                last = System.currentTimeMillis();
             } catch (SocketException e)
             {
                 logger.error("Error checking network interfaces", e);

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberAccountID.java
Patch:
@@ -91,7 +91,7 @@ public boolean isStunServerDiscoveryEnabled()
         return
             getAccountPropertyBoolean(
                     ProtocolProviderFactory.AUTO_DISCOVER_STUN,
-                    false);
+                    true);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1217,7 +1217,7 @@ protected void initialize(String screenname,
              */
             if (accountID.getAccountPropertyBoolean(
                     ProtocolProviderFactoryJabberImpl.IS_USE_JINGLE_NODES,
-                    false))
+                    true))
             {
                 supportedFeatures.add(URN_XMPP_JINGLE_NODES);
             }

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/IceConfigPanel.java
Patch:
@@ -1268,7 +1268,7 @@ protected void modifyJingleNodes(JingleNodeDescriptor jingleNode)
      */
     protected boolean isUseUPNP()
     {
-        return iceBox.isSelected();
+        return upnpBox.isSelected();
     }
 
     /**

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/AccountPanel.java
Patch:
@@ -208,6 +208,7 @@ String getUsername()
     void setUsername(String username)
     {
         userIDField.setText(username);
+        userIDField.setEnabled(false);
     }
 
     /**

File: src/net/java/sip/communicator/util/NetworkUtils.java
Patch:
@@ -1019,7 +1019,7 @@ private static boolean isMappedIPv4Addr(byte[] address)
     private static Lookup createLookup(String domain, int type)
         throws TextParseException
     {
-        Lookup lookup = new Lookup(domain, Type.SRV);
+        Lookup lookup = new Lookup(domain, type);
 
         //initiate our global parallel resolver if this is our first ever
         //DNS query.

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryServiceImpl.java
Patch:
@@ -651,7 +651,7 @@ private void writeCall( CallRecordImpl callRecord,
                     .getStartTime().getTime()));
                 callPeerEndTime.append(String.valueOf(item.getEndTime()
                     .getTime()));
-                callPeerStates.append(item.getState().getStateString());
+                callPeerStates.append(item.getState().getLocalizedStateString());
             }
 
             historyWriter.addRecord(new String[] {

File: src/net/java/sip/communicator/impl/gui/main/call/CallPeerAdapter.java
Patch:
@@ -66,7 +66,7 @@ public void peerStateChanged(CallPeerChangeEvent evt)
         CallPeerState newState = (CallPeerState) evt.getNewValue();
         CallPeerState oldState = (CallPeerState) evt.getOldValue();
 
-        String newStateString = sourcePeer.getState().getStateString();
+        String newStateString = sourcePeer.getState().getLocalizedStateString();
 
         // Play the dialing audio when in connecting and initiating call state.
         // Stop the dialing audio when we enter any other state.
@@ -97,8 +97,10 @@ else if (newState == CallPeerState.BUSY)
 
             // We start the busy sound only if we're in a simple call.
             if (!renderer.getCallDialog().isConference())
+            {
                 NotificationManager.fireNotification(
                     NotificationManager.BUSY_CALL);
+            }
         }
         else if (newState == CallPeerState.CONNECTING_INCOMING_CALL ||
             newState == CallPeerState.CONNECTING_INCOMING_CALL_WITH_MEDIA)

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -330,7 +330,7 @@ private Component createStatusBar()
         // stateLabel
         callStatusLabel.setForeground(Color.WHITE);
         dtmfLabel.setForeground(Color.WHITE);
-        callStatusLabel.setText(callPeer.getState().getStateString());
+        callStatusLabel.setText(callPeer.getState().getLocalizedStateString());
 
         PeerStatusPanel statusPanel = new PeerStatusPanel(new GridBagLayout());
 

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferencePeerPanel.java
Patch:
@@ -364,7 +364,7 @@ public void setErrorReason(String reason)
      */
     private void initStatusBar(CallPeer callPeer)
     {
-        this.setParticipantState(callPeer.getState().getStateString());
+        this.setParticipantState(callPeer.getState().getLocalizedStateString());
 
         this.addToStatusBar(securityStatusLabel);
         this.addToStatusBar(holdStatusLabel);

File: src/net/java/sip/communicator/impl/gui/main/menus/MainMenu.java
Patch:
@@ -45,7 +45,7 @@ private void addMenu(JMenu menu, String key)
 
         menu.setText(resources.getI18NString(key));
         menu.setMnemonic(resources.getI18nMnemonic(key));
-        menu.setOpaque(false);
+
         add(menu);
     }
 

File: src/net/java/sip/communicator/plugin/aimaccregwizz/FirstWizardPage.java
Patch:
@@ -42,7 +42,7 @@ public class FirstWizardPage
      */
     private final Component uinPassPanel;
 
-    private JTextField uinField = new JTextField();
+    private JTextField uinField = new TrimTextField();
 
     private JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/facebookaccregwizz/FirstWizardPage.java
Patch:
@@ -47,7 +47,7 @@ public class FirstWizardPage
 
     private JLabel usernameExampleLabel = new JLabel(USER_NAME_EXAMPLE);
 
-    private JTextField usernameField = new JTextField();
+    private JTextField usernameField = new TrimTextField();
 
     private JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/gibberishaccregwizz/FirstWizardPage.java
Patch:
@@ -45,7 +45,7 @@ public class FirstWizardPage
 
     private JLabel userIDExampleLabel = new JLabel(USER_NAME_EXAMPLE);
 
-    private JTextField userIDField = new JTextField();
+    private JTextField userIDField = new TrimTextField();
 
     private JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/FirstWizardPage.java
Patch:
@@ -50,7 +50,7 @@ public class FirstWizardPage
 
     private JLabel userIDExampleLabel = new JLabel(USER_NAME_EXAMPLE);
 
-    private JTextField userIDField = new JTextField();
+    private JTextField userIDField = new TrimTextField();
 
     private JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/icqaccregwizz/FirstWizardPage.java
Patch:
@@ -46,7 +46,7 @@ public class FirstWizardPage
     private JLabel passLabel
         = new JLabel(Resources.getString("service.gui.PASSWORD"));
 
-    private JTextField uinField = new JTextField();
+    private JTextField uinField = new TrimTextField();
 
     private JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/ircaccregwizz/FirstWizardPage.java
Patch:
@@ -80,7 +80,7 @@ public class FirstWizardPage
 
     private JLabel serverExampleLabel = new JLabel(SERVER_EXAMPLE);
 
-    private JTextField userIDField = new JTextField();
+    private JTextField userIDField = new TrimTextField();
 
     private JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/AccountPanel.java
Patch:
@@ -43,7 +43,7 @@ public class AccountPanel
 
     private final JLabel userIDExampleLabel = new JLabel(USER_NAME_EXAMPLE);
 
-    private final JTextField userIDField = new JTextField();
+    private final JTextField userIDField = new TrimTextField();
 
     private final JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/msnaccregwizz/FirstWizardPage.java
Patch:
@@ -46,7 +46,7 @@ public class FirstWizardPage
 
     private JLabel uinExampleLabel = new JLabel(USER_NAME_EXAMPLE);
 
-    private JTextField uinField = new JTextField();
+    private JTextField uinField = new TrimTextField();
 
     private JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/sip2sipaccregwizz/CreateSip2SipAccountForm.java
Patch:
@@ -36,7 +36,7 @@ public class CreateSip2SipAccountForm
     /**
      * The user name text field.
      */
-    private final JTextField usernameField = new JTextField();
+    private final JTextField usernameField = new TrimTextField();
 
     /**
      * The display name text field.

File: src/net/java/sip/communicator/plugin/sipaccregwizz/AccountPanel.java
Patch:
@@ -35,7 +35,7 @@ public class AccountPanel
 
     private final JPanel emptyPanel = new TransparentPanel();
 
-    private final JTextField userIDField = new JTextField();
+    private final JTextField userIDField = new TrimTextField();
 
     private final JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/sshaccregwizz/FirstWizardPage.java
Patch:
@@ -71,7 +71,7 @@ public class FirstWizardPage
 
     private JPanel emptyPanel9 = new TransparentPanel();
 
-    private JTextField userIDField = new JTextField();
+    private JTextField userIDField = new TrimTextField();
 
     private JTextField identityFileField = new JTextField(
         Resources.getString("plugin.sshaccregwizz.OPTIONAL"));

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/FirstWizardPage.java
Patch:
@@ -48,7 +48,7 @@ public class FirstWizardPage
 
     private JLabel uinExampleLabel = new JLabel(USER_NAME_EXAMPLE);
 
-    private JTextField userIDField = new JTextField();
+    private JTextField userIDField = new TrimTextField();
 
     private JPasswordField passField = new JPasswordField();
 

File: src/net/java/sip/communicator/plugin/zeroconfaccregwizz/FirstWizardPage.java
Patch:
@@ -56,7 +56,7 @@ public class FirstWizardPage
     private JLabel lastExampleLabel = new JLabel("Ex: Gates");
     private JLabel mailExampleLabel = new JLabel("Ex: Bill@microsoft.com");
 
-    private JTextField userIDField = new JTextField();
+    private JTextField userIDField = new TrimTextField();
     private JTextField firstField = new JTextField();
     private JTextField lastField = new JTextField();
     private JTextField mailField = new JTextField();

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -312,6 +312,9 @@ public ProtocolProviderService installAccount(
                             JingleNodeDescriptor.JN_PREFIX + serverIndex);
         }
 
+        accountProperties.put(ProtocolProviderFactory.IS_USE_UPNP,
+                String.valueOf(registration.isUseUPNP()));
+
         if (isModification)
         {
             providerFactory.modifyAccount(  protocolProvider,

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -277,9 +277,9 @@ private JComponent createTopComponent()
 
             MacUtils.makeWindowLeopardStyle(getRootPane());
 
-            macToolbarPanel.getComponent().setLayout(new BorderLayout(3, 3));
+            macToolbarPanel.getComponent().setLayout(new BorderLayout(5, 5));
             macToolbarPanel.getComponent()
-                .setBorder(BorderFactory.createEmptyBorder(3, 3, 3, 3));
+                .setBorder(BorderFactory.createEmptyBorder(3, 5, 3, 5));
             macToolbarPanel.disableBackgroundPainter();
             macToolbarPanel.installWindowDraggerOnWindow(this);
 
@@ -295,7 +295,7 @@ private JComponent createTopComponent()
         {
             JPanel panel = new TransparentPanel(new BorderLayout());
 
-            panel.setBorder(BorderFactory.createEmptyBorder(3, 3, 3, 3));
+            panel.setBorder(BorderFactory.createEmptyBorder(3, 5, 3, 5));
 
             topComponent = panel;
         }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -1255,7 +1255,7 @@ private void removeNonReadChatState()
     }
 
     private static class ToolbarPanel
-        extends JPanel
+        extends TransparentPanel
         implements Skinnable
     {
         private Image logoBgImage;

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberAccountID.java
Patch:
@@ -153,7 +153,7 @@ public boolean isJingleNodesAutoDiscoveryEnabled()
     {
         return getAccountPropertyBoolean(
                 ProtocolProviderFactory.AUTO_DISCOVER_JINGLE_NODES,
-                false);
+                true);
     }
 
     /**
@@ -167,6 +167,6 @@ public boolean isJingleNodesRelayEnabled()
     {
         return getAccountPropertyBoolean(
                 ProtocolProviderFactory.IS_USE_JINGLE_NODES,
-                false);
+                true);
     }
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/JingleNodesCandidate.java
Patch:
@@ -97,6 +97,7 @@ public JingleNodesCandidate(TransportAddress transportAddress,
      * @return the <tt>DatagramSocket</tt> associated with this
      * <tt>Candidate</tt>
      */
+    @Override
     public DatagramSocket getSocket()
     {
         if (socket == null)

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/FirstWizardPage.java
Patch:
@@ -334,7 +334,7 @@ public void loadAccount(ProtocolProviderService protocolProvider)
         String useJN =
             accountProperties.get(ProtocolProviderFactory.IS_USE_JINGLE_NODES);
         boolean isUseJN = Boolean.parseBoolean(
-                (useJN != null && useJN.length() != 0) ? useJN : "false");
+                (useJN != null && useJN.length() != 0) ? useJN : "true");
 
         iceConfigPanel.setUseJingleNodes(isUseJN);
 
@@ -344,7 +344,7 @@ public void loadAccount(ProtocolProviderService protocolProvider)
         boolean isUseAutoDiscoverJN = Boolean.parseBoolean(
                 (useAutoDiscoverJN != null &&
                         useAutoDiscoverJN.length() != 0) ?
-                                useAutoDiscoverJN : "false");
+                                useAutoDiscoverJN : "true");
 
         iceConfigPanel.setAutoDiscoverJingleNodes(isUseAutoDiscoverJN);
 

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/IceConfigPanel.java
Patch:
@@ -107,8 +107,8 @@ public IceConfigPanel()
         autoDiscoverBox.setSelected(true);
         defaultStunBox.setSelected(true);
 
-        //jnBox.setSelected(true);
-        //jnAutoDiscoverBox.setSelected(true);
+        jnBox.setSelected(true);
+        jnAutoDiscoverBox.setSelected(true);
 
         JPanel checkBoxPanel = new TransparentPanel(new GridLayout(0, 1));
         checkBoxPanel.add(iceBox);

File: src/net/java/sip/communicator/impl/protocol/sip/SipMessageFactory.java
Patch:
@@ -1036,7 +1036,8 @@ public Request createRegisterRequest(Address      addressOfRecord,
             .getMaxForwardsHeader();
 
         //create a host-only uri for the request uri header.
-        String domain = ((SipURI) toHeader.getAddress().getURI()).getHost();
+        String domain = protocolProvider.getAccountID().
+            getAccountPropertyString(ProtocolProviderFactory.SERVER_ADDRESS);
 
         //Request URI
         SipURI requestURI = protocolProvider.getAddressFactory()

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -413,6 +413,9 @@ else if(serverAddress == null &&
         }
         else
         {
+            accountProperties.put(ProtocolProviderFactory.PROXY_AUTO_CONFIG,
+                    Boolean.FALSE.toString());
+
             accountProperties.put(ProtocolProviderFactory.PROXY_ADDRESS,
                 registration.getProxy());
 

File: src/net/java/sip/communicator/impl/neomedia/MediaStreamImpl.java
Patch:
@@ -1372,7 +1372,9 @@ public void setFormat(MediaFormat format)
     {
         if(logger.isTraceEnabled())
             logger.trace("Changing format of stream " + hashCode()
-                + " from:" + getDeviceSession().getFormat()
+                // getDeviceSession().getFormat() will activate
+                // device in order to get its format
+                //+ " from:" + getDeviceSession().getFormat()
                 + " to:" + format);
 
         setAdvancedAttributes(format.getAdvancedAttributes());

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceParticipantPanel.java
Patch:
@@ -372,8 +372,10 @@ private void initTitleBar()
     /**
      * Overrides {@link JComponent#paintComponent(Graphics)} in order to
      * customize the background of this panel.
+     *
      * @param g the <tt>Graphics</tt> object used for painting
      */
+    @Override
     public void paintComponent(Graphics g)
     {
         super.paintComponent(g);

File: src/net/java/sip/communicator/impl/gui/main/call/SelectScreenDialog.java
Patch:
@@ -11,10 +11,10 @@
 import java.io.*;
 import java.util.List;
 
-import javax.media.*;
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
+import net.java.sip.communicator.service.neomedia.*;
 import net.java.sip.communicator.service.neomedia.device.*;
 import net.java.sip.communicator.service.neomedia.format.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopSharingServerJabberImpl.java
Patch:
@@ -300,7 +300,6 @@ public void enableRemoteControl(CallPeer callPeer)
         if(logger.isInfoEnabled())
             logger.info("Enable remote control");
 
-        System.out.println("remote control enabled");
         CallJabberImpl call = (CallJabberImpl)callPeer.getCall();
 
         if(call.getLocalInputEvtAware())
@@ -322,7 +321,6 @@ public void enableRemoteControl(CallPeer callPeer)
      */
     public void disableRemoteControl(CallPeer callPeer)
     {
-        System.out.println("remote control disabled");
         if(logger.isInfoEnabled())
             logger.info("Disable remote control");
 

File: src/net/java/sip/communicator/plugin/aimaccregwizz/FirstWizardPage.java
Patch:
@@ -303,9 +303,8 @@ public void pageBack() {}
     public void loadAccount(ProtocolProviderService protocolProvider)
     {
         AccountID accountID = protocolProvider.getAccountID();
-        String password =
-            accountID
-                .getAccountPropertyString(ProtocolProviderFactory.PASSWORD);
+        String password = AimAccRegWizzActivator.getAimProtocolProviderFactory()
+            .loadPassword(accountID);
 
         this.uinField.setEnabled(false);
         this.uinField.setText(accountID.getUserID());

File: src/net/java/sip/communicator/plugin/facebookaccregwizz/FirstWizardPage.java
Patch:
@@ -338,8 +338,9 @@ public void pageBack()
     public void loadAccount(ProtocolProviderService protocolProvider)
     {
         AccountID accountID = protocolProvider.getAccountID();
-        String password = accountID.getAccountProperties()
-            .get(ProtocolProviderFactory.PASSWORD);
+        String password =
+            FacebookAccRegWizzActivator.getFacebookProtocolProviderFactory()
+                .loadPassword(accountID);
 
         this.usernameField.setEnabled(false);
         this.usernameField.setText(accountID.getUserID());

File: src/net/java/sip/communicator/plugin/gibberishaccregwizz/FirstWizardPage.java
Patch:
@@ -266,8 +266,8 @@ public void loadAccount(ProtocolProviderService protocolProvider)
     {
         AccountID accountID = protocolProvider.getAccountID();
         String password =
-            accountID
-                .getAccountPropertyString(ProtocolProviderFactory.PASSWORD);
+            GibberishAccRegWizzActivator.getGibberishProtocolProviderFactory()
+                .loadPassword(accountID);
 
         this.userIDField.setEnabled(false);
         this.userIDField.setText(accountID.getUserID());

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/FirstWizardPage.java
Patch:
@@ -406,8 +406,8 @@ public void loadAccount(ProtocolProviderService protocolProvider)
         Map<String, String> accountProperties
             = accountID.getAccountProperties();
 
-        String password
-            = accountProperties.get(ProtocolProviderFactory.PASSWORD);
+        String password = GoogleTalkAccRegWizzActivator
+            .getGoogleTalkProtocolProviderFactory().loadPassword(accountID);
 
         this.userIDField.setEnabled(false);
         this.userIDField.setText(accountID.getUserID());

File: src/net/java/sip/communicator/plugin/icqaccregwizz/FirstWizardPage.java
Patch:
@@ -285,9 +285,8 @@ public void pageBack()
     public void loadAccount(ProtocolProviderService protocolProvider)
     {
         AccountID accountID = protocolProvider.getAccountID();
-        String password =
-            accountID
-                .getAccountPropertyString(ProtocolProviderFactory.PASSWORD);
+        String password = IcqAccRegWizzActivator.getIcqProtocolProviderFactory()
+            .loadPassword(accountID);
 
         this.uinField.setText(accountID.getUserID());
 

File: src/net/java/sip/communicator/plugin/ircaccregwizz/FirstWizardPage.java
Patch:
@@ -390,9 +390,8 @@ public void loadAccount(ProtocolProviderService protocolProvider)
     {
         AccountID accountID = protocolProvider.getAccountID();
 
-        String password =
-            accountID
-                .getAccountPropertyString(ProtocolProviderFactory.PASSWORD);
+        String password = IrcAccRegWizzActivator.getIrcProtocolProviderFactory()
+            .loadPassword(accountID);
 
         String server =
             accountID

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/FirstWizardPage.java
Patch:
@@ -255,8 +255,9 @@ public void loadAccount(ProtocolProviderService protocolProvider)
         Map<String, String> accountProperties
             = accountID.getAccountProperties();
 
-        String password
-            = accountProperties.get(ProtocolProviderFactory.PASSWORD);
+        String password =
+            JabberAccRegWizzActivator.getJabberProtocolProviderFactory()
+                .loadPassword(accountID);
 
         accountPanel.setRememberPassword(false);
         accountPanel.setUsername(accountID.getUserID());

File: src/net/java/sip/communicator/plugin/msnaccregwizz/FirstWizardPage.java
Patch:
@@ -260,9 +260,8 @@ public void pageBack()
     public void loadAccount(ProtocolProviderService protocolProvider)
     {
         AccountID accountID = protocolProvider.getAccountID();
-        String password =
-            accountID
-                .getAccountPropertyString(ProtocolProviderFactory.PASSWORD);
+        String password = MsnAccRegWizzActivator.getMsnProtocolProviderFactory()
+            .loadPassword(accountID);
 
         this.uinField.setText(accountID.getUserID());
 

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationForm.java
Patch:
@@ -305,8 +305,8 @@ public boolean commitPage(SIPAccountRegistration registration)
      */
     public void loadAccount(AccountID accountID)
     {
-        String password = accountID.getAccountPropertyString(
-            ProtocolProviderFactory.PASSWORD);
+        String password = SIPAccRegWizzActivator.getSIPProtocolProviderFactory()
+            .loadPassword(accountID);
 
         String serverAddress = accountID.getAccountPropertyString(
                     ProtocolProviderFactory.SERVER_ADDRESS);

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/FirstWizardPage.java
Patch:
@@ -258,9 +258,8 @@ public void pageBack()
     public void loadAccount(ProtocolProviderService protocolProvider)
     {
         AccountID accountID = protocolProvider.getAccountID();
-        String password =
-            accountID
-                .getAccountPropertyString(ProtocolProviderFactory.PASSWORD);
+        String password = YahooAccRegWizzActivator
+            .getYahooProtocolProviderFactory().loadPassword(accountID);
 
         this.userIDField.setEnabled(false);
         this.userIDField.setText(accountID.getUserID());

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/FirstWizardPage.java
Patch:
@@ -71,7 +71,7 @@ public FirstWizardPage(JabberAccountRegistrationWizard wizard)
      */
     private void init()
     {
-        JTabbedPane tabbedPane = new JTabbedPane();
+        JTabbedPane tabbedPane = new SIPCommTabbedPane(false, false);
 
         this.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
 

File: src/net/java/sip/communicator/service/protocol/StunServerDescriptor.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.service.protocol;
 
-import java.io.*;
 import java.util.*;
 
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/neomedia/ZrtpConfigurePanel.java
Patch:
@@ -88,11 +88,11 @@ public ZrtpConfigurePanel()
 
         JPanel checkBar = new TransparentPanel(new GridLayout(1,2));
         final JCheckBox trustedMitM
-            = new JCheckBox(
+            = new SIPCommCheckBox(
                     resources.getI18NString("impl.media.security.zrtp.TRUSTED"),
                     trusted);
         final JCheckBox sasSignature
-            = new JCheckBox(
+            = new SIPCommCheckBox(
                     resources.getI18NString(
                             "impl.media.security.zrtp.SASSIGNATURE"),
                     sasSign);

File: src/net/java/sip/communicator/impl/gui/utils/NotificationManager.java
Patch:
@@ -293,6 +293,8 @@ public static void stopSound(String eventType)
                 .getEventNotificationActionHandler(
                     eventType, NotificationService.ACTION_SOUND);
 
-        soundHandler.stop();
+        // There can be no sound action handler for this event type
+        if(soundHandler != null)
+            soundHandler.stop();
     }
 }

File: src/net/java/sip/communicator/impl/notification/CommandNotificationHandlerImpl.java
Patch:
@@ -45,6 +45,9 @@ public CommandNotificationHandlerImpl(String commandDescriptor)
      */
     public void execute()
     {
+        if(StringUtils.isNullOrEmpty(commandDescriptor, true))
+            return;
+
         try
         {
             Runtime.getRuntime().exec(commandDescriptor);

File: src/net/java/sip/communicator/impl/notification/SoundNotificationHandlerImpl.java
Patch:
@@ -8,6 +8,7 @@
 
 import net.java.sip.communicator.service.audionotifier.*;
 import net.java.sip.communicator.service.notification.*;
+import net.java.sip.communicator.util.*;
 
 /**
  * An implementation of the <tt>SoundNotificationHandlerImpl</tt> interface.
@@ -80,7 +81,8 @@ public void start()
         AudioNotifierService audioNotifService
             = NotificationActivator.getAudioNotifier();
 
-        if(audioNotifService == null)
+        if(audioNotifService == null
+            || StringUtils.isNullOrEmpty(soundFileDescriptor, true))
             return;
 
         audio = audioNotifService.createAudio(soundFileDescriptor);

File: src/net/java/sip/communicator/impl/neomedia/portaudio/PortAudio.java
Patch:
@@ -31,7 +31,7 @@ public final class PortAudio
 
     static
     {
-        System.loadLibrary("jportaudio");
+        System.loadLibrary("jnportaudio");
 
         try
         {
@@ -610,7 +610,7 @@ public static void PaStreamParameters_free(long streamParameters)
              * implementation.
              */
             logger.warn(
-                    "The JNI library jportaudio is out-of-date and needs to be"
+                    "The JNI library jnportaudio is out-of-date and needs to be"
                         + " recompiled.",
                     ulerr);
         }

File: src/net/java/sip/communicator/impl/packetlogging/PacketLoggingActivator.java
Patch:
@@ -317,6 +317,8 @@ static void setGlobalLoggingEnabled(boolean enabled)
             jabberLoggingEnabled = false;
             rtpLoggingEnabled = false;
         }
+
+        globalLoggingEnabled = enabled;
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h263p/JNIEncoder.java
Patch:
@@ -199,7 +199,6 @@ public synchronized void open()
 
         avcontext = FFmpeg.avcodec_alloc_context();
 
-        System.out.println("transmit " + width + "x" + height);
         FFmpeg.avcodeccontext_set_pix_fmt(avcontext, FFmpeg.PIX_FMT_YUV420P);
         FFmpeg.avcodeccontext_set_size(avcontext, width, height);
         FFmpeg.avcodeccontext_set_qcompress(avcontext, 0.6f);

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberAccountID.java
Patch:
@@ -106,6 +106,6 @@ public boolean isUseDefaultStunServer()
         return
             getAccountPropertyBoolean(
                     ProtocolProviderFactory.USE_DEFAULT_STUN_SERVER,
-                    false);
+                    true);
     }
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -1260,6 +1260,9 @@ private class ImageRetriever
             setDaemon(true);
         }
 
+        /**
+         * Thread entry point.
+         */
         public void run()
         {
             try

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -210,10 +210,10 @@ CallPeerJabberImpl createOutgoingCall(
 
         // we determine on which resource the remote user is connected if the
         // resource isn't already provided
-        String fullCalleeURI = null; //getFullCalleeURI(calleeAddress);
+        String fullCalleeURI = null;
 
         DiscoverInfo di = null;
-        int bestPriority = 0;
+        int bestPriority = -1;
 
         Iterator<Presence> it =
             getProtocolProvider().getConnection().getRoster().getPresences(

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -266,15 +266,15 @@ CallPeerJabberImpl createOutgoingCall(
         if(di != null)
         {
             if (logger.isInfoEnabled())
-                logger.info(fullCalleeURI + ": jingle supported ");
+                logger.info(calleeAddress + ": jingle supported ");
         }
         else
         {
             if (logger.isInfoEnabled())
                 logger.info(calleeAddress + ": jingle not supported ?");
             throw new OperationFailedException(
                     "Failed to create OutgoingJingleSession.\n"
-                        + fullCalleeURI + " does not support jingle",
+                        + calleeAddress + " does not support jingle",
                     OperationFailedException.INTERNAL_ERROR);
         }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerJabberImpl.java
Patch:
@@ -815,6 +815,7 @@ else if(senders == SendersEnum.none)
         try
         {
             getMediaHandler().reinitContent(remoteContent.getName(), senders);
+            getMediaHandler().start();
         }
         catch(Exception e)
         {

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -445,6 +445,7 @@ public void updateHoldButtonState()
         // hold of the peer menu in a conference call we need to update the
         // state of the call dialog hold button.
         this.holdButton.setSelected(isAllLocallyOnHold);
+        this.holdButton.setEnabled(true);
     }
 
     /**
@@ -530,7 +531,7 @@ public void enableButtons(boolean enable)
         // connected.
         dialButton.setEnabled(enable);
         conferenceButton.setEnabled(enable);
-        holdButton.setEnabled(enable);
+        //holdButton.setEnabled(enable);
         muteButton.setEnabled(enable);
         recordButton.setEnabled(enable);
         volumeControlButton.setEnabled(enable);

File: src/net/java/sip/communicator/impl/gui/main/call/CallPeerAdapter.java
Patch:
@@ -120,7 +120,6 @@ else if (newState == CallPeerState.CONNECTING_WITH_EARLY_MEDIA)
         }
         else if (newState == CallPeerState.CONNECTED)
         {
-            System.out.println("CONNECTED" + CallPeerState.isOnHold(oldState));
             if (!CallPeerState.isOnHold(oldState))
             {
                 NotificationManager

File: src/net/java/sip/communicator/impl/contactlist/MetaContactImpl.java
Patch:
@@ -437,7 +437,7 @@ else if (contactProvider.getOperationSet(operationSet) != null)
                         = capabilities.get(operationSet.getName());
 
                     if (capContacts == null
-                            || !capContacts.contains(defaultContact))
+                            || !capContacts.contains(protoContact))
                     {
                         continue;
                     }

File: src/net/java/sip/communicator/plugin/updatechecker/UpdateCheckActivator.java
Patch:
@@ -775,7 +775,8 @@ protected PasswordAuthentication getPasswordAuthentication()
                 else
                 {
                     AuthenticationWindow authWindow =
-                            new AuthenticationWindow("host", true, null);
+                            new AuthenticationWindow(
+                                getRequestingHost(), true, null);
 
                     userCredentials = new UserCredentials();
 

File: src/net/java/sip/communicator/impl/callhistory/CallRecordImpl.java
Patch:
@@ -18,6 +18,9 @@
 public class CallRecordImpl
     extends CallRecord
 {
+    /**
+     * The <tt>Call</tt> source of this record.
+     */
     private Call sourceCall = null;
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/RTPConnectorImpl.java
Patch:
@@ -102,7 +102,7 @@ public void addTarget(SessionAddress target)
      */
     public void close()
     {
-        if (dataOutputStream != null) 
+        if (dataOutputStream != null)
         {
             dataOutputStream.close();
             dataOutputStream = null;

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackSharing.java
Patch:
@@ -1134,7 +1134,7 @@ private boolean applyNonConformanceHacks(RequestEvent event)
             if(request.getMethod().equals(Request.NOTIFY)
                && request.getHeader(SubscriptionStateHeader.NAME) == null)
             {
-                return false;
+                return true;
             }
         }
         catch(Throwable ex)

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPanel.java
Patch:
@@ -9,7 +9,6 @@
 import java.awt.event.*;
 
 import javax.swing.*;
-import javax.swing.event.*;
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/protocol/AccountManagerImpl.java
Patch:
@@ -598,7 +598,6 @@ public void storeAccount(
                 // encrypt and store
                 if ((value != null)
                         && (value.length() != 0)
-                        && !credentialsStorage.isStoredEncrypted(accountPrefix)
                         && !credentialsStorage.storePassword(
                                 accountPrefix,
                                 value))

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1142,7 +1142,7 @@ protected void initialize(String screenname,
              */
             if (accountID.getAccountPropertyBoolean(
                     ProtocolProviderFactory.IS_USE_ICE,
-                    false))
+                    true))
             {
                 supportedFeatures.add(URN_XMPP_JINGLE_ICE_UDP_1);
             }

File: src/net/java/sip/communicator/service/contactsource/ContactDetail.java
Patch:
@@ -15,7 +15,7 @@
  * corresponding to a specific address (phone number, email, identifier, etc.),
  * which defines the different possible types of communication and the preferred
  * <tt>ProtocolProviderService</tt>s to go through.
- * 
+ *
  * <p>
  * Example: A <tt>ContactDetail</tt> could define two types of communication,
  * by declaring two supported operation sets
@@ -62,7 +62,7 @@ public class ContactDetail
     /**
      * Creates a <tt>ContactDetail</tt> by specifying the contact address,
      * corresponding to this detail.
-     * @param contactAddress
+     * @param contactAddress the contact address corresponding to this detail
      */
     public ContactDetail(String contactAddress)
     {

File: src/net/java/sip/communicator/service/contactsource/ContactSourceService.java
Patch:
@@ -15,6 +15,9 @@
  */
 public interface ContactSourceService
 {
+    /**
+     * Constants to identify <tt>ContactSource</tt> in call history.
+     */
     public static final String CALL_HISTORY = "CallHistory";
 
     /**

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetPersistentPresenceYahooImpl.java
Patch:
@@ -386,7 +386,7 @@ public void publishPresenceStatus(PresenceStatus status,
 
         try
         {
-            if(statusMessage != null)
+            if(statusMessage != null && statusMessage.length() != 0)
             {
                 boolean isAvailable = false;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetDesktopStreamingJabberImpl.java
Patch:
@@ -115,7 +115,6 @@ public Call createVideoCall(String uri)
         Call call = createOutgoingVideoCall(uri);
         size = (((VideoMediaFormat)((CallJabberImpl)call).getDefaultDevice(
                 MediaType.VIDEO).getFormat()).getSize());
-        System.out.println("dimension: " + size);
         return call;
     }
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -491,6 +491,9 @@ else if (!isSelected && videoButton.isSelected())
      */
     public void setDesktopSharingButtonSelected(boolean isSelected)
     {
+        if (logger.isTraceEnabled())
+            logger.trace("Desktop sharing enabled: " + isSelected);
+
         if (isSelected && !desktopSharingButton.isSelected())
             desktopSharingButton.setSelected(true);
         else if (!isSelected && desktopSharingButton.isSelected())

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistration.java
Patch:
@@ -40,7 +40,7 @@ public class SIPAccountRegistration
 
     private String serverPort = null;
 
-    private boolean proxyAutoConfigure = false;
+    private boolean proxyAutoConfigure = true;
 
     private String proxyPort = null;
 

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -2022,6 +2022,9 @@ void initOutboundProxy(SipAccountID accountID, int ix)
                 }
             }
 
+            if(proxySocketAddress == null)
+                throw new UnknownHostException();
+
             proxyAddress = proxySocketAddress.getAddress();
             proxyPort = proxySocketAddress.getPort();
 

File: src/net/java/sip/communicator/impl/protocol/zeroconf/BonjourService.java
Patch:
@@ -82,7 +82,7 @@ public BonjourService(int port,
                 .getOperationSet(OperationSetPersistentPresence.class);
 
         // Gaim
-        props.put("1st", acc.getFirst());
+        props.put("1st", (acc.getFirst() == null)? "":acc.getFirst());
         props.put("email", (acc.getMail() == null)? "":acc.getMail());
         props.put("jid", this.id);
         props.put("last", (acc.getLast() == null)?"":acc.getLast());
@@ -99,7 +99,7 @@ public BonjourService(int port,
 
         //XEP-0174 (Final paper)
         props.put("ext","");
-        props.put("nick", acc.getFirst());
+        props.put("nick", (acc.getFirst() == null)? this.id:acc.getFirst());
         props.put("ver", "1");
         props.put("node", "SIP Communicator");
 

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ProtocolProviderServiceZeroconfImpl.java
Patch:
@@ -248,7 +248,8 @@ public void unregister()
         RegistrationState oldState = currentRegistrationState;
         currentRegistrationState = RegistrationState.UNREGISTERED;
 
-        bonjourService.shutdown();
+        if(bonjourService != null)
+            bonjourService.shutdown();
 
         fireRegistrationStateChanged(
             oldState

File: src/net/java/sip/communicator/plugin/zeroconfaccregwizz/FirstWizardPage.java
Patch:
@@ -250,8 +250,7 @@ public void commitPage()
      */
     private void setNextButtonAccordingToUserID()
     {
-        if (userIDField.getText() == null || userIDField.getText().equals("")
-           || firstField.getText() == null || firstField.getText().equals(""))
+        if (userIDField.getText() == null || userIDField.getText().equals(""))
         {
             wizard.getWizardContainer().setNextFinishButtonEnabled(false);
         }
@@ -338,7 +337,7 @@ public void loadAccount(ProtocolProviderService protocolProvider)
 
     public Object getSimpleForm()
     {
-        JPanel simplePanel = new TransparentPanel(new BorderLayout());
+        JPanel simplePanel = new TransparentPanel(new BorderLayout(10, 10));
 
         simplePanel.add(userID, BorderLayout.WEST);
         simplePanel.add(userIDField, BorderLayout.CENTER);

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -1304,6 +1304,8 @@ public boolean isVisible()
      */
     public void setVisible(final boolean isVisible)
     {
+        ConfigurationManager.setApplicationVisible(isVisible);
+
         SwingUtilities.invokeLater(new Runnable(){
             public void run()
             {

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/speex/JNIEncoder.java
Patch:
@@ -413,7 +413,7 @@ public Format getOutputFormat()
         {
             AudioFormat outputAudioFormat = (AudioFormat) outputFormat;
 
-            setOutputFormat(
+            outputFormat = setOutputFormat(
                 new AudioFormat(
                             outputAudioFormat.getEncoding(),
                             outputAudioFormat.getSampleRate(),
@@ -425,6 +425,8 @@ public Format getOutputFormat()
                             outputAudioFormat.getFrameRate(),
                             outputAudioFormat.getDataType())
                         {
+                            private static final long serialVersionUID = 0L;
+
                             @Override
                             public long computeDuration(long length)
                             {

File: src/net/java/sip/communicator/impl/osdependent/OsDependentActivator.java
Patch:
@@ -60,7 +60,8 @@ public void start(BundleContext bc)
         {
             // Adds a MacOSX specific dock icon listener in order to show main
             // contact list window on dock icon click.
-            MacOSXDockIcon.addDockIconListener();
+            if (OSUtils.IS_MAC)
+                MacOSXDockIcon.addDockIconListener();
 
             // Create the notification service implementation
             SystrayService systrayService = new SystrayServiceJdicImpl();

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -20,7 +20,6 @@
 import net.java.sip.communicator.impl.gui.main.call.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
-import net.java.sip.communicator.impl.gui.main.contactlist.contactsource.*;
 import net.java.sip.communicator.impl.gui.main.menus.*;
 import net.java.sip.communicator.impl.gui.main.presence.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/gui/main/presence/message/NewStatusMessageDialog.java
Patch:
@@ -73,8 +73,6 @@ private void init()
             GuiActivator.getResources().getI18NString(
                 "service.gui.NEW_STATUS_MESSAGE"));
 
-        JTextField messageTextField = new JTextField();
-
         JPanel dataPanel
             = new TransparentPanel(new BorderLayout(5, 5));
 

File: src/net/java/sip/communicator/impl/gui/main/presence/message/StatusMessageMenu.java
Patch:
@@ -94,6 +94,9 @@ public void actionPerformed(ActionEvent e)
             dialog.setVisible(true);
 
             dialog.requestFocusInField();
+
+            // we will set status from the Status Message Dialog
+            return;
         }
         else if (menuItem.equals(busyMessageItem))
         {

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -533,7 +533,7 @@ public void enableButtons()
             }
 
             if (protocolProvider.getOperationSet(
-                OperationSetDesktopStreaming.class) != null)
+                OperationSetDesktopSharingServer.class) != null)
             {
                 desktopSharingButton.setEnabled(true);
             }

File: src/net/java/sip/communicator/impl/gui/main/call/DesktopSharingButton.java
Patch:
@@ -62,9 +62,9 @@ public void buttonPressed()
     {
         if (call != null)
         {
-            OperationSetDesktopStreaming desktopOpSet
+            OperationSetDesktopSharingServer desktopOpSet
                 = call.getProtocolProvider().getOperationSet(
-                        OperationSetDesktopStreaming.class);
+                        OperationSetDesktopSharingServer.class);
 
             // This shouldn't happen at this stage, because we disable the button
             // if the operation set isn't available.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MetaContactRightButtonMenu.java
Patch:
@@ -359,7 +359,7 @@ private void init()
                 }
 
                 if (protocolProvider.getOperationSet(
-                        OperationSetDesktopStreaming.class) != null)
+                        OperationSetDesktopSharingServer.class) != null)
                 {
                     desktopSharingMenu.add(
                         createMenuItem( contactDisplayName,
@@ -459,7 +459,7 @@ private void init()
             this.videoCallItem.setEnabled(false);
 
         if (metaContact.getDefaultContact(
-            OperationSetDesktopStreaming.class) == null)
+            OperationSetDesktopSharingServer.class) == null)
             this.desktopSharingItem.setEnabled(false);
 
         if (metaContact.getDefaultContact(

File: src/net/java/sip/communicator/impl/neomedia/codec/EncodingConfiguration.java
Patch:
@@ -177,6 +177,7 @@ public void initializeFormatPreferences()
         // audio
         setEncodingPreference("speex", 32000, 701);
         setEncodingPreference("speex", 16000, 700);
+        setEncodingPreference("G722", 8000 /* actually, 16 kHz */, 675);
         setEncodingPreference("PCMU", 8000, 650);
         setEncodingPreference("PCMA", 8000, 600);
         setEncodingPreference("iLBC", 8000, 500);
@@ -187,7 +188,6 @@ public void initializeFormatPreferences()
         setEncodingPreference("G723", 8000, 150);
         setEncodingPreference("G728", 8000, 100);
 
-        setEncodingPreference("G722", 8000, 0);
         setEncodingPreference("G729", 8000, 0 /* proprietary */);
 
         // enables by default telephone event(DTMF rfc4733), with lowest

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaUIContact.java
Patch:
@@ -24,7 +24,7 @@
  * @author Yana Stamcheva
  */
 public class MetaUIContact
-    implements  UIContact
+    implements UIContact
 {
     /**
      * The key of the user data in <tt>MetaContact</tt> which specifies

File: src/net/java/sip/communicator/impl/neomedia/NeomediaActivator.java
Patch:
@@ -156,7 +156,7 @@ public void start(BundleContext bundleContext)
                 getClass().getClassLoader(),
                 "impl.media.security.zrtp.CONF_ICON",
                 "service.gui.CALL",
-                1100),
+                0),
             securityProps);
 
         GatherEntropy entropy

File: src/net/java/sip/communicator/plugin/otr/OtrActivator.java
Patch:
@@ -168,7 +168,7 @@ public void start(BundleContext bc) throws Exception
                 "net.java.sip.communicator.plugin.otr.OtrConfigurationPanel",
                 getClass().getClassLoader(),
                 "plugin.otr.configform.ICON",
-                "service.gui.CHAT", 30),
+                "service.gui.CHAT", 1),
                 properties);
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactGroupJabberImpl.java
Patch:
@@ -112,7 +112,7 @@ public class ContactGroupJabberImpl
         {
             RosterEntry rEntry = groupMembers.next();
 
-            if(rEntry.getType() == RosterPacket.ItemType.none)
+            if(!ServerStoredContactListJabberImpl.isEntryDisplayable(rEntry))
                 continue;
 
             //only add the buddy if it doesn't already exist in some other group
@@ -445,7 +445,7 @@ void setResolved(RosterGroup source)
             // to our roster and this contacts are with subscription none.
             // if such already exist, remove it. This is typically our
             // own contact
-            if(item.getType() == RosterPacket.ItemType.none)
+            if(!ServerStoredContactListJabberImpl.isEntryDisplayable(item))
             {
                 if(contact != null)
                 {

File: src/net/java/sip/communicator/impl/gui/customcontrols/ErrorDialog.java
Patch:
@@ -137,7 +137,7 @@ public ErrorDialog( Frame owner,
     public ErrorDialog( Frame owner,
                         String title,
                         String message,
-                        Exception e)
+                        Throwable e)
     {
         this(owner, title, message);
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -673,7 +673,7 @@ else if (stringContact != null)
                         GuiActivator.getResources()
                             .getI18NString("service.gui.ERROR"),
                         exception.getMessage(),
-                        ErrorDialog.ERROR)
+                        exception)
                     .showDialog();
             }
         }

File: src/net/java/sip/communicator/plugin/provisioning/ProvisioningForm.java
Patch:
@@ -151,7 +151,9 @@ private void initButtonStates()
     {
         String provMethod = ProvisioningActivator.getProvisioningMethod();
         boolean isProvEnabled
-            = (provMethod != null && !provMethod.equals("NONE"));
+            = (provMethod != null
+                && provMethod.length() > 0
+                && !provMethod.equals("NONE"));
 
         enableCheckBox.setSelected(isProvEnabled);
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -3589,7 +3589,8 @@ protected void processActiveRequest(
         protected void processFailureResponse(
                 ResponseEvent responseEvent, int statusCode)
         {
-            logger.error("Cannot subscripe to presence watcher info!");
+            if(logger.isDebugEnabled())
+                logger.debug("Cannot subscripe to presence watcher info!");
         }
 
         /**

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicInstantMessagingSipImpl.java
Patch:
@@ -702,8 +702,8 @@ public boolean processRequest(RequestEvent requestEvent)
                     logger.debug("received a message from an unknown contact: "
                             + fromHeader.getAddress().getURI().toString());
                 //create the volatile contact
-                from = opSetPersPresence
-                    .createVolatileContact(fromHeader.getAddress());
+                from = opSetPersPresence.createVolatileContact(
+                            fromHeader.getAddress().getURI().toString());
             }
 
             // answer ok

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetTypingNotificationsSipImpl.java
Patch:
@@ -206,7 +206,7 @@ public boolean processMessage(RequestEvent requestEvent)
         {
             //create the volatile contact
             from = opSetPersPresence.createVolatileContact(
-                    fromHeader.getAddress());
+                    fromHeader.getAddress().getURI().toString());
         }
 
         // parse content

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -2803,6 +2803,9 @@ private void resolveAddresses(
             if(addressObj6 != null && !resultAddresses.contains(addressObj6))
                 resultAddresses.add(addressObj6);
         }
+
+        if(addressObj4 == null && addressObj6 == null)
+            logger.warn("No AAAA and A record found for " + address);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/model/commonpolicy/RuleType.java
Patch:
@@ -33,7 +33,7 @@ public class RuleType
     /**
      * The transformations element.
      */
-    private TransfomationsType transformations;
+    private TransformationsType transformations;
 
     /**
      * Gets the value of the conditions property.
@@ -80,7 +80,7 @@ public void setActions(ActionsType actions)
      *
      * @return the transformations property.
      */
-    public TransfomationsType getTransformations()
+    public TransformationsType getTransformations()
     {
         return transformations;
     }
@@ -90,7 +90,7 @@ public TransfomationsType getTransformations()
      *
      * @param transformations the uri to set.
      */
-    public void setTransformations(TransfomationsType transformations)
+    public void setTransformations(TransformationsType transformations)
     {
         this.transformations = transformations;
     }

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/model/commonpolicy/TransformationsType.java
Patch:
@@ -18,7 +18,7 @@
  *
  * @author Grigorii Balutsel
  */
-public class TransfomationsType
+public class TransformationsType
 {
     /**
      * The service-permissions element.

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/model/presrules/PresRulesParser.java
Patch:
@@ -150,11 +150,11 @@ public static Element elementFromActions(
      * @return the transfomations object.
      * @throws Exception if there is some error during parsing.
      */
-    public static TransfomationsType transformationsFromElement(
+    public static TransformationsType transformationsFromElement(
             Element element)
             throws Exception
     {
-        TransfomationsType transfomations = new TransfomationsType();
+        TransformationsType transfomations = new TransformationsType();
         if (!CommonPolicyParser.NAMESPACE
                 .equals(getNamespaceUri(element)) ||
                 !CommonPolicyParser.TRANSFORMATIONS_ELEMENT
@@ -236,7 +236,7 @@ else if (PROVIDE_PERSONS_ELEMENT.equals(localName))
      * @throws Exception if there is some error during creating.
      */
     public static Element elementFromTransfomations(
-            Document document, TransfomationsType transformations)
+            Document document, TransformationsType transformations)
             throws Exception
     {
         Element element = document.createElementNS(CommonPolicyParser.NAMESPACE,

File: src/net/java/sip/communicator/util/NetworkUtils.java
Patch:
@@ -821,7 +821,7 @@ public static InetSocketAddress getARecord(String domain, int port)
         }
         else
         {
-            logger.warn("No A record found for: " + domain);
+            //No A record found
             return null;
         }
     }
@@ -858,7 +858,7 @@ public static InetSocketAddress getAAAARecord(String domain, int port)
         }
         else
         {
-            logger.warn("No AAAA record found for: " + domain);
+            //"No AAAA record found
             return null;
         }
     }

File: test/net/java/sip/communicator/slick/protocol/sip/TestXCapParse.java
Patch:
@@ -296,7 +296,7 @@ private static void validatePresRules(RulesetType ruleset)
                 "The actions we set is not read properly",
                 actions.getAny().size() == 0);
         // transformations
-        TransfomationsType transfomations = rule.getTransformations();
+        TransformationsType transfomations = rule.getTransformations();
         assertNull(
                 "The transfomations we set is not read properly",
                 transfomations.getDevicePermission());

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -550,6 +550,7 @@ private void publishStatus(
 
     /**
      * Updates the status of the given <tt>protocolProvider</tt>.
+     *
      * @param protocolProvider the <tt>ProtocolProviderService</tt>
      * corresponding to the menu to update
      */
@@ -671,7 +672,7 @@ private void setSystrayIcon(int status)
             return;
 
         int imgType = SystrayService.SC_IMG_OFFLINE_TYPE;
-        
+
         if(status < PresenceStatus.ONLINE_THRESHOLD)
         {
             imgType = SystrayService.SC_IMG_OFFLINE_TYPE;

File: src/net/java/sip/communicator/impl/protocol/sip/SipStatusEnum.java
Patch:
@@ -108,7 +108,7 @@ public SipStatusEnum(String iconPath)
             loadIcon(iconPath + "/sip16x16-busy.png"));
 
         this.onThePhoneStatus = new SipPresenceStatus(
-            37,
+            31,
             ON_THE_PHONE,
             loadIcon(iconPath + "/sip16x16-phone.png"));
 

File: src/net/java/sip/communicator/impl/configuration/ConfigurationActivator.java
Patch:
@@ -34,7 +34,7 @@ public class ConfigurationActivator
 
     /**
      * Starts the configuration service
-     * 
+     *
      * @param bundleContext the <tt>BundleContext</tt> as provided by the OSGi
      * framework.
      * @throws Exception if anything goes wrong

File: src/net/java/sip/communicator/impl/neomedia/device/AudioMediaDeviceSession.java
Patch:
@@ -124,8 +124,6 @@ protected void processorControllerUpdate(ControllerEvent event)
      *
      * @param processor the processor on which track control we need
      * to register a level effect with.
-     * @throws UnsupportedPlugInException if we <tt>tc</tt> does not support
-     * effects.
      */
     protected void registerLocalUserAudioLevelEffect(Processor processor)
     {

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetMultiUserChatJabberImpl.java
Patch:
@@ -629,7 +629,8 @@ private class SmackInvitationRejectionListener
          * passes to it the chat room for which it will listen for rejection
          * events.
          *
-         * @param chatRoom
+         * @param chatRoom chat room for which this intance will listen for
+         * rejection events
          */
         public SmackInvitationRejectionListener(ChatRoom chatRoom)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/OutgoingFileTransferJabberImpl.java
Patch:
@@ -28,6 +28,9 @@ public class OutgoingFileTransferJabberImpl
     extends AbstractFileTransfer
     implements PacketInterceptor
 {
+    /**
+     * The logger of this class.
+     */
     private final Logger logger
         = Logger.getLogger(OutgoingFileTransferJabberImpl.class);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/UriHandlerJabberImpl.java
Patch:
@@ -27,6 +27,9 @@
 public class UriHandlerJabberImpl
     implements UriHandler, ServiceListener, AccountManagerListener
 {
+    /**
+     * The logger of this class.
+     */
     private static final Logger logger =
         Logger.getLogger(UriHandlerJabberImpl.class);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/WhiteboardSessionJabberImpl.java
Patch:
@@ -30,6 +30,9 @@ public class WhiteboardSessionJabberImpl
     implements  WhiteboardParticipantListener,
                 WhiteboardSession
 {
+    /**
+     * The logger of this class.
+     */
     private static final Logger logger =
         Logger.getLogger(WhiteboardSessionJabberImpl.class);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/DefaultPacketExtensionProvider.java
Patch:
@@ -16,6 +16,7 @@
  * A provider that parses incoming packet extensions into instances of the
  * {@link Class} that it has been instantiated for.
  *
+ * @param <C> Class that the packets we will be parsing belong to
  * @author Emil Ivov
  */
 public class DefaultPacketExtensionProvider<C extends AbstractPacketExtension>

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/geolocation/GeolocationJabberUtils.java
Patch:
@@ -21,6 +21,9 @@
  */
 public class GeolocationJabberUtils
 {
+    /**
+     * The logger of this class.
+     */
     private static final Logger logger =
         Logger.getLogger(GeolocationJabberUtils.class);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/geolocation/GeolocationPacketExtensionProvider.java
Patch:
@@ -21,7 +21,9 @@
 public class GeolocationPacketExtensionProvider
     implements PacketExtensionProvider
 {
-
+    /**
+     * The logger of this class.
+     */
     private static final Logger logger =
         Logger.getLogger(GeolocationPacketExtensionProvider.class);
 

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandlerSipImpl.java
Patch:
@@ -594,7 +594,6 @@ private String getUserName()
         return getPeer().getProtocolProvider().getAccountID().getUserID();
     }
 
-
     /**
      * Generates an SDP <tt>MediaDescription</tt> for <tt>MediaDevice</tt>
      * taking account the local streaming preference for the corresponding

File: src/net/java/sip/communicator/service/argdelegation/UriHandler.java
Patch:
@@ -23,6 +23,8 @@ public interface UriHandler
 
     /**
      * Returns the protocol that this handler is responsible for.
+     *
+     * @return protocol that this handler is responsible for
      */
     public String getProtocol();
 

File: src/net/java/sip/communicator/service/configuration/ConfigVetoableChangeListener.java
Patch:
@@ -10,7 +10,7 @@
 import java.beans.*;
 import java.util.EventListener;
 
-/*
+/**
  * This interface uses SC's own ProperteyVetoException.
  */
 public interface ConfigVetoableChangeListener extends EventListener
@@ -22,4 +22,4 @@ public interface ConfigVetoableChangeListener extends EventListener
    * @throws ConfigPropertyVetoException if the change is vetoed by the listener
    */
   void vetoableChange(PropertyChangeEvent e) throws ConfigPropertyVetoException;
-} 
+}

File: src/net/java/sip/communicator/service/neomedia/MediaService.java
Patch:
@@ -155,10 +155,10 @@ public MediaStream createMediaStream(StreamConnector connector,
     /**
      * Creates a new <tt>Recorder</tt> instance that can be used to record a
      * call which captures and plays back media using a specific
-     * <tt>MediaDevice</tt>. 
+     * <tt>MediaDevice</tt>.
      *
      * @param device the <tt>MediaDevice</tt> which is used for media capture
-     * and playback by the call to be recorded 
+     * and playback by the call to be recorded
      * @return a new <tt>Recorder</tt> instance that can be used to record a
      * call which captures and plays back media using the specified
      * <tt>MediaDevice</tt>

File: src/net/java/sip/communicator/service/neomedia/MediaUseCase.java
Patch:
@@ -32,7 +32,6 @@ public enum MediaUseCase
 
     /**
      * Name of this <tt>MediaUseCase</tt>.
-     *
      */
     private final String mediaUseCase;
 

File: src/net/java/sip/communicator/service/neomedia/device/ScreenDevice.java
Patch:
@@ -10,14 +10,14 @@
 
 /**
  * The <tt>ScreenDevice</tt> interface represent physical screen display.
- * 
+ *
  * @author Sebastien Vincent
  */
-public interface ScreenDevice 
+public interface ScreenDevice
 {
     /**
      * Get current resolution of <tt>ScreenDevice</tt> device.
-     * 
+     *
      * @return current resolution of the screen
      */
     public Dimension getSize();

File: src/net/java/sip/communicator/service/protocol/OperationSetWhiteboarding.java
Patch:
@@ -66,7 +66,7 @@ public List<WhiteboardSession> getCurrentlyJoinedWhiteboards(
      */
     public WhiteboardSession createWhiteboardSession(
             String sessionName,
-            Hashtable sessionProperties)
+            Hashtable<Object, Object> sessionProperties)
         throws OperationFailedException, OperationNotSupportedException;
 
     /**

File: src/net/java/sip/communicator/service/protocol/event/CallChangeEvent.java
Patch:
@@ -19,6 +19,9 @@
 public class CallChangeEvent
     extends java.beans.PropertyChangeEvent
 {
+    /**
+     * Serial version UID.
+     */
     private static final long serialVersionUID = 0L;
 
     /**

File: src/net/java/sip/communicator/service/protocol/event/CallReceivedEvent.java
Patch:
@@ -18,6 +18,9 @@
 public class CallReceivedEvent
     extends EventObject
 {
+    /**
+     * Serial version UID.
+     */
     private static final long serialVersionUID = 0L;
 
     public CallReceivedEvent(Call call)

File: src/net/java/sip/communicator/util/SortedProperties.java
Patch:
@@ -25,6 +25,8 @@ public class SortedProperties extends Properties
      * Get an enumeration of keys hold by the <tt>Properties</tt> object.
      * Contrary to the original <tt>Properties</tt> implementation, it forces
      * the keys to be sorted alphabetically.
+     *
+     * @return enumeration of the keys hold by the <tt>Properties</tt>.
      */
     public synchronized Enumeration<Object> keys()
     {

File: src/net/java/sip/communicator/util/xml/XMLException.java
Patch:
@@ -16,6 +16,9 @@
 public class XMLException
     extends Exception
 {
+    /**
+     * Serial version UID.
+     */
     private static final long serialVersionUID = 0L;
 
     /**

File: src/net/java/sip/communicator/plugin/updatechecker/Resources.java
Patch:
@@ -39,7 +39,8 @@ public static String getConfigString(String key)
             if (!configPropsFile.exists())
             {
                 if (logger.isInfoEnabled())
-                    logger.info("No config file specified for update checker. Disabling update checks");
+                    logger.info("No config file specified for update checker." +
+                            " Disabling update checks");
                 return null;
             }
 

File: src/net/java/sip/communicator/impl/neomedia/device/MediaDeviceSession.java
Patch:
@@ -1665,10 +1665,11 @@ protected void startProcessorInAccordWithDirection(Processor processor)
         {
             processor.start();
             if (logger.isTraceEnabled())
-                logger
-                    .trace(
+            {
+                logger.trace(
                         "Started Processor with hashCode "
                             + processor.hashCode());
+            }
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/RemoteCandidatePacketExtension.java
Patch:
@@ -25,5 +25,4 @@ public RemoteCandidatePacketExtension()
     {
         super(ELEMENT_NAME);
     }
-
 }

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetBasicInstantMessagingMsnImpl.java
Patch:
@@ -186,7 +186,7 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
                 MsnMessenger msnMessenger = msnProvider.getMessenger();
 
                 /*
-                 * FIXME What's the point of having to MsnMessageListener
+                 * FIXME What's the point of having two MsnMessageListener
                  * instances?
                  */
                 msnMessenger.addMessageListener(new MsnMessageListener());

File: src/net/java/sip/communicator/impl/protocol/rss/ProtocolProviderFactoryRssImpl.java
Patch:
@@ -163,7 +163,6 @@ public void modifyAccount(  ProtocolProviderService protocolProvider,
         throws NullPointerException
     {
         // TODO Auto-generated method stub
-
     }
 
     /**

File: src/net/java/sip/communicator/service/contactlist/event/MetaContactListListener.java
Patch:
@@ -131,10 +131,10 @@ public interface MetaContactListListener
      * Notifies this listener that the list of the <tt>OperationSet</tt>
      * capabilities of a <tt>MetaContact</tt> has changed.
      * 
-     * @param evt a <tt>ContactCapabilitiesEvent</tt> with ID
+     * @param evt a <tt>MetaContactCapabilitiesEvent</tt> with ID
      * {@link MetaContactCapabilitiesEvent#SUPPORTED_OPERATION_SETS_CHANGED}
-     * which specifies the <tt>Contact</tt> whose list of <tt>OperationSet</tt>
-     * capabilities has changed
+     * which specifies the <tt>MetaContact</tt> whose list of
+     * <tt>OperationSet</tt> capabilities has changed
      */
     public void metaContactCapabilitiesChanged(MetaContactCapabilitiesEvent evt);
 }

File: src/net/java/sip/communicator/service/neomedia/MediaService.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.service.neomedia;
 
-import java.awt.*;
 import java.util.*;
 import java.util.List;
 

File: src/net/java/sip/communicator/service/protocol/AbstractCall.java
Patch:
@@ -63,7 +63,7 @@ public int getCallPeerCount()
     /**
      * Returns the {@link Vector} containing {@link CallPeer}s currently
      * part of this call. This method should eventually be removed and code
-     * that is using it in the descendents should be brought here.
+     * that is using it in the descendants should be brought here.
      *
      * @return  the {@link Vector} containing {@link CallPeer}s currently
      * participating in this call.

File: src/net/java/sip/communicator/service/resources/SkinPack.java
Patch:
@@ -10,6 +10,7 @@
 
 /**
  * Default Skin Pack interface.
+ *
  * @author Adam Netocny
  */
 public interface SkinPack
@@ -18,7 +19,7 @@ public interface SkinPack
     /**
      * Default resource name.
      */
-    public String RESOURCE_NAME_DEFAULT_VALUE = "SkinPack";
+    public static final String RESOURCE_NAME_DEFAULT_VALUE = "SkinPack";
 
     /**
      * Returns a <tt>Map</tt>, containing all [key, value] pairs for image

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -2443,7 +2443,9 @@ private void updateContactIcon(ContactSipImpl contact, URI imageUri)
                     String errorMessage = String.format(
                             "Error while getting icon %1s for the contact %2s",
                             imageUri, contact.getUri());
-                    logger.error(errorMessage, e);
+                    logger.warn(errorMessage);
+                    if(logger.isDebugEnabled())
+                        logger.debug(errorMessage, e);
                 }
             }
             else

File: src/net/java/sip/communicator/impl/protocol/sip/SipRegistrarConnection.java
Patch:
@@ -55,7 +55,7 @@ public class SipRegistrarConnection
     * expire or otherwise put - the number of seconds we wait before re-
     * registering.
     */
-    public static final int DEFAULT_REGISTRATION_EXPIRATION = 3600;
+    public static final int DEFAULT_REGISTRATION_EXPIRATION = 600;
 
     /**
     * The amount of time (in seconds) that registration take to expire or

File: src/net/java/sip/communicator/plugin/dictaccregwizz/FirstWizardPage.java
Patch:
@@ -44,7 +44,7 @@ public class FirstWizardPage
     private JLabel hostExampleLabel = new JLabel("Ex: dict.org");
 
     private JLabel portLabel
-        = new JLabel(Resources.getString("plugin.dictaccregwizz.PORT"));
+        = new JLabel(Resources.getString("service.gui.PORT"));
 
     private JTextField hostField = new JTextField();
 

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/FirstWizardPage.java
Patch:
@@ -90,7 +90,7 @@ public class FirstWizardPage
     private JTextField serverField = new JTextField();
 
     private JLabel portLabel
-        = new JLabel(Resources.getString("plugin.jabberaccregwizz.PORT"));
+        = new JLabel(Resources.getString("service.gui.PORT"));
 
     private JTextField portField
         = new JTextField(
@@ -242,7 +242,7 @@ public void removeUpdate(DocumentEvent evt)
         {
             public void actionPerformed(ActionEvent evt)
             {
-                if (logger.isDebugEnabled())
+                if (logger.isDebugEnabled())
                     logger.debug("Reg OK");
 
                 /*
@@ -251,7 +251,7 @@ public void actionPerformed(ActionEvent evt)
                  */
                 FirstWizardPage.this.wizard.webSignup();
 
-                if (logger.isDebugEnabled())
+                if (logger.isDebugEnabled())
                     logger.debug("Reg End");
             }
         });

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/GoogleTalkAccountRegistrationWizard.java
Patch:
@@ -137,7 +137,7 @@ public Iterator<Map.Entry<String, String>> getSummary()
             registration.getServerAddress());
 
         summaryTable.put(
-            Resources.getString("plugin.jabberaccregwizz.PORT"),
+            Resources.getString("service.gui.PORT"),
             String.valueOf(registration.getPort()));
 
         summaryTable.put(

File: src/net/java/sip/communicator/plugin/iptelaccregwizz/IptelAccountRegistrationWizard.java
Patch:
@@ -43,6 +43,9 @@ public class IptelAccountRegistrationWizard
     public IptelAccountRegistrationWizard(WizardContainer wizardContainer)
     {
         super(wizardContainer);
+
+        getRegistration().setDefaultDomain("iptel.org");
+        getRegistration().setDefaultTransport("TCP");
     }
 
     /**

File: src/net/java/sip/communicator/plugin/ircaccregwizz/FirstWizardPage.java
Patch:
@@ -70,7 +70,7 @@ public class FirstWizardPage
         = new JLabel(Resources.getString("plugin.ircaccregwizz.HOST"));
 
     private JLabel port
-        = new JLabel(Resources.getString("plugin.ircaccregwizz.PORT"));
+        = new JLabel(Resources.getString("service.gui.PORT" + ":"));
 
     private JPanel emptyPanel = new TransparentPanel();
 

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/ConnectionPanel.java
Patch:
@@ -56,7 +56,7 @@ public class ConnectionPanel
     private final JTextField serverField = new JTextField();
 
     private final JLabel portLabel
-        = new JLabel(Resources.getString("plugin.jabberaccregwizz.PORT"));
+        = new JLabel(Resources.getString("service.gui.PORT"));
 
     private final JTextField portField
         = new JTextField(JabberAccountRegistration.DEFAULT_PORT);

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/IceConfigPanel.java
Patch:
@@ -77,7 +77,7 @@ private Component createAdditionalServersComponent()
 
         tableModel.addColumn(
             Resources.getString("plugin.jabberaccregwizz.IP_ADDRESS")
-            + "/" + Resources.getString("plugin.jabberaccregwizz.PORT"));
+            + "/" + Resources.getString("service.gui.PORT"));
         tableModel.addColumn(
             Resources.getString("plugin.jabberaccregwizz.SUPPORT_TURN"));
 
@@ -238,7 +238,7 @@ public StunConfigDialog()
             JLabel addressLabel = new JLabel(
                 Resources.getString("plugin.jabberaccregwizz.IP_ADDRESS"));
             JLabel portLabel = new JLabel(
-                Resources.getString("plugin.jabberaccregwizz.PORT"));
+                Resources.getString("service.gui.PORT"));
             JLabel usernameLabel = new JLabel(
                 Resources.getString("plugin.jabberaccregwizz.USERNAME"));
             JLabel passwordLabel = new JLabel(

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -134,7 +134,7 @@ public Iterator<Map.Entry<String,String>> getSummary()
             registration.getServerAddress());
 
         summaryTable.put(
-            Resources.getString("plugin.jabberaccregwizz.PORT"),
+            Resources.getString("service.gui.PORT"),
             String.valueOf(registration.getPort()));
 
         summaryTable.put(

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberNewAccountDialog.java
Patch:
@@ -66,7 +66,7 @@ public class JabberNewAccountDialog
             "plugin.jabberaccregwizz.PASSWORD_CONFIRM"));
 
     private JLabel portLabel
-        = new JLabel(Resources.getString("plugin.jabberaccregwizz.PORT"));
+        = new JLabel(Resources.getString("service.gui.PORT"));
 
     private JLabel westIconLabel = new JLabel();
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/MailThreadInfo.java
Patch:
@@ -601,7 +601,7 @@ private void parseSenders(XmlPullParser parser)
 
     /**
      * Creates an html description of all participant names in the thread.
-     * We try to do this in a GMail-like (although quite simplified) way:<br/>
+     * We try to do this in a Gmail-like (although quite simplified) way:<br/>
      * We print the whole name for a sole participant. <br/>
      * We print only the first names for more than one participant. <br/>
      * We print up to three names max. <br/>

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/MailboxQueryIQ.java
Patch:
@@ -11,7 +11,7 @@
 
 /**
  * A straightforward <tt>IQ</tt> extension. The <tt>QueryNotify</tt> object is
- * used to create queries for the GMail mail server. It creates a simple
+ * used to create queries for the Gmail mail server. It creates a simple
  * <tt>IQ</tt> packet which represents the query.
  *
  * @author Matthieu Helleringer

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -471,7 +471,7 @@ protected String getServerFromUserName(String userName)
     }
 
     /**
-     * Opens the GMail signup URI in the OS's default browser.
+     * Opens the Gmail signup URI in the OS's default browser.
      */
     public void webSignup()
     {

File: src/net/java/sip/communicator/util/Base64.java
Patch:
@@ -32,7 +32,6 @@
 
 import java.io.*;
 
-
 public class Base64
 {
     private static final Base64Encoder encoder = new Base64Encoder();

File: src/net/java/sip/communicator/util/GenericBuffer.java
Patch:
@@ -3,16 +3,15 @@
  * 
  * Distributable under LGPL license. See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.util;
 
 import java.util.*;
 
 /**
  * The GenericBuffer class provides a way to minimize the effort needed to
- * bufferize any kind of information. This class is particularly suited to
+ * buffer any kind of information. This class is particularly suited to
  * optimizations based on reusing already computed data.
- * 
+ *
  * @author Benoit Pradelle
  */
 public class GenericBuffer<T>

File: src/net/java/sip/communicator/util/Logger.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.util;
 
-import java.io.*;
 import java.util.logging.*;
 
 /**

File: src/net/java/sip/communicator/util/ScStdOut.java
Patch:
@@ -272,6 +272,4 @@ public void println()
         if(stdOutPrintingEnabled)
             super.println();
     }
-
-
 }

File: src/net/java/sip/communicator/util/launchutils/AEGetURLEventHandler.java
Patch:
@@ -4,12 +4,11 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.util.launchutils;
 
 /**
- * Registers as listener for Apple Event GURL.
- * And will handle any url comming from the os by passing it to LaunchArgHandler.
+ * Registers as listener for kAEGetURL AppleScript events.
+ * And will handle any url coming from the OS by passing it to LaunchArgHandler.
  *
  * @author Lubomir Marinov
  * @author Damian Minkov

File: src/net/java/sip/communicator/util/skin/Skinnable.java
Patch:
@@ -4,7 +4,6 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.util.skin;
 
 /**

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/IceConfigPanel.java
Patch:
@@ -115,9 +115,9 @@ public void actionPerformed(ActionEvent e)
                                     stunServer.getAddress(),
                                     stunServer.getPort(),
                                     stunServer.isTurnSupported(),
-                                    StunServerDescriptor.getUTF8String(
+                                    StringUtils.getUTF8String(
                                                     stunServer.getUsername()),
-                                    StunServerDescriptor.getUTF8String(
+                                    StringUtils.getUTF8String(
                                                     stunServer.getPassword()));
 
                     dialog.setVisible(true);

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableUI.java
Patch:
@@ -287,9 +287,7 @@ public Component getTableCellRendererComponent(
             OperationSetPresence presence
                 = pps.getOperationSet(OperationSetPresence.class);
 
-            this.setText(pps.getAccountID().getDisplayName());
-
-            if(presence.getPresenceStatus() != null)
+            if(presence != null)
             {
                 byte[] protocolStatusImage =
                     presence.getPresenceStatus().getStatusIcon();
@@ -304,6 +302,8 @@ public Component getTableCellRendererComponent(
                 }
             }
 
+            this.setText(pps.getAccountID().getDisplayName());
+
             if(isSelected)
                 this.setBackground(table.getSelectionBackground());
             else

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaUIContact.java
Patch:
@@ -273,8 +273,7 @@ public ImageIcon getAvatar(
         // If the avatar isn't available or it's not up-to-date, create it.
         if (avatar == null)
         {
-            avatar
-                = ImageUtils.getScaledRoundedIcon(avatarBytes, width, height);
+            avatar = ImageUtils.getScaledRoundedIcon(avatarBytes, width, height);
         }
 
         // Cache the avatar in case it has changed.

File: src/net/java/sip/communicator/impl/replacement/dailymotion/ReplacementServiceDailymotionImpl.java
Patch:
@@ -59,7 +59,6 @@ public ReplacementServiceDailymotionImpl()
      */
     public String getReplacedMessage(final String chatString)
     {
-
         final Pattern p =
             Pattern.compile(DAILYMOTION_PATTERN, Pattern.CASE_INSENSITIVE
                 | Pattern.DOTALL);

File: src/net/java/sip/communicator/impl/resources/util/SkinJarBuilder.java
Patch:
@@ -347,7 +347,6 @@ else if (f.getName().equals("styles"))
                         styles = true;
                     }
                 }
-
             }
             else
             {

File: src/net/java/sip/communicator/service/replacement/ReplacementService.java
Patch:
@@ -5,8 +5,6 @@
  */
 package net.java.sip.communicator.service.replacement;
 
-import java.util.*;
-
 /**
  * A service used to provide substitution for any text in chat messages, like
  * smileys, video and image previews, etc.
@@ -29,7 +27,7 @@ public interface ReplacementService
      *         in case of no match.
      */
     public String getReplacedMessage(String chatString);
-    
+
     /**
      * Returns the name of the replacement source.
      * 

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -614,8 +614,6 @@ else if(state == ConnectState.STOP_TRYING)
 
                     }catch(XMPPException ex)
                     {
-                        if(isAuthenticationFailed(ex))
-                            throw ex;
                         // server disconnect us after such an error
                         // cleanup
                         disconnectAndCleanConnection();

File: src/net/java/sip/communicator/service/protocol/event/AccountManagerEvent.java
Patch:
@@ -45,7 +45,8 @@ public class AccountManagerEvent
      * 
      * @param accountManager the <code>AccountManager</code> issuing the
      *            notification i.e. the source of the event
-     * @param type
+     * @param type the type of the event which is one of
+     * {@link #STORED_ACCOUNTS_LOADED}
      * @param factory the <code>ProtocolProviderFactory</code> being worked on
      *            at the time this event has been fired
      */

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryServiceImpl.java
Patch:
@@ -719,7 +719,7 @@ private void handleProviderAdded(ProtocolProviderService provider)
             logger.debug("Adding protocol provider " + provider.getProtocolName());
 
         // check whether the provider has a basic telephony operation set
-        OperationSetBasicTelephony opSetTelephony
+        OperationSetBasicTelephony<?> opSetTelephony
             = provider.getOperationSet(OperationSetBasicTelephony.class);
 
         if (opSetTelephony != null)
@@ -741,7 +741,7 @@ private void handleProviderAdded(ProtocolProviderService provider)
      */
     private void handleProviderRemoved(ProtocolProviderService provider)
     {
-        OperationSetBasicTelephony opSetTelephony
+        OperationSetBasicTelephony<?> opSetTelephony
             = provider.getOperationSet(OperationSetBasicTelephony.class);
 
         if (opSetTelephony != null)

File: src/net/java/sip/communicator/impl/gui/main/account/EmptyAccountRegistrationWizardPage.java
Patch:
@@ -76,15 +76,15 @@ private void initComponents()
     /**
      * Returns the <tt>JPanel</tt> that contains the message prompting the user
      * to select a protocol.
-     * 
+     *
      * @return the <tt>JPanel</tt> that contains the message prompting the user
      * to select a protocol.
      */
     public Object getSimpleForm()
     {
         return mainPanel;
     }
-    
+
     /**
      * Implements the <code>WizardPage.getIdentifier</code> to return this
      * page identifier.

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -88,7 +88,7 @@ public class CallDialog
 
     /**
      * The button which allows starting and stopping the recording of the
-     * {@link #call}. 
+     * {@link #call}.
      */
     private RecordButton recordButton;
 

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -83,7 +83,7 @@ public void actionPerformed(ActionEvent evt)
         {
             Iterator<? extends CallPeer> peers = call.getCallPeers();
             boolean on = isSelected();
-            OperationSetBasicTelephony telephony
+            OperationSetBasicTelephony<?> telephony
                 = call.getProtocolProvider().getOperationSet(
                         OperationSetBasicTelephony.class);
 

File: src/net/java/sip/communicator/impl/gui/main/call/MuteButton.java
Patch:
@@ -73,7 +73,7 @@ public void actionPerformed(ActionEvent evt)
     {
         if (call != null)
         {
-            OperationSetBasicTelephony telephony
+            OperationSetBasicTelephony<?> telephony
                 = call.getProtocolProvider().getOperationSet(
                         OperationSetBasicTelephony.class);
 

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -56,7 +56,7 @@ public ReceivedCallDialog(Call call)
 
         this.initComponents();
 
-        OperationSetBasicTelephony telephonyOpSet
+        OperationSetBasicTelephony<?> telephonyOpSet
             = call.getProtocolProvider()
                 .getOperationSet(OperationSetBasicTelephony.class);
 

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallButton.java
Patch:
@@ -47,7 +47,7 @@ public TransferCallButton(Call c)
         setToolTipText(GuiActivator.getResources().getI18NString(
             "service.gui.TRANSFER_BUTTON_TOOL_TIP"));
 
-        OperationSetAdvancedTelephony telephony =
+        OperationSetAdvancedTelephony<?> telephony =
             call.getProtocolProvider()
                 .getOperationSet(OperationSetAdvancedTelephony.class);
 
@@ -75,7 +75,7 @@ public void actionPerformed(ActionEvent evt)
      */
     private void transferCall()
     {
-        OperationSetAdvancedTelephony telephony
+        OperationSetAdvancedTelephony<?> telephony
             = call.getProtocolProvider()
                 .getOperationSet(OperationSetAdvancedTelephony.class);
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/DefaultTreeContactList.java
Patch:
@@ -135,9 +135,9 @@ else if (element instanceof GroupNode)
             tip = new ExtendedTooltip(true);
             tip.setTitle(group.getDisplayName());
         }
-        else if (element instanceof ChatContact)
+        else if (element instanceof ChatContact<?>)
         {
-            ChatContact chatContact = (ChatContact) element;
+            ChatContact<?> chatContact = (ChatContact<?>) element;
 
             ImageIcon avatarImage = chatContact.getAvatar();
 

File: src/net/java/sip/communicator/impl/neomedia/RTPConnectorOutputStream.java
Patch:
@@ -279,7 +279,7 @@ private class MaxPacketsPerMillisPolicy
         /**
          * The maximum number of RTP packets to be sent by this
          * <tt>OutputDataStream</tt> through its <tt>DatagramSocket</tt> per
-         * {@link #perMillis} milliseconds.
+         * {@link #perNanos} nanoseconds.
          */
         private int maxPackets = -1;
 
@@ -371,7 +371,7 @@ synchronized void close()
 
         /**
          * Sends the RTP packets in {@link #packetQueue} in accord with
-         * {@link #maxPackets} and {@link #perMillis}.
+         * {@link #maxPackets} and {@link #perNanos}.
          */
         private void runInSendThread()
         {

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/Utils.java
Patch:
@@ -28,7 +28,8 @@ public class Utils
      * @return a short array, or <code>null</code> if byteArray is of zero
      *    length
      *
-     * @throws java.lang.ArrayIndexOutOfBoundsException
+     * @throws java.lang.ArrayIndexOutOfBoundsException if the array is too
+     * small to fill data
      */
     public static short[] byteToShortArray
         (byte[] byteArray, int offset, int length, boolean little)

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/alaw/Packetizer.java
Patch:
@@ -19,6 +19,9 @@
 public class Packetizer
     extends AudioPacketizer
 {
+    /**
+     * Constructs a new ALAW packetizer.
+     */
     public Packetizer()
     {
         packetSize = 160;

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/AbstractPullBufferStream.java
Patch:
@@ -155,8 +155,8 @@ public long getContentLength()
     }
 
     /**
-     * Implements {@link Controls#getControls()}. Gets the controls available
-     * for this instance.
+     * Implements {@link javax.media.protocol.Controls#getControls()}. Gets the
+     * controls available for this instance.
      *
      * @return an array of <tt>Object</tt>s which represent the controls
      * available for this instance

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/AbstractPushBufferCaptureDevice.java
Patch:
@@ -411,8 +411,8 @@ public Object getControl(String controlType)
     }
 
     /**
-     * Implements {@link Controls#getControls()}. Gets the controls available
-     * for this instance.
+     * Implements {@link javax.media.protocol.Controls#getControls()}. Gets the
+     * controls available for this instance.
      *
      * @return an array of <tt>Object</tt>s which represent the controls
      * available for this instance

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/AbstractPushBufferStream.java
Patch:
@@ -161,8 +161,8 @@ public long getContentLength()
     }
 
     /**
-     * Implements {@link Controls#getControls()}. Gets the controls available
-     * for this instance.
+     * Implements {@link javax.media.protocol.Controls#getControls()}. Gets the
+     * controls available for this instance.
      *
      * @return an array of <tt>Object</tt>s which represent the controls
      * available for this instance

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetGeolocationJabberImpl.java
Patch:
@@ -32,7 +32,9 @@
 public class OperationSetGeolocationJabberImpl
     implements OperationSetGeolocation
 {
-
+    /**
+     * Our logger.
+     */
     private static final Logger logger =
         Logger.getLogger(OperationSetGeolocationJabberImpl.class);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -205,7 +205,7 @@ private void fireGroupEvent(ContactGroupJabberImpl group, int eventID)
          */
         if(eventID == ServerStoredGroupEvent.GROUP_CREATED_EVENT)
         {
-            Iterator iter = group.contacts();
+            Iterator<Contact> iter = group.contacts();
             while (iter.hasNext())
             {
                 ContactJabberImpl c = (ContactJabberImpl)iter.next();
@@ -663,7 +663,7 @@ void removeContact(ContactJabberImpl contactToRemove)
                 else if(err.getCode() > 500)
                     errorCode = OperationFailedException.INTERNAL_SERVER_ERROR;
 
-                errTxt = err.getCondition();                
+                errTxt = err.getCondition();
             }
 
             throw new OperationFailedException(errTxt, errorCode, ex);

File: src/net/java/sip/communicator/impl/protocol/rss/ProtocolProviderFactoryRssImpl.java
Patch:
@@ -159,7 +159,7 @@ public void modifyAccount(  ProtocolProviderService protocolProvider,
         throws NullPointerException
     {
         // TODO Auto-generated method stub
-        
+
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/rss/RssFeedReader.java
Patch:
@@ -195,13 +195,13 @@ public String getNoNewFeedString()
     private String getNewsAbstract(SyndEntry syndEntry)
     {
         StringBuffer newsAbstract = new StringBuffer();
-        List contents;
+        List<?> contents;
 
         // get item contents
         contents = syndEntry.getContents();
         if (!contents.isEmpty())
         {
-            Iterator it = contents.iterator();
+            Iterator<?> it = contents.iterator();
             while (it.hasNext())
             {
                 newsAbstract.append(((SyndContent)it.next()).getValue());

File: src/net/java/sip/communicator/plugin/defaultresourcepack/DefaultLanguagePackImpl.java
Patch:
@@ -37,7 +37,7 @@ public class DefaultLanguagePackImpl
     public DefaultLanguagePackImpl()
     {
         // Finds all the files *.properties in the path : /resources/languages.
-        Enumeration fsEnum = DefaultResourcePackActivator.bundleContext.getBundle().
+        Enumeration<?> fsEnum = DefaultResourcePackActivator.bundleContext.getBundle().
                 findEntries("/resources/languages", "*.properties", false);
 
         while (fsEnum.hasMoreElements())

File: src/net/java/sip/communicator/plugin/pluginmanager/PluginTableModel.java
Patch:
@@ -14,7 +14,7 @@
 
 /**
  * The <tt>TableModel</tt> of the table containing all plug-ins.
- * 
+ *
  * @author Yana Stamcheva
  */
 public class PluginTableModel
@@ -200,7 +200,7 @@ private void refreshSortedBundlesList()
         {
             for(Bundle b : list)
             {
-                Dictionary headers = b.getHeaders();
+                Dictionary<?, ?> headers = b.getHeaders();
                 if(headers.get(Constants.BUNDLE_ACTIVATOR)!=null)
                 {
                     if(!headers.get(Constants.BUNDLE_ACTIVATOR).toString()

File: src/net/java/sip/communicator/plugin/skinmanager/SkinTableModel.java
Patch:
@@ -145,7 +145,7 @@ private void refreshSortedBundlesList()
         {
             for (Bundle b : list)
             {
-                Dictionary headers = b.getHeaders();
+                Dictionary<?, ?> headers = b.getHeaders();
                 if (headers.get(Constants.BUNDLE_ACTIVATOR) != null)
                 {
                     if (headers.get(Constants.BUNDLE_ACTIVATOR).toString()

File: src/net/java/sip/communicator/service/contactlist/event/MetaContactModifiedEvent.java
Patch:
@@ -19,11 +19,11 @@ public class MetaContactModifiedEvent
      * Name of the modification.
      */
     private String modificationName;
-    
+
     /**
      * Creates an instance of this event using the specified arguments.
      * @param source the <tt>MetaContact</tt> that this event is about.
-     * @param modificationName name of the modifiaction
+     * @param modificationName name of the modification
      * @param oldValue the new value for the modification of this meta contact.
      * @param newValue the old value for the modification of this meta contact.
      */
@@ -35,7 +35,7 @@ public MetaContactModifiedEvent(MetaContact source,
         super(source, META_CONTACT_MODIFIED, oldValue, newValue);
         this.modificationName = modificationName;
     }
-    
+
     /**
      * Returns the modification name of the source meta contact.
      * @return the modification name for the meta contact.

File: src/net/java/sip/communicator/service/geolocation/GeolocationService.java
Patch:
@@ -25,7 +25,7 @@ public interface GeolocationService
      * @return the last <tt>Geolocation</tt> that we have set by a geolocation
      * backend.
      */
-    public Map getCurrentGeolocation();
+    public Map<String, String> getCurrentGeolocation();
 
     /**
      * Registers a listener that would get notifications any time the provider
@@ -40,7 +40,8 @@ public interface GeolocationService
      * Remove a listener that would get notifications any time the provider
      * geolocation was succesfully refreshed.
      *
-     * @param listener
+     * @param listener the <tt>ProviderGeolocationPresenceListener</tt> to
+     * remove
      */
     public void removeGeolocationListener(GeolocationListener listener);
 }

File: src/net/java/sip/communicator/service/protocol/ActiveCallsRepository.java
Patch:
@@ -20,7 +20,7 @@
  * @author Emil Ivov
  */
 public abstract class ActiveCallsRepository<T extends Call,
-                                   U extends OperationSetBasicTelephony>
+        U extends OperationSetBasicTelephony<? extends ProtocolProviderService>>
     extends CallChangeAdapter
 {
     /**

File: src/net/java/sip/communicator/service/protocol/event/GeolocationEvent.java
Patch:
@@ -32,7 +32,7 @@ public class GeolocationEvent
     /**
      * The new location of the contact that has caused this event.
      */
-    private Map newLocation = null;
+    private Map<String, String> newLocation = null;
 
     /**
      * Creates an event instance indicating that the specified source contact
@@ -45,7 +45,7 @@ public class GeolocationEvent
      */
     public GeolocationEvent(Contact                 sourceContact,
                             ProtocolProviderService sourceProvider,
-                            Map                     newLocation,
+                            Map<String, String>     newLocation,
                             OperationSetGeolocation geolocationOpSet)
     {
         super(geolocationOpSet);
@@ -81,7 +81,7 @@ public Contact getSourceContact()
      * @return geolocation stored into a Map indicating the current location
      * of the source Contact at the moment the event was dispatched.
      */
-    public Map getNewLocation()
+    public Map<String, String> getNewLocation()
     {
         return newLocation;
     }

File: src/net/java/sip/communicator/service/protocol/media/AbstractOperationSetBasicTelephony.java
Patch:
@@ -148,13 +148,12 @@ public void setMute(Call call, boolean mute)
      * the new <tt>Recorder</tt> for the specified <tt>call</tt>
      * @see OperationSetBasicTelephony#createRecorder(Call)
      */
-    @SuppressWarnings("rawtypes")
     public Recorder createRecorder(Call call)
         throws OperationFailedException
     {
         return
-            (call instanceof MediaAwareCall)
-                ? ((MediaAwareCall) call).createRecorder()
+            (call instanceof MediaAwareCall<?, ?, ?>)
+                ? ((MediaAwareCall<?, ?, ?>) call).createRecorder()
                 : null;
     }
 }

File: test/net/java/sip/communicator/slick/runner/ScTestRunner.java
Patch:
@@ -35,7 +35,7 @@ public ScTestRunner(XmlFormatter printer)
     /**
      * Runs a suite extracted from a TestCase subclass.
      */
-    static public void run(Class testClass, XmlFormatter fmtr)
+    static public void run(Class<? extends Test> testClass, XmlFormatter fmtr)
     {
         run(new TestSuite(testClass), fmtr);
     }

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerJabberImpl.java
Patch:
@@ -411,7 +411,10 @@ public void putOnHold(boolean onHold)
         if(onHold)
             type = SessionInfoType.hold;
         else
+        {
             type = SessionInfoType.unhold;
+            getMediaHandler().reinitAllContents();
+        }
 
         //we are now on hold and need to realize this before potentially
         //spoling it all with an exception while sending the packet :).

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -532,6 +532,7 @@ public void processAck(ServerTransaction serverTransaction, Request ack)
         if (!CallPeerState.isOnHold(peerState))
         {
             setState(CallPeerState.CONNECTED);
+            getMediaHandler().start();
 
             // as its connected, set initial mute status,
             // corresponding call status
@@ -656,6 +657,7 @@ public void processInviteOK(ClientTransaction clientTransaction,
         if (!CallPeerState.isOnHold(getState()))
         {
             setState(CallPeerState.CONNECTED);
+            getMediaHandler().start();
 
             // as its connected, set initial mute status,
             // corresponding call status

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -3176,7 +3176,7 @@ protected void processSuccessResponse(
 
         /**
          * Implements the corresponding <tt>SipListener</tt> method by
-         * terminating the corresponding subsctiption and polling the related
+         * terminating the corresponding subscription and polling the related
          * contact.
          *
          * @param requestEvent the event containing the request that was \

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -613,8 +613,8 @@ public Object construct() throws Exception
                    ReplacementService source = entry.getValue();
 
                    if (!(GuiActivator.getConfigurationService().getBoolean(
-                       ReplacementProperty.getPropertyName(entry
-                           .getKey()), true) && (isEnabled || entry.getKey()
+                       ReplacementProperty.getPropertyName(source
+                       .getSourceName()), true) && (isEnabled || entry.getKey()
                        .equals("SMILEY"))))
                        continue;
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -613,7 +613,7 @@ public Object construct() throws Exception
                    ReplacementService source = entry.getValue();
 
                    if (!(GuiActivator.getConfigurationService().getBoolean(
-                       ReplacementProperty.getPropertyName((String) entry
+                       ReplacementProperty.getPropertyName(entry
                            .getKey()), true) && (isEnabled || entry.getKey()
                        .equals("SMILEY"))))
                        continue;

File: src/net/java/sip/communicator/impl/neomedia/codec/EncodingConfiguration.java
Patch:
@@ -70,13 +70,13 @@ public class EncodingConfiguration
             "net.java.sip.communicator.impl.neomedia.codec.video.h264.JNIDecoder",
             "net.java.sip.communicator.impl.neomedia.codec.video.h264.JNIEncoder",
             "net.java.sip.communicator.impl.neomedia.codec.video.h264.Packetizer",
-            //"net.java.sip.communicator.impl.neomedia.codec.video.ImageScaler",
             "net.java.sip.communicator.impl.neomedia.codec.video.SwScaler",
             "net.java.sip.communicator.impl.neomedia.codec.audio.speex.JNIEncoder",
             "net.java.sip.communicator.impl.neomedia.codec.audio.speex.JNIDecoder",
             SPEEX_RESAMPLER,
             "net.java.sip.communicator.impl.neomedia.codec.audio.speex.JavaEncoder",
             "net.java.sip.communicator.impl.neomedia.codec.audio.speex.JavaDecoder",
+            "net.java.sip.communicator.impl.neomedia.codec.audio.mp3.JNIEncoder",
             "net.java.sip.communicator.impl.neomedia.codec.audio.ilbc.JavaEncoder",
             "net.java.sip.communicator.impl.neomedia.codec.audio.ilbc.JavaDecoder",
             G729

File: src/net/java/sip/communicator/impl/neomedia/codec/video/ByteBuffer.java
Patch:
@@ -6,6 +6,8 @@
  */
 package net.java.sip.communicator.impl.neomedia.codec.video;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
+
 /**
  * Represents a buffer of native memory with a specific size/capacity which
  * either contains a specific number of bytes of valid data or is free for

File: src/net/java/sip/communicator/impl/neomedia/codec/video/FinalizableAVFrame.java
Patch:
@@ -10,6 +10,7 @@
 
 import javax.media.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.*;
 
 /**

File: src/net/java/sip/communicator/impl/neomedia/codec/video/SwScaler.java
Patch:
@@ -11,6 +11,7 @@
 import javax.media.*;
 import javax.media.format.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.control.*;
 import net.java.sip.communicator.util.*;
 import net.sf.fmj.media.*;

File: src/net/java/sip/communicator/impl/neomedia/device/DirectShowAuto.java
Patch:
@@ -8,6 +8,7 @@
 
 import javax.media.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.directshow.*;
 import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.directshow.*;

File: src/net/java/sip/communicator/impl/neomedia/device/ImageStreamingAuto.java
Patch:
@@ -14,6 +14,7 @@
 
 import net.java.sip.communicator.service.neomedia.device.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.*;
 

File: src/net/java/sip/communicator/impl/neomedia/device/QuickTimeAuto.java
Patch:
@@ -9,6 +9,7 @@
 import javax.media.*;
 import javax.media.format.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.quicktime.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/neomedia/device/Video4Linux2Auto.java
Patch:
@@ -9,6 +9,7 @@
 import javax.media.*;
 import javax.media.format.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.video4linux2.*;
 

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/ByteBufferPool.java
Patch:
@@ -8,6 +8,7 @@
 
 import java.util.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/directshow/DataSource.java
Patch:
@@ -14,6 +14,7 @@
 import javax.media.control.*;
 import javax.media.format.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.device.*;
 import net.java.sip.communicator.impl.neomedia.directshow.*;

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/imgstreaming/ImageStream.java
Patch:
@@ -14,6 +14,7 @@
 import javax.media.control.*;
 import javax.media.format.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.imgstreaming.*;
 import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.*;

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/quicktime/QuickTimeStream.java
Patch:
@@ -14,6 +14,7 @@
 import javax.media.format.*;
 import javax.media.protocol.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.*;
 import net.java.sip.communicator.impl.neomedia.quicktime.*;

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/video4linux2/DataSource.java
Patch:
@@ -11,7 +11,7 @@
 import javax.media.*;
 import javax.media.control.*;
 
-import net.java.sip.communicator.impl.neomedia.codec.video.*;
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.device.*;
 import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.*;
 

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/video4linux2/Video4Linux2Stream.java
Patch:
@@ -13,6 +13,7 @@
 import javax.media.control.*;
 import javax.media.format.*;
 
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.*;
 

File: src/net/java/sip/communicator/impl/neomedia/portaudio/PortAudio.java
Patch:
@@ -10,7 +10,7 @@
 import java.lang.reflect.*;
 import java.nio.charset.*;
 
-import net.java.sip.communicator.impl.neomedia.codec.video.*;
+import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/neomedia/quicktime/QTCaptureDevice.java
Patch:
@@ -20,7 +20,7 @@ public class QTCaptureDevice
 
     /**
      * The cached <tt>QTCaptureDevice</tt> instances previously returned by the
-     * last call to {@link #inputDevicesWithMediaType(QTMediaType).
+     * last call to {@link #inputDevicesWithMediaType(QTMediaType)}.
      */
     private static final Map<QTMediaType, List<QTCaptureDevice>> inputDevices
         = new HashMap<QTMediaType, List<QTCaptureDevice>>();

File: src/net/java/sip/communicator/impl/protocol/gibberish/CallPeerGibberishImpl.java
Patch:
@@ -172,7 +172,7 @@ public Contact getContact()
      */
     public ProtocolProviderServiceGibberishImpl getProtocolProvider()
     {
-        return this.call.getProtocolProvider();
+        return call.getProtocolProvider();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/mock/MockCall.java
Patch:
@@ -14,6 +14,7 @@
 
 /**
  * @author Damian Minkov
+ * @author Lubomir Marinov
  */
 public class MockCall
     extends AbstractCall<MockCallPeer, MockProvider>

File: src/net/java/sip/communicator/impl/replacement/dailymotion/DailymotionActivator.java
Patch:
@@ -9,7 +9,6 @@
 import java.util.*;
 
 import net.java.sip.communicator.service.replacement.*;
-import net.java.sip.communicator.service.resources.*;
 import net.java.sip.communicator.util.*;
 
 import org.osgi.framework.*;

File: src/net/java/sip/communicator/plugin/keybindingchooser/chooser/BindingAdaptor.java
Patch:
@@ -97,7 +97,7 @@ public int getInputEventType()
      * which includes: KEY_PRESSED, KEY_RELEASED, or KEY_TYPED.
      * 
      * @param type type of keystroke registered by input
-     * @throws IllegalArgumentExeption if type doesn't match a valid key event
+     * @throws IllegalArgumentException if type doesn't match a valid key event
      */
     public void setInputEventType(int type)
     {

File: src/net/java/sip/communicator/util/SoundFileUtils.java
Patch:
@@ -35,7 +35,7 @@ public class SoundFileUtils
      * The file extension and the format of call recording to be used by
      * default. 
      */
-    public static final String DEFAULT_CALL_RECORDING_FORMAT = wav;
+    public static final String DEFAULT_CALL_RECORDING_FORMAT = mp3;
 
     /**
      * Checks whether this file is a sound file.

File: test/net/java/sip/communicator/slick/runner/XmlFormatter.java
Patch:
@@ -39,7 +39,7 @@
  * Prints XML output of the test to a specified Writer.
  *
  * @author Emil Ivov
- * @see FormatterElement
+ * @see Element
  */
 
 public class XmlFormatter extends ResultPrinter implements XMLConstants {

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/JinglePacketFactory.java
Patch:
@@ -30,8 +30,8 @@ public class JinglePacketFactory
      */
     public static JingleIQ createRinging(JingleIQ sessionInitiate)
     {
-        return createSessionInfo(sessionInitiate.getFrom(),
-                                 sessionInitiate.getTo(),
+        return createSessionInfo(sessionInitiate.getTo(),
+                                 sessionInitiate.getFrom(),
                                  sessionInitiate.getSID(),
                                  SessionInfoType.ringing);
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaContactQueryListener.java
Patch:
@@ -17,14 +17,14 @@ public interface MetaContactQueryListener
     /**
      * Indicates that a <tt>MetaContact</tt> has been received for a search in
      * the <tt>MetaContactListService</tt>.
-     * @param metaContact the received <tt>MetaContact</tt>
+     * @param event the received <tt>MetaContactQueryEvent</tt>
      */
     public void metaContactReceived(MetaContactQueryEvent event);
 
     /**
      * Indicates that a <tt>MetaGroup</tt> has been received from a search in
      * the <tt>MetaContactListService</tt>.
-     * @param metaGroup the <tt>MetaGroup</tt> that has been received
+     * @param event the <tt>MetaGroupQueryEvent</tt> that has been received
      */
     public void metaGroupReceived(MetaGroupQueryEvent event);
 

File: src/net/java/sip/communicator/impl/gui/main/presence/avatar/imagepicker/EditPanel.java
Patch:
@@ -146,7 +146,7 @@ public void reset()
     /**
      * Returns the clipped image.
      * 
-     * @return
+     * @return the clipped image
      */
     public byte[] getClippedImage()
     {

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h264/JNIDecoder.java
Patch:
@@ -209,6 +209,8 @@ public Format[] getSupportedOutputFormats(Format in)
 
     /**
      * Inits the codec instances.
+     *
+     * @throws ResourceUnavailableException if codec initialization failed
      */
     @Override
     public synchronized void open()

File: src/net/java/sip/communicator/impl/neomedia/device/AudioMediaDeviceSession.java
Patch:
@@ -56,8 +56,8 @@ protected AudioMediaDeviceSession(AbstractMediaDevice device)
     }
 
     /**
-     * Called by {@link MediaDeviceSession#createPlayer(DataSource dataSource)}
-     * when the player associated with this session's
+     * Called by {@link MediaDeviceSession#playerControllerUpdate(
+     * ControllerEvent event)} when the player associated with this session's
      * <tt>ReceiveStream</tt> moves enters the <tt>Configured</tt> state, so
      * we use the occasion to add our audio level effect.
      *

File: src/net/java/sip/communicator/impl/neomedia/portaudio/PortAudio.java
Patch:
@@ -327,7 +327,7 @@ public static native long Pa_OpenStream(
         throws PortAudioException;
 
     /**
-     * Read samples from an input stream. The function doesn't return until 
+     * Read samples from an input stream. The function doesn't return until
      * the entire buffer has been filled - this may involve waiting for
      * the operating system to supply the data.
      * @param stream pointer to the stream.
@@ -499,7 +499,7 @@ public static native double PaDeviceInfo_getDefaultSampleRate(
      * get the name of
      * @return the name of the PortAudio device specified by the
      * <tt>PaDeviceInfo</tt> instance pointed to by <tt>deviceInfo</tt>
-     * @deprecated Replaced by {@link #PaDeviceInfo_getCharsetAwareName()}
+     * @deprecated Replaced by {@link #PaDeviceInfo_getCharsetAwareName(long)}
      * because <tt>PaDeviceInfo_getName</tt> presumes that the <tt>name</tt> of
      * <tt>PaDeviceInfo</tt> is encoded in modified UTF-8
      */
@@ -588,7 +588,7 @@ public static void PaStreamParameters_free(long streamParameters)
         /*
          * FFmpeg on Windows seems to be compiled with --enable-memalign-hack so
          * av_free(void *) isn't the same as free(void *) and thus is not a
-         * suitable/safe fallback. 
+         * suitable/safe fallback.
          */
         if (OSUtils.IS_LINUX || OSUtils.IS_MAC)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetGeolocationJabberImpl.java
Patch:
@@ -76,7 +76,6 @@ public OperationSetGeolocationJabberImpl(
             GeolocationPacketExtensionProvider.ELEMENT_NAME
             , GeolocationPacketExtensionProvider.NAMESPACE
             , new GeolocationPacketExtensionProvider());
-
     }
 
     /**
@@ -142,7 +141,6 @@ public void removeGeolocationListener(GeolocationListener listener)
         {
             geolocationContactsListeners.remove(listener);
         }
-
     }
 
     /**
@@ -154,7 +152,7 @@ private class RegistrationStateListener
         implements RegistrationStateChangeListener
     {
         /**
-         * The method is called by a ProtocolProvider implementation whenver
+         * The method is called by a ProtocolProvider implementation whenever
          * a change in the registration state of the corresponding provider had
          * occurred.
          * @param evt ProviderStatusChangeEvent the event describing the status

File: src/net/java/sip/communicator/impl/protocol/jabber/ScServiceDiscoveryManager.java
Patch:
@@ -74,7 +74,7 @@ public class ScServiceDiscoveryManager
 
     /**
      * The unmodifiable view of {@link #features} which can be exposed to the
-     * public through {@link #getFeatures()}, for example. 
+     * public through {@link #getFeatures()}, for example.
      */
     private final List<String> unmodifiableFeatures;
 

File: src/net/java/sip/communicator/util/launchutils/LaunchArgHandler.java
Patch:
@@ -449,7 +449,6 @@ public void handleHelpArg()
         System.out.println("  -m, --multiple    do not ensure single instance");
         System.out.println("  -6, --ipv6        prefer IPv6 addresses where possible only");
         System.out.println("  -4, --ipv4        forces use of IPv4 only");
-        System.out.println("  -s, --desktop-stream     use desktop streaming");
         System.out.println("  -v, --version     display the current version and exit");
     }
 

File: src/net/java/sip/communicator/util/swing/FramedImage.java
Patch:
@@ -102,7 +102,7 @@ public void setImageIcon(Image image)
 
     /**
      * Returns the image that is shown.
-     * @return
+     * @return the image that is shown
      */
     public Image getImage()
     {

File: src/net/java/sip/communicator/impl/gui/main/call/conference/CallPeerMenu.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.awt.*;
 import java.awt.event.*;
-import java.beans.*;
 
 import javax.swing.*;
 

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/EditMenu.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.main.chat.menus;
 
-import java.awt.*;
 import java.awt.event.*;
 
 import javax.swing.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/FileMenu.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.main.chat.menus;
 
-import java.awt.*;
 import java.awt.event.*;
 
 import javax.swing.*;

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/ChatRoomNamePanel.java
Patch:
@@ -13,7 +13,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.util.swing.*;
 

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/SelectAccountPanel.java
Patch:
@@ -15,7 +15,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.swing.*;
 

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigFormList.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.main.configforms;
 
-import java.awt.*;
-
 import javax.swing.*;
 import javax.swing.event.*;
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/MetaContactQueryListener.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.main.contactlist.contactsource;
 
-import net.java.sip.communicator.service.contactlist.*;
-
 /**
  * The <tt>MetaContactQueryListener</tt> listens for events coming from a
  * <tt>MetaContactListService</tt> filtering.

File: src/net/java/sip/communicator/impl/gui/main/menus/ViewMenu.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.main.menus;
 
-import java.awt.*;
-
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.util.swing.*;

File: src/net/java/sip/communicator/impl/gui/main/presence/avatar/SelectAvatarMenu.java
Patch:
@@ -15,7 +15,6 @@
 import java.awt.*;
 import java.awt.event.*;
 import java.awt.image.*;
-import java.util.*;
 
 import javax.swing.*;
 

File: src/net/java/sip/communicator/impl/neomedia/device/DeviceConfiguration.java
Patch:
@@ -14,7 +14,6 @@
 
 import net.java.sip.communicator.impl.neomedia.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
-import net.java.sip.communicator.impl.neomedia.imgstreaming.*;
 import net.java.sip.communicator.impl.neomedia.jmfext.media.renderer.audio.*;
 import net.java.sip.communicator.impl.neomedia.portaudio.*;
 import net.java.sip.communicator.service.neomedia.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/DefaultPacketExtensionProvider.java
Patch:
@@ -8,8 +8,6 @@
 
 import java.util.logging.*;
 
-import net.java.sip.communicator.impl.protocol.jabber.extensions.jingle.*;
-
 import org.jivesoftware.smack.packet.*;
 import org.jivesoftware.smack.provider.*;
 import org.xmlpull.v1.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/ReasonProvider.java
Patch:
@@ -8,7 +8,6 @@
 
 import org.jivesoftware.smack.packet.*;
 import org.jivesoftware.smack.provider.*;
-import org.jivesoftware.smackx.packet.*;
 import org.xmlpull.v1.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/sip/SipRegistrarConnection.java
Patch:
@@ -6,10 +6,10 @@
  */
 package net.java.sip.communicator.impl.protocol.sip;
 
-import java.io.IOException;
 import java.net.*;
 import java.text.*;
 import java.util.*;
+
 import javax.sip.*;
 import javax.sip.address.*;
 import javax.sip.header.*;

File: src/net/java/sip/communicator/service/protocol/event/SoundLevelChangeEvent.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.service.protocol.event;
 
 import java.util.*;
-import net.java.sip.communicator.service.protocol.*;
 
 /**
  * <tt>SoundLevelChangeEvent</tt>s are triggered whenever a change occurs in the

File: src/net/java/sip/communicator/impl/resources/ResourceManagementServiceImpl.java
Patch:
@@ -389,7 +389,7 @@ public InputStream getImageInputStreamForPath(String path)
      * Returns the <tt>InputStream</tt> of the image corresponding to the given
      * key.
      *
-     * @param streamKey The identifier of the image in the resource properties�
+     * @param streamKey The identifier of the image in the resource properties
      * file.
      * @return the <tt>InputStream</tt> of the image corresponding to the given
      * key.

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactJabberImpl.java
Patch:
@@ -163,10 +163,7 @@ public byte[] getImage()
     byte[] getImage(boolean retrieveIfNecessary)
     {
         if(image == null && retrieveIfNecessary)
-        {
             ssclCallback.addContactForImageUpdate(this);
-        }
-
         return image;
     }
 

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/speex/JNIEncoder.java
Patch:
@@ -386,7 +386,7 @@ protected Format[] getMatchingOutputFormats(Format inputFormat)
 
     /**
      * @return
-     * @see AbstractCodec#getOutputFormat()
+     * @see net.sf.fmj.media.AbstractCodec#getOutputFormat()
      */
     @Override
     public Format getOutputFormat()

File: src/net/java/sip/communicator/impl/neomedia/protocol/StreamSubstituteBufferTransferHandler.java
Patch:
@@ -11,8 +11,8 @@
 /**
  * Implements a <tt>BufferTransferHandler</tt> wrapper which doesn't
  * expose a <tt>PushBufferStream</tt> but rather a specific substitute in order
- * to give full control to the {@link PushBufferStream#read(Buffer)} method of
- * the substitute.
+ * to give full control to the {@link PushBufferStream#read(javax.media.Buffer)}
+ * method of the substitute.
  * <p>
  * The purpose is achieved in <code>#transferData(PushBufferStream)</code>
  * where the method argument <code>stream</code> is ignored and the substitute

File: src/net/java/sip/communicator/service/protocol/AbstractCall.java
Patch:
@@ -83,6 +83,6 @@ protected Vector<T> getCallPeersVector()
     @SuppressWarnings("unchecked")
     public U getProtocolProvider()
     {
-        return (U)super.getProtocolProvider();
+        return (U) super.getProtocolProvider();
     }
 }

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackSharing.java
Patch:
@@ -1059,6 +1059,6 @@ public java.net.InetSocketAddress getLocalAddressForDestination(
 //                .getLocalTLSAddressForDestination(dst, dstPort, localAddress));
 //        else
             return (java.net.InetSocketAddress)(((SipStackImpl)this.stack)
-            .getLocalAddressForDestination(dst, dstPort, localAddress, 0));
+            .obtainLocalAddress(dst, dstPort, localAddress, 0));
     }
 }

File: test/net/java/sip/communicator/slick/protocol/sip/TestOperationSetServerStoredInfo.java
Patch:
@@ -113,7 +113,7 @@ protected void tearDown() throws Exception
     {
         super.tearDown();
         fixture.tearDown();
-        xCapClient.dicsonnect();
+        xCapClient.disconnect();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/BaseHttpXCapClient.java
Patch:
@@ -128,9 +128,9 @@ public boolean isConnected()
     }
 
     /**
-     * Dicsonnects user from the XCAP server.
+     * Disconnects user from the XCAP server.
      */
-    public void dicsonnect()
+    public void disconnect()
     {
         this.uri = null;
         this.userAddress = null;

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/HttpXCapClient.java
Patch:
@@ -30,9 +30,9 @@ public void connect(URI uri, Address userAddress, String password)
             throws XCapException;
 
     /**
-     * Dicsonnects user from the XCAP server.
+     * Disconnects user from the XCAP server.
      */
-    public void dicsonnect();
+    public void disconnect();
 
     /**
      * Checks if user is connected to the XCAP server.

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/XCapClientImpl.java
Patch:
@@ -67,7 +67,7 @@ public void connect(URI uri, Address userAddress, String password)
         }
         catch (XCapException e)
         {
-            dicsonnect();
+            disconnect();
             throw e;
         }
         for (String namespace : xCapCaps.getNamespaces().getNamespace())
@@ -90,9 +90,9 @@ public void connect(URI uri, Address userAddress, String password)
     /**
      * Disconnects user from the XCAP server.
      */
-    public void dicsonnect()
+    public void disconnect()
     {
-        super.dicsonnect();
+        super.disconnect();
         xCapCaps = null;
         resourceListsSupported = false;
     }

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -1041,6 +1041,7 @@ public void setErrorReason(String reason)
             errorMessageComponent = new JTextPane();
 
             JTextPane textPane = (JTextPane) errorMessageComponent;
+            textPane.setEditable(false);
             textPane.setOpaque(false);
 
             StyledDocument doc = textPane.getStyledDocument();

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceParticipantPanel.java
Patch:
@@ -407,6 +407,7 @@ protected void setErrorReason(String reason)
             errorMessageComponent = new JTextPane();
 
             JTextPane textPane = (JTextPane) errorMessageComponent;
+            textPane.setEditable(false);
             textPane.setOpaque(false);
 
             StyledDocument doc = textPane.getStyledDocument();

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -1125,6 +1125,8 @@ public void leaveChatRoom(ChatRoomWrapper chatRoomWrapper)
             chatRoomWrapper.getParentProvider().getProtocolProvider(),
             chatRoomWrapper.getChatRoomID(),
             Constants.OFFLINE_STATUS);
+
+        this.closeChatRoom(existChatRoomWrapper);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/TransportManagerSipImpl.java
Patch:
@@ -46,7 +46,7 @@ protected TransportManagerSipImpl(CallPeerSipImpl callPeer)
     protected InetAddress getIntendedDestination(CallPeerSipImpl peer)
     {
         return peer.getProtocolProvider()
-            .getIntendedDestination(peer.getPeerAddress());
+            .getIntendedDestination(peer.getPeerAddress()).getAddress();
     }
 
 }

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/XCapClientImpl.java
Patch:
@@ -245,7 +245,7 @@ private XCapCapsType loadXCapCaps()
             String xml = getResource(resourceId, XCapCapsClient.CONTENT_TYPE);
             if (xml == null)
             {
-                return new XCapCapsType();
+                throw new XCapException("Server xcap-caps wasn't find");
             }
             return XCapCapsParser.fromXml(xml);
         }

File: src/net/java/sip/communicator/plugin/sipaccregwizz/PresencePanel.java
Patch:
@@ -99,7 +99,7 @@ public PresencePanel(SIPAccountRegistrationForm regform)
             Resources.getString("plugin.sipaccregwizz.XCAP_ENABLE"),
             regform.getRegistration().isXCapEnable());
         this.xCapUseSipCredetialsBox = new SIPCommCheckBox(
-            Resources.getString("plugin.sipaccregwizz.XCAP_USE_SIP_CREDETIALS"),
+            Resources.getString("plugin.sipaccregwizz.XCAP_USE_SIP_CREDENTIALS"),
             regform.getRegistration().isXCapUseSipCredetials());
 
         enablePresOpButton.addActionListener(new ActionListener()

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -2058,8 +2058,8 @@ else if (event.getType() == ServiceEvent.UNREGISTERING)
             AccountID accountID = provider.getAccountID();
 
             // If the account is still registered or is just unloaded but
-            // remains stored we have nothing to do here.
-            if(sourceFactory.getRegisteredAccounts().contains(accountID))
+            // remains stored we remove its contacts but without storing this
+            if(ContactlistActivator.getAccountManager().getStoredAccounts().contains(accountID))
             {
                 //the account is still installed it means we are modifying it.
                 // we remove all its contacts from current contactlist

File: src/net/java/sip/communicator/service/protocol/AbstractProtocolProviderService.java
Patch:
@@ -214,8 +214,8 @@ public Map<String, OperationSet> getSupportedOperationSets()
     /**
      * Indicates whether or not this provider is registered
      *
-     * @return true if the provider is currently registered and false
-     *   otherwise.
+     * @return <tt>true</tt> if the provider is currently registered and
+     * <tt>false</tt> otherwise.
      */
     public boolean isRegistered()
     {

File: src/net/java/sip/communicator/impl/neomedia/RecorderImpl.java
Patch:
@@ -153,8 +153,6 @@ private ContentDescriptor getContentDescriptor(String format)
 
         if (SoundFileUtils.wav.equalsIgnoreCase(format))
             type = FileTypeDescriptor.WAVE;
-        else if (SoundFileUtils.mp2.equalsIgnoreCase(format))
-            type = FileTypeDescriptor.MPEG_AUDIO;
         else if (SoundFileUtils.gsm.equalsIgnoreCase(format))
             type = FileTypeDescriptor.GSM;
         else if (SoundFileUtils.au.equalsIgnoreCase(format))

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -1626,7 +1626,7 @@ public Contact createUnresolvedContact(
     * the contact. When this happens the corresponding event would notify
     * interested subscription listeners.
     *
-    * @param addressStr an identifier of the contact that we'll be creating.
+    * @param contactId an identifier of the contact that we'll be creating.
     * @param persistentData a String returned Contact's getPersistentData()
     * method during a previous run and that has been persistently stored
     * locally.
@@ -1636,12 +1636,12 @@ public Contact createUnresolvedContact(
     * @return the unresolved <tt>Contact</tt> created from the specified
     * <tt>address</tt> and <tt>persistentData</tt>
     */
-    public Contact createUnresolvedContact(String addressStr,
+    public Contact createUnresolvedContact(String contactId,
                          String persistentData,
                          ContactGroup parent)
     {
         return ssContactList.createUnresolvedContact((ContactGroupSipImpl)
-                parent, addressStr);
+                parent, contactId, persistentData);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/AccountID.java
Patch:
@@ -133,7 +133,7 @@ protected AccountID( String userID,
         this.protocolName = protocolName;
         this.userID = userID;
         this.accountProperties
-            = new Hashtable<String, String>(accountProperties);
+            = new HashMap<String, String>(accountProperties);
         this.serviceName = serviceName;
 
         //create a unique identifier string
@@ -211,7 +211,7 @@ public String getAccountUniqueID()
      */
     public Map<String, String> getAccountProperties()
     {
-        return new Hashtable<String, String>(accountProperties);
+        return new HashMap<String, String>(accountProperties);
     }
 
     public Object getAccountProperty(Object key)

File: src/net/java/sip/communicator/util/swing/SipCommFileChooser.java
Patch:
@@ -16,10 +16,10 @@
  * user interface for file selection provided by Mac OS which is more practical
  * than the user interface performed by a JFileChooser (on Mac).
  * 
- * Therefore, under other plateforms (Microsoft Windows, Linux), the use of 
+ * Therefore, under other platforms (Microsoft Windows, Linux), the use of 
  * JFileChooser instead of FileDialog performs a better user interface for 
  * browsing among a file hierarchy.
- * 
+ *
  * @author Valentin Martinet
  */
 public interface SipCommFileChooser 

File: src/net/java/sip/communicator/impl/neomedia/device/MediaDeviceImpl.java
Patch:
@@ -267,7 +267,7 @@ public MediaDirection getDirection()
     }
 
     /**
-     * Gets the <tt>MediaFormat</tt> in which this <t>MediaDevice</tt> captures
+     * Gets the <tt>MediaFormat</tt> in which this <tt>MediaDevice</tt> captures
      * media.
      *
      * @return the <tt>MediaFormat</tt> in which this <tt>MediaDevice</tt>

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistration.java
Patch:
@@ -52,9 +52,9 @@ public class SIPAccountRegistration
 
     private boolean forceP2PMode = false;
 
-    private boolean defaultEncryption = false;
+    private boolean defaultEncryption = true;
 
-    private boolean sipZrtpAttribute = false;
+    private boolean sipZrtpAttribute = true;
 
     private String pollingPeriod = DEFAULT_POLL_PERIOD;
 

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationForm.java
Patch:
@@ -42,7 +42,7 @@ public SIPAccountRegistrationForm(SIPAccountRegistrationWizard wizard)
 
         connectionPanel = new ConnectionPanel(this);
 
-        presencePanel = new PresencePanel();
+        presencePanel = new PresencePanel(this);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/DTMFHandler.java
Patch:
@@ -20,7 +20,7 @@
 
 /**
  * Handles DTMF sending and playing sound notifications for that.
- * 
+ *
  * @author Damian Minkov
  */
 public class DTMFHandler

File: src/net/java/sip/communicator/impl/protocol/sip/ClientCapabilities.java
Patch:
@@ -71,6 +71,8 @@ public ClientCapabilities(ProtocolProviderServiceSipImpl protocolProvider)
      * methods that we support.
      *
      * @param requestEvent the incoming options request.
+     * @return <tt>true</tt> if request has been successfully processed,
+     * <tt>false</tt> otherwise
      */
     public boolean processRequest(RequestEvent requestEvent)
     {

File: src/net/java/sip/communicator/service/neomedia/format/VideoMediaFormat.java
Patch:
@@ -11,7 +11,7 @@
 /**
  * The interface represents a video format. Video formats characterize video
  * streams and the <tt>VideoMediaFormat</tt> interface gives access to some of
- * their  properties such as encoding and clock rate.
+ * their properties such as encoding and clock rate.
  *
  * @author Emil Ivov
  */

File: src/net/java/sip/communicator/service/protocol/OperationSetDTMF.java
Patch:
@@ -32,7 +32,8 @@ public void startSendingDTMF(CallPeer callPeer, DTMFTone tone)
 
     /**
      * Stop sending of the currently transmitting DTMF tone.
-     * @param callPeer
+     *
+     * @param callPeer the  call peer to stop send <tt>tone</tt> to.
      */
     public void stopSendingDTMF(CallPeer callPeer);
 }

File: src/net/java/sip/communicator/service/protocol/OperationSetDesktopSharingClient.java
Patch:
@@ -6,14 +6,14 @@
  */
 package net.java.sip.communicator.service.protocol;
 
-import java.awt.Dimension;
+import java.awt.*;
 import java.awt.event.*;
 
 import net.java.sip.communicator.service.protocol.event.RemoteControlListener;
 
 /**
  * Represents an <tt>OperationSet</tt> giving access to desktop sharing
- * client-side specific functionality.
+ * client-side specific functionalities.
  *
  * @author Sebastien Vincent
  */

File: src/net/java/sip/communicator/service/protocol/OperationSetDesktopSharingServer.java
Patch:
@@ -10,7 +10,7 @@
 
 /**
  * Represents an <tt>OperationSet</tt> giving access to desktop sharing
- * server-side specific functionality.
+ * server-side specific functionalities.
  *
  * @author Sebastien Vincent
  */

File: src/net/java/sip/communicator/service/protocol/event/ProviderChangeListener.java
Patch:
@@ -15,7 +15,7 @@
 public interface ProviderChangeListener
 {
     /**
-     * The method is called by a ProtocolProvider implementation whenver
+     * The method is called by a ProtocolProvider implementation whenever
      * a change in the presence status of the corresponding provider had
      * occurred.
      * @param evt ProviderStatusChangeEvent the event describing the status

File: src/net/java/sip/communicator/util/ByteFormat.java
Patch:
@@ -12,8 +12,8 @@
  * Acknowledgment: This file was originally provided by the Ignite Realtime
  * community, and was part of the Spark project (distributed under the terms of
  * the LGPL).
- * 
- * A formatter for formatting byte sizes. For example, formatting 12345 byes
+ *
+ * A formatter for formatting byte sizes. For example, formatting 12345 bytes
  * results in "12.1 K" and 1234567 results in "1.18 MB".
  *
  * @author Bill Lynch

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetVideoTelephonyJabberImpl.java
Patch:
@@ -22,7 +22,6 @@ public class OperationSetVideoTelephonyJabberImpl
         ProtocolProviderServiceJabberImpl,
         CallJabberImpl,
         CallPeerJabberImpl>
-
 {
     /**
      * The <tt>Logger</tt> used by the

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandlerSipImpl.java
Patch:
@@ -416,8 +416,9 @@ private Vector<MediaDescription> createMediaDescriptionsForAnswer(
                 = getTransportManager().getStreamConnector(mediaType);
 
             // create the corresponding stream...
-            initStream(connector, dev, mutuallySupportedFormats.get(0), target,
-                      direction, rtpExtensions);
+            MediaFormat fmt = findMediaFormat(remoteFormats,
+                    mutuallySupportedFormats.get(0));
+            initStream(connector, dev, fmt, target, direction, rtpExtensions);
 
             MediaDescription md = createMediaDescription(
                 mutuallySupportedFormats, connector, direction, rtpExtensions);

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -16,7 +16,7 @@
 
 import org.jivesoftware.smack.*;
 import org.jivesoftware.smack.packet.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 import org.jivesoftware.smackx.*;
 import org.jivesoftware.smackx.muc.*;
 import org.jivesoftware.smackx.packet.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/IncomingFileTransferRequestJabberImpl.java
Patch:
@@ -18,7 +18,7 @@
 import org.jivesoftware.smack.*;
 import org.jivesoftware.smack.filter.*;
 import org.jivesoftware.smack.packet.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 import org.jivesoftware.smackx.filetransfer.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -20,7 +20,7 @@
 import org.jivesoftware.smack.filter.*;
 import org.jivesoftware.smack.packet.*;
 import org.jivesoftware.smack.provider.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 import org.jivesoftware.smackx.*;
 import org.jivesoftware.smackx.packet.*;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetContactCapabilitiesJabberImpl.java
Patch:
@@ -8,7 +8,7 @@
 
 import java.util.*;
 
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 
 import net.java.sip.communicator.impl.protocol.jabber.extensions.caps.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetGeolocationJabberImpl.java
Patch:
@@ -12,7 +12,7 @@
 import org.jivesoftware.smack.filter.*;
 import org.jivesoftware.smack.packet.*;
 import org.jivesoftware.smack.provider.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 
 import net.java.sip.communicator.impl.protocol.jabber.extensions.geolocation.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetMultiUserChatJabberImpl.java
Patch:
@@ -14,7 +14,7 @@
 
 import org.jivesoftware.smack.*;
 import org.jivesoftware.smack.packet.Message;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 import org.jivesoftware.smackx.*;
 import org.jivesoftware.smackx.muc.*;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -16,7 +16,7 @@
 import org.jivesoftware.smack.*;
 import org.jivesoftware.smack.filter.*;
 import org.jivesoftware.smack.packet.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 
 /**
  * The Jabber implementation of a Persistent Presence Operation set. This class

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTypingNotificationsJabberImpl.java
Patch:
@@ -14,7 +14,7 @@
 import net.java.sip.communicator.util.*;
 
 import org.jivesoftware.smack.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 import org.jivesoftware.smackx.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetWhiteboardingJabberImpl.java
Patch:
@@ -18,7 +18,7 @@
 import org.jivesoftware.smack.filter.*;
 import org.jivesoftware.smack.packet.*;
 import org.jivesoftware.smack.provider.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 
 /**
  * Provides basic functionality for white-board.

File: src/net/java/sip/communicator/impl/protocol/jabber/OutgoingFileTransferJabberImpl.java
Patch:
@@ -15,7 +15,7 @@
 import org.jivesoftware.smack.*;
 import org.jivesoftware.smack.filter.*;
 import org.jivesoftware.smack.packet.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 import org.jivesoftware.smackx.filetransfer.*;
 import org.jivesoftware.smackx.packet.*;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -24,7 +24,7 @@
 import org.jivesoftware.smack.*;
 import org.jivesoftware.smack.packet.*;
 import org.jivesoftware.smack.provider.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 import org.jivesoftware.smackx.*;
 import org.jivesoftware.smackx.packet.*;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/WhiteboardSessionJabberImpl.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.impl.protocol.jabber.extensions.version.*;
 import net.java.sip.communicator.impl.protocol.jabber.extensions.whiteboard.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
@@ -18,7 +17,7 @@
 import org.jivesoftware.smack.*;
 import org.jivesoftware.smack.filter.*;
 import org.jivesoftware.smack.packet.*;
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 import org.jivesoftware.smackx.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/sip/xcap/model/xcapcaps/XCapCapsParser.java
Patch:
@@ -6,9 +6,9 @@
  */
 package net.java.sip.communicator.impl.protocol.sip.xcap.model.xcapcaps;
 
-import static net.java.sip.communicator.impl.protocol.sip.xcap.model.StringUtils.*;
+import static net.java.sip.communicator.util.StringUtils.*;
+import static net.java.sip.communicator.util.xml.XMLUtils.*;
 import net.java.sip.communicator.impl.protocol.sip.xcap.model.*;
-import static net.java.sip.communicator.impl.protocol.sip.xcap.model.XmlUtils.*;
 import org.w3c.dom.*;
 
 /**
@@ -52,7 +52,7 @@ public static XCapCapsType fromXml(String xml)
         try
         {
             XCapCapsType xCapCaps = new XCapCapsType();
-            Document document = XmlUtils.createDocument(xml);
+            Document document = createDocument(xml);
             Element xCapCapsElement = document.getDocumentElement();
             if (XCAPCAPS_ELEMENT.equals(xCapCapsElement.getLocalName()) &&
                     !NAMESPACE.equals(xCapCapsElement.getNamespaceURI()))

File: src/net/java/sip/communicator/util/StringUtils.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.impl.protocol.sip.xcap.model;
+package net.java.sip.communicator.util;
 
 import java.io.*;
 

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetMultiUserChat2.java
Patch:
@@ -8,7 +8,7 @@
 
 import java.util.*;
 
-import org.jivesoftware.smack.util.*;
+import org.jivesoftware.smack.util.StringUtils;
 
 import junit.framework.*;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -14,7 +14,6 @@
 import javax.net.ssl.*;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.ProxyInfo.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.service.protocol.jabberconstants.*;
 import net.java.sip.communicator.util.*;
@@ -1080,7 +1079,7 @@ else if(exMsg.indexOf("no response from the server") != -1
 
         fireRegistrationStateChanged(
             getRegistrationState(), regState, reason, null);
-        
+
         if(regState == RegistrationState.UNREGISTERED
             || regState == RegistrationState.CONNECTION_FAILED)
         {

File: src/net/java/sip/communicator/service/protocol/AbstractCallPeer.java
Patch:
@@ -416,7 +416,8 @@ public void setState(CallPeerState newState, String reason)
         fireCallPeerChangeEvent(
                 CallPeerChangeEvent.CALL_PEER_STATE_CHANGE,
                 oldState,
-                newState);
+                newState,
+                reason);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -295,7 +295,7 @@ public Component getTreeCellRendererComponent(JTree tree, Object value,
 
             String displayName = contact.getDisplayName();
 
-            if (displayName == null || displayName.length() < 1)
+            if (displayName == null || displayName.trim().length() < 1)
             {
                 displayName = GuiActivator.getResources()
                     .getI18NString("service.gui.UNKNOWN");

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -304,7 +304,7 @@ public List<ContentPacketExtension> createContentList()
                             hash.setValue(helloHash);
                             //we are currently disabling ZRTP until we find the
                             //time to fix it
-                            //content.addChildExtension(hash);
+                            content.addChildExtension(hash);
                         }
                     }
                     mediaDescs.add(content);

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -278,7 +278,7 @@ private void putOnHold(CallPeer peer, boolean on)
         throws OperationFailedException
     {
         CallPeerJabberImpl jabberPeer = (CallPeerJabberImpl) peer;
-        //jabberPeer.putOnHold(on);
+        jabberPeer.putOnHold(on);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -930,7 +930,7 @@ protected void initialize(String screenname,
                                            new JingleIQProvider());
 
             //initialize the telephony operation set
-/* disabled until implementation is ready.
+/* disabled until implementation is ready. */
             addSupportedOperationSet(
                 OperationSetBasicTelephony.class,
                 new OperationSetBasicTelephonyJabberImpl(this));
@@ -943,7 +943,7 @@ protected void initialize(String screenname,
             //supportedFeatures.add(URN_XMPP_JINGLE_ICE_UDP_1);
             supportedFeatures.add(URN_XMPP_JINGLE_RTP_AUDIO);
             supportedFeatures.add(URN_XMPP_JINGLE_RTP_VIDEO);
-*/
+/**/
 
             // OperationSetContactCapabilities
             opsetContactCapabilities

File: src/net/java/sip/communicator/plugin/sipaccregwizz/ConnectionPanel.java
Patch:
@@ -72,7 +72,7 @@ public ConnectionPanel(SIPAccountRegistrationForm regform)
         this.transportCombo.addItemListener(this);
 
         transportCombo.setSelectedItem(
-            SIPAccountRegistration.DEFAULT_TRANSPORT);
+            regform.getRegistration().getDefaultTransport());
 
         JPanel mainPanel = new TransparentPanel(new BorderLayout(10, 10));
 

File: src/net/java/sip/communicator/impl/protocol/jabber/RawUdpTransportManager.java
Patch:
@@ -77,6 +77,7 @@ public void startCandidateHarvest(List<ContentPacketExtension> theirOffer,
             cpExt.addChildExtension(ourTransport);
         }
 
+System.out.println("setting cpe list to " + ourAnswer + " in " + this);
         this.cpeList = ourAnswer;
     }
 
@@ -114,7 +115,7 @@ public void startCandidateHarvest(
 
             cpExt.addChildExtension(ourTransport);
         }
-
+System.out.println("setting cpe list to " + ourAnswer + " in " + this);
         this.cpeList = ourAnswer;
     }
 
@@ -172,6 +173,7 @@ private RawUdpTransportPacketExtension createTransport(
      */
     public List<ContentPacketExtension> wrapupHarvest()
     {
+System.out.println("returnin cpe list " + cpeList + " in " + this);
         return cpeList;
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/jinglesdp/JingleUtils.java
Patch:
@@ -89,7 +89,6 @@ public static List<MediaFormat> extractFormats(
             //continue if our media service does not know this format
             if(format == null)
             {
-System.out.println("Unsupported remote format: " + ptExt.toXML());
                 if(logger.isTraceEnabled())
                     logger.trace("Unsupported remote format: " + ptExt.toXML());
                 continue;

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1407,8 +1407,8 @@ public String getOurJID()
     {
         String jid = null;
 
-        if( connection != null )
-            connection.getUser();
+        if( connection != null && connection.getUser() != null)
+            return connection.getUser();
 
         if (jid == null)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerMediaHandlerJabberImpl.java
Patch:
@@ -115,7 +115,7 @@ public void processOffer(List<ContentPacketExtension> offer)
             MediaType mediaType
                             = MediaType.parseString( description.getMedia() );
 
-            List<MediaFormat> supportedFormats = JingleUtils.extractFormats(
+            List<MediaFormat> remoteFormats = JingleUtils.extractFormats(
                             description, getDynamicPayloadTypes());
 
             MediaDevice dev = getDefaultDevice(mediaType);
@@ -136,7 +136,7 @@ public void processOffer(List<ContentPacketExtension> offer)
 
             // intersect the MediaFormats of our device with remote ones
             List<MediaFormat> mutuallySupportedFormats
-                = intersectFormats(supportedFormats, dev.getSupportedFormats());
+                = intersectFormats(remoteFormats, dev.getSupportedFormats());
 
             // check whether we will be exchanging any RTP extensions.
             List<RTPExtension> offeredRTPExtensions
@@ -155,7 +155,7 @@ public void processOffer(List<ContentPacketExtension> offer)
 
             int targetDataPort = target.getDataAddress().getPort();
 
-            if (supportedFormats.isEmpty()
+            if (mutuallySupportedFormats.isEmpty()
                 || (devDirection == MediaDirection.INACTIVE)
                 || (targetDataPort == 0))
             {

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -218,13 +218,10 @@ private CallJabberImpl createOutgoingCall(String calleeAddress)
 
         try
         {
-System.out.println("1");
             call.initiateSession(fullCalleeURI, di);
-System.out.println("2");
         }
         catch(Throwable t)
         {
-t.printStackTrace();
             throw new OperationFailedException("Failed to create a call",
                             OperationFailedException.INTERNAL_ERROR, t);
         }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -218,7 +218,9 @@ private CallJabberImpl createOutgoingCall(String calleeAddress)
 
         try
         {
+System.out.println("1");
             call.initiateSession(fullCalleeURI, di);
+System.out.println("2");
         }
         catch(Throwable t)
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -222,7 +222,7 @@ private CallJabberImpl createOutgoingCall(String calleeAddress)
         }
         catch(Throwable t)
         {
-t.printStackTrace()
+t.printStackTrace();
             throw new OperationFailedException("Failed to create a call",
                             OperationFailedException.INTERNAL_ERROR, t);
         }

File: src/net/java/sip/communicator/impl/protocol/jabber/RawUdpTransportManager.java
Patch:
@@ -164,7 +164,8 @@ private RawUdpTransportPacketExtension createTransport(
 
     /**
      * Simply returns the list of local candidates that we gathered during the
-     * harvest.
+     * harvest. This is a raw udp transport manager so there's no real wraping
+     * up to do.
      *
      * @return the list of local candidates that we gathered during the
      * harvest.

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerJabberImpl.java
Patch:
@@ -162,7 +162,7 @@ protected synchronized void processSessionInitiate(JingleIQ sessionInitIQ)
             JingleIQ errResp = JinglePacketFactory.createSessionTerminate(
                 sessionInitIQ.getTo(), sessionInitIQ.getFrom(),
                 sessionInitIQ.getSID(), Reason.INCOMPATIBLE_PARAMETERS,
-                exc.getClass().getSimpleName() + ": " + exc.getMessage());
+                "Error: " + exc.getMessage());
 
             setState(CallPeerState.FAILED, "Error: " + exc.getMessage());
             getProtocolProvider().getConnection().sendPacket(errResp);
@@ -353,7 +353,7 @@ public void processSessionAccept(JingleIQ sessionInitIQ)
             JingleIQ errResp = JinglePacketFactory.createSessionTerminate(
                 sessionInitIQ.getTo(), sessionInitIQ.getFrom(),
                 sessionInitIQ.getSID(), Reason.INCOMPATIBLE_PARAMETERS,
-                exc.getMessage());
+                exc.getClass().getName() + ": " + exc.getMessage());
 
             setState(CallPeerState.FAILED, "Error: " + exc.getMessage());
             getProtocolProvider().getConnection().sendPacket(errResp);

File: src/net/java/sip/communicator/impl/protocol/jabber/CallPeerJabberImpl.java
Patch:
@@ -162,7 +162,7 @@ protected synchronized void processSessionInitiate(JingleIQ sessionInitIQ)
             JingleIQ errResp = JinglePacketFactory.createSessionTerminate(
                 sessionInitIQ.getTo(), sessionInitIQ.getFrom(),
                 sessionInitIQ.getSID(), Reason.INCOMPATIBLE_PARAMETERS,
-                exc.getMessage());
+                exc.getClass().getSimpleName() + ": " + exc.getMessage());
 
             setState(CallPeerState.FAILED, "Error: " + exc.getMessage());
             getProtocolProvider().getConnection().sendPacket(errResp);

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1456,7 +1456,6 @@ public InetAddress getNextHop()
             nextHopStr = getConnection().getHost();
         }
 
-
         try
         {
             nextHop = NetworkUtils.getInetAddress(nextHopStr);

File: src/net/java/sip/communicator/service/protocol/media/TransportManager.java
Patch:
@@ -135,9 +135,9 @@ public void closeStreamConnector(MediaType mediaType)
         {
             if(connector != null)
             {
-                audioStreamConnector.getDataSocket().close();
-                audioStreamConnector.getControlSocket().close();
-                audioStreamConnector = null;
+                connector.getDataSocket().close();
+                connector.getControlSocket().close();
+                connector = null;
             }
         }
 

File: src/net/java/sip/communicator/impl/gui/utils/ExtendedTooltip.java
Patch:
@@ -115,7 +115,7 @@ public void setTitle(String titleText)
      * @param icon the icon to show
      * @param text the name to show
      */
-    public void addLine(ImageIcon icon,
+    public void addLine(Icon icon,
                         String text)
     {
         JLabel lineLabel = new JLabel(  text,

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -266,13 +266,13 @@ public void messageReceived(ChatRoomMessageReceivedEvent evt)
             String nickname = sourceChatRoom.getUserNickname();
 
             int atIx = nickname.indexOf("@");
-
+            
             fireChatNotification =
                 (nickname == null)
                     || messageContent.toLowerCase().contains(
                         nickname.toLowerCase())
                     || ((atIx == -1)? false : messageContent.toLowerCase()
-                        .contains(nickname.substring(0, atIx + 1)));
+                        .contains(nickname.substring(0, atIx).toLowerCase()));
         }
         if (fireChatNotification)
         {

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableDialog.java
Patch:
@@ -94,7 +94,6 @@ public static void showChatRoomTableDialog()
             chatRoomTableDialog
                 = new ChatRoomTableDialog(
                         GuiActivator.getUIService().getMainFrame());
-            chatRoomTableDialog.setPreferredSize(new Dimension(500, 400));
 
             /*
              * When the global/shared ChatRoomTableDialog closes, don't keep a
@@ -194,6 +193,9 @@ public void itemStateChanged(ItemEvent e)
         chatRoomsTableUI.setOpaque(false);
         chatRoomsTableUI.setBorder(BorderFactory.createEmptyBorder(5, 15, 5, 15));
 
+        // this controls and the whole dialog width
+        northPanel.setPreferredSize(new Dimension(600, 80));
+
         this.getContentPane().add(northPanel, BorderLayout.NORTH);
         this.getContentPane().add(buttonPanel, BorderLayout.SOUTH);
         this.getContentPane().add(chatRoomsTableUI, BorderLayout.CENTER);

File: src/net/java/sip/communicator/service/neomedia/AbstractMediaStream.java
Patch:
@@ -74,7 +74,9 @@ protected void firePropertyChange(
      * @param encoding
      * @param clockRate
      * @param channels
-     * @return
+     * @return <tt>true</tt> if the specified <tt>format</tt> has specific
+     * values for its properties <tt>mediaType</tt>, <tt>encoding</tt>,
+     * <tt>clockRate</tt> and <tt>channels</tt>; otherwise, <tt>false</tt>
      */
     public static boolean matches(
             MediaFormat format,

File: src/net/java/sip/communicator/service/neomedia/AudioMediaStream.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.service.neomedia;
 
-import net.java.sip.communicator.impl.neomedia.audiolevel.*;
 import net.java.sip.communicator.service.neomedia.event.*;
 
 /**

File: src/net/java/sip/communicator/service/neomedia/event/RTCPFeedbackEvent.java
Patch:
@@ -14,7 +14,8 @@
  *
  * @author Sebastien Vincent
  */
-public class RTCPFeedbackEvent extends EventObject
+public class RTCPFeedbackEvent
+    extends EventObject
 {
     /**
      * Transport layer type (payload type).

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomWrapper.java
Patch:
@@ -199,7 +199,7 @@ public void setAutoJoin(boolean value)
     {
         autoJoin = value;
 
-        if(!persistent)
+        if(!isPersistent())
             return;
 
         if(value)

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -1089,15 +1089,15 @@ public void connectionClosedOnError(Exception exception)
                             eventDuringLogin = new RegistrationStateChangeEvent(
                                 ProtocolProviderServiceJabberImpl.this,
                                 getRegistrationState(),
-                                RegistrationState.CONNECTION_FAILED,
+                                RegistrationState.UNREGISTERED,
                                 RegistrationStateChangeEvent.REASON_MULTIPLE_LOGINS,
                                 "Connecting multiple times with the same resource");
                              return;
                         }
                     }
 
                     fireRegistrationStateChanged(getRegistrationState(),
-                        RegistrationState.CONNECTION_FAILED,
+                        RegistrationState.UNREGISTERED,
                         RegistrationStateChangeEvent.REASON_MULTIPLE_LOGINS,
                         "Connecting multiple times with the same resource");
                     return;

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomTableDialog.java
Patch:
@@ -447,6 +447,9 @@ public Component getListCellRendererComponent(JList list, Object value,
         {
             ChatRoomProviderWrapper provider = (ChatRoomProviderWrapper)value;
 
+            if(provider == null)
+                return this;
+
             if (isSelected)
             {
                 setBackground(list.getSelectionBackground());

File: src/net/java/sip/communicator/impl/gui/main/account/NewAccountDialog.java
Patch:
@@ -440,7 +440,7 @@ public static void showNewAccountDialog()
      */
     protected void close(boolean isEscaped)
     {
-        newAccountDialog = null;
+        dispose();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/SendSmsDialog.java
Patch:
@@ -169,5 +169,6 @@ private void sendSmsMessage(String phoneNumber, String message)
     @Override
     protected void close(boolean isEscaped)
     {
+        this.dispose();
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListDialog.java
Patch:
@@ -167,5 +167,6 @@ else if (buttonName.equals(JOIN_CHAT_ROOM))
     @Override
     protected void close(boolean isEscaped)
     {
+        this.dispose();
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigurationFrame.java
Patch:
@@ -187,6 +187,7 @@ public void setVisible(boolean isVisible)
      */
     protected void close(boolean isEscaped)
     {
+        this.setVisible(false);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/caps/CapsPacketExtension.java
Patch:
@@ -80,6 +80,7 @@ public CapsPacketExtension(String ext,
                                String hash,
                                String ver)
     {
+        this.ext = ext;
         this.node = node;
         this.ver = ver;
         this.hash = hash;

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationForm.java
Patch:
@@ -107,7 +107,7 @@ void setNextFinishButtonEnabled(boolean isEnabled)
      * @param userName the username.
      * @return the server part of the sip user name.
      */
-    private String getServerFromUserName(String userName)
+    static String getServerFromUserName(String userName)
     {
         int delimIndex = userName.indexOf("@");
         if (delimIndex != -1)

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -1040,9 +1040,7 @@ public void run()
                     responsePacket.setTo(fromID);
                     parentProvider.getConnection().sendPacket(responsePacket);
 
-                        }
-                    }
-                ).start();
+                }}).start();
             }
             else if (presenceType == Presence.Type.unsubscribed)
             {

File: src/net/java/sip/communicator/impl/gui/utils/ExtendedTooltip.java
Patch:
@@ -159,6 +159,7 @@ private class ImageToolTipUI extends MetalToolTipUI
          * @param g the <tt>Graphics</tt> object
          * @param c the component used to render the tooltip
          */
+        @Override
         public void paint(Graphics g, JComponent c)
         {}
 
@@ -167,6 +168,7 @@ public void paint(Graphics g, JComponent c)
          * @param c the component used to render the tooltip
          * @return the size of the given component.
          */
+        @Override
         public Dimension getPreferredSize(JComponent c)
         {
             Icon icon = imageLabel.getIcon();

File: src/net/java/sip/communicator/impl/gui/main/account/NewAccountDialog.java
Patch:
@@ -370,9 +370,11 @@ else if (sourceButton.equals(addAccountButton))
                 protocolProvider = wizard.signin();
 
                 if (protocolProvider != null)
+                {
                     wizardContainer.saveAccountWizard(protocolProvider, wizard);
 
-                this.dispose();
+                    this.dispose();
+                }
             }
             catch (OperationFailedException e)
             {

File: src/net/java/sip/communicator/impl/neomedia/codec/EncodingConfiguration.java
Patch:
@@ -164,13 +164,13 @@ public void initializeFormatPreferences()
             800);
 
         // audio
+        setEncodingPreference("speex", 32000, 701);
+        setEncodingPreference("speex", 16000, 700);
         setEncodingPreference("PCMU", 8000, 650);
         setEncodingPreference("PCMA", 8000, 600);
         setEncodingPreference("iLBC", 8000, 500);
         setEncodingPreference("GSM", 8000, 450);
         setEncodingPreference("speex", 8000, 352);
-        setEncodingPreference("speex", 16000, 351);
-        setEncodingPreference("speex", 32000, 350);
         setEncodingPreference("DVI4", 8000, 300);
         setEncodingPreference("DVI4", 16000, 250);
         setEncodingPreference("G723", 8000, 150);

File: src/net/java/sip/communicator/impl/protocol/sip/ActiveCallsRepositorySipImpl.java
Patch:
@@ -149,9 +149,6 @@ public CallPeerSipImpl findCallPeer(String callID,
         {
             CallSipImpl call = activeCalls.next();
 
-            if (!callID.equals(call.getCallID()))
-                continue;
-
             for (Iterator<? extends CallPeer> callPeerIter
                             = call.getCallPeers();
                     callPeerIter.hasNext();)
@@ -162,6 +159,9 @@ public CallPeerSipImpl findCallPeer(String callID,
 
                 if (dialog != null)
                 {
+                    if (!callID.equals(dialog.getCallId().getCallId()))
+                        continue;
+
                     String dialogLocalTag = dialog.getLocalTag();
 
                     if (((localTag == null) || "0".equals(localTag))

File: src/net/java/sip/communicator/impl/protocol/sip/CallSipImpl.java
Patch:
@@ -321,7 +321,7 @@ public CallPeerSipImpl findCallPeer(Dialog dialog)
     @Override
     public ProtocolProviderServiceSipImpl getProtocolProvider()
     {
-        return (ProtocolProviderServiceSipImpl)super.getProtocolProvider();
+        return super.getProtocolProvider();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -1631,7 +1631,8 @@ public void transfer(CallPeer transferee, CallPeer transferTarget)
         try
         {
             sipURI.setHeader(ReplacesHeader.NAME,
-                    URLEncoder.encode(replacesHeader.encode(), "UTF-8"));
+                    URLEncoder.encode(replacesHeader.encodeBody(
+                        new StringBuilder()).toString(), "UTF-8"));
         }
         catch (Exception ex)
         {

File: src/net/java/sip/communicator/service/protocol/media/CallPeerMediaHandler.java
Patch:
@@ -392,9 +392,10 @@ public void setLocallyOnHold(boolean locallyOnHold)
 
     /**
      * Closes and null-ifies all streams and connectors and readies this media
-     * handler for garbage collection (or reuse).
+     * handler for garbage collection (or reuse). Synchronized if any other
+     * stream operations are in process we won't interrupt them.
      */
-    public void close()
+    public synchronized void close()
     {
         closeStream(MediaType.AUDIO);
         closeStream(MediaType.VIDEO);

File: src/net/java/sip/communicator/impl/protocol/jabber/OutgoingFileTransferJabberImpl.java
Patch:
@@ -88,7 +88,7 @@ public OutgoingFileTransferJabberImpl(
                             new String[]{"urn:xmpp:thumbs:0",
                                 "urn:xmpp:bob"}))
             {
-                protocolProvider.getConnection().addPacketWriterInterceptor(
+                protocolProvider.getConnection().addPacketInterceptor(
                     this,
                     new IQTypeFilter(IQ.Type.SET));
             }
@@ -213,7 +213,7 @@ public void interceptPacket(Packet packet)
             }
         }
         // Remove this packet interceptor after we're done.
-        protocolProvider.getConnection().removePacketWriterInterceptor(this);
+        protocolProvider.getConnection().removePacketInterceptor(this);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/BandwidthPacketExtension.java
Patch:
@@ -56,7 +56,7 @@ public void setType(String type)
      */
     public String getType()
     {
-        return getAttributeString(TYPE_ARG_NAME);
+        return getAttributeAsString(TYPE_ARG_NAME);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/ContentProvider.java
Patch:
@@ -86,7 +86,7 @@ public ContentPacketExtension parseExtension(final XmlPullParser parser)
                 }
 
                 PacketExtension extension = provider.parseExtension(parser);
-                content.addExtensions(extension);
+                content.addChildExtension(extension);
             }
             else if (eventType == XmlPullParser.END_TAG)
             {
@@ -96,7 +96,6 @@ else if (eventType == XmlPullParser.END_TAG)
                 }
             }
         }
-
         return content;
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/EncryptionPacketExtension.java
Patch:
@@ -92,7 +92,7 @@ public void setRequired(boolean required)
      */
     public boolean isRequired()
     {
-        String required = getAttributeString(REQUIRED_ARG_NAME);
+        String required = getAttributeAsString(REQUIRED_ARG_NAME);
 
         return Boolean.valueOf(required) || "1".equals(required);
     }
@@ -103,7 +103,7 @@ public boolean isRequired()
      * @return a {@link List} containing all our <tt>crypto</tt> sub-elements.
      */
     @Override
-    public List<? extends PacketExtension> getChildElements()
+    public List<? extends PacketExtension> getChildExtensions()
     {
         return getCryptoList();
     }

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/jingle/JingleIQProvider.java
Patch:
@@ -8,7 +8,6 @@
 import net.java.sip.communicator.util.*;
 
 import org.jivesoftware.smack.provider.*;
-import org.jivesoftware.smackx.packet.*;
 import org.xmlpull.v1.XmlPullParser;
 
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransferHandler.java
Patch:
@@ -174,7 +174,7 @@ else if (t.isDataFlavorSupported(uiContactDataFlavor))
 
                 if (contact != null)
                 {
-                    ArrayList inviteList = new ArrayList();
+                    List<String> inviteList = new ArrayList<String>();
                     inviteList.add(contact);
                     chatPanel.inviteContacts(   currentChatTransport,
                                                 inviteList, null);

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/quicktime/QuickTimeStream.java
Patch:
@@ -131,7 +131,7 @@ public class QuickTimeStream
         }
 
         automaticallyDropsLateVideoFrames
-            = false;//captureOutput.setAutomaticallyDropsLateVideoFrames(true);
+            = captureOutput.setAutomaticallyDropsLateVideoFrames(true);
         captureOutput
             .setDelegate(
                 new QTCaptureDecompressedVideoOutput.Delegate()

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -786,6 +786,7 @@ else if(evt.getNewState() == RegistrationState.UNREGISTERED
                 fireProviderStatusChangeEvent(oldStatus, currentStatus);
 
                 ssContactList.cleanup();
+                subscribtionPacketListener = null;
 
                 if(parentProvider.getConnection() != null &&
                     parentProvider.getConnection().getRoster() != null)

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -696,7 +696,9 @@ void cleanup()
             imageRetriever = null;
         }
 
-        this.roster.removeRosterListener(rosterChangeListener);
+        if(this.roster != null)
+            this.roster.removeRosterListener(rosterChangeListener);
+
         this.rosterChangeListener = null;
         this.roster = null;
     }

File: src/net/java/sip/communicator/impl/protocol/jabber/VolatileContactGroupJabberImpl.java
Patch:
@@ -44,6 +44,7 @@ public class VolatileContactGroupJabberImpl
      * Returns the name of this group.
      * @return a String containing the name of this group.
      */
+    @Override
     public String getGroupName()
     {
         return contactGroupName;
@@ -54,6 +55,7 @@ public String getGroupName()
      * JabberGroup.GroupName[size]{ buddy1.toString(), buddy2.toString(), ...}.
      * @return  a String representation of the object.
      */
+    @Override
     public String toString()
     {
         StringBuffer buff = new StringBuffer("VolatileJabberGroup.");
@@ -77,6 +79,7 @@ public String toString()
      * containing non persistent contacts.
      * @return true if the contact group is persistent and false otherwise.
      */
+    @Override
     public boolean isPersistent()
     {
         return false;

File: src/net/java/sip/communicator/impl/gui/main/account/AccountListCellRenderer.java
Patch:
@@ -104,8 +104,7 @@ public Component getListCellRendererComponent(JList list, Object value,
         this.index = index;
         this.isSelected = isSelected;
 
-        if (getBounds().width == 0)
-            this.setBounds(0, 0, list.getWidth(), getPreferredSize().height);
+        this.setBounds(0, 0, list.getWidth(), getPreferredSize().height);
 
         this.addCheckBox();
 

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberAccountID.java
Patch:
@@ -25,8 +25,9 @@ public class JabberAccountID
      */
     JabberAccountID(String id, Map<String, String> accountProperties )
     {
-        super(id, accountProperties, ProtocolNames.JABBER,
-              getServiceName(accountProperties));
+        super(  id, accountProperties,
+                ProtocolNames.JABBER,
+                getServiceName(accountProperties));
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/SipAccountID.java
Patch:
@@ -43,7 +43,7 @@ protected SipAccountID(String userID, Map<String, String> accountProperties,
         String serverName)
     {
         super(stripServerNameFromUserID(userID), accountProperties,
-            accountProperties.get(ProtocolProviderFactory.PROTOCOL),
+            ProtocolNames.SIP,
             serverName);
     }
 

File: src/net/java/sip/communicator/impl/neomedia/ZrtpConfigureTableModel.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.plugin.securityconfig.call;
+package net.java.sip.communicator.impl.neomedia;
 
 import java.util.*;
 

File: src/net/java/sip/communicator/plugin/otr/ScOtrEngine.java
Patch:
@@ -15,7 +15,7 @@
  * 
  * @author George Politis
  */
-public interface OtrEngineService
+public interface ScOtrEngine
 {
     // Proxy methods OtrEngine.
 

File: src/net/java/sip/communicator/plugin/otr/ScOtrKeyManager.java
Patch:
@@ -14,8 +14,9 @@
  * @author George Politis
  *
  */
-public interface OtrKeyManagerService
+public interface ScOtrKeyManager
 {
+
     public abstract void addListener(ScOtrKeyManagerListener l);
 
     public abstract void removeListener(ScOtrKeyManagerListener l);

File: src/net/java/sip/communicator/plugin/otr/ScOtrKeyManagerImpl.java
Patch:
@@ -15,8 +15,8 @@
 /**
  * @author George Politis
  */
-public class OtrKeyManagerServiceImpl
-    implements OtrKeyManagerService
+public class ScOtrKeyManagerImpl
+    implements ScOtrKeyManager
 {
     private final OtrConfigurator configurator = new OtrConfigurator();
 

File: src/net/java/sip/communicator/impl/neomedia/DeviceConfigurationComboBoxModel.java
Patch:
@@ -28,8 +28,8 @@ public static class CaptureDevice
     {
         /**
          * Compares two CaptureDeviceInfo
-         * @param a
-         * @param b
+         * @param a first <tt>CaptureDeviceInfo</tt> to compare
+         * @param b second <tt>CaptureDeviceInfo</tt> to compare
          * @return whether a is equal to b
          */
         public static boolean equals(CaptureDeviceInfo a, CaptureDeviceInfo b)
@@ -206,7 +206,7 @@ private CaptureDevice[] getDevices()
 
     /**
      * Extracts the devices selected by the configuration.
-     * @return
+     * @return <tt>CaptureDevice</tt> selected
      */
     private CaptureDevice getSelectedDevice()
     {

File: src/net/java/sip/communicator/impl/neomedia/codec/video/FinalizableAVFrame.java
Patch:
@@ -71,6 +71,7 @@ protected void finalize()
     /**
      * Frees the memory pointed to by the <tt>data0</tt> member of the native
      * <tt>AVFrame</tt>.
+     * @param data0 pointer to free
      */
     protected void freeData0(long data0)
     {

File: src/net/java/sip/communicator/impl/neomedia/device/AudioMediaDeviceSession.java
Patch:
@@ -56,7 +56,7 @@ protected AudioMediaDeviceSession(AbstractMediaDevice device)
     }
 
     /**
-     * Called by {@link MediaDeviceSession#createPlayer(DataSource dataSource)} 
+     * Called by {@link MediaDeviceSession#createPlayer(DataSource dataSource)}
      * when the player associated with this session's
      * <tt>ReceiveStream</tt> moves enters the <tt>Configured</tt> state, so
      * we use the occasion to add our audio level effect.

File: src/net/java/sip/communicator/impl/neomedia/device/ImageStreamingAuto.java
Patch:
@@ -17,11 +17,10 @@
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.*;
 import net.java.sip.communicator.impl.neomedia.imgstreaming.*;
-import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.imgstreaming.*;
 
 /**
  * Add ImageStreaming capture device.
- * 
+ *
  * @author Sebastien Vincent
  */
 public class ImageStreamingAuto
@@ -94,7 +93,7 @@ public ImageStreamingAuto() throws Exception
                         new MediaLocator(
                             ImageStreamingUtils.LOCATOR_PROTOCOL + ":" + i),
                         formats);
-        
+
             /* add to JMF device manager */
             CaptureDeviceManager.addDevice(devInfo);
             i++;

File: src/net/java/sip/communicator/impl/neomedia/device/PortAudioAuto.java
Patch:
@@ -195,13 +195,13 @@ public class PortAudioAuto
      * Gets a sample rate supported by a PortAudio device with a specific device
      * index with which it is to be registered with JMF.
      *
-     * @param <tt>true</tt> if the supported sample rate is to be retrieved for
+     * @param input <tt>true</tt> if the supported sample rate is to be retrieved for
      * the PortAudio device with the specified device index as an input device
      * or <tt>false</tt> for an output device
      * @param deviceIndex the device index of the PortAudio device for which a
      * supported sample rate is to be retrieved
-     * @param channelCount
-     * @param sampleFormat
+     * @param channelCount number of channel
+     * @param sampleFormat sample format
      * @return a sample rate supported by the PortAudio device with the
      * specified device index with which it is to be registered with JMF
      */

File: src/net/java/sip/communicator/impl/neomedia/directshow/DSManager.java
Patch:
@@ -175,7 +175,8 @@ public DSCaptureDevice[] getCaptureDevices()
     /**
      * Native method to get capture devices pointers.
      *
-     * @return array of native pointer
+     * @param ptr native pointer of DSManager
+     * @return array of native pointer to DSCaptureDevice
      */
     private native long[] getCaptureDevices(long ptr);
 }

File: src/net/java/sip/communicator/impl/neomedia/imgstreaming/ImageStreamingUtils.java
Patch:
@@ -32,7 +32,7 @@ public class ImageStreamingUtils
      * @param src source image
      * @param width width of scaled image
      * @param height height of scaled image
-     * @param type
+     * @param type <tt>BufferedImage</tt> type
      * @return scaled <tt>BufferedImage</tt>
      */
     public static BufferedImage getScaledImage(BufferedImage src,
@@ -63,7 +63,7 @@ public static BufferedImage getScaledImage(BufferedImage src,
      * @param output output buffer, if not null and if its length is at least
      * image's (width * height) * 4, method will put bytes in it.
      * @return raw bytes or null if src is not an ARGB
-     * <tt>BufferedImage</tt> 
+     * <tt>BufferedImage</tt>
      */
     public static byte[] getImageBytes(BufferedImage src, byte output[])
     {

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/portaudio/DataSource.java
Patch:
@@ -67,9 +67,9 @@ public DataSource(MediaLocator locator)
      * @param locator the <tt>MediaLocator</tt> to create the new instance from
      * @param supportedFormats the list of <tt>Format</tt>s in which the new
      * instance is to be capable of capturing audio data
-     * @param audioQuality <tt>true</tt> if audio quality improvement is to be
-     * enabled in accord with the preferences of the user or <tt>false</tt> to
-     * completely disable audio quality improvement
+     * @param audioQualityImprovement <tt>true</tt> if audio quality improvement
+     * is to be enabled in accord with the preferences of the user or
+     * <tt>false</tt> to completely disable audio quality improvement
      */
     public DataSource(
             MediaLocator locator,

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/quicktime/QuickTimeStream.java
Patch:
@@ -105,8 +105,8 @@ public class QuickTimeStream
      * The <tt>Thread</tt> which is to call
      * {@link BufferTransferHandler#transferData(PushBufferStream)} for this
      * <tt>QuickTimeStream</tt> so that the call is not made in QuickTime/QTKit
-     * and we can drop late frames when {@link #automaticallyDropsLateFrames} is
-     * <tt>false</tt>.
+     * and we can drop late frames when
+     * {@link #automaticallyDropsLateVideoFrames} is <tt>false</tt>.
      */
     private Thread transferDataThread;
 

File: test/net/java/sip/communicator/slick/protocol/sip/TestAccountInstallation.java
Patch:
@@ -102,7 +102,6 @@ public void testInstallAccount()
             sipAccount2Properties.get(ProtocolProviderFactory.USER_ID)
             , sipAccount2Properties);
 
-
         //try to install one of the accounts one more time and verify that an
         //excepion is thrown.
         try{
@@ -126,7 +125,6 @@ public void testInstallAccount()
 
         //Verify protocol providers corresponding to the new account have
         //been properly registered with the osgi framework.
-
         osgiFilter =
             "(&("+ProtocolProviderFactory.PROTOCOL +"="+ProtocolNames.SIP+")"
              +"(" + ProtocolProviderFactory.USER_ID
@@ -146,7 +144,7 @@ public void testInstallAccount()
             fail(osgiFilter + "is not a valid osgi filter");
         }
 
-        assertTrue("An ICQ protocol provider was apparently not installed as "
+        assertTrue("A SIP protocol provider was apparently not installed as "
                 + "requested."
                 , serRefs != null && serRefs.length > 0);
 

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/quicktime/QuickTimeStream.java
Patch:
@@ -180,6 +180,7 @@ private void captureOutputDidOutputVideoFrameWithSampleBuffer(
     {
         CVPixelBuffer pixelBuffer = (CVPixelBuffer) videoFrame;
         boolean transferData;
+        Format videoFrameFormat = getVideoFrameFormat(pixelBuffer);
 
         synchronized (dataSyncRoot)
         {
@@ -201,7 +202,7 @@ private void captureOutputDidOutputVideoFrameWithSampleBuffer(
                                     nextData.capacity));
                     nextDataTimeStamp = System.nanoTime();
                     if (nextDataFormat == null)
-                        nextDataFormat = getVideoFrameFormat(pixelBuffer);
+                        nextDataFormat = videoFrameFormat;
                 }
                 return;
             }
@@ -218,7 +219,7 @@ private void captureOutputDidOutputVideoFrameWithSampleBuffer(
                 data.setLength(pixelBuffer.getBytes(data.ptr, data.capacity));
                 dataTimeStamp = System.nanoTime();
                 if (dataFormat == null)
-                    dataFormat = getVideoFrameFormat(pixelBuffer);
+                    dataFormat = videoFrameFormat;
             }
             if (nextData != null)
             {

File: src/net/java/sip/communicator/impl/neomedia/MediaStreamImpl.java
Patch:
@@ -560,8 +560,6 @@ else if (dataSource instanceof PullDataSource)
 
         for (int streamIndex = 0; streamIndex < streamCount; streamIndex++)
         {
-            Throwable exception = null;
-
             try
             {
                 SendStream sendStream

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/AbstractPullBufferCaptureDevice.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.io.*;
 import java.lang.reflect.*;
-import java.util.*;
 
 import javax.media.*;
 import javax.media.control.*;

File: src/net/java/sip/communicator/impl/gui/main/account/AccountList.java
Patch:
@@ -264,13 +264,13 @@ public void addAccount(Account account)
             }
 
             boolean isAccountAdded = false;
-            Enumeration<Account> accounts = (Enumeration<Account>) elements();
+            Enumeration<?> accounts = elements();
             AccountID accountID = account.getProtocolProvider().getAccountID();
 
             // If we already have other accounts.
             while (accounts.hasMoreElements())
             {
-                Account a = accounts.nextElement();
+                Account a = (Account) accounts.nextElement();
                 AccountID listAccountID = a.getProtocolProvider().getAccountID();
 
                 int accountIndex = indexOf(a);

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -756,7 +756,7 @@ protected String findAccountPrefix(BundleContext bundleContext,
                 accountRootPropertyName //node id
                 + "." + ACCOUNT_UID); // propname
 
-            if (accountUID.equals(accountID.getAccountUniqueID()))
+            if (accountID.getAccountUniqueID().equals(accountUID))
             {
                 return accountRootPropertyName;
             }

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/speex/SpeexResampler.java
Patch:
@@ -57,8 +57,8 @@ public class SpeexResampler
                         1 /* channels */,
                         AudioFormat.LITTLE_ENDIAN,
                         AudioFormat.SIGNED,
-                        16,
-                        SUPPORTED_SAMPLE_RATES[i],
+                        Format.NOT_SPECIFIED,
+                        Format.NOT_SPECIFIED,
                         Format.byteArray);
         }
     }
@@ -231,7 +231,7 @@ public Format setInputFormat(Format format)
                         inputFormat.getEndian(),
                         inputFormat.getSigned(),
                         Format.NOT_SPECIFIED,
-                        inputFormat.getFrameSizeInBits(),
+                        Format.NOT_SPECIFIED,
                         inputFormat.getDataType()));
         }
         return inputFormat;

File: src/net/java/sip/communicator/impl/neomedia/device/PortAudioAuto.java
Patch:
@@ -109,7 +109,7 @@ public class PortAudioAuto
                                             1 /* channels */,
                                             AudioFormat.LITTLE_ENDIAN,
                                             AudioFormat.SIGNED,
-                                            16 /* frameSizeInBits */,
+                                            Format.NOT_SPECIFIED /* frameSizeInBits */,
                                             Format.NOT_SPECIFIED /* frameRate */,
                                             Format.byteArray)
                                 });

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/portaudio/PortAudioStream.java
Patch:
@@ -284,7 +284,7 @@ synchronized void setDeviceIndex(int deviceIndex)
                             channels,
                             AudioFormat.LITTLE_ENDIAN,
                             AudioFormat.SIGNED,
-                            sampleSizeInBits * channels,
+                            Format.NOT_SPECIFIED /* frameSizeInBits */,
                             Format.NOT_SPECIFIED /* frameRate */,
                             Format.byteArray);
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -2604,7 +2604,7 @@ public void unsubscribeToAllContact()
                  {
                      unsubscribe(contact, false);
                  }
-                 catch (OperationFailedException ex)
+                 catch (Throwable ex)
                  {
                      logger.error(
                          "Failed to unsubscribe to contact " + contact,

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchField.java
Patch:
@@ -119,7 +119,7 @@ private void updateContactListView()
         }
 
         if (logger.isDebugEnabled())
-            logger.debug("Is filter query for string "
+            logger.debug("Filter query for string "
                 + filterString + " : " + filterQuery);
 
         if (filterQuery != null && !filterQuery.isCanceled())

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -995,6 +995,9 @@ public void run()
      */
     public FilterQuery applyFilter(ContactListFilter filter)
     {
+        if (logger.isDebugEnabled())
+            logger.debug("Contact list filter applied: " + filter);
+
         if (currentFilterQuery != null && !currentFilterQuery.isCanceled())
             currentFilterQuery.cancel();
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchField.java
Patch:
@@ -8,7 +8,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.main.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
 import net.java.sip.communicator.util.swing.event.*;
 

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -256,7 +256,9 @@ public void startConnecting(ProtocolProviderService protocolProvider)
      */
     public void stopConnecting(ProtocolProviderService protocolProvider)
     {
-        accountMenus.get(protocolProvider).stopConnecting();
+        StatusSelectorMenu selectorMenu = accountMenus.get(protocolProvider);
+        if (selectorMenu != null)
+            selectorMenu.stopConnecting();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceCallPanel.java
Patch:
@@ -167,7 +167,7 @@ public void addCallPeerPanel(CallPeer peer)
         // Add the renderer component to this container.
         constraints.fill = GridBagConstraints.BOTH;
         constraints.gridx = 0;
-        constraints.gridy = mainPanel.getComponentCount() + 1;
+        constraints.gridy++;
         constraints.weightx = 1;
         constraints.weighty = 0;
         constraints.insets = new Insets(0, 0, 10, 0);

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferencePeerPanel.java
Patch:
@@ -138,6 +138,8 @@ public ConferencePeerPanel(CallDialog callDialog, CallPeer callPeer)
         this.callDialog = callDialog;
         this.callPeer = callPeer;
 
+        this.setMute(callPeer.isMute());
+
         this.setPeerImage(CallManager.getPeerImage(callPeer));
 
         this.setPeerName(callPeer.getDisplayName());

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -1605,6 +1605,7 @@ else if (e.getKeyCode() == KeyEvent.VK_ENTER
             }
 
             if (!searchField.isFocusOwner()
+                && keyManager.getFocusOwner() != null
                 && keyManager.getFocusOwner()
                     .equals(keyManager.getPermanentFocusOwner()))
             {

File: src/net/java/sip/communicator/impl/gui/main/call/conference/CallPeerMenu.java
Patch:
@@ -57,11 +57,13 @@ public CallPeerMenu(CallPeer peer)
         this.callPeer = peer;
 
         this.setOpaque(false);
-        this.setPreferredSize(new Dimension(20, 20));
 
         // Should explicitly remove any border in order to align correctly the
         // icon.
         this.setBorder(BorderFactory.createEmptyBorder());
+        this.setPreferredSize(new Dimension(16, 16));
+        this.setHorizontalAlignment(SwingConstants.CENTER);
+
         this.setIcon(new ImageIcon(ImageLoader
             .getImage(ImageLoader.CALL_PEER_TOOLS)));
         this.setIconTextGap(0);

File: src/net/java/sip/communicator/util/swing/SIPCommMenuBar.java
Patch:
@@ -19,8 +19,6 @@
 public class SIPCommMenuBar
     extends JMenuBar
 {
-    private boolean isRollover;
-
     public SIPCommMenuBar()
     {
         this.setBorder(BorderFactory.createEmptyBorder());

File: src/net/java/sip/communicator/impl/resources/ResourceManagementActivator.java
Patch:
@@ -39,7 +39,8 @@ public void start(BundleContext bc) throws Exception
                                         resPackImpl,
                                         null);
 
-        logger.info("Resource manager ... [REGISTERED]");
+        if (logger.isInfoEnabled())
+            logger.info("Resource manager ... [REGISTERED]");
     }
 
     public void stop(BundleContext bc) throws Exception

File: src/net/java/sip/communicator/plugin/contactinfo/ContactInfoActivator.java
Patch:
@@ -41,7 +41,8 @@ public void start(BundleContext bc) throws Exception
                                         cinfoMenuItem,
                                         containerFilter);
 
-        logger.info("CONTACT INFO... [REGISTERED]");
+        if (logger.isInfoEnabled())
+            logger.info("CONTACT INFO... [REGISTERED]");
     }
 
     public void stop(BundleContext bc) throws Exception

File: src/net/java/sip/communicator/plugin/defaultresourcepack/DefaultResourcePackActivator.java
Patch:
@@ -89,7 +89,8 @@ public void start(BundleContext bc) throws Exception
                                         sndPackImpl,
                                         sndProps);
 
-        logger.info("Default resources ... [REGISTERED]");
+        if (logger.isInfoEnabled())
+            logger.info("Default resources ... [REGISTERED]");
     }
 
     public void stop(BundleContext bc) throws Exception

File: src/net/java/sip/communicator/plugin/dictaccregwizz/ThreadManager.java
Patch:
@@ -82,7 +82,8 @@ public boolean waitThread()
         }
         catch (InterruptedException e)
         {
-            logger.info(e);
+            if (logger.isInfoEnabled())
+                logger.info(e);
             return false;
         }
         return true;

File: src/net/java/sip/communicator/plugin/exampleplugin/ExamplePluginActivator.java
Patch:
@@ -45,7 +45,8 @@ public void start(BundleContext bc)
                                         examplePlugin,
                                         containerFilter);
 
-        logger.info("CONTACT INFO... [REGISTERED]");
+        if (logger.isInfoEnabled())
+            logger.info("CONTACT INFO... [REGISTERED]");
     }
 
     /**

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigPluginActivator.java
Patch:
@@ -47,7 +47,8 @@ public void start(BundleContext bc) throws Exception
                     0),
                 null);
 
-        logger.info("PREFERENCES PLUGIN... [REGISTERED]");
+        if (logger.isInfoEnabled())
+            logger.info("PREFERENCES PLUGIN... [REGISTERED]");
     }
 
     public void stop(BundleContext bc) throws Exception

File: src/net/java/sip/communicator/plugin/globalproxyconfig/GlobalProxyPluginActivator.java
Patch:
@@ -60,7 +60,8 @@ public void start(BundleContext bc) throws Exception
 
         initProperties();
 
-        logger.info("GLOBAL PROXY CONFIGURATION PLUGIN... [REGISTERED]");
+        if (logger.isInfoEnabled())
+            logger.info("GLOBAL PROXY CONFIGURATION PLUGIN... [REGISTERED]");
     }
 
     /**

File: src/net/java/sip/communicator/plugin/keybindingchooser/KeybindingChooserActivator.java
Patch:
@@ -36,7 +36,8 @@ public void start(BundleContext context)
     {
         bundleContext = context;
 
-        logger.debug("Service Impl: " + getClass().getName() + " [  STARTED ]");
+        if (logger.isDebugEnabled())
+            logger.debug("Service Impl: " + getClass().getName() + " [  STARTED ]");
 
         context
             .registerService(

File: src/net/java/sip/communicator/plugin/notificationconfiguration/NotificationConfigurationActivator.java
Patch:
@@ -46,7 +46,8 @@ public void start(BundleContext bc) throws Exception
                     30),
                 null);
 
-        logger.trace("Notification Configuration: [ STARTED ]");
+        if (logger.isTraceEnabled())
+            logger.trace("Notification Configuration: [ STARTED ]");
     }
 
     /**

File: src/net/java/sip/communicator/plugin/simpleaccreg/InitialAccountRegistrationFrame.java
Patch:
@@ -462,7 +462,8 @@ public void actionPerformed(ActionEvent evt)
                     }
                     catch (OperationFailedException e)
                     {
-                        logger.debug("The sign in operation has failed.");
+                        if (logger.isDebugEnabled())
+                            logger.debug("The sign in operation has failed.");
 
                         PopupDialog popupDialog
                             = SimpleAccountRegistrationActivator.getUIService()

File: src/net/java/sip/communicator/plugin/simpleaccreg/SimpleAccountRegistrationActivator.java
Patch:
@@ -49,7 +49,8 @@ public void start(BundleContext bc) throws Exception
             accountRegFrame.setVisible(true);
         }
         
-        logger.info("SIMPLE ACCOUNT REGISTRATION ...[STARTED]");
+        if (logger.isInfoEnabled())
+            logger.info("SIMPLE ACCOUNT REGISTRATION ...[STARTED]");
     }
 
     public void stop(BundleContext bc) throws Exception

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardActivator.java
Patch:
@@ -53,7 +53,8 @@ public void start (BundleContext bc) throws Exception
                                         whiteboardPlugin,
                                         containerFilter);
 
-        logger.info("WHITEBOARD... [REGISTERED]");
+        if (logger.isInfoEnabled())
+            logger.info("WHITEBOARD... [REGISTERED]");
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/AbstractFileTransfer.java
Patch:
@@ -154,7 +154,8 @@ public void fireStatusChangeEvent(int newStatus, String reason)
                 = new ArrayList<FileTransferStatusListener>(statusListeners);
         }
 
-        logger.debug("Dispatching a FileTransfer Event to" + listeners.size()
+        if (logger.isDebugEnabled())
+            logger.debug("Dispatching a FileTransfer Event to" + listeners.size()
             + " listeners. Status=" + status);
 
         FileTransferStatusChangeEvent statusEvent

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetBasicInstantMessaging.java
Patch:
@@ -149,7 +149,8 @@ protected void fireMessageEvent(EventObject evt)
             listeners = new ArrayList<MessageListener>(this.messageListeners);
         }
 
-        logger.debug("Dispatching Message Listeners=" + listeners.size()
+        if (logger.isDebugEnabled())
+            logger.debug("Dispatching Message Listeners=" + listeners.size()
             + " evt=" + evt);
 
         /*

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetBasicTelephony.java
Patch:
@@ -65,7 +65,8 @@ public void fireCallEvent(int eventID, Call sourceCall)
             listeners = new ArrayList<CallListener>(callListeners);
         }
 
-        logger.debug("Dispatching a CallEvent to " + listeners.size()
+        if (logger.isDebugEnabled())
+            logger.debug("Dispatching a CallEvent to " + listeners.size()
             + " listeners. event is: " + cEvent);
 
         for (Iterator<CallListener> listenerIter

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetTypingNotifications.java
Patch:
@@ -110,7 +110,8 @@ public void fireTypingNotificationsEvent(
                                 typingNotificationsListeners.size()]);
         }
 
-        logger.debug(
+        if (logger.isDebugEnabled())
+            logger.debug(
             "Dispatching a TypingNotificationEvent to "
                 + listeners.length
                 + " listeners. Contact "

File: src/net/java/sip/communicator/service/protocol/AbstractProtocolProviderService.java
Patch:
@@ -158,7 +158,8 @@ public void fireRegistrationStateChanged( RegistrationState oldState,
                     throwable);
             }
 
-        logger.trace("Done.");
+        if (logger.isTraceEnabled())
+            logger.trace("Done.");
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -783,7 +783,8 @@ private String getFactoryImplPackageName()
      */
     public void stop()
     {
-        logger.trace("Preparing to stop all protocol providers of" + this);
+        if (logger.isTraceEnabled())
+            logger.trace("Preparing to stop all protocol providers of" + this);
 
         synchronized (registeredAccounts)
         {

File: src/net/java/sip/communicator/util/Html2Text.java
Patch:
@@ -52,7 +52,8 @@ public static synchronized String extractText(String html)
         }
         catch (Exception exc)
         {
-            logger.info("Failed to extract plain text from html="+html, exc);
+            if (logger.isInfoEnabled())
+                logger.info("Failed to extract plain text from html="+html, exc);
             return html;
         }
     }

File: src/net/java/sip/communicator/util/UtilActivator.java
Patch:
@@ -53,7 +53,8 @@ public class UtilActivator
     public void start(BundleContext context)
         throws Exception
     {
-        logger.trace("Setting default uncaught exception handler.");
+        if (logger.isTraceEnabled())
+            logger.trace("Setting default uncaught exception handler.");
 
         bundleContext = context;
 

File: src/net/java/sip/communicator/util/swing/FileDragLabel.java
Patch:
@@ -88,7 +88,8 @@ public synchronized void drop(DropTargetDropEvent event)
         }
         catch (Exception ex)
         {
-            logger.debug("Unable to drop label.", ex);
+            if (logger.isDebugEnabled())
+                logger.debug("Unable to drop label.", ex);
             event.rejectDrop();
         }
     }

File: src/net/java/sip/communicator/impl/osdependent/jdic/StatusSelector.java
Patch:
@@ -184,7 +184,8 @@ else if (!status.isOnline()
 
     public void updateStatus(PresenceStatus presenceStatus)
     {
-        logger.trace("Systray update status for provider: "
+        if (logger.isTraceEnabled())
+            logger.trace("Systray update status for provider: "
             + provider.getAccountID().getAccountAddress()
             + ". The new status will be: " + presenceStatus.getStatusName());
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/MailboxIQ.java
Patch:
@@ -173,7 +173,8 @@ public void setTotalEstimate(boolean totalEstimate)
     @Override
     public String getChildElementXML()
     {
-        logger.debug("Mailbox.getChildElementXML usage");
+        if (logger.isDebugEnabled())
+            logger.debug("Mailbox.getChildElementXML usage");
         String totalString = totalEstimate ? " total-estimate='1' " : "";
         return "<mailbox result-time='" + resultTime + "' total-matched='"
                 + totalMatched + "'" + totalString + "/>";

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/MailboxIQProvider.java
Patch:
@@ -82,7 +82,8 @@ public IQ parseIQ(final XmlPullParser parser) throws Exception
                 if(logger.isTraceEnabled())
                 {
                     logger.trace("xml parser returned eventType=" + eventType);
-                    logger.trace("parser="+parser.getText());
+                    if (logger.isTraceEnabled())
+                        logger.trace("parser="+parser.getText());
                 }
             }
             eventType = parser.next();

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/MailboxQueryIQ.java
Patch:
@@ -49,7 +49,8 @@ public class MailboxQueryIQ extends IQ
     @Override
     public String getChildElementXML()
     {
-        logger.debug("QueryNotify.getChildElementXML usage");
+        if (logger.isDebugEnabled())
+            logger.debug("QueryNotify.getChildElementXML usage");
 
         StringBuffer xml = new StringBuffer(
                         "<query xmlns='google:mail:notify'");

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/NewMailNotificationIQ.java
Patch:
@@ -46,7 +46,8 @@ public class NewMailNotificationIQ extends IQ
     @Override
     public String getChildElementXML()
     {
-        logger.trace("NewMailNotification.getChildElementXML usage");
+        if (logger.isTraceEnabled())
+            logger.trace("NewMailNotification.getChildElementXML usage");
         return "<iq type='"+"result"+"' "+
                 "from='"+getFrom()+"' "+
                 "to='"+getTo()+"' "+

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/NewMailNotificationProvider.java
Patch:
@@ -42,7 +42,8 @@ public class NewMailNotificationProvider
      */
     public IQ parseIQ(final XmlPullParser parser) throws Exception
     {
-        logger.debug("NewMailNotificationProvider.getChildElementXML usage");
+        if (logger.isDebugEnabled())
+            logger.debug("NewMailNotificationProvider.getChildElementXML usage");
         NewMailNotificationIQ iq = new NewMailNotificationIQ();
 
         return iq;

File: src/net/java/sip/communicator/impl/protocol/jabber/mediamgr/AudioMediaSession.java
Patch:
@@ -105,7 +105,8 @@ public void initialize()
         localIp = getLocal().getLocalIp();
         localPort = getLocal().getPort();
         remotePort = getRemote().getPort();
-        logger.info("AudioMediaSession : " + localIp + ":" + localPort + 
+        if (logger.isInfoEnabled())
+            logger.info("AudioMediaSession : " + localIp + ":" + localPort + 
                     " <-> " + remoteIp + ":" + remotePort);
 //        }
 

File: src/net/java/sip/communicator/impl/protocol/mock/MockCall.java
Patch:
@@ -70,7 +70,8 @@ public void addCallPeer(MockCallPeer callPeer)
 
         this.callPeers.add(callPeer);
 
-        logger.info("Will fire peer added");
+        if (logger.isInfoEnabled())
+            logger.info("Will fire peer added");
 
         fireCallPeerEvent(
             callPeer, CallPeerEvent.CALL_PEER_ADDED);

File: src/net/java/sip/communicator/impl/protocol/msn/IncomingFileTransferRequestMsnImpl.java
Patch:
@@ -166,7 +166,8 @@ public void rejectFile()
         }
         catch(IllegalStateException e)
         {
-            logger.debug("Error rejecting file",e);
+            if (logger.isDebugEnabled())
+                logger.debug("Error rejecting file",e);
             return;
         }
     }

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetAdHocMultiUserChatMsnImpl.java
Patch:
@@ -459,7 +459,8 @@ public void instantMessageReceived( MsnSwitchboard switchboard,
 
             Message newMessage = createMessage(message.getContent());
 
-            logger.debug("Group chat message received.");
+            if (logger.isDebugEnabled())
+                logger.debug("Group chat message received.");
 
             AdHocChatRoomMsnImpl chatRoom
             = getLocalAdHocChatRoomInstance(switchboard);

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetFileTransferMsnImpl.java
Patch:
@@ -313,7 +313,8 @@ private class RegistrationStateListener
          */
         public void registrationStateChanged(RegistrationStateChangeEvent evt)
         {
-            logger.debug("The provider changed state from: "
+            if (logger.isDebugEnabled())
+                logger.debug("The provider changed state from: "
                          + evt.getOldState()
                          + " to: " + evt.getNewState());
 

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetTypingNotificationsMsnImpl.java
Patch:
@@ -156,7 +156,8 @@ private class ProviderRegListener
          */
         public void registrationStateChanged(RegistrationStateChangeEvent evt)
         {
-            logger.debug("The provider changed state from: "
+            if (logger.isDebugEnabled())
+                logger.debug("The provider changed state from: "
                          + evt.getOldState()
                          + " to: " + evt.getNewState());
             if (evt.getNewState() == RegistrationState.REGISTERED)

File: src/net/java/sip/communicator/impl/protocol/rss/RssTimerRefreshFeed.java
Patch:
@@ -41,7 +41,8 @@ public RssTimerRefreshFeed(OperationSetBasicInstantMessagingRssImpl opSet)
      */
     public void run()
     {
-        logger.trace("Starting a periodic rss check.");
+        if (logger.isTraceEnabled())
+            logger.trace("Starting a periodic rss check.");
         this.opSet.refreshAllRssFeeds();
     }
 }

File: src/net/java/sip/communicator/impl/protocol/rss/UriHandlerRssImpl.java
Patch:
@@ -135,7 +135,8 @@ public void handleUri(String uri)
         catch (OperationFailedException exc)
         {
             // The operation has been canceled by the user. Bail out.
-            logger.trace("User canceled handling of uri " + uri);
+            if (logger.isTraceEnabled())
+                logger.trace("User canceled handling of uri " + uri);
             return;
         }
 

File: src/net/java/sip/communicator/impl/protocol/sip/EventPackageSupport.java
Patch:
@@ -334,7 +334,8 @@ static void processAuthenticationChallenge(
     {
         try
         {
-            logger.debug("Authenticating a message request.");
+            if (logger.isDebugEnabled())
+                logger.debug("Authenticating a message request.");
 
             ClientTransaction retryTran
                 = protocolProvider

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -679,7 +679,8 @@ public void processTransactionTerminated(TransactionTerminatedEvent
         }
 
         Request request = transaction.getRequest();
-        logger.debug("Transaction terminated for req=\n" + request);
+        if (logger.isDebugEnabled())
+            logger.debug("Transaction terminated for req=\n" + request);
 
         //find the object that is supposed to take care of responses with the
         //corresponding method

File: src/net/java/sip/communicator/impl/protocol/sip/security/MessageDigestAlgorithm.java
Patch:
@@ -58,7 +58,8 @@ static String calculateResponse(String algorithm,
                                     String entity_body,
                                     String qop_value)
     {
-        logger.debug("trying to authenticate using : " + algorithm + ", "
+        if (logger.isDebugEnabled())
+            logger.debug("trying to authenticate using : " + algorithm + ", "
                 + username_value + ", " + realm_value + ", " + (passwd != null
                 && passwd.trim().length() > 0) + ", " + nonce_value + ", "
                 + nc_value + ", " + cnonce_value + ", " + method + ", "

File: src/net/java/sip/communicator/impl/protocol/ssh/ContactSSHImpl.java
Patch:
@@ -353,7 +353,8 @@ public void setPersistentData(String persistentData)
             int fifthCommaIndex = this.persistentData.indexOf(separator,
                     fourthCommaIndex +1);
 
-            logger.debug("Commas: " + firstCommaIndex + " " + secondCommaIndex + " "
+            if (logger.isDebugEnabled())
+                logger.debug("Commas: " + firstCommaIndex + " " + secondCommaIndex + " "
                     + thirdCommaIndex + " " +fourthCommaIndex + " "
                     +fifthCommaIndex);
 

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHFileTransferDaemon.java
Patch:
@@ -322,7 +322,8 @@ private void upload()
 //        }
         
         command += file.getName() + "\n";
-        logger.trace(command);
+        if (logger.isTraceEnabled())
+            logger.trace(command);
         scpOutputStream.write(command.getBytes());
         scpOutputStream.flush();
         

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetFileTransferYahooImpl.java
Patch:
@@ -434,7 +434,8 @@ private class RegistrationStateListener
          */
         public void registrationStateChanged(RegistrationStateChangeEvent evt)
         {
-            logger.debug("The provider changed state from: "
+            if (logger.isDebugEnabled())
+                logger.debug("The provider changed state from: "
                          + evt.getOldState()
                          + " to: " + evt.getNewState());
 

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetTypingNotificationsYahooImpl.java
Patch:
@@ -123,7 +123,8 @@ private class ProviderRegListener
          */
         public void registrationStateChanged(RegistrationStateChangeEvent evt)
         {
-            logger.debug("The provider changed state from: "
+            if (logger.isDebugEnabled())
+                logger.debug("The provider changed state from: "
                          + evt.getOldState()
                          + " to: " + evt.getNewState());
             if (evt.getNewState() == RegistrationState.REGISTERED)

File: src/net/java/sip/communicator/impl/protocol/zeroconf/OperationSetBasicInstantMessagingZeroconfImpl.java
Patch:
@@ -100,7 +100,8 @@ private void deliverMessage(Message message, ContactZeroconfImpl to)
                 if (thread == null) 
                 {
                     Socket sock;
-                    logger.debug("ZEROCONF: Creating a chat connexion to "
+                    if (logger.isDebugEnabled())
+                        logger.debug("ZEROCONF: Creating a chat connexion to "
                             +to.getIpAddress()+":"+to.getPort());
                     sock = new Socket(to.getIpAddress(), to.getPort());
                     thread = new ClientThread(sock, to.getBonjourService());

File: src/net/java/sip/communicator/impl/protocol/zeroconf/OperationSetPersistentPresenceZeroconfImpl.java
Patch:
@@ -712,7 +712,8 @@ private class UnregistrationListener
         public void registrationStateChanged(RegistrationStateChangeEvent evt)
         {
             
-            logger.debug("ZEROCONF : The Zeroconf provider changed state from: "
+            if (logger.isDebugEnabled())
+                logger.debug("ZEROCONF : The Zeroconf provider changed state from: "
                          + evt.getOldState()
                          + " to: " + evt.getNewState());
             

File: src/net/java/sip/communicator/impl/neomedia/directshow/DSFormat.java
Patch:
@@ -26,6 +26,7 @@ public class DSFormat
         NV12 = getNV12PixelFormat();
         Y411 = getY411PixelFormat();
         Y41P = getY41PPixelFormat();
+        I420 = getI420PixelFormat();
     }
 
     /* supported formats */
@@ -37,6 +38,7 @@ public class DSFormat
     public static final long Y411;
     public static final long Y41P;
     public static final long NV12;
+    public static final long I420;
 
     /**
      * Video width.
@@ -119,5 +121,6 @@ public long getPixelFormat()
     public static native long getY41PPixelFormat();
     public static native long getYVU9PixelFormat();
     public static native long getYVYUPixelFormat();
+    public static native long getI420PixelFormat();
 }
 

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/directshow/DataSource.java
Patch:
@@ -67,6 +67,8 @@ public class DataSource extends AbstractPushBufferCaptureDevice
                     FFmpeg.PIX_FMT_UYYVYY411,
                     DSFormat.NV12,
                     FFmpeg.PIX_FMT_NV12,
+                    DSFormat.I420,
+                    FFmpeg.PIX_FMT_YUV420P,
                 };
     /**
      * The default width of <tt>DataSource</tt>.
@@ -180,7 +182,7 @@ protected AbstractPushBufferStream createStream(
         for(int i = 0 ; i < fmts.length ; i++)
         {
             System.out.println(fmts[i].getWidth() + " " + fmts[i].getHeight()
-                    + fmts[i].getColorSpace());
+                    + "  " + fmts[i].getPixelFormat());
         }
         */
 

File: src/net/java/sip/communicator/impl/media/MediaServiceImpl.java
Patch:
@@ -446,7 +446,8 @@ private void registerAudioNotifyService()
                     audioNotifier,
                     null);
 
-            logger.info("Audio Notifier Service ...[REGISTERED]");
+            if (logger.isInfoEnabled())
+                logger.info("Audio Notifier Service ...[REGISTERED]");
     }
 
     /**

File: src/net/java/sip/communicator/impl/media/ProcessorUtility.java
Patch:
@@ -74,7 +74,8 @@ public void controllerUpdate(ControllerEvent ce)
             if (ce instanceof ControllerErrorEvent)
                 logger.warn("ControllerErrorEvent: " + ce);
             else
-                logger.debug("ControllerClosedEvent: " + ce);
+                if (logger.isDebugEnabled())
+                    logger.debug("ControllerClosedEvent: " + ce);
 
             setFailed(true);
 

File: src/net/java/sip/communicator/impl/media/codec/video/h264/JNIDecoder.java
Patch:
@@ -248,7 +248,8 @@ public synchronized int process(Buffer inputBuffer, Buffer outputBuffer)
             long oldRecv = lastReceivedSeq;
             lastReceivedSeq = inputBuffer.getSequenceNumber();
             waitingForMarker = true;
-            logger.trace("DROP rtp data! " + oldRecv + "/" + lastReceivedSeq);
+            if (logger.isTraceEnabled())
+                logger.trace("DROP rtp data! " + oldRecv + "/" + lastReceivedSeq);
             parser.reset();
             reset();
             return OUTPUT_BUFFER_NOT_FILLED;

File: src/net/java/sip/communicator/impl/metahistory/MetaHistoryActivator.java
Patch:
@@ -44,7 +44,8 @@ public void start(BundleContext bundleContext) throws Exception
             bundleContext.registerService(
                 MetaHistoryService.class.getName(), metaHistoryService, null);
 
-            logger.info("Meta History Service ...[REGISTERED]");
+            if (logger.isInfoEnabled())
+                logger.info("Meta History Service ...[REGISTERED]");
         }
         finally
         {

File: src/net/java/sip/communicator/impl/metahistory/MetaHistoryServiceImpl.java
Patch:
@@ -860,7 +860,8 @@ public void serviceChanged(ServiceEvent serviceEvent)
      */
     public void start(BundleContext bc)
     {
-        logger.debug("Starting the call history implementation.");
+        if (logger.isDebugEnabled())
+            logger.debug("Starting the call history implementation.");
         this.bundleContext = bc;
 
         services.clear();

File: src/net/java/sip/communicator/impl/msghistory/MessageHistoryActivator.java
Patch:
@@ -57,7 +57,8 @@ public void start(BundleContext bc) throws Exception
             bundleContext.registerService(
                 MessageHistoryService.class.getName(), msgHistoryService, null);
 
-            logger.info("Message History Service ...[REGISTERED]");
+            if (logger.isInfoEnabled())
+                logger.info("Message History Service ...[REGISTERED]");
         }
         finally
         {

File: src/net/java/sip/communicator/impl/neomedia/AudioMediaStreamImpl.java
Patch:
@@ -231,7 +231,8 @@ protected void registerCustomCodecFormats(RTPManager rtpManager)
 
         for (AudioFormat format : CUSTOM_CODEC_FORMATS)
         {
-            logger.debug("registering format " + format + " with RTP manager");
+            if (logger.isDebugEnabled())
+                logger.debug("registering format " + format + " with RTP manager");
 
             /*
              * NOTE (mkoch@rowa.de): com.sun.media.rtp.RtpSessionMgr.addFormat

File: src/net/java/sip/communicator/impl/neomedia/ProcessorUtility.java
Patch:
@@ -88,7 +88,8 @@ public void controllerUpdate(ControllerEvent ce)
             if (ce instanceof ControllerErrorEvent)
                 logger.warn("ControllerErrorEvent: " + ce);
             else
-                logger.debug("ControllerClosedEvent: " + ce);
+                if (logger.isDebugEnabled())
+                    logger.debug("ControllerClosedEvent: " + ce);
 
             setFailed(true);
 

File: src/net/java/sip/communicator/impl/neomedia/device/AudioMediaDeviceImpl.java
Patch:
@@ -218,7 +218,8 @@ public List<RTPExtension> getSupportedExtensions()
             {
                 // can't happen since CSRC_AUDIO_LEVEL_URN is a valid URI and
                 // never changes.
-                logger.info("Aha! Someone messed with the source!", e);
+                if (logger.isInfoEnabled())
+                    logger.info("Aha! Someone messed with the source!", e);
                 return null;
             }
 

File: src/net/java/sip/communicator/impl/neomedia/device/AudioMixerMediaDevice.java
Patch:
@@ -383,7 +383,8 @@ public List<RTPExtension> getSupportedExtensions()
             {
                 // can't happen since CSRC_AUDIO_LEVEL_URN is a valid URI and
                 // never changes.
-                logger.info("Aha! Someone messed with the source!", e);
+                if (logger.isInfoEnabled())
+                    logger.info("Aha! Someone messed with the source!", e);
                 return null;
             }
 

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/ByteBufferPool.java
Patch:
@@ -69,7 +69,8 @@ else if (loggerIsTraceEnabled)
             }
             if (loggerIsTraceEnabled)
             {
-                logger.trace(
+                if (logger.isTraceEnabled())
+                    logger.trace(
                         "Leaking " + leakedCount + " ByteBuffer instances.");
             }
         }

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/imgstreaming/ImageStream.java
Patch:
@@ -213,7 +213,8 @@ public void start()
     @Override
     public void stop()
     {
-        logger.info("Stop stream");
+        if (logger.isInfoEnabled())
+            logger.info("Stop stream");
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegSummaryPage.java
Patch:
@@ -170,7 +170,8 @@ public void commitPage()
         }
         catch (OperationFailedException e)
         {
-            logger.debug("The sign in operation has failed.");
+            if (logger.isDebugEnabled())
+                logger.debug("The sign in operation has failed.");
 
             if (e.getErrorCode()
                     == OperationFailedException.ILLEGAL_ARGUMENT)

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -75,7 +75,8 @@ public AccountRegWizardContainerImpl(MainFrame mainFrame)
         // in case we found any, add them in this container.
         if (accountWizardRefs != null)
         {
-            logger.debug("Found "
+            if (logger.isDebugEnabled())
+                logger.debug("Found "
                          + accountWizardRefs.length
                          + " already installed providers.");
             for (ServiceReference serRef : accountWizardRefs)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -2011,7 +2011,8 @@ public void fireChatFocusEvent(int eventID)
     {
         ChatFocusEvent evt = new ChatFocusEvent(this, eventID);
 
-        logger.trace("Will dispatch the following chat event: " + evt);
+        if (logger.isTraceEnabled())
+            logger.trace("Will dispatch the following chat event: " + evt);
 
         Iterable<ChatFocusListener> listeners;
         synchronized (focusListeners)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransportSelectorBox.java
Patch:
@@ -139,7 +139,8 @@ public void actionPerformed(ActionEvent e)
             }
         }
 
-        logger.debug( "Could not find contact for menu item "
+        if (logger.isDebugEnabled())
+            logger.debug( "Could not find contact for menu item "
                       + menuItem.getText() + ". contactsTable("
                       + transportMenuItems.size()+") is : "
                       + transportMenuItems);

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatTransport.java
Patch:
@@ -533,7 +533,8 @@ private byte[] getFileThumbnail(File file)
             }
             catch (MalformedURLException e)
             {
-                logger.debug("Could not locate image.", e);
+                if (logger.isDebugEnabled())
+                    logger.debug("Could not locate image.", e);
             }
         }
         return bytes;

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigurationFrame.java
Patch:
@@ -188,7 +188,8 @@ public void serviceChanged(ServiceEvent event)
         switch (event.getType())
         {
         case ServiceEvent.REGISTERED:
-            logger.info("Handling registration of a new Configuration Form.");
+            if (logger.isInfoEnabled())
+                logger.info("Handling registration of a new Configuration Form.");
 
             this.addConfigurationForm(configForm);
             break;

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -201,7 +201,8 @@ public void updateStatus(PresenceStatus presenceStatus)
         OperationSetPresence presence
             = MainFrame.getProtocolPresenceOpSet(protocolProvider);
 
-        logger.trace("Update status for provider: "
+        if (logger.isTraceEnabled())
+            logger.trace("Update status for provider: "
             + protocolProvider.getAccountID().getAccountAddress()
             + ". The new status will be: " + presenceStatus.getStatusName());
 

File: src/net/java/sip/communicator/impl/gui/utils/FileImageLabel.java
Patch:
@@ -119,7 +119,8 @@ private void setFileIcon(File file)
             }
             catch (MalformedURLException e)
             {
-                logger.debug("Could not locate image.", e);
+                if (logger.isDebugEnabled())
+                    logger.debug("Could not locate image.", e);
                 this.setIcon(new ImageIcon(
                     ImageLoader.getImage(ImageLoader.DEFAULT_FILE_ICON)));
             }

File: src/net/java/sip/communicator/impl/gui/utils/ImageLoader.java
Patch:
@@ -1447,7 +1447,8 @@ public static String getImageUri(ImageID imageID)
         }
         catch (URISyntaxException e)
         {
-            logger.debug("Unable to parse image URL to URI.", e);
+            if (logger.isDebugEnabled())
+                logger.debug("Unable to parse image URL to URI.", e);
         }
 
         return null;

File: src/net/java/sip/communicator/impl/keybindings/KeybindingsActivator.java
Patch:
@@ -33,7 +33,8 @@ public void start(BundleContext context)
     {
         if (this.keybindingsService == null)
         {
-            logger.debug("Service Impl: " + getClass().getName()
+            if (logger.isDebugEnabled())
+                logger.debug("Service Impl: " + getClass().getName()
                 + " [  STARTED ]");
             this.keybindingsService = new KeybindingsServiceImpl();
             this.keybindingsService.start(context);

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryActivator.java
Patch:
@@ -85,7 +85,8 @@ public void start(BundleContext bc) throws Exception
                 ContactSourceService.class.getName(),
                 new CallHistoryContactSource(), null);
 
-            logger.info("Call History Service ...[REGISTERED]");
+            if (logger.isInfoEnabled())
+                logger.info("Call History Service ...[REGISTERED]");
         }
         finally
         {

File: src/net/java/sip/communicator/impl/filehistory/FileHistoryActivator.java
Patch:
@@ -52,7 +52,8 @@ public void start(BundleContext bundleContext) throws Exception
             bundleContext.registerService(
                 FileHistoryService.class.getName(), fileHistoryService, null);
 
-            logger.info("File History Service ...[REGISTERED]");
+            if (logger.isInfoEnabled())
+                logger.info("File History Service ...[REGISTERED]");
         }
         finally
         {

File: src/net/java/sip/communicator/impl/galagonotification/GalagoNotificationActivator.java
Patch:
@@ -96,7 +96,8 @@ public void start(BundleContext bundleContext)
                         .debug(
                             "org.freedesktop.Notifications.GetCapabilities:");
                     for (String capability : capabilities)
-                        logger.debug("\t" + capability);
+                        if (logger.isDebugEnabled())
+                            logger.debug("\t" + capability);
                 }
 
                 /*

File: src/net/java/sip/communicator/impl/neomedia/VideoMediaStreamImpl.java
Patch:
@@ -16,7 +16,6 @@
 import javax.media.protocol.*;
 import javax.media.rtp.*;
 
-import net.java.sip.communicator.impl.neomedia.*;
 import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.device.*;
 import net.java.sip.communicator.service.neomedia.*;

File: src/net/java/sip/communicator/impl/neomedia/device/DirectShowAuto.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.neomedia.device;
 
-import java.util.*;
-
 import javax.media.*;
 
 import net.java.sip.communicator.impl.neomedia.codec.video.*;

File: src/net/java/sip/communicator/impl/neomedia/device/VideoMediaDeviceSession.java
Patch:
@@ -19,10 +19,8 @@
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.h264.*;
 import net.java.sip.communicator.impl.neomedia.imgstreaming.*;
-import net.java.sip.communicator.impl.neomedia.jmfext.media.protocol.*;
 import net.java.sip.communicator.impl.neomedia.transform.*;
 import net.java.sip.communicator.service.neomedia.*;
-import net.java.sip.communicator.service.neomedia.format.*;
 import net.java.sip.communicator.service.neomedia.event.*;
 import net.java.sip.communicator.service.resources.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/protocol/quicktime/DataSource.java
Patch:
@@ -481,7 +481,6 @@ protected Format setFormat(
                     && (newSize.height < DEFAULT_HEIGHT))
             {
                 String encoding = newVideoFormatValue.getEncoding();
-                int maxDataLength = newVideoFormatValue.getMaxDataLength();
                 Class<?> dataType = newVideoFormatValue.getDataType();
                 float frameRate = newVideoFormatValue.getFrameRate();
 

File: src/net/java/sip/communicator/impl/neomedia/jmfext/media/renderer/video/JAWTRenderer.java
Patch:
@@ -184,7 +184,7 @@ public void paint(Graphics g)
                         if (wantsPaint && (handle != 0))
                         {
                             wantsPaint
-                                = JAWTRenderer.this.paint(handle, this, g);
+                                = JAWTRenderer.paint(handle, this, g);
                         }
                     }
                 }

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -602,7 +602,7 @@ public void unregister()
      * Unregister and fire the event if requested
      * @param fireEvent boolean
      */
-    private void unregister(boolean fireEvent)
+    void unregister(boolean fireEvent)
     {
         synchronized(initializationLock)
         {

File: src/net/java/sip/communicator/impl/protocol/gibberish/CallGibberishImpl.java
Patch:
@@ -78,7 +78,8 @@ public void addCallPeer(final CallPeerGibberishImpl callPeer)
 
         this.callPeers.add(callPeer);
 
-        logger.info("Will fire peer added");
+        if (logger.isInfoEnabled())
+            logger.info("Will fire peer added");
 
         fireCallPeerEvent(
             callPeer, CallPeerEvent.CALL_PEER_ADDED);

File: src/net/java/sip/communicator/impl/protocol/gibberish/OperationSetTelephonyConferencingGibberishImpl.java
Patch:
@@ -118,8 +118,9 @@ public void callStateChanged(CallChangeEvent evt)
              CallGibberishImpl sourceCall = (CallGibberishImpl) this.activeCalls
                  .remove(evt.getSourceCall().getCallID());
 
-             logger.trace(  "Removing call " + sourceCall + " from the list of "
-                          + "active calls because it entered an ENDED state");
+             if (logger.isTraceEnabled())
+                 logger.trace(  "Removing call " + sourceCall + " from the list of "
+                         + "active calls because it entered an ENDED state");
 
              telephonyOpSet.fireCallEvent(CallEvent.CALL_ENDED, sourceCall);
          }

File: src/net/java/sip/communicator/impl/protocol/icq/IncomingFileTransferRequestIcqImpl.java
Patch:
@@ -174,7 +174,8 @@ public void rejectFile()
         }
         catch(IllegalStateException e)
         {
-            logger.debug("Error rejecting file",e);
+            if (logger.isDebugEnabled())
+                logger.debug("Error rejecting file",e);
             return;
         }
     }

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomConfigurationFormJabberImpl.java
Patch:
@@ -97,7 +97,8 @@ public Iterator<ChatRoomConfigurationFormField> getConfigurationSet()
     public void submit()
         throws OperationFailedException
     {
-        logger.trace("Sends chat room configuration form to the server.");
+        if (logger.isTraceEnabled())
+            logger.trace("Sends chat room configuration form to the server.");
         
         try
         {

File: src/net/java/sip/communicator/impl/protocol/jabber/UriHandlerJabberImpl.java
Patch:
@@ -288,7 +288,8 @@ public void handleUri(String uri)
         catch (OperationFailedException exc)
         {
             // The operation has been canceled by the user. Bail out.
-            logger.trace("User canceled handling of uri " + uri);
+            if (logger.isTraceEnabled())
+                logger.trace("User canceled handling of uri " + uri);
             return;
         }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/WhiteboardParticipantJabberImpl.java
Patch:
@@ -353,7 +353,8 @@ protected void fireWhiteboardParticipantChangeEvent(String eventType,
             new WhiteboardParticipantChangeEvent(this, eventType, oldValue,
                 newValue, reason);
 
-        logger.debug("Dispatching a WhiteboardParticipantChangeEvent event to "
+        if (logger.isDebugEnabled())
+            logger.debug("Dispatching a WhiteboardParticipantChangeEvent event to "
             + whiteboardParticipantListeners.size() + " listeners. event is: "
             + evt.toString());
 

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandler.java
Patch:
@@ -936,7 +936,8 @@ private MediaStream configureAndStartStream(
      */
     private void sendHolePunchPacket(MediaStreamTarget target)
     {
-        logger.info("Try to open port on NAT if any");
+        if (logger.isInfoEnabled())
+            logger.info("Try to open port on NAT if any");
         try
         {
             /* data port (RTP) */

File: src/net/java/sip/communicator/impl/protocol/sip/EventPackageSupport.java
Patch:
@@ -346,7 +346,8 @@ static void processAuthenticationChallenge(
 
             if(retryTran == null)
             {
-                logger.trace("No password supplied or error occured!");
+                if (logger.isTraceEnabled())
+                    logger.trace("No password supplied or error occured!");
                 return;
             }
 

File: src/net/java/sip/communicator/impl/protocol/sip/UriHandlerSipImpl.java
Patch:
@@ -282,7 +282,8 @@ public void handleUri(String uri)
         catch (OperationFailedException exc)
         {
             // The operation has been canceled by the user. Bail out.
-            logger.trace("User canceled handling of uri " + uri);
+            if (logger.isTraceEnabled())
+                logger.trace("User canceled handling of uri " + uri);
             return;
         }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/CallHistoryFilter.java
Patch:
@@ -51,6 +51,8 @@ public void applyFilter(FilterQuery filterQuery)
             // expect any further results from it.
             filterQuery.removeQuery(query);
         }
+        // Closes this filter to indicate that we finished adding queries to it.
+        filterQuery.close();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/PresenceFilter.java
Patch:
@@ -54,6 +54,8 @@ public void applyFilter(FilterQuery filterQuery)
 
         // Add this query to the filterQuery.
         filterQuery.addContactQuery(query);
+        // Closes this filter to indicate that we finished adding queries to it.
+        filterQuery.close();
 
         query.addContactQueryListener(GuiActivator.getContactList());
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -103,6 +103,9 @@ public void applyFilter(FilterQuery filterQuery)
             filterQuery.addContactQuery(
                 applyFilter(filterSource));
         }
+
+        // Closes this filter to indicate that we finished adding queries to it.
+        filterQuery.close();
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h264/JNIEncoder.java
Patch:
@@ -246,7 +246,7 @@ public synchronized void open()
         FFmpeg.avcodeccontext_set_bit_rate(avcontext, bitRate);
         // so to be 1 in x264
         FFmpeg.avcodeccontext_set_bit_rate_tolerance(avcontext, (int)(bitRate /
-                DEFAULT_FRAME_RATE));
+                frameRate));
         FFmpeg.avcodeccontext_set_rc_max_rate(avcontext, bitRate);
         FFmpeg.avcodeccontext_set_sample_aspect_ratio(avcontext, 0, 0);
         FFmpeg.avcodeccontext_set_thread_count(avcontext, 1);

File: src/net/java/sip/communicator/impl/neomedia/RawPacket.java
Patch:
@@ -145,7 +145,7 @@ public long getTimestamp()
      */
     public void setTimestamp(long timestamp)
     {
-        writeInt(getOffset(), (int)timestamp);
+        writeInt(getOffset() + 4, (int)timestamp);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -1682,7 +1682,7 @@ public void handleAuthenticationChallenge(ClientTransaction retryTran)
      * @return a reference to the <tt>CallPeerMediaHandler</tt> instance that
      * this peer uses for media related tips and tricks.
      */
-    CallPeerMediaHandler getMediaHandler()
+    public CallPeerMediaHandler getMediaHandler()
     {
         return mediaHandler;
     }

File: src/net/java/sip/communicator/impl/osdependent/jdic/SystrayServiceJdicImpl.java
Patch:
@@ -8,11 +8,11 @@
 
 import com.apple.eawt.*;
 
-import java.awt.*;
+import java.awt.Image;
+import java.awt.Toolkit;
 import java.awt.event.*;
 import java.net.*;
 import java.util.*;
-import java.util.List;
 
 import javax.swing.*;
 import javax.swing.event.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchField.java
Patch:
@@ -55,7 +55,8 @@ public SearchField(MainFrame frame)
         this.setDragEnabled(true);
         this.addTextChangeListener(this);
 
-        InputMap imap = getInputMap(JComponent.WHEN_FOCUSED);
+        InputMap imap
+            = getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
         imap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0), "escape");
         ActionMap amap = getActionMap();
         amap.put("escape", new AbstractAction()

File: src/net/java/sip/communicator/impl/neomedia/device/VideoMediaDeviceSession.java
Patch:
@@ -16,10 +16,10 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.neomedia.*;
-import net.java.sip.communicator.impl.neomedia.transform.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.*;
 import net.java.sip.communicator.impl.neomedia.codec.video.h264.*;
 import net.java.sip.communicator.impl.neomedia.imgstreaming.*;
+import net.java.sip.communicator.impl.neomedia.transform.*;
 import net.java.sip.communicator.service.neomedia.*;
 import net.java.sip.communicator.service.neomedia.format.*;
 import net.java.sip.communicator.service.neomedia.event.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchField.java
Patch:
@@ -11,7 +11,6 @@
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
 import net.java.sip.communicator.util.swing.event.*;
-import net.java.sip.communicator.util.swing.plaf.*;
 
 /**
  * The field shown on the top of the main window, which allows the user to
@@ -46,7 +45,7 @@ public SearchField(MainFrame frame)
 
         this.mainFrame = frame;
 
-        SearchTextFieldUI textFieldUI = new SearchTextFieldUI();
+        SearchFieldUI textFieldUI = new SearchFieldUI();
         textFieldUI.setDeleteButtonEnabled(true);
         this.setUI(textFieldUI);
         this.setBorder(null);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -183,6 +183,7 @@ public void setFilterString(String filter)
      */
     public void stopFilter()
     {
+        mclSource.stopFiltering();
         Iterator<ContactQuery> queriesIter = currentQueries.iterator();
         while (queriesIter.hasNext())
             queriesIter.next().cancel();

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1002,8 +1002,8 @@ public void setGroupClickConsumed(boolean isGroupClickConsumed)
      */
     public void stopFiltering()
     {
-        currentFilter.stopFilter();
         this.isFiltering = false;
+        currentFilter.stopFilter();
 
         if (filterQuery != null)
             filterQuery.cancel();

File: src/net/java/sip/communicator/impl/gui/main/contactlist/FilterQuery.java
Patch:
@@ -125,7 +125,8 @@ public void queryStatusChanged(ContactQueryStatusEvent event)
             return;
 
         // First set the isSucceeded property.
-        setSucceeded(!isSucceeded() && !query.getQueryResults().isEmpty());
+        if (!isSucceeded() && !query.getQueryResults().isEmpty())
+            setSucceeded(true);
 
         // Then remove the wait result from the filterQuery.
         filterQueries.remove(query);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/TreeContactList.java
Patch:
@@ -1075,8 +1075,8 @@ public void run()
                                         tempTreeModel,
                                         filterSource);
 
-                    filterQuery.setSucceeded(
-                        !filterQuery.isSucceeded() && isSucceeded);
+                    if (!filterQuery.isSucceeded() && isSucceeded)
+                        filterQuery.setSucceeded(true);
                 }
             }.start();
         }

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryContactSource.java
Patch:
@@ -141,7 +141,8 @@ public void addContactQueryListener(ContactQueryListener l)
          */
         public void cancel()
         {
-            callHistoryQuery.cancel();
+            if (callHistoryQuery != null)
+                callHistoryQuery.cancel();
         }
 
         /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -267,7 +267,7 @@ public void actionPerformed(ActionEvent e)
                             else if (providersCount > 1)
                                 chooseAccountDialog
                                     = new ChooseCallAccountPopupMenu(
-                                        tree, providers);
+                                        tree, detail.getAddress(), providers);
                         }
                     }
                     else if (telephonyContacts.size() > 1)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/contactsource/SourceUIContact.java
Patch:
@@ -99,7 +99,7 @@ public int getSourceIndex()
      */
     public ImageIcon getStatusIcon()
     {
-        return null;
+        return new ImageIcon(Constants.getStatusIcon(Constants.OFFLINE_STATUS));
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -230,8 +230,6 @@ public void callEnded(CallEvent event)
 
         if (sourceCall.equals(incomingCall))
         {
-            CallManager.addMissedCall();
-
             this.dispose();
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/CallHistoryFilter.java
Patch:
@@ -139,6 +139,7 @@ private void addHistoryContact( SourceContact sourceContact,
         GuiActivator.getContactList()
             .addContact(resultTreeModel,
                         uiSource.getUIContact(sourceContact),
+                        uiSource.getUIGroup(),
                         false,
                         false);
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GroupNode.java
Patch:
@@ -115,6 +115,7 @@ public void removeContact(UIContact uiContact)
             children.removeElementAt(index);
             contactNode.setParent(null);
             uiContact.setContactNode(null);
+            uiContact = null;
 
             fireNodeRemoved(contactNode, index);
         }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchFilter.java
Patch:
@@ -266,6 +266,7 @@ private void addSourceContact(SourceContact sourceContact)
             GuiActivator.getContactList().addContact(
                 resultTreeModel,
                 sourceUI.getUIContact(sourceContact),
+                sourceUI.getUIGroup(),
                 true,
                 false);
     }

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandler.java
Patch:
@@ -505,7 +505,8 @@ public void setLocallyOnHold(boolean locallyOnHold)
                             .or(MediaDirection.SENDONLY));
                 audioStream.setMute(locallyOnHold);
             }
-            if(videoStream != null)
+            if(videoStream != null
+                && videoStream.getDirection() != MediaDirection.INACTIVE)
             {
                 videoStream.setDirection(videoStream.getDirection()
                             .or(MediaDirection.SENDONLY));

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -371,7 +371,7 @@ public void addProtocolSupportedOperationSets(
             presence.addProviderPresenceStatusListener(
                         new GUIProviderPresenceStatusListener());
             presence.addContactPresenceStatusListener(
-                        TreeContactList.presenceFilter);
+                        GuiActivator.getContactList());
         }
 
         // Obtain the basic instant messaging operation set.

File: src/net/java/sip/communicator/impl/neomedia/format/AudioMediaFormatImpl.java
Patch:
@@ -111,6 +111,8 @@ public class AudioMediaFormatImpl
      * <tt>AudioMediaFormatImpl</tt> instance
      * @param formatParameters any codec-specific parameters that have been
      * received via SIP/SDP or XMPP/Jingle.
+     * @param advancedParameters set of advanced parameters that have been
+     * received by SIP/SDP or XMPP/Jingle
      */
     AudioMediaFormatImpl(
             String encoding,

File: src/net/java/sip/communicator/impl/neomedia/format/MediaFormatFactoryImpl.java
Patch:
@@ -285,6 +285,8 @@ public MediaFormat createMediaFormat(
      * <tt>encoding</tt>; otherwise, ignored
      * @param formatParams any codec specific parameters which have been
      * received via SIP/SDP or XMPP/Jingle
+     * @param advancedParams any parameters which have been
+     * received via SIP/SDP or XMPP/Jingle
      * @return a <tt>MediaFormat</tt> with the specified <tt>encoding</tt>,
      * <tt>clockRate</tt>, <tt>channels</tt> and set of format parameters which
      * is either an <tt>AudioMediaFormat</tt> or a <tt>VideoMediaFormat</tt>

File: src/net/java/sip/communicator/impl/neomedia/format/VideoMediaFormatImpl.java
Patch:
@@ -101,6 +101,7 @@ public class VideoMediaFormatImpl
      * instance
      * @param formatParameters the set of format-specific parameters of the new
      * instance
+     * @param advancedParameters set of advanced parameters of the new instance
      */
     VideoMediaFormatImpl(
             VideoFormat format,

File: src/net/java/sip/communicator/impl/protocol/sip/sdp/SdpUtils.java
Patch:
@@ -16,7 +16,6 @@
 
 import net.java.sip.communicator.impl.protocol.sip.*;
 import net.java.sip.communicator.service.neomedia.*;
-import net.java.sip.communicator.service.neomedia.device.*;
 import net.java.sip.communicator.service.neomedia.format.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: test/net/java/sip/communicator/slick/callhistory/TestCallHistoryService.java
Patch:
@@ -317,12 +317,12 @@ public void checkRecordCompleteness()
 
         Collection<CallRecord> lastCall = callHistoryService.findLast(1);
 
-        assertEquals("There must be 1 Call", lastCall.size(), 1);
+        assertEquals("There must be 1 Call", 1, lastCall.size());
 
         CallRecord callRecord = lastCall.iterator().next();
 
         assertEquals("There must be 2 participants in the call",
-                     callRecord.getPeerRecords().size(), 2);
+                     2, callRecord.getPeerRecords().size());
 
         CallPeerRecord callP1 =
             callRecord.findPeerRecord(partAddresses[0]);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SourceContactRightButtonMenu.java
Patch:
@@ -74,7 +74,7 @@ private Component initCallMenu()
             final ContactDetail detail = details.next();
             // add all the contacts that support telephony to the call menu
             JMenuItem callContactItem = new JMenuItem();
-            callContactItem.setName(detail.getContactAddress());
+            callContactItem.setText(detail.getContactAddress());
             callContactItem.addActionListener(new ActionListener()
             {
                 public void actionPerformed(ActionEvent e)

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -230,6 +230,8 @@ public void callEnded(CallEvent event)
 
         if (sourceCall.equals(incomingCall))
         {
+            CallManager.addMissedCall();
+
             this.dispose();
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/UnknownContactPanel.java
Patch:
@@ -85,7 +85,7 @@ public void actionPerformed(ActionEvent e)
                 if (searchText == null)
                     return;
 
-                Vector<ProtocolProviderService> telephonyProviders
+                List<ProtocolProviderService> telephonyProviders
                     = CallManager.getTelephonyProviders();
 
                 if (telephonyProviders.size() == 1)

File: src/net/java/sip/communicator/impl/gui/main/call/ChooseCallAccountPopupMenu.java
Patch:
@@ -81,6 +81,8 @@ private void init()
         this.add(createInfoLabel());
 
         this.addSeparator();
+
+        this.setFocusable(true);
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/AudioMediaStreamImpl.java
Patch:
@@ -137,12 +137,12 @@ protected void configureRTPManagerBufferControl(
                     nfe);
         }
 
-        bufferLength = bufferControl.setBufferLength(bufferLength);
+        bufferLength = bufferControl.setBufferLength(/* bufferLength */ BufferControl.MAX_VALUE);
         if (logger.isTraceEnabled())
             logger.trace("Set receiver buffer length to " + bufferLength);
 
         bufferControl.setEnabledThreshold(true);
-        bufferControl.setMinimumThreshold(100);
+        bufferControl.setMinimumThreshold(20);
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/device/PortAudioAuto.java
Patch:
@@ -87,7 +87,8 @@ public class PortAudioAuto
             int maxOutputChannels =
                 PortAudio.PaDeviceInfo_getMaxOutputChannels(deviceInfo);
 
-            String devName = PortAudio.PaDeviceInfo_getName(deviceInfo);
+            String devName
+                = PortAudio.PaDeviceInfo_getCharsetAwareName(deviceInfo);
             if (devName != null)
                 devName = devName.trim();
 
@@ -166,7 +167,6 @@ public class PortAudioAuto
             logger.error("Error parsing audio config", e);
         }
 
-
         supported = true;
     }
 

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPanel.java
Patch:
@@ -44,7 +44,7 @@ public OneToOneCallPanel(   CallDialog callDialog,
         this.callDialog = callDialog;
 
         this.setBorder(BorderFactory
-            .createEmptyBorder(5, 5, 5, 5));
+            .createEmptyBorder(5, 0, 5, 0));
 
         this.setTransferHandler(new CallTransferHandler(call));
 

File: src/net/java/sip/communicator/impl/gui/main/menus/HelpMenu.java
Patch:
@@ -42,8 +42,6 @@ public HelpMenu(MainFrame mainFrame)
     {
         ResourceManagementService resources = GuiActivator.getResources();
 
-        setForeground(
-            new Color(resources.getColor("service.gui.MAIN_MENU_FOREGROUND")));
         setMnemonic(resources.getI18nMnemonic("service.gui.HELP"));
         setOpaque(false);
         setText(resources.getI18NString("service.gui.HELP"));

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -66,6 +66,8 @@ private void initComponents()
     {
         JPanel mainPanel = new JPanel(new GridBagLayout());
         JLabel callLabel = new JLabel();
+        // disable html rendering
+        callLabel.putClientProperty("html.disable", Boolean.TRUE);
 
         JPanel buttonsPanel = new TransparentPanel(new GridBagLayout());
 

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -841,7 +841,7 @@ public void shutdown()
         // especially for ending SIMPLE
         Thread t = new Thread(new ShutdownThread());
         t.setDaemon(false);
-        t.run();
+        t.start();
 
     }
 

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandler.java
Patch:
@@ -1586,7 +1586,7 @@ private StreamConnector createStreamConnector()
         //make sure that next time we don't try to bind on occupied ports
         nextMediaPortToTry = rtcpSocket.getLocalPort() + 1;
 
-        if (nextMediaPortToTry > maxMediaPort)
+        if (nextMediaPortToTry > maxMediaPort -1)// take RTCP into account.
             nextMediaPortToTry = minMediaPort;
 
         //create the RTCP socket

File: src/net/java/sip/communicator/impl/neomedia/device/DeviceConfiguration.java
Patch:
@@ -225,7 +225,7 @@ else if (audioCaptureDevices.length < 1)
 
             if(audioDevName == null)
             {
-                // the default behaviour if nothing set is to use javasound
+                // the default behaviour if nothing set is to use portaudio
                 // this will also choose the capture device
                 if(PortAudioAuto.isSupported())
                 {
@@ -255,11 +255,11 @@ else if (audioCaptureDevices.length < 1)
                 {
                     logger.warn("Computer sound config changed or " +
                         "there is a problem since last config was saved, " +
-                        "will back to javasound");
+                        "will back to default");
                     setAudioPlaybackDevice(null, false);
                     setAudioNotifyDevice(null, false);
                     setAudioCaptureDevice(null, false);
-                    setAudioSystem(AUDIO_SYSTEM_JAVASOUND, null, false);
+                    setAudioSystem(AUDIO_SYSTEM_PORTAUDIO, null, false);
                 }
             }
             if (audioCaptureDevice != null)

File: src/net/java/sip/communicator/impl/configuration/ChangeEventDispatcher.java
Patch:
@@ -306,7 +306,7 @@ public void fireVetoableChange(PropertyChangeEvent evt)
                 try {
                     target.vetoableChange(evt);
                 } catch (PropertyVetoException e) {
-                    throw new ConfigPropertyVetoExceoption(e.getLocalizedMessage(), evt);
+                    throw new ConfigPropertyVetoException(e.getLocalizedMessage(), evt);
                 }
             }
         }

File: src/net/java/sip/communicator/service/configuration/ConfigPropertyVetoException.java
Patch:
@@ -14,7 +14,7 @@
  *
  * @author Emil Ivov
  */
-public class ConfigPropertyVetoExceoption
+public class ConfigPropertyVetoException
     extends RuntimeException
 {
     /**
@@ -30,7 +30,7 @@ public class ConfigPropertyVetoExceoption
      * @param message Descriptive message
      * @param evt A PropertyChangeEvent describing the vetoed change.
      */
-    public ConfigPropertyVetoExceoption(String message, PropertyChangeEvent evt)
+    public ConfigPropertyVetoException(String message, PropertyChangeEvent evt)
     {
         super(message);
 

File: src/net/java/sip/communicator/util/swing/SIPCommDialog.java
Patch:
@@ -205,7 +205,7 @@ private void saveSizeAndLocation()
         {
             SIPCommFrame.saveSizeAndLocation(this);
         }
-        catch (ConfigPropertyVetoExceoption e1)
+        catch (ConfigPropertyVetoException e1)
         {
             logger.error("The proposed property change "
                     + "represents an unacceptable value");

File: src/net/java/sip/communicator/util/swing/SIPCommFrame.java
Patch:
@@ -192,7 +192,7 @@ private void saveSizeAndLocation()
         {
             saveSizeAndLocation(this);
         }
-        catch (ConfigPropertyVetoExceoption e)
+        catch (ConfigPropertyVetoException e)
         {
             logger
                 .error(
@@ -212,7 +212,7 @@ private void saveSizeAndLocation()
      * <tt>PropertyVetoListener</tt>s.
      */
     static void saveSizeAndLocation(Component component)
-        throws ConfigPropertyVetoExceoption
+        throws ConfigPropertyVetoException
     {
         Map<String, Object> props = new HashMap<String, Object>();
         String className

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -319,7 +319,8 @@ public void unregister()
         throws OperationFailedException
     {
         if(getRegistrationState().equals(RegistrationState.UNREGISTERED)
-            || getRegistrationState().equals(RegistrationState.UNREGISTERING))
+            || getRegistrationState().equals(RegistrationState.UNREGISTERING)
+                || getRegistrationState().equals(RegistrationState.CONNECTION_FAILED))
         {
             return;
         }

File: src/net/java/sip/communicator/impl/gui/main/login/CertificateVerificationServiceImpl.java
Patch:
@@ -90,8 +90,7 @@ private static class VerifyCertificateDialog
          * Date formatter.
          */
         private static SimpleDateFormat dateFormatter =
-            new SimpleDateFormat(GuiActivator.getResources()
-                .getI18NString("service.gui.CERT_INFO_DATE_FORMAT"));
+            new SimpleDateFormat("MM/dd/yyyy");
 
         /**
          * Used for converting bytes to HEX.

File: src/net/java/sip/communicator/plugin/iptelaccregwizz/IptelAccountRegistration.java
Patch:
@@ -26,7 +26,7 @@ public class IptelAccountRegistration
     /**
      * The default transport.
      */
-    public static String DEFAULT_TRANSPORT = "UDP";
+    public static String DEFAULT_TRANSPORT = "TCP";
 
     /**
      * The default poll period.

File: src/net/java/sip/communicator/plugin/chatalerter/ChatAlerterActivator.java
Patch:
@@ -299,7 +299,7 @@ private void alertChatWindow()
 
             Alerter.newInstance().alert(fr);
         }
-        catch (Exception ex)
+        catch (Throwable ex)
         {
             logger.error("Cannot alert chat window!");
         }

File: src/net/java/sip/communicator/plugin/otr/OtrConfigurationPanel.java
Patch:
@@ -450,7 +450,7 @@ public void actionPerformed(ActionEvent arg0)
 
             btnForgetFingerprint = new JButton();
             btnForgetFingerprint.setText(OtrActivator.resourceService
-                .getI18NString("plugin.otr.configform.VERIFY_FINGERPRINT"));
+                .getI18NString("plugin.otr.configform.FORGET_FINGERPRINT"));
             btnForgetFingerprint.addActionListener(new ActionListener()
             {
                 public void actionPerformed(ActionEvent arg0)

File: src/net/java/sip/communicator/impl/osdependent/jdic/TrayMenuFactory.java
Patch:
@@ -176,8 +176,8 @@ public void actionPerformed(ActionEvent event)
 
         add(trayMenu, showHideMenuItem);
 
-        add(trayMenu, createTrayMenuItem("service.gui.CLOSE",
-            "service.gui.CLOSE", "service.systray.CLOSE_MENU_ICON", listener,
+        add(trayMenu, createTrayMenuItem("service.gui.QUIT",
+            "service.gui.QUIT", "service.systray.QUIT_MENU_ICON", listener,
             swing));
 
         OsDependentActivator.getUIService().addWindowListener(

File: src/net/java/sip/communicator/plugin/sipaccregwizz/FirstWizardPage.java
Patch:
@@ -281,7 +281,7 @@ public void actionPerformed(ActionEvent evt)
         advancedOpPanel.add(encryptionPanel, BorderLayout.SOUTH);
 
         advancedOpPanel.setBorder(BorderFactory.createTitledBorder(Resources
-            .getString("plugin.aimaccregwizz.ADVANCED_OPTIONS")));
+            .getString("plugin.sipaccregwizz.ADVANCED_OPTIONS")));
 
         advancedPanel.add(advancedOpPanel);
 

File: src/net/java/sip/communicator/util/swing/SIPCommDialog.java
Patch:
@@ -256,7 +256,7 @@ private void ensureOnScreenLocationAndSize()
 
         int width = this.getWidth();
         int height = this.getHeight();
-
+        
         Rectangle virtualBounds = ScreenInformation.getScreenBounds();
 
         // the default distance to the screen border
@@ -312,9 +312,8 @@ private void ensureOnScreenLocationAndSize()
         }
 
         // check the lower right corder
-        if (!(virtualBounds.contains(x + width, y + height)))
+        if (!(virtualBounds.contains(x, y, width, height)))
         {
-
             if (x + width > virtualBounds.x + virtualBounds.width)
             {
                 // location of window is too far to the right, its right

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatContactListModel.java
Patch:
@@ -86,8 +86,8 @@ public void addElement(ChatContact chatContact)
         if (chatContact == null)
             throw new IllegalArgumentException("chatContact");
 
-        int index = -1;
         int chatContactCount = chatContacts.size();
+        int index = -1;
 
         for (int i = 0; i < chatContactCount; i++)
         {
@@ -104,7 +104,7 @@ public void addElement(ChatContact chatContact)
             }
         }
         if (index == -1)
-            index = 0;
+            index = chatContactCount;
 
         chatContacts.add(index, chatContact);
         fireIntervalAdded(this, index, index);

File: src/net/java/sip/communicator/impl/protocol/irc/ChatRoomIrcImpl.java
Patch:
@@ -22,7 +22,7 @@
  * @author Yana Stamcheva
  */
 public class ChatRoomIrcImpl
-    implements  ChatRoom
+    implements ChatRoom
 {
     /**
      * The object used for logging.
@@ -49,7 +49,7 @@ public class ChatRoomIrcImpl
     /**
      * The parent protocol service provider
      */
-    private ProtocolProviderServiceIrcImpl parentProvider;
+    private final ProtocolProviderServiceIrcImpl parentProvider;
 
     /**
      * Listeners that will be notified of changes in member status in the
@@ -106,7 +106,7 @@ public class ChatRoomIrcImpl
      * Indicates if this chat room is a private one (i.e. created with the 
      * query command ).
      */
-    private boolean isPrivate = false;
+    private final boolean isPrivate;
 
     /**
      * Indicates if this chat room is a system one (i.e. corresponding to the

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegSummaryPage.java
Patch:
@@ -62,9 +62,9 @@ public AccountRegSummaryPage(AccountRegWizardContainerImpl wizardContainer)
         JPanel wrapPanel = new TransparentPanel(new BorderLayout());
         wrapPanel.add(mainPanel, BorderLayout.NORTH);
 
-        this.setViewportView(wrapPanel);
-
-        this.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
+        setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
+        setOpaque(false);
+        setViewportView(wrapPanel);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceInviteDialog.java
Patch:
@@ -102,6 +102,8 @@ public void actionPerformed(ActionEvent e)
                 {
                     lastSelectedAccount = accountSelectorBoxSelectedItem;
 
+                    removeAllSelectedContacts();
+
                     initContactListData(
                         (ProtocolProviderService) accountSelectorBox
                             .getSelectedItem());

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -285,10 +285,7 @@ else if (chatSession instanceof ConferenceChatSession)
                 = chatSession.getParticipants();
 
             while (chatParticipants.hasNext())
-            {
-                //Add the contact to the list of contacts contained in this chat.
                 chatContactListPanel.addContact(chatParticipants.next());
-            }
         }
 
         if (!chatSession.getCurrentChatTransport().allowsSmsMessage())

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomMemberListPanel.java
Patch:
@@ -67,6 +67,7 @@ public ChatRoomMemberListPanel(final ChatPanel chat)
         {
             this.memberList.addMouseListener(new MouseAdapter()
             {
+                @Override
                 public void mouseClicked(MouseEvent e)
                 {
                     if(e.getButton() == MouseEvent.BUTTON3)

File: src/net/java/sip/communicator/service/resources/ResourceManagementService.java
Patch:
@@ -151,6 +151,7 @@ public interface ResourceManagementService
      * Returns an internationalized string corresponding to the given key.
      *
      * @param key The key of the string.
+     * @param l The locale.
      * @return An internationalized string corresponding to the given key.
      */
     public char getI18nMnemonic(String key, Locale l);
@@ -211,6 +212,7 @@ public interface ResourceManagementService
      * Returns the path of the sound corresponding to the given
      * property key.
      *
+     * @param soundKey The key of the sound.
      * @return the path of the sound corresponding to the given
      * property key.
      */

File: src/net/java/sip/communicator/impl/gui/main/menus/MainMenu.java
Patch:
@@ -76,15 +76,16 @@ public boolean hasSelectedMenus()
     /**
      * Paints the MENU_BACKGROUND image on the background of this container.
      * 
-     * @param g the Graphics object that does the painting
+     * @param g the <tt>Graphics</tt> object that does the painting
      */
+    @Override
     public void paintComponent(Graphics g)
     {
         super.paintComponent(g);
 
         Image backgroundImage
             = ImageLoader.getImage(ImageLoader.MENU_BACKGROUND);
 
-        g.drawImage(backgroundImage, 0, 0, getWidth(), getHeight(), null);
+        g.drawImage(backgroundImage, 0, 0, getWidth(), getHeight(), this);
     }
 }

File: src/net/java/sip/communicator/impl/neomedia/MediaStreamImpl.java
Patch:
@@ -495,9 +495,7 @@ else if (dataSource instanceof PullDataSource)
                 ZRTPTransformEngine engine = zrtpControl.getZrtpEngine();
 
                 if (engine != null)
-                {
                     engine.setOwnSSRC(sendStream.getSSRC());
-                }
             }
             catch (IOException ioe)
             {

File: src/net/java/sip/communicator/impl/neomedia/codec/video/FFMPEG.java
Patch:
@@ -216,6 +216,7 @@ public static native int img_convert(long dst, int dst_pix_fmt, long src,
      * or short[])
      * @param dst_pix_fmt destination format
      * @param src source image. Its type must be an array (int[], byte[] or short[])
+     * @param pix_fmt the format of <tt>src</tt>
      * @param width original width
      * @param height original height
      * @param newWidth new width

File: src/net/java/sip/communicator/impl/gui/main/contactlist/CommonRightButtonMenu.java
Patch:
@@ -26,8 +26,8 @@ public class CommonRightButtonMenu extends JPopupMenu
     implements ActionListener
 {
     private final JMenuItem addContactItem = new JMenuItem(
-        GuiActivator.getResources().getI18NString("service.gui.ADD_CONTACT"
-            + "..."),
+        GuiActivator.getResources()
+            .getI18NString("service.gui.ADD_CONTACT") + "...",
         new ImageIcon(ImageLoader.getImage(ImageLoader.ADD_CONTACT_16x16_ICON)));
 
     private final JMenuItem createGroupItem = new JMenuItem(

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -22,7 +22,7 @@
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
 import net.java.sip.communicator.impl.gui.main.chat.history.*;
 import net.java.sip.communicator.impl.gui.main.configforms.*;
-import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.*;
+import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.impl.gui.main.login.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.contactlist.*;
@@ -390,7 +390,7 @@ public boolean getExitOnMainWindowClose()
      */
     public void initExportedWindows()
     {
-        registerExportedWindow(new AddContactWizardExportedWindow(mainFrame));
+        registerExportedWindow(new AddContactDialog(mainFrame));
         registerExportedWindow(new AuthenticationExportedWindow(mainFrame));
     }
 

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/ChatRoomNamePanel.java
Patch:
@@ -42,7 +42,7 @@ public class ChatRoomNamePanel
         GuiActivator.getResources().getI18NString("service.gui.CREATE_CHAT_ROOM"));
     
     private JLabel iconLabel = new JLabel(new ImageIcon(ImageLoader
-            .getImage(ImageLoader.ADD_CONTACT_WIZARD_ICON)));
+            .getImage(ImageLoader.ADD_CONTACT_CHAT_ICON)));
 
     private JPanel labelsPanel =
         new TransparentPanel(new GridLayout(0, 1, 10, 10));

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/CreateChatRoomWizardPage2.java
Patch:
@@ -7,7 +7,6 @@
 
 package net.java.sip.communicator.impl.gui.main.chatroomslist.createforms;
 
-import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.*;
 import net.java.sip.communicator.service.gui.*;
 
 /**
@@ -55,7 +54,7 @@ public Object getNextPageIdentifier()
      */
     public Object getBackPageIdentifier()
     {
-        return AddContactWizardPage1.IDENTIFIER;
+        return CreateChatRoomWizardPage1.IDENTIFIER;
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/SelectAccountPanel.java
Patch:
@@ -51,7 +51,7 @@ public class SelectAccountPanel extends TransparentPanel
             = new TransparentPanel(new BorderLayout(10, 10));
     
     private final JLabel iconLabel = new JLabel(new ImageIcon(ImageLoader
-            .getImage(ImageLoader.ADD_CONTACT_WIZARD_ICON)));
+            .getImage(ImageLoader.ADD_CONTACT_CHAT_ICON)));
     
     private final SIPCommMsgTextArea infoLabel = new SIPCommMsgTextArea(
         GuiActivator.getResources()

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomDialog.java
Patch:
@@ -35,7 +35,7 @@ public class JoinChatRoomDialog
         GuiActivator.getResources().getI18NString("service.gui.CANCEL"));
     
     private JLabel iconLabel = new JLabel(new ImageIcon(ImageLoader
-        .getImage(ImageLoader.ADD_CONTACT_WIZARD_ICON)));
+        .getImage(ImageLoader.ADD_CONTACT_CHAT_ICON)));
 
     private JPanel buttonsPanel =
         new TransparentPanel(new FlowLayout(FlowLayout.RIGHT));

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomWizardPage2.java
Patch:
@@ -9,7 +9,6 @@
 
 import javax.swing.event.*;
 
-import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.*;
 import net.java.sip.communicator.service.gui.*;
 
 /**
@@ -69,7 +68,7 @@ public Object getNextPageIdentifier()
      */
     public Object getBackPageIdentifier()
     {
-        return AddContactWizardPage1.IDENTIFIER;
+        return JoinChatRoomWizardPage1.IDENTIFIER;
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/SelectAccountPanel.java
Patch:
@@ -62,7 +62,7 @@ public class SelectAccountPanel extends TransparentPanel
         = new TransparentPanel(new BorderLayout(5, 5));
     
     private final JLabel iconLabel = new JLabel(new ImageIcon(ImageLoader
-            .getImage(ImageLoader.ADD_CONTACT_WIZARD_ICON)));
+            .getImage(ImageLoader.ADD_CONTACT_CHAT_ICON)));
     
     private final SIPCommMsgTextArea infoLabel = new SIPCommMsgTextArea(
         GuiActivator.getResources()

File: src/net/java/sip/communicator/impl/gui/utils/ImageLoader.java
Patch:
@@ -566,8 +566,8 @@ public class ImageLoader
     /**
      * The image used for decoration of the "Add contact" window.
      */
-    public static final ImageID ADD_CONTACT_WIZARD_ICON
-        = new ImageID("service.gui.icons.ADD_CONTACT_WIZARD_ICON");
+    public static final ImageID ADD_CONTACT_DIALOG_ICON
+        = new ImageID("service.gui.icons.ADD_CONTACT_DIALOG_ICON");
 
     /**
      * The image used for decoration of the "Add group" window.

File: src/net/java/sip/communicator/impl/osdependent/jdic/TrayMenuFactory.java
Patch:
@@ -111,7 +111,7 @@ public void actionPerformed(ActionEvent event)
         add(trayMenu, createTrayMenuItem("settings", "service.gui.SETTINGS",
             "service.systray.CONFIGURE_ICON", listener, swing));
         add(trayMenu, createTrayMenuItem("addContact",
-            "service.gui.ADD_CONTACT",
+            "service.gui.ADD_CONTACT" + "...",
             "service.gui.icons.ADD_CONTACT_16x16_ICON", listener, swing));
         addSeparator(trayMenu);
         add(trayMenu, new StatusSubMenu(tray, swing).getMenu());

File: src/net/java/sip/communicator/util/swing/SIPCommDialog.java
Patch:
@@ -375,7 +375,7 @@ public void setVisible(boolean isVisible)
             }
 
             ensureOnScreenLocationAndSize();
-            
+
             JButton button = this.getRootPane().getDefaultButton();
 
             if(button != null)

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -851,7 +851,7 @@ public void enterFullScreen()
 
         // Lay out the main Components of the UI.
         final Container contentPane = frame.getContentPane();
-        contentPane.setLayout(new FullScreenLayout(true));
+        contentPane.setLayout(new FullScreenLayout(false));
         if (buttonBar != null)
             contentPane.add(buttonBar, FullScreenLayout.SOUTH);
         if (center != null)

File: src/net/java/sip/communicator/impl/neomedia/MediaServiceImpl.java
Patch:
@@ -489,7 +489,6 @@ public java.awt.Dimension getScreenSize()
         try
         {
             res = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
-            res = null;
         }
         catch(NoClassDefFoundError e)
         {

File: src/net/java/sip/communicator/impl/neomedia/device/VideoMediaDeviceSession.java
Patch:
@@ -188,7 +188,9 @@ protected void setFormat(Processor processor, Format format)
          */
         if(outputSize != null)
         {
-            newFormat = new VideoFormat(tmp.getEncoding(), outputSize, tmp.getMaxDataLength(), tmp.getDataType(), tmp.getFrameRate());
+            newFormat = new VideoFormat(tmp.getEncoding(), outputSize, 
+                    tmp.getMaxDataLength(), tmp.getDataType(), 
+                    tmp.getFrameRate());
         }
 
         super.setFormat(processor, newFormat != null ? newFormat : format);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -1072,7 +1072,7 @@ public void catchException(Throwable ex)
                     addErrorMessage(
                         chatSession.getCurrentChatTransport().getName(),
                         GuiActivator.getResources().getI18NString(
-                            "service.gui.MSG_DELIVERY_UNKNOWN_ERROR",
+                            "service.gui.MSG_DELIVERY_ERROR",
                             new String[]{ex.getMessage()}));
                 }
             }
@@ -1267,7 +1267,7 @@ protected void sendInstantMessage()
             this.addErrorMessage(
                 chatSession.getCurrentChatTransport().getName(),
                 GuiActivator.getResources().getI18NString(
-                    "service.gui.MSG_DELIVERY_UNKNOWN_ERROR",
+                    "service.gui.MSG_DELIVERY_ERROR",
                     new String[]{ex.getMessage()}));
         }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/SendSmsDialog.java
Patch:
@@ -159,7 +159,7 @@ private void sendSmsMessage(String phoneNumber, String message)
             chatPanel.addErrorMessage(
                 phoneNumber,
                 GuiActivator.getResources()
-                    .getI18NString("service.gui.MSG_DELIVERY_UNKNOWN_ERROR",
+                    .getI18NString("service.gui.MSG_DELIVERY_ERROR",
                     new String[]{ex.getMessage()}));
         }
         

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -404,7 +404,7 @@ else if (evt.getErrorCode()
         else
         {
             errorMsg = GuiActivator.getResources().getI18NString(
-                    "service.gui.MSG_DELIVERY_UNKNOWN_ERROR",
+                    "service.gui.MSG_DELIVERY_ERROR",
                     new String[]{evt.getReason()});
         }
 

File: src/net/java/sip/communicator/impl/gui/main/presence/AccountStatusPanel.java
Patch:
@@ -133,7 +133,7 @@ public AccountStatusPanel(MainFrame mainFrame)
             = new TransparentPanel(new BorderLayout());
 
         new PluginContainer(
-            new TransparentPanel(new BorderLayout()),
+            southPluginPanel,
             Container.CONTAINER_ACCOUNT_SOUTH);
 
         this.add(southPluginPanel, BorderLayout.SOUTH);

File: src/net/java/sip/communicator/service/protocol/event/MessageReceivedEvent.java
Patch:
@@ -72,7 +72,7 @@ public MessageReceivedEvent(Message source, Contact from, long timestamp)
      * 
      * @param source the <tt>Message</tt> whose reception this event represents.
      * @param from the <tt>Contact</tt> that has sent this message.
-     * @param timestamp the exact date when the event ocurred.
+     * @param timestamp the exact date when the event occurred.
      * @param eventType the type of message event that this instance represents
      * (one of the XXX_MESSAGE_RECEIVED static fields). 
      */

File: src/net/java/sip/communicator/impl/neomedia/codec/video/SwScaler.java
Patch:
@@ -14,7 +14,7 @@
 import net.sf.fmj.media.*;
 
 /**
- * Codec that use libswccale to scale images from one size to 
+ * Codec that use libswscale to scale images from one size to 
  * another and change format (typically RGB to YUV).
  *
  * @author Sebastien Vincent
@@ -122,7 +122,7 @@ public Format setOutputFormat(Format format)
     }
 
     /**
-     * Process (format convertion, rescale) a buffer.
+     * Process (format conversion, rescale) a buffer.
      *
      * @param input input buffer
      * @param output output buffer
@@ -182,7 +182,7 @@ public int process(Buffer input, Buffer output)
             dst = new byte[outputSize];
         }
 
-        /* convertion! */
+        /* conversion! */
         //System.out.println("Convert: " + inputWidth + "x" + inputHeight + " to " + outputWidth + "x" + outputHeight);
         FFMPEG.img_convert(dst, outfmt, src, infmt, inputWidth, inputHeight, outputWidth, outputHeight);
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallTransferHandler.java
Patch:
@@ -15,7 +15,7 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
-import net.java.sip.communicator.service.contactlist.*;
+import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
@@ -107,10 +107,10 @@ public boolean importData(JComponent comp, Transferable t)
                     logger.debug("Failed to drop meta contact.", e);
             }
 
-            if (o instanceof MetaContact)
+            if (o instanceof ContactNode)
             {
                 Iterator<Contact> contacts
-                    = ((MetaContact) o).getContactsForProvider(
+                    = ((ContactNode) o).getMetaContact().getContactsForProvider(
                         call.getProtocolProvider());
 
                 String callee = null;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTransferHandler.java
Patch:
@@ -339,8 +339,9 @@ public Object getTransferData(DataFlavor flavor)
             }
             else if (DataFlavor.stringFlavor.equals(flavor))
             {
-                if (transferredObject instanceof MetaContact)
-                    return ((MetaContact) transferredObject).getDisplayName();
+                if (transferredObject instanceof ContactNode)
+                    return ((ContactNode) transferredObject)
+                        .getMetaContact().getDisplayName();
             }
             else
                 throw new UnsupportedFlavorException(flavor);

File: src/net/java/sip/communicator/impl/neomedia/transform/csrc/CsrcTransformEngine.java
Patch:
@@ -120,8 +120,6 @@ public RawPacket reverseTransform(RawPacket pkt)
 
                 csrcLevelDispatcher.addLevels(levels);
             }
-
-            pkt.removeExtension();
         }
         return pkt;
     }

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -210,7 +210,7 @@ private void initDates()
      */
     public void showHistoryByPeriod(Date startDate, Date endDate)
     {
-        if((searchKeyword == null || searchKeyword == "")
+        if((searchKeyword == null || searchKeyword.length() == 0)
                 && dateHistoryTable.containsKey(startDate))
         {
             HTMLDocument document = dateHistoryTable.get(startDate);
@@ -588,7 +588,7 @@ public void run()
                 {
                     HTMLDocument doc = createHistory(msgList);
 
-                    if(searchKeyword == null || searchKeyword == "")
+                    if(searchKeyword == null || searchKeyword.length() == 0)
                     {
                         dateHistoryTable.put(startDate, doc);
                     }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -1324,7 +1324,7 @@ public void addComponent(ChatConversationComponent component)
      */
     public static String getDateString(long date)
     {
-        if (GuiUtils.compareDates(date, System.currentTimeMillis()) < 0)
+        if (GuiUtils.compareDatesOnly(date, System.currentTimeMillis()) < 0)
         {
             StringBuffer dateStrBuf = new StringBuffer();
 

File: src/net/java/sip/communicator/launcher/ChangeJVMFrame.java
Patch:
@@ -13,7 +13,7 @@
 
 /**
  * The <tt>ChangeJVMFrame</tt> will ask the user to install the newest java
- * version if she's using an old and icompatible one.
+ * version if she's using an old and incompatible one.
  * 
  * @author Yana Stamcheva
  */

File: src/net/java/sip/communicator/util/swing/UIAction.java
Patch:
@@ -11,7 +11,7 @@
 /**
  * A wrapper around AbstractAction, so we can differ our Actions.
  * Used when adding actions to the action map,
- * and actions will be trigered by keystrokes from the inputMap of the RootPane.
+ * and actions will be triggered by keystrokes from the inputMap of the RootPane.
  * 
  * @author Damian Minkov
  */

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -492,7 +492,7 @@ public void componentShown(ComponentEvent evt)
      */
     public void requestFocusInWriteArea()
     {
-        getChatWritePanel().getEditorPane().requestFocusInWindow();
+        getChatWritePanel().getEditorPane().requestFocus();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -14,7 +14,6 @@
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
 import net.java.sip.communicator.impl.gui.main.chatroomslist.*;
-import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/contactlist/MetaContactImpl.java
Patch:
@@ -619,6 +619,9 @@ void addProtoContact(Contact contact)
 
             this.protoContacts.add(contact);
 
+            // Re-init the default contact.
+            defaultContact = null;
+
             // if this is our firt contact and we don't already have a display
             // name, use theirs.
             if (this.protoContacts.size() == 1

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatSession.java
Patch:
@@ -398,6 +398,8 @@ public void metaContactMoved(MetaContactMovedEvent evt)
     public void metaContactRemoved(MetaContactEvent evt)
     {}
 
+    public void metaContactAvatarUpdated(MetaContactAvatarUpdateEvent evt) {}
+
     /**
      * Implements <tt>MetaContactListListener.metaContactRenamed</tt> method.
      * When a meta contact is renamed, updates all related labels in this

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -217,6 +217,8 @@ public void metaContactMoved(MetaContactMovedEvent evt)
         this.modifyGroup(evt.getOldParent());
     }
 
+    public void metaContactAvatarUpdated(MetaContactAvatarUpdateEvent evt) {}
+
     /**
      * Handles the <tt>MetaContactGroupEvent</tt>. Refreshes the list model
      * when a new meta contact group has been added.

File: src/net/java/sip/communicator/service/contactlist/event/MetaContactAvatarUpdateEvent.java
Patch:
@@ -13,7 +13,7 @@
  *
  * @author Emil Ivov
  */
-public class MetaContactAvatarUpdate
+public class MetaContactAvatarUpdateEvent
     extends MetaContactPropertyChangeEvent
 {
     /**
@@ -23,11 +23,11 @@ public class MetaContactAvatarUpdate
      * @param oldAvatar the new avatar just of this meta contact.
      * @param newAvatar the old avatar that just got replaced or <tt>null</tt>.
      */
-    public MetaContactAvatarUpdate(MetaContact source,
+    public MetaContactAvatarUpdateEvent(MetaContact source,
                                    byte[] oldAvatar,
                                    byte[] newAvatar)
     {
-        super(source, PROTO_CONTACT_AVATAR_UPDATE, oldAvatar, newAvatar);
+        super(source, META_CONTACT_AVATAR_UPDATE, oldAvatar, newAvatar);
     }
 
     /**

File: src/net/java/sip/communicator/service/contactlist/event/MetaContactPropertyChangeEvent.java
Patch:
@@ -54,8 +54,8 @@ public abstract class MetaContactPropertyChangeEvent
      * Indicates that the MetaContactEvent instance was triggered by the update
      * of an Avatar for one of its encapsulated contacts.
      */
-    public static final String PROTO_CONTACT_AVATAR_UPDATE
-                                            = "ProtoContactAvatarUpdate";
+    public static final String META_CONTACT_AVATAR_UPDATE
+                                            = "MetaContactAvatarUpdate";
 
     /**
      * Indicates that the meta contact has been modified. The old and new value

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactDialog.java
Patch:
@@ -185,7 +185,7 @@ public void run()
                             {
                                 new ErrorDialog(mainFrame,
                                     GuiActivator.getResources().getI18NString(
-                                    "addContactErrorTitle"),
+                                    "service.gui.ADD_CONTACT_ERROR_TITLE"),
                                     GuiActivator.getResources().getI18NString(
                                             "service.gui.ADD_CONTACT_EXIST_ERROR",
                                             new String[]{uin}),
@@ -198,7 +198,7 @@ else if (errorCode
                             {
                                 new ErrorDialog(mainFrame,
                                     GuiActivator.getResources().getI18NString(
-                                    "addContactErrorTitle"),
+                                    "service.gui.ADD_CONTACT_ERROR_TITLE"),
                                     GuiActivator.getResources().getI18NString(
                                         "service.gui.ADD_CONTACT_NETWORK_ERROR",
                                         new String[]{uin}),
@@ -209,7 +209,7 @@ else if (errorCode
                             {
                                 new ErrorDialog(mainFrame,
                                     GuiActivator.getResources().getI18NString(
-                                    "addContactErrorTitle"),
+                                    "service.gui.ADD_CONTACT_ERROR_TITLE"),
                                     GuiActivator.getResources().getI18NString(
                                             "service.gui.ADD_CONTACT_ERROR",
                                             new String[]{uin}),

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactWizard.java
Patch:
@@ -163,7 +163,7 @@ public void run()
                 {
                         new ErrorDialog(mainFrame,
                             GuiActivator.getResources().getI18NString(
-                            "addContactErrorTitle"),
+                            "service.gui.ADD_CONTACT_ERROR_TITLE"),
                             GuiActivator.getResources().getI18NString(
                                     "service.gui.ADD_CONTACT_EXIST_ERROR",
                                     new String[]{newContact.getUin()}),
@@ -186,7 +186,7 @@ else if (errorCode
                     
                     new ErrorDialog(mainFrame,
                         GuiActivator.getResources().getI18NString(
-                        "addContactErrorTitle"),
+                        "service.gui.ADD_CONTACT_ERROR_TITLE"),
                         GuiActivator.getResources().getI18NString(
                                 "service.gui.ADD_CONTACT_ERROR",
                                 new String[]{newContact.getUin()}),

File: src/net/java/sip/communicator/impl/gui/main/contactlist/UnknownContactPanel.java
Patch:
@@ -89,11 +89,10 @@ public void actionPerformed(ActionEvent e)
                 Vector<ProtocolProviderService> telephonyProviders
                     = CallManager.getTelephonyProviders();
 
-                ProtocolProviderService callProvider = null;
-
                 if (telephonyProviders.size() == 1)
                 {
-                    CallManager.createCall(callProvider, searchText);
+                    CallManager.createCall(
+                        telephonyProviders.get(0), searchText);
                 }
                 else if (telephonyProviders.size() > 1)
                 {

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/CreateChatRoomWizardPage2.java
Patch:
@@ -37,7 +37,7 @@ public CreateChatRoomWizardPage2(WizardContainer wizard,
     {
         this.newChatRoom = newChatRoom;
         
-        namePanel = new ChatRoomNamePanel(wizard);                
+        namePanel = new ChatRoomNamePanel(wizard);
     }
 
     /**

File: src/net/java/sip/communicator/plugin/dictaccregwizz/FirstWizardPage.java
Patch:
@@ -276,13 +276,13 @@ public Object getNextPageIdentifier()
 
     /**
      * Implements the <code>WizardPage.getBackPageIdentifier</code> to return
-     * the next back identifier - the default page.
+     * the back identifier, which is null as this is the first wizard page.
      *
-     * @return Returns the identifier of the previous page of the wizard.
+     * @return the identifier of the previous page of the wizard.
      */
     public Object getBackPageIdentifier()
     {
-        return WizardPage.DEFAULT_PAGE_IDENTIFIER;
+        return null;
     }
 
     /**

File: src/net/java/sip/communicator/service/gui/WizardPage.java
Patch:
@@ -42,12 +42,11 @@ public interface WizardPage
      * The identifier of the default wizard page.
      * <p>
      * At the time of this writing, it seems from its current uses that the
-     * constant indicates a <tt>null</tt> back page.  
+     * constant indicates a <tt>null</tt> back page.
      * </p>
      */
     String DEFAULT_PAGE_IDENTIFIER = "DEFAULT";
 
-
     /**
      * Returns the identifier of this <tt>WizardPage</tt>.
      *

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactWizard.java
Patch:
@@ -175,7 +175,7 @@ else if (errorCode
                     
                     new ErrorDialog(mainFrame,
                         GuiActivator.getResources().getI18NString(
-                        "addContactErrorTitle"),
+                        "service.gui.ADD_CONTACT_ERROR_TITLE"),
                         GuiActivator.getResources().getI18NString(
                                 "service.gui.ADD_CONTACT_NETWORK_ERROR",
                                 new String[]{newContact.getUin()}),

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -302,7 +302,7 @@ public Component getTreeCellRendererComponent(JTree tree, Object value,
 
             this.nameLabel.setText(displayName);
 
-            if(contactList.isMetaContactActive(metaContact))
+            if(contactList.isContactActive(metaContact))
             {
                 statusIcon.setImage(msgReceivedImage);
             }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/DefaultTreeContactList.java
Patch:
@@ -77,7 +77,7 @@ public void mouseReleased(MouseEvent e)
      * @return TRUE if the given <tt>MetaContact</tt> is active, FALSE -
      * otherwise
      */
-    public boolean isMetaContactActive(MetaContact metaContact)
+    public boolean isContactActive(MetaContact metaContact)
     {
         return false;
     }

File: src/net/java/sip/communicator/plugin/facebookaccregwizz/FirstWizardPage.java
Patch:
@@ -352,8 +352,8 @@ private boolean isExistingAccount(String username)
     }
 
     /**
-     * The simple form.
-     * @return
+     * Get the simple form.
+     * @return form with user and password field
      */
     public Object getSimpleForm()
     {

File: src/net/java/sip/communicator/service/protocol/OperationSetAvatar.java
Patch:
@@ -52,8 +52,7 @@ public interface OperationSetAvatar extends OperationSet
      * Returns the current avatar of this protocol. May return null if the
      * account has no avatar
      * 
-     * @param avatar
-     *            the new avatar
+     * @return avatar's bytes or null if no avatar set
      */
     public byte[] getAvatar();
 

File: src/net/java/sip/communicator/plugin/branding/AboutWindow.java
Patch:
@@ -176,9 +176,7 @@ public AboutWindow(Frame owner)
         this.pack();
         this.setResizable(false);
 
-        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
-        setLocation(screenSize.width / 2 - getWidth() / 2, screenSize.height
-            / 2 - getHeight() / 2);
+        setLocationRelativeTo(getParent());
     }
 
     /**

File: src/net/java/sip/communicator/util/swing/SIPCommFrame.java
Patch:
@@ -276,9 +276,7 @@ public void setSizeAndLocation()
      */
     private void setCenterLocation()
     {
-        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
-        this.setLocation(screenSize.width / 2 - this.getWidth() / 2,
-            screenSize.height / 2 - this.getHeight() / 2);
+        setLocationRelativeTo(null);
     }
 
     /**

File: src/net/java/sip/communicator/plugin/branding/AboutWindow.java
Patch:
@@ -197,14 +197,15 @@ public WindowBackground()
             {
                 bgImage = ImageIO.read(BrandingActivator.getResources().
                     getImageURL("plugin.branding.ABOUT_WINDOW_BACKGROUND"));
+
+                this.setPreferredSize(new Dimension(bgImage.getWidth(this),
+                    bgImage.getHeight(this)));
             }
             catch (IOException e)
             {
                 logger.error("Error cannot obtain background image", e);
                 bgImage = null;
             }
-            this.setPreferredSize(new Dimension(bgImage.getWidth(this),
-                                                bgImage.getHeight(this)));
         }
 
         protected void paintComponent(Graphics g)

File: src/net/java/sip/communicator/plugin/iptelaccregwizz/FirstWizardPage.java
Patch:
@@ -136,7 +136,7 @@ public class FirstWizardPage
 
     private JCheckBox forceP2PPresOpButton =
         new SIPCommCheckBox(Resources
-            .getString("plugin.sipaccregwizz.FORCE_P2P_PRESENCE"), true);
+            .getString("plugin.sipaccregwizz.FORCE_P2P_PRESENCE"), false);
 
     private JLabel pollPeriodLabel = new JLabel(
         Resources.getString(

File: src/net/java/sip/communicator/plugin/iptelaccregwizz/IptelAccountRegistration.java
Patch:
@@ -73,7 +73,7 @@ public class IptelAccountRegistration
 
     private boolean enablePresence = true;
 
-    private boolean forceP2PMode = true;
+    private boolean forceP2PMode = false;
 
     private boolean defaultEncryption = false;
 

File: src/net/java/sip/communicator/plugin/sipaccregwizz/FirstWizardPage.java
Patch:
@@ -125,7 +125,7 @@ public class FirstWizardPage
 
     private JCheckBox forceP2PPresOpButton =
         new SIPCommCheckBox(Resources
-            .getString("plugin.sipaccregwizz.FORCE_P2P_PRESENCE"), true);
+            .getString("plugin.sipaccregwizz.FORCE_P2P_PRESENCE"), false);
 
     private JLabel pollPeriodLabel = new JLabel(
         Resources.getString(

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistration.java
Patch:
@@ -47,7 +47,7 @@ public class SIPAccountRegistration
 
     private boolean enablePresence = true;
 
-    private boolean forceP2PMode = true;
+    private boolean forceP2PMode = false;
 
     private boolean defaultEncryption = false;
 

File: src/net/java/sip/communicator/impl/gui/customcontrols/events/CloseTabbedPaneEvent.java
Patch:
@@ -18,7 +18,9 @@
 /**
  * @author Yana Stamcheva
  */
-public class CloseTabbedPaneEvent extends Event {
+public class CloseTabbedPaneEvent
+    extends Event
+{
     private final String description;
 
     private final MouseEvent e;

File: src/net/java/sip/communicator/impl/media/device/JavaSoundAuto.java
Patch:
@@ -32,7 +32,7 @@ public static void main(String[] args) {
         System.exit(0);
     }
 
-    @SuppressWarnings("unchecked") //legacy JMF code.
+    @SuppressWarnings("unchecked") // JMF legacy code
     public JavaSoundAuto() {
         boolean supported = false;
         // instance JavaSoundDetector to check is javasound's capture is availabe
@@ -50,7 +50,8 @@ public JavaSoundAuto() {
         if (supported) {
             // It's there, start to register JavaSound with CaptureDeviceManager
             Vector<CaptureDeviceInfo> devices
-                = (Vector) CaptureDeviceManager.getDeviceList(null).clone();
+                = CaptureDeviceManager.getDeviceList(null);
+            devices = (Vector<CaptureDeviceInfo>) devices.clone();
 
             // remove the old javasound capturers
             String name;

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicInstantMessagingSipImpl.java
Patch:
@@ -540,6 +540,7 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
     private class BasicInstantMessagingMethodProcessor
         extends MethodProcessorAdapter
     {
+        @Override
         public boolean processTimeout(TimeoutEvent timeoutEvent)
         {
             synchronized (messageProcessors)
@@ -630,6 +631,7 @@ public boolean processTimeout(TimeoutEvent timeoutEvent)
          *         processor and shouldn't be offered to other processors
          *         registered for the same method; <tt>false</tt>, otherwise
          */
+        @Override
         public boolean processRequest(RequestEvent requestEvent)
         {
             synchronized (messageProcessors)
@@ -739,6 +741,7 @@ public boolean processRequest(RequestEvent requestEvent)
          *         processor and shouldn't be offered to other processors
          *         registered for the same method; <tt>false</tt>, otherwise
          */
+        @Override
         public boolean processResponse(ResponseEvent responseEvent)
         {
             synchronized (messageProcessors)

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomConfigurationWindow.java
Patch:
@@ -110,7 +110,7 @@ public ChatRoomConfigurationWindow(String chatRoomName,
 
         this.generalScrollPane.setPreferredSize(new Dimension(550, 500));
         this.generalScrollPane.setHorizontalScrollBarPolicy(
-            JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
+            JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED);
         this.optionsScrollPane.setHorizontalScrollBarPolicy(
             JScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
 
@@ -329,7 +329,8 @@ else if(fieldType.equals(
                     BorderFactory.createEmptyBorder(0, 0, 10, 0));
 
                 label.setPreferredSize(new Dimension(labelWidth, 30));
-
+                label.setAlignmentX(JLabel.RIGHT_ALIGNMENT);
+                
                 fieldPanel.add(label, BorderLayout.WEST);
                 fieldPanel.add(field, BorderLayout.CENTER);
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTreeCellRenderer.java
Patch:
@@ -255,7 +255,7 @@ public void actionPerformed(ActionEvent e)
                 if (treeNode != null && treeNode instanceof ContactNode)
                 {
                     GuiActivator.getUIService().getChatWindowManager()
-                    .startChat(((ContactNode) treeNode).getMetaContact());
+                        .startChat(((ContactNode) treeNode).getMetaContact());
                 }
             }
         });

File: src/net/java/sip/communicator/impl/gui/main/contactlist/SearchField.java
Patch:
@@ -46,7 +46,7 @@ public SearchField(MainFrame mainFrame)
         this.setOpaque(false);
         this.setPreferredSize(new Dimension(100, 22));
 
-        this.setTransferHandler(new ExtendedTransferHandler());
+        this.setDragEnabled(true);
         this.getDocument().addDocumentListener(this);
 
         InputMap imap = getInputMap();

File: src/net/java/sip/communicator/util/swing/ExtendedTransferHandler.java
Patch:
@@ -83,7 +83,7 @@ else if (flavor[i].equals(DataFlavor.stringFlavor))
             {
                 if (comp instanceof JTextComponent)
                 {
-                    JTextComponent c = (JTextComponent)comp;
+                    JTextComponent c = (JTextComponent) comp;
 
                     if (c.isEditable() && c.isEnabled())
                     {
@@ -463,5 +463,5 @@ public void dragDropEnd(DragSourceDropEvent e)
         }
 
         public void dropActionChanged(DragSourceDragEvent dsde) {}
-    } 
+    }
 }

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -1471,6 +1471,8 @@ public boolean dispatchKeyEvent(KeyEvent e)
                 || e.getKeyCode() == KeyEvent.VK_RIGHT
                 || e.getKeyCode() == KeyEvent.VK_UP
                 || e.getKeyCode() == KeyEvent.VK_DOWN
+                || e.getKeyCode() == KeyEvent.VK_PAGE_UP
+                || e.getKeyCode() == KeyEvent.VK_PAGE_DOWN
                 || e.getKeyCode() == KeyEvent.VK_BACK_SPACE
                 || e.getKeyCode() == KeyEvent.VK_CONTROL
                 || e.getKeyCode() == KeyEvent.VK_ALT

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h264/H264Parser.java
Patch:
@@ -24,7 +24,7 @@ public class H264Parser
     private final Logger logger = Logger.getLogger(H264Parser.class);
 
     // allocate enough space for the incoming data
-    private static final int MAX_FRAME_SIZE = 128 * 1024;
+    private static final int MAX_FRAME_SIZE = 1280 * 1024;
 
     // every NAL starts with this start sequence
     private static final byte[] startSequence = { 0, 0, 1};

File: src/net/java/sip/communicator/impl/protocol/sip/sdp/SdpUtils.java
Patch:
@@ -682,9 +682,9 @@ private static MediaFormat createFormat(
          * payloadType in its answer to a different MediaFormat than the one
          * we've specified in our offer?
          */
-        if ((payloadType >= DynamicPayloadTypeRegistry.MIN_DYNAMIC_PAYLOAD_TYPE)
+        if ((payloadType >= MediaFormat.MIN_DYNAMIC_PAYLOAD_TYPE)
                 && (payloadType
-                        <= DynamicPayloadTypeRegistry.MAX_DYNAMIC_PAYLOAD_TYPE)
+                        <= MediaFormat.MAX_DYNAMIC_PAYLOAD_TYPE)
                 && (format != null)
                 && (ptRegistry.findFormat(payloadType) == null))
             ptRegistry.addMapping(format, payloadType);

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h264/JNIEncoder.java
Patch:
@@ -303,8 +303,7 @@ public synchronized void open()
         avframe = FFMPEG.avcodec_alloc_frame();
         int size = width * height;
         FFMPEG.avframe_set_data(avframe, rawFrameBuffer, size, size / 4);
-        FFMPEG.avframe_set_linesize(avframe, width, height / 2,
-            width / 2);
+        FFMPEG.avframe_set_linesize(avframe, width, width / 2, width / 2);
 
         encFrameBuffer = new byte[encFrameLen];
 

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -1399,7 +1399,7 @@ private void reflectConferenceFocus(javax.sip.message.Message message)
         if (contactHeader != null)
         {
             if (getCall().isConferenceFocus())
-                contactHeader.setParameter("isfocus", "");
+                contactHeader.setParameter("isfocus", null);
             else
                 contactHeader.removeParameter("isfocus");
         }

File: src/net/java/sip/communicator/impl/protocol/yahoo/ProtocolProviderServiceYahooImpl.java
Patch:
@@ -459,10 +459,11 @@ public void inputExceptionThrown(SessionExceptionEvent ev)
                 logger.error("Yahoo protocol exception occured exception",
                     ev.getException());
                 logger.error("Yahoo protocol exception occured exception cause",
-                    ((YMSG9BadFormatException)ev.getException().getCause()));
+                    ev.getException().getCause());
             }
             else
-                    logger.error("Yahoo protocol exception occured", ev.getException());
+                    logger.error(
+                        "Yahoo protocol exception occured", ev.getException());
 
             unregister(false);
             if(isRegistered())

File: src/net/java/sip/communicator/launcher/SIPCommunicator.java
Patch:
@@ -48,7 +48,8 @@ public static void main(String[] args)
          */
         setScHomeDir(osName);
 
-        if (version.startsWith("1.4") || vmVendor.startsWith("Gnu") || vmVendor.startsWith("Free"))
+        if (version.startsWith("1.4") || vmVendor.startsWith("Gnu") || 
+                vmVendor.startsWith("Free"))
         {
             String os = "";
 

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/AdHocConferenceChatSession.java
Patch:
@@ -447,7 +447,7 @@ public boolean isContactListSupported()
     public void participantPresenceChanged(
             AdHocChatRoomParticipantPresenceChangeEvent evt) {
         AdHocChatRoom sourceChatRoom = evt.getAdHocChatRoom();
-
+        
         if(!sourceChatRoom.equals(chatRoomWrapper.getAdHocChatRoom()))
             return;
 

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/CreateChatRoomDialog.java
Patch:
@@ -105,7 +105,9 @@ public void actionPerformed(ActionEvent e)
 
             GuiActivator.getUIService().getConferenceChatManager()
                 .createChatRoom(chatRoomName,
-                                chatRoomProvider.getProtocolProvider(), null);
+                                chatRoomProvider.getProtocolProvider(), 
+                                null, 
+                                "");
         }
         this.dispose();
     }

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/CreateChatRoomWizard.java
Patch:
@@ -65,7 +65,8 @@ public void wizardFinished(WizardEvent e)
             GuiActivator.getUIService().getConferenceChatManager()
                 .createChatRoom(newChatRoom.getChatRoomName(),
                                 newChatRoom.getProtocolProvider(),
-                                null);
+                                null,
+                                "");
         }
     }
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetMultiUserChatJabberImpl.java
Patch:
@@ -124,7 +124,6 @@ public ChatRoom createChatRoom(
             room = createLocalChatRoomInstance(muc);
             room.setUserRole(ChatRoomMemberRole.OWNER);
         }
-        room.join();
         return room;
     }
 

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h264/JNIDecoder.java
Patch:
@@ -76,7 +76,9 @@ public JNIDecoder()
         outputFormats = new VideoFormat[1];
 
         /* default output format */
-        outputFormats[0] = new RGBFormat(new Dimension(Constants.VIDEO_WIDTH, Constants.VIDEO_HEIGHT), -1, Format.intArray,
+        outputFormats[0] = new RGBFormat(
+                new Dimension(Constants.VIDEO_WIDTH, Constants.VIDEO_HEIGHT), 
+                -1, Format.intArray,
                 ensureFrameRate(Format.NOT_SPECIFIED), 32, RED_MASK,
                 GREEN_MASK, BLUE_MASK, 1, -1, Format.FALSE,
                 Format.NOT_SPECIFIED);

File: src/net/java/sip/communicator/impl/neomedia/codec/video/h264/JNIDecoder.java
Patch:
@@ -176,7 +176,9 @@ public Format setOutputFormat(Format format)
     /**
      * Init the codec instances.
      */
-    public synchronized void open() throws ResourceUnavailableException
+    @Override
+    public synchronized void open()
+        throws ResourceUnavailableException
     {
         if (opened)
             return;
@@ -360,7 +362,6 @@ public String getName()
         return PLUGIN_NAME;
     }
 
-    @Override
     public Format[] getSupportedOutputFormats(Format in)
     {
         // null input format

File: src/net/java/sip/communicator/launcher/ChangeJVMFrame.java
Patch:
@@ -44,8 +44,8 @@ public class ChangeJVMFrame
         + " the newest version for your environment.";
 
     private String macLink
-        = "<a href=\"http://www.apple.com/downloads/macosx/apple/macosx_updates/" +
-            "javaformacosx104release6.html\">Download Java 1.5 for MacOSX</a>";
+        = "<a href=\"http://www.apple.com/downloads/macosx/apple/application_updates/" +
+          "javaformacosx104release9.html\">Download Java 1.5 for MacOSX</a>";
 
     private String defaultLink
         = "<a href=\"https://cds.sun.com/is-bin/INTERSHOP.enfinity/" +

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -142,7 +142,7 @@ public Iterator<Map.Entry<String,String>> getSummary()
 
         summaryTable.put(
             Resources.getString(
-                        "plugin.jabberaccregwizz.GMAIL_NOTIFICATIONS_ENABLED"),
+                        "plugin.jabberaccregwizz.ENABLE_GMAIL_NOTIFICATIONS"),
             String.valueOf(registration.isGmailNotificationEnabled()));
 
         summaryTable.put(

File: src/net/java/sip/communicator/impl/neomedia/portaudio/streams/InputPortAudioStream.java
Patch:
@@ -78,6 +78,7 @@ public synchronized void stop()
     {
         if(started)
         {
+            parentStream.setStopping(true);
             parentStream.stop(this);
             started = false;
         }

File: src/net/java/sip/communicator/impl/neomedia/device/DeviceConfiguration.java
Patch:
@@ -365,7 +365,7 @@ public CaptureDeviceInfo getAudioCaptureDevice()
      * Gets the list of audio capture devices which are available through this
      * <code>DeviceConfiguration</code>, amongst which is
      * {@link #getAudioCaptureDevice()} and represent acceptable values
-     * for {@link #setAudioCaptureDevice(CaptureDeviceInfo)}
+     * for {@link #setAudioCaptureDevice(CaptureDeviceInfo, boolean)}
      *
      * @return an array of <code>CaptureDeviceInfo</code> describing the audio
      *         capture devices available through this
@@ -384,7 +384,7 @@ public CaptureDeviceInfo[] getAvailableAudioCaptureDevices()
      * Gets the list of audio capture devices which are available through this
      * <code>DeviceConfiguration</code>, amongst which is
      * {@link #getAudioCaptureDevice()} and represent acceptable values
-     * for {@link #setAudioCaptureDevice(CaptureDeviceInfo)}
+     * for {@link #setAudioCaptureDevice(CaptureDeviceInfo, boolean)}
      *
      * @param soundSystem
      *         filter capture devices only from the supplied audio system.
@@ -434,7 +434,7 @@ public CaptureDeviceInfo[] getAvailableAudioPlaybackDevices()
      * Gets the list of video capture devices which are available through this
      * <code>DeviceConfiguration</code>, amongst which is
      * {@link #getVideoCaptureDevice()} and represent acceptable values
-     * for {@link #setVideoCaptureDevice(CaptureDeviceInfo)}
+     * for {@link #setVideoCaptureDevice(CaptureDeviceInfo, boolean)}
      *
      * @return an array of <code>CaptureDeviceInfo</code> describing the video
      *         capture devices available through this

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandler.java
Patch:
@@ -1905,8 +1905,6 @@ public Component createLocalVisualComponent()
               
     /**
      * Dispose local visual <tt>Component</tt> of the local peer.
-     *
-     * @return visual <tt>Component</tt>
      */
     public void disposeLocalVisualComponent()
     {

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetAdHocMultiUserChatYahooImpl.java
Patch:
@@ -290,6 +290,7 @@ private AdHocChatRoom createAdHocChatRoom(
             throw new OperationFailedException(errorMessage,
                 OperationFailedException.CHAT_ROOM_NOT_JOINED, e);
         }
+        chatRoom.join();
         return chatRoom;
     }
 

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -800,7 +800,7 @@ public void contactPersonalMessageChanged(MsnMessenger messenger ,
             ContactMsnImpl contactImpl =
                 findContactById(contact.getEmail().getEmailAddress());
 
-            if (contactImpl != null)
+            if (contactImpl == null)
                 return;
 
             contactImpl.setStatusMessage(contact.getPersonalMessage());

File: src/net/java/sip/communicator/util/swing/GenericFileDialog.java
Patch:
@@ -53,6 +53,9 @@ else if(fileOperation == SipCommFileChooser.SAVE_FILE_OPERATION)
 					e.printStackTrace();
 				}
 	
+			if (parent == null)
+				parent = new Frame();
+			
 			return new SipCommFileDialogImpl(parent, title, operation);
 		}
 		else

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceParticipantPanel.java
Patch:
@@ -324,7 +324,8 @@ public void paintComponent(Graphics g)
                 AntialiasingManager.activateAntialiasing(g);
 
                 g.setColor(bgColor);
-                g.fillRoundRect(0, 0, this.getWidth(), this.getHeight(), 20, 20);
+                g.fillRoundRect(
+                    0, 0, this.getWidth(), this.getHeight(), 20, 20);
             }
             finally
             {

File: src/net/java/sip/communicator/impl/neomedia/AudioMediaStreamImpl.java
Patch:
@@ -10,7 +10,6 @@
 import javax.media.format.*;
 import javax.media.rtp.*;
 
-import net.java.sip.communicator.impl.neomedia.audiolevel.*;
 import net.java.sip.communicator.impl.neomedia.codec.*;
 import net.java.sip.communicator.impl.neomedia.device.*;
 import net.java.sip.communicator.service.neomedia.*;
@@ -225,6 +224,7 @@ public void stopSendingDTMF()
      * lifetime of this stream.
      * @param rtpExtension the RTPExtension that is being added to this stream.
      */
+    @Override
     public void addRTPExtension(byte extensionID, RTPExtension rtpExtension)
     {
         super.addRTPExtension(extensionID, rtpExtension);

File: src/net/java/sip/communicator/impl/neomedia/control/ReadOnlyBufferControlDelegate.java
Patch:
@@ -15,7 +15,7 @@
  * @author Lubomir Marinov
  */
 public class ReadOnlyBufferControlDelegate
-        implements BufferControl
+    implements BufferControl
 {
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/imgstreaming/DesktopInteractImpl.java
Patch:
@@ -155,4 +155,3 @@ public void mouseWheel(int wheelAmt)
         robot.mouseWheel(wheelAmt);
     }
 }
-

File: src/net/java/sip/communicator/impl/neomedia/notify/AudioNotifierServiceImpl.java
Patch:
@@ -113,7 +113,8 @@ else if(getDeviceConfiguration().getAudioSystem().equals(
      */
     public void destroyAudio(SCAudioClip audioClip)
     {
-        synchronized (audioClips) {
+        synchronized (audioClips)
+        {
             audioClips.remove(audioClip);
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -515,7 +515,7 @@ public void conferenceMemberRemoved(CallPeerConferenceEvent conferenceEvent) {}
     public boolean isConference()
     {
         // If we're the focus of the conference.
-        if (call.isConferenceFocus() && call.getCallPeerCount() > 1)
+        if (call.isConferenceFocus())
             return true;
 
         // If one of our peers is a conference focus, we're in a

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -16,8 +16,6 @@
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
-import net.java.sip.communicator.service.protocol.event.VideoEvent;
-import net.java.sip.communicator.service.protocol.event.VideoListener;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
 
@@ -343,7 +341,7 @@ public void soundLevelChanged(SoundLevelChangeEvent event)
                 remoteLevelIndicator.updateSoundLevel(event.getLevel());
             }
         });
-        
+
         this.callPeer.getCall().addLocalUserSoundLevelListener(
         new SoundLevelListener()
         {

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -26,11 +26,12 @@
  * @author Yana Stamcheva
  * @author Valentin Martinet
  */
-@SuppressWarnings("serial")
 public class ChatContactRightButtonMenu
     extends JPopupMenu
     implements  ActionListener
 {
+	private static final long serialVersionUID = -4069653895234333083L;
+
 	private Logger logger = Logger.getLogger(ChatContactRightButtonMenu.class);
 
     private final JMenuItem kickItem

File: src/net/java/sip/communicator/impl/neomedia/transform/zrtp/ZRTPTransformEngine.java
Patch:
@@ -564,8 +564,6 @@ public RawPacket transform(RawPacket pkt)
         /*
          * Never transform outgoing ZRTP (invalid RTP) packets.
          */        
-        byte[] buffer = pkt.getBuffer();
-        int offset = pkt.getOffset();
         if (ZrtpRawPacket.isZrtpData(pkt))
         {
             return pkt;
@@ -574,7 +572,7 @@ public RawPacket transform(RawPacket pkt)
         // ZRTP needs the SSRC of the sending stream.
         if (enableZrtp && ownSSRC == 0)
         {
-            ownSSRC = (int)(pkt.readUnsignedIntAsLong(8) & 0xffffffff);
+            ownSSRC = pkt.getSSRC();
         }
 
         // If SRTP is active then srtpTransformer is set, use it.

File: src/net/java/sip/communicator/impl/protocol/sip/CallSipImpl.java
Patch:
@@ -75,15 +75,15 @@ public class CallSipImpl
     /**
      * Holds listeners registered for level changes in local audio.
      */
-    private List<SoundLevelListener> localUserAudioLevelListeners
+    private final List<SoundLevelListener> localUserAudioLevelListeners
         = new ArrayList<SoundLevelListener>();
 
     /**
      * The listener that would actually subscribe for level events from the
      * media handler if there's at least one listener in
      * <tt>localUserAudioLevelListeners</tt>.
      */
-    private SimpleAudioLevelListener localAudioLevelDelegator
+    private final SimpleAudioLevelListener localAudioLevelDelegator
         = new SimpleAudioLevelListener()
         {
             public void audioLevelChanged(int level)

File: src/net/java/sip/communicator/service/protocol/CallPeerState.java
Patch:
@@ -158,7 +158,7 @@ public class CallPeerState
 
     /**
      * This constant value indicates that the state of the call peer is
-     * is DISCONNECTET - which means that this peer is not participating :)
+     * is DISCONNECTED - which means that this peer is not participating :)
      * in the call any more.
      */
     public static final CallPeerState DISCONNECTED    =

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -1828,7 +1828,7 @@ public void audioLevelsReceived(long[][] audioLevels)
         {
             for (int i = 0; i < conferenceMemberAudioLevelListeners.size(); i++)
             {
-                conferenceMemberAudioLevelListeners.get(0)
+                conferenceMemberAudioLevelListeners.get(i)
                     .soundLevelChanged(evt);
             }
         }

File: src/net/java/sip/communicator/impl/protocol/sip/SipActivator.java
Patch:
@@ -9,13 +9,14 @@
 import java.util.*;
 
 import org.osgi.framework.*;
+
 import net.java.sip.communicator.service.configuration.*;
 import net.java.sip.communicator.service.gui.*;
+import net.java.sip.communicator.service.neomedia.*;
 import net.java.sip.communicator.service.netaddr.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
-import net.java.sip.communicator.service.neomedia.*;
 import net.java.sip.communicator.service.version.*;
+import net.java.sip.communicator.util.*;
 
 /**
  * Activates the SIP package

File: src/net/java/sip/communicator/impl/neomedia/transform/csrc/CsrcTransformEngine.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.neomedia.transform.csrc;
 
-import javax.media.*;
-
 import net.java.sip.communicator.impl.neomedia.*;
 import net.java.sip.communicator.impl.neomedia.transform.*;
 import net.java.sip.communicator.service.neomedia.*;

File: src/net/java/sip/communicator/impl/browserlauncher/BrowserLauncherImpl.java
Patch:
@@ -16,7 +16,7 @@
  * an OS-specific associated browser.
  * 
  * @author Yana Stamcheva
- * @authro Lubomir Marinov
+ * @author Lubomir Marinov
  */
 public class BrowserLauncherImpl
     implements BrowserLauncherService

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -113,7 +113,7 @@ public class ChatConversationPanel
     private boolean scrollToBottomIsPending = false;
 
     /**
-     * The implementation of the routine which scrolls {@chatTextPane} to its
+     * The implementation of the routine which scrolls {@link #chatTextPane} to its
      * bottom.
      */
     private final Runnable scrollToBottomRunnable = new Runnable()

File: src/net/java/sip/communicator/impl/media/ArrayIOUtils.java
Patch:
@@ -54,7 +54,7 @@ public static short readShort(byte[] input, int inputOffset)
     /**
      * Converts a short integer to a series of bytes and writes the result into
      * a specific output array of bytes starting the writing at a specific
-     * offset in it. The difference with {@link #writeShort(short, byte[], int)
+     * offset in it. The difference with {@link #writeShort(short, byte[], int)}
      * is that the input is an <tt>int</tt> and just two bytes of it are
      * written.
      * 

File: src/net/java/sip/communicator/impl/media/codec/audio/speex/JavaDecoder.java
Patch:
@@ -59,8 +59,8 @@ public JavaDecoder()
 
     /**
      * Returns the output format that matches the supplied input format.
-     * @param in
-     * @return
+     * @param in input format
+     * @return array of formats that match input ones
      */
     protected Format[] getMatchingOutputFormats(Format in)
     {

File: src/net/java/sip/communicator/impl/media/codec/audio/speex/JavaEncoder.java
Patch:
@@ -71,8 +71,8 @@ public JavaEncoder()
 
     /**
      * Returns the output format that matches the supplied input format.
-     * @param in
-     * @return
+     * @param in input format
+     * @return array of formats that match input ones
      */
     protected Format[] getMatchingOutputFormats(Format in)
     {

File: src/net/java/sip/communicator/impl/neomedia/ArrayIOUtils.java
Patch:
@@ -54,7 +54,7 @@ public static short readShort(byte[] input, int inputOffset)
     /**
      * Converts a short integer to a series of bytes and writes the result into
      * a specific output array of bytes starting the writing at a specific
-     * offset in it. The difference with {@link #writeShort(short, byte[], int)
+     * offset in it. The difference with {@link #writeShort(short, byte[], int)}
      * is that the input is an <tt>int</tt> and just two bytes of it are
      * written.
      * 

File: src/net/java/sip/communicator/impl/neomedia/ZrtpControlImpl.java
Patch:
@@ -116,7 +116,7 @@ public void setSASVerification(boolean verified)
 
     /**
      * Returns the zrtp engine currently used by this stream.
-     * @return
+     * @return the zrtp engine
      */
     public ZRTPTransformEngine getZrtpEngine()
     {

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/speex/JavaDecoder.java
Patch:
@@ -59,8 +59,8 @@ public JavaDecoder()
 
     /**
      * Returns the output format that matches the supplied input format.
-     * @param in
-     * @return
+     * @param in input format
+     * @return array of format that match input ones
      */
     protected Format[] getMatchingOutputFormats(Format in)
     {

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/speex/JavaEncoder.java
Patch:
@@ -71,8 +71,8 @@ public JavaEncoder()
 
     /**
      * Returns the output format that matches the supplied input format.
-     * @param in
-     * @return
+     * @param in input format
+     * @return array of formats that match input ones
      */
     protected Format[] getMatchingOutputFormats(Format in)
     {

File: src/net/java/sip/communicator/impl/neomedia/conference/InputDataSourceDesc.java
Patch:
@@ -64,7 +64,7 @@ class InputDataSourceDesc
 
     /**
      * The <tt>AudioMixingPushBufferDataSource</tt> in which the mix
-     * contributions of {@link inputDataSource} are to not be included.
+     * contributions of {@link #inputDataSource} are to not be included.
      */
     public final AudioMixingPushBufferDataSource outputDataSource;
 

File: src/net/java/sip/communicator/impl/neomedia/control/AbstractFormatControl.java
Patch:
@@ -27,7 +27,7 @@ public abstract class AbstractFormatControl
     private boolean enabled;
 
     /**
-     * Implements {@link Controls#getControlComponent()}. Returns <tt>null</tt>.
+     * Implements {@link Control#getControlComponent()}. Returns <tt>null</tt>.
      *
      * @return a <tt>Component</tt> which represents UI associated with this
      * instance if any; otherwise, <tt>null</tt>

File: src/net/java/sip/communicator/impl/neomedia/control/ControlsAdapter.java
Patch:
@@ -23,9 +23,9 @@ public class ControlsAdapter
     public static final Object[] EMPTY_CONTROLS = new Object[0];
 
     /**
-     * Implements {@link Controls#getControls()}. Gets the controls available
-     * for the owner of this instance. The current implementation returns an
-     * empty array because it has no available controls.
+     * Implements {@link javax.media.Controls#getControls()}. Gets the controls
+     * available for the owner of this instance. The current implementation
+     * returns an empty array because it has no available controls.
      *
      * @return an array of <tt>Object</tt>s which represent the controls
      * available for the owner of this instance

File: src/net/java/sip/communicator/impl/neomedia/control/ReadOnlyBufferControlDelegate.java
Patch:
@@ -49,7 +49,7 @@ public long getBufferLength()
     }
 
     /**
-     * Implements {@link Control#getControlComponent()}. Gets the UI
+     * Implements {@link javax.media.Control#getControlComponent()}. Gets the UI
      * <tt>Component</tt> representing this instance and exported by the owner
      * of the wrapped <tt>BufferControl</tt>.
      *

File: src/net/java/sip/communicator/impl/neomedia/control/ReadOnlyFormatControlDelegate.java
Patch:
@@ -40,7 +40,7 @@ public ReadOnlyFormatControlDelegate(FormatControl formatControl)
     }
 
     /**
-     * Implements {@link Controls#getControlComponent()}.
+     * Implements {@link Control#getControlComponent()}.
      *
      * @return a <tt>Component</tt> which represents UI associated with this
      * instance if any; otherwise, <tt>null</tt>

File: src/net/java/sip/communicator/impl/neomedia/device/AudioMediaDeviceSession.java
Patch:
@@ -56,7 +56,8 @@ protected AudioMediaDeviceSession(AbstractMediaDevice device)
     }
 
     /**
-     * Called by {@link MediaDeviceSession#addReceiveStream(ReceiveStream)} when the player associated with this session's
+     * Called by {@link MediaDeviceSession#createPlayer(DataSource dataSource)} 
+     * when the player associated with this session's
      * <tt>ReceiveStream</tt> moves enters the <tt>Configured</tt> state, so
      * we use the occasion to add our audio level effect.
      *

File: src/net/java/sip/communicator/impl/neomedia/device/ReceiveStreamPushBufferDataSource.java
Patch:
@@ -17,7 +17,7 @@
  * is introduced because it seems that after the <tt>DataSource</tt> of a
  * <tt>ReceiveStream</tt> is disconnected, it cannot be connected to or started
  * and if a <tt>Processor</tt> is created on it, it freezes in the
- * {@link Processor#Configuring} state.
+ * {@link javax.media.Processor#Configuring} state.
  *
  * @author Lubomir Marinov
  */

File: src/net/java/sip/communicator/impl/neomedia/format/VideoMediaFormatImpl.java
Patch:
@@ -188,7 +188,7 @@ public Dimension getSize()
      * Overrides <tt>MediaFormatImpl#hashCode()</tt> because
      * <tt>Object#equals(Object)</tt> is overridden.
      *
-     * @returns a hash code value for this <tt>VideoMediaFormatImpl</tt>
+     * @return a hash code value for this <tt>VideoMediaFormatImpl</tt>
      * @see MediaFormatImpl#hashCode()
      */
     @Override

File: src/net/java/sip/communicator/impl/neomedia/transform/zrtp/ZRTPTransformEngine.java
Patch:
@@ -948,7 +948,7 @@ public void signSAS(String sas)
     /**
      * 
      * @param sas
-     * @return 
+     * @return false if signature check fails, true otherwise
      * @see gnu.java.zrtp.ZrtpCallback#checkSASSignature(java.lang.String)
      */
     public boolean checkSASSignature(String sas)

File: src/net/java/sip/communicator/plugin/zrtpconfigure/ZrtpConfigureTableModel.java
Patch:
@@ -132,7 +132,7 @@ public void setValueAt(Object value, int row, int column)
      *        Because the functions converts a move up into a move down
      *        this flag shows what the caller intented. Needed to adjust
      *        an index return value.
-     * @return
+     * @return new row index of entry
      */
     public int move(int row, boolean up, boolean upSave) {
         if (up) {

File: src/net/java/sip/communicator/impl/neomedia/audiolevel/AudioLevelMap.java
Patch:
@@ -182,8 +182,8 @@ private long[][] appendCSRCToMatrix(long[][] levels, long csrc, int level)
         long[][] newLevels = new long[newLength][2];
 
         //put the new level.
-        levels[0][0] = csrc;
-        levels[0][1] = level;
+        newLevels[0][0] = csrc;
+        newLevels[0][1] = level;
 
         if( newLength == 1)
             return newLevels;

File: src/net/java/sip/communicator/impl/media/protocol/portaudio/PortAudio.java
Patch:
@@ -104,7 +104,7 @@ public final class PortAudio
      * Used when creating new stream parameters for suggested latency.
      * To use default value.
      */
-    public static final double LATENCY_UNSEPCIFIED = 0d;
+    public static final double LATENCY_UNSPECIFIED = 0d;
 
     /**
      * Used when creating new stream parameters for suggested latency.
@@ -457,7 +457,7 @@ public static native boolean Pa_IsFormatSupported(
      * @param channelCount the channels to be used.
      * @param sampleFormat the sample format.
      * @param suggestedLatency the suggested latency in milliseconds:
-     *          LATENCY_UNSEPCIFIED -
+     *          LATENCY_UNSPECIFIED -
      *              use default(default high input/output latency)
      *          LATENCY_HIGH - use default high input/output latency
      *          LATENCY_LOW - use default low input/output latency

File: src/net/java/sip/communicator/impl/media/protocol/portaudio/PortAudioManager.java
Patch:
@@ -43,7 +43,7 @@ public class PortAudioManager
     private int frameSize = NUM_SAMPLES;
     private int filterLength = 2048;
 
-    private static double suggestedLatency = PortAudio.LATENCY_UNSEPCIFIED;
+    private static double suggestedLatency = PortAudio.LATENCY_UNSPECIFIED;
 
     /**
      * Private constructor as we have one static instance of this manager.
@@ -205,15 +205,15 @@ public void setDeNoise(boolean enabled)
      */
     public static double getSuggestedLatency()
     {
-        if(suggestedLatency != PortAudio.LATENCY_UNSEPCIFIED)
+        if(suggestedLatency != PortAudio.LATENCY_UNSPECIFIED)
             return suggestedLatency;
 
         if (OSUtils.IS_MAC || OSUtils.IS_LINUX)
             return PortAudio.LATENCY_HIGH;
         else if (OSUtils.IS_WINDOWS)
             return 0.1d;
         else
-            return PortAudio.LATENCY_UNSEPCIFIED;
+            return PortAudio.LATENCY_UNSPECIFIED;
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/portaudio/PortAudio.java
Patch:
@@ -104,7 +104,7 @@ public final class PortAudio
      * Used when creating new stream parameters for suggested latency.
      * To use default value.
      */
-    public static final double LATENCY_UNSEPCIFIED = 0d;
+    public static final double LATENCY_UNSPECIFIED = 0d;
 
     /**
      * Used when creating new stream parameters for suggested latency.
@@ -457,7 +457,7 @@ public static native boolean Pa_IsFormatSupported(
      * @param channelCount the channels to be used.
      * @param sampleFormat the sample format.
      * @param suggestedLatency the suggested latency in milliseconds:
-     *          LATENCY_UNSEPCIFIED -
+     *          LATENCY_UNSPECIFIED -
      *              use default(default high input/output latency)
      *          LATENCY_HIGH - use default high input/output latency
      *          LATENCY_LOW - use default low input/output latency

File: src/net/java/sip/communicator/impl/neomedia/portaudio/PortAudioManager.java
Patch:
@@ -43,7 +43,7 @@ public class PortAudioManager
     private int frameSize = NUM_SAMPLES;
     private int filterLength = 2048;
 
-    private static double suggestedLatency = PortAudio.LATENCY_UNSEPCIFIED;
+    private static double suggestedLatency = PortAudio.LATENCY_UNSPECIFIED;
 
     /**
      * Private constructor as we have one static instance of this manager.
@@ -205,15 +205,15 @@ public void setDeNoise(boolean enabled)
      */
     public static double getSuggestedLatency()
     {
-        if(suggestedLatency != PortAudio.LATENCY_UNSEPCIFIED)
+        if(suggestedLatency != PortAudio.LATENCY_UNSPECIFIED)
             return suggestedLatency;
 
         if (OSUtils.IS_MAC || OSUtils.IS_LINUX)
             return PortAudio.LATENCY_HIGH;
         else if (OSUtils.IS_WINDOWS)
             return 0.1d;
         else
-            return PortAudio.LATENCY_UNSEPCIFIED;
+            return PortAudio.LATENCY_UNSPECIFIED;
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/protocol/MutePullBufferDataSource.java
Patch:
@@ -144,5 +144,5 @@ public Format getFormat()
         {
             return stream.getFormat();
         }
-        }
     }
+}

File: src/net/java/sip/communicator/impl/neomedia/audiolevel/AudioLevelCalculator.java
Patch:
@@ -46,7 +46,6 @@ private static int calculateLevelRatio(int minLevel, int maxLevel)
     {
         // magic ratio which scales good visually our levels
         return MAX_AUDIO_LEVEL/(maxLevel - minLevel)/16;
-
     }
 
     /**
@@ -81,7 +80,9 @@ public static int calculateCurrentSignalPower(
             if (soundLevel > MAX_AUDIO_LEVEL)
             {
                 soundLevel = MAX_AUDIO_LEVEL;
-            } else if (soundLevel < MIN_AUDIO_LEVEL) {
+            }
+            else if (soundLevel < MIN_AUDIO_LEVEL)
+            {
                 soundLevel = MIN_AUDIO_LEVEL;
             }
 

File: src/net/java/sip/communicator/impl/neomedia/protocol/TranscodingDataSource.java
Patch:
@@ -92,7 +92,7 @@ public synchronized void connect()
          * Manager#createProcessor(DataSource) requires the specified DataSource
          * to be connected.
          */
-//        inputDataSource.connect();
+        inputDataSource.connect();
 
         Processor processor;
 

File: src/net/java/sip/communicator/impl/neomedia/control/ReadOnlyFormatControlDelegate.java
Patch:
@@ -91,7 +91,7 @@ public boolean isEnabled()
      */
     public void setEnabled(boolean enabled)
     {
-        formatControl.setEnabled(enabled);
+        // Ignore the request because this instance is read-only.
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactRightButtonMenu.java
Patch:
@@ -223,7 +223,7 @@ private void init()
         this.addSeparator();
 
         OperationSetPersistentPresence opSet
-            = (OperationSetPersistentPresence) room.getParentProvider()
+            = room.getParentProvider()
                 .getOperationSet(OperationSetPersistentPresence.class);
 
         Contact c = opSet.findContactByID(room.getUserNickname());

File: src/net/java/sip/communicator/service/protocol/ChatRoom.java
Patch:
@@ -494,7 +494,7 @@ public ChatRoomConfigurationForm getConfigurationForm()
     * membership. A user that becomes a room member will be able to enter a room
     * of type Members-Only (i.e. a room that a user cannot enter without being
     * on the member list). If the user is in the room and the room is of type
-    * members-only then the user will be removed from the room. ��
+    * members-only then the user will be removed from the room.
     *
     * @param address the user address of the user to revoke membership
     * (e.g. "user@host.org").
@@ -517,7 +517,7 @@ public ChatRoomConfigurationForm getConfigurationForm()
     * Revokes ownership privileges from another user. The occupant that loses
     * ownership privileges will become an administrator. Room owners may revoke
     * ownership privileges. Some room implementations will not allow to grant
-    * ownership privileges to other users. �
+    * ownership privileges to other users.
     *
     * @param address the user address of the user to revoke ownership
     * (e.g. "user@host.org").

File: src/net/java/sip/communicator/impl/neomedia/protocol/CaptureDeviceDelegatePullBufferDataSource.java
Patch:
@@ -211,7 +211,6 @@ public Time getDuration()
      * <tt>CaptureDevice</tt> if available; otherwise, an empty array with
      * <tt>FormatControl</tt> element type
      */
-    @Override
     public FormatControl[] getFormatControls()
     {
         return

File: src/net/java/sip/communicator/impl/neomedia/MediaStreamImpl.java
Patch:
@@ -201,7 +201,7 @@ public MediaStreamImpl(StreamConnector connector, MediaDevice device)
      * <tt>MediaStream</tt> with the specified <tt>MediaFormat</tt>
      * @param format the <tt>MediaFormat</tt> to be associated in this
      * <tt>MediaStream</tt> with <tt>rtpPayloadType</tt>
-     * @see MediaStream#addDynamicRTPPayloadType(int, MediaFormat)
+     * @see MediaStream#addDynamicRTPPayloadType(byte, MediaFormat)
      */
     public void addDynamicRTPPayloadType(
             byte rtpPayloadType,
@@ -258,7 +258,7 @@ private void closeSendStreams()
 
     /**
      * Creates new <tt>SendStream</tt> instances for the streams of
-     * {@link #device} through {@link #rtpManager}.
+     * {@link #deviceSession} through {@link #rtpManager}.
      */
     private void createSendStreams()
     {
@@ -520,7 +520,7 @@ public MediaDirection getDirection()
      * Gets the existing associations in this <tt>MediaStream</tt> of RTP
      * payload types to <tt>MediaFormat</tt>s. The returned <tt>Map</tt>
      * only contains associations previously added in this instance with
-     * {@link #addDynamicRTPPayloadType(int, MediaFormat)} and not globally or
+     * {@link #addDynamicRTPPayloadType(byte, MediaFormat)} and not globally or
      * well-known associations reported by
      * {@link MediaFormat#getRTPPayloadType()}.
      *

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerMediaHandler.java
Patch:
@@ -526,7 +526,9 @@ private Vector<MediaDescription> createMediaDescriptions()
 
                 if(direction != MediaDirection.INACTIVE)
                     mediaDescs.add(createMediaDescription(
-                        dev, getStreamConnector(mediaType), direction));
+                        dev.getSupportedFormats(),
+                        getStreamConnector(mediaType),
+                        direction));
             }
         }
 

File: src/net/java/sip/communicator/service/neomedia/MediaStream.java
Patch:
@@ -181,7 +181,7 @@ public void addDynamicRTPPayloadType(
      * Gets the existing associations in this <tt>MediaStream</tt> of RTP
      * payload types to <tt>MediaFormat</tt>s. The returned <tt>Map</tt>
      * only contains associations previously added in this instance with
-     * {@link #addDynamicRTPPayloadType(int, MediaFormat)} and not globally or
+     * {@link #addDynamicRTPPayloadType(byte, MediaFormat)} and not globally or
      * well-known associations reported by
      * {@link MediaFormat#getRTPPayloadType()}.
      *

File: src/net/java/sip/communicator/service/neomedia/event/SoundLevelChangeEvent.java
Patch:
@@ -52,8 +52,9 @@ public class SoundLevelChangeEvent
      * Creates a new instance of a <tt>SoundLevelChangeEvent</tt> for the
      * specified source stream and level mappings.
      *
-     * @param source
-     * @param levels
+     * @param source the MediaStream that we are listening to and that generated
+     * this event.
+     * @param levels the <tt>Map</tt> containing SSRC to level bindings.
      */
     public SoundLevelChangeEvent(MediaStream source,
                                  Map<Long, Integer> levels)

File: src/net/java/sip/communicator/impl/neomedia/device/AudioMixerMediaDevice.java
Patch:
@@ -108,7 +108,7 @@ public synchronized MediaDeviceSession createSession()
      * @return the <tt>AudioMixer</tt> which performs audio mixing in this
      * <tt>MediaDevice</tt> (and rather the session it represents)
      */
-    private AudioMixer getAudioMixer()
+    private synchronized AudioMixer getAudioMixer()
     {
         if (audioMixer == null)
             audioMixer = new AudioMixer(device.createCaptureDevice())

File: src/net/java/sip/communicator/impl/neomedia/device/MediaDeviceImpl.java
Patch:
@@ -124,7 +124,7 @@ CaptureDevice createCaptureDevice()
                 logger
                     .error(
                         "Failed to create CaptureDevice"
-                            + "from CaptureDeviceInfo "
+                            + " from CaptureDeviceInfo "
                             + captureDeviceInfo,
                         exception);
             else

File: src/net/java/sip/communicator/impl/neomedia/device/MediaDeviceSession.java
Patch:
@@ -210,7 +210,7 @@ public void addReceiveStream(ReceiveStream receiveStream)
      * @param receiveStreamDataSource the <tt>DataSource</tt> to be used for
      * accessing the media data of <tt>receiveStream</tt> during its playback
      */
-    protected void addReceiveStream(
+    protected synchronized void addReceiveStream(
             ReceiveStream receiveStream,
             DataSource receiveStreamDataSource)
     {
@@ -599,7 +599,7 @@ private static Format findFirstMatchingFormat(
      * @return the <tt>DataSource</tt> that this instance uses to read captured
      * media from
      */
-    protected DataSource getCaptureDevice()
+    protected synchronized DataSource getCaptureDevice()
     {
         if (captureDevice == null)
             captureDevice = createCaptureDevice();
@@ -1028,7 +1028,7 @@ protected void realizeComplete(Processor player)
      * <tt>MediaDeviceSession</tt> and playback on the associated
      * <tt>MediaDevice</tt>
      */
-    public void removeReceiveStream(ReceiveStream receiveStream)
+    public synchronized void removeReceiveStream(ReceiveStream receiveStream)
     {
         DataSource receiveStreamDataSource
             = receiveStreams.remove(receiveStream);

File: src/net/java/sip/communicator/impl/neomedia/device/AudioMixerMediaDevice.java
Patch:
@@ -109,7 +109,7 @@ public synchronized MediaDeviceSession createSession()
     private AudioMixer getAudioMixer()
     {
         if (audioMixer == null)
-            audioMixer = new AudioMixer(device.getCaptureDevice())
+            audioMixer = new AudioMixer(device.createCaptureDevice())
             {
                 @Override
                 protected void readCaptureDeviceStream(

File: src/net/java/sip/communicator/impl/neomedia/RTPConnectorOutputStream.java
Patch:
@@ -65,7 +65,7 @@ public void addTarget(InetAddress remoteAddr, int remotePort)
      * specified <tt>byte[]</tt> buffer or possibly its modification;
      * <tt>null</tt> to ignore the packet data of the specified <tt>byte[]</tt>
      * buffer and not send it to the targets of this instance through its
-     * {@link #write(byte[], int, int)} method 
+     * {@link #write(byte[], int, int)} method
      */
     protected RawPacket createRawPacket(byte[] buffer, int offset, int length)
     {

File: src/net/java/sip/communicator/impl/neomedia/device/MediaDeviceSession.java
Patch:
@@ -909,7 +909,7 @@ private void processorControllerUpdate(ControllerEvent event)
                 if (format != null)
                     setFormat(processor, format);
 
-                if (true
+                if (false
                         && (NeomediaActivator
                                     .getMediaServiceImpl()
                                         .getLocalSoundLevelListeners().size()

File: src/net/java/sip/communicator/impl/neomedia/conference/AudioMixer.java
Patch:
@@ -1025,7 +1025,7 @@ class AudioMixerPushBufferStream
          * reads from an input streams exceeds this limit, they get reported and
          * the counting is restarted.
          */
-        private static final long TRACE_NON_CONTRIBUTING_READ_COUNT = 1000;
+        private static final long TRACE_NON_CONTRIBUTING_READ_COUNT = 0;
 
         /**
          * The <tt>SourceStream</tt>s (in the form of

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/SoundLevelIndicatorEffect.java
Patch:
@@ -159,7 +159,6 @@ public int process(Buffer inputBuffer, Buffer outputBuffer)
     public static int calculateCurrentSignalPower(
         byte[] buff, int offset, int len, double levelRatio)
     {
-System.out.println("time="+ System.currentTimeMillis());
         if(len == 0)
             return 0;
 

File: src/net/java/sip/communicator/impl/neomedia/codec/audio/SoundLevelIndicatorEffect.java
Patch:
@@ -77,7 +77,7 @@ public Format[] getSupportedInputFormats()
 
     /**
      * Lists the output formats that this codec can generate.
-     * @param input The <code>Format</code> of the data to be used 
+     * @param input The <code>Format</code> of the data to be used
      *        as input to the plug-in.
      * @return An array that contains the supported output <code>Formats</code>.
      */
@@ -149,7 +149,7 @@ public int process(Buffer inputBuffer, Buffer outputBuffer)
 
     /**
      * Estimates the signal power and use the levelRatio to
-     * scale it to the needed levels. 
+     * scale it to the needed levels.
      * @param buff the buffer with the data.
      * @param offset the offset that data starts.
      * @param len the length of the data
@@ -159,6 +159,7 @@ public int process(Buffer inputBuffer, Buffer outputBuffer)
     public static int calculateCurrentSignalPower(
         byte[] buff, int offset, int len, double levelRatio)
     {
+System.out.println("time="+ System.currentTimeMillis());
         if(len == 0)
             return 0;
 

File: src/net/java/sip/communicator/impl/protocol/sip/security/SipSecurityManager.java
Patch:
@@ -106,7 +106,7 @@ public void setHeaderFactory(HeaderFactory headerFactory)
      * @throws OperationFailedException if we fail to acquire a password from
      * our security authority.
      */
-    public synchronized ClientTransaction handleChallenge(
+    public ClientTransaction handleChallenge(
                                     Response          challenge,
                                     ClientTransaction challengedTransaction,
                                     SipProvider       transactionCreator)
@@ -115,6 +115,7 @@ public synchronized ClientTransaction handleChallenge(
                OperationFailedException,
                NullPointerException
     {
+
         String branchID = challengedTransaction.getBranchId();
         Request challengedRequest = challengedTransaction.getRequest();
         Request reoriginatedRequest = cloneReqForAuthentication(
@@ -160,7 +161,6 @@ public synchronized ClientTransaction handleChallenge(
                     //obtain new credentials
                     logger.trace("We don't seem to have a good pass! Get one.");
 
-System.err.println("!!!???!!! - asking for authentication because we don't have a password at all.");
                     ccEntry = createCcEntryWithNewCredentials(
                         realm, SecurityAuthority.AUTHENTICATION_REQUIRED);
 
@@ -185,7 +185,6 @@ public synchronized ClientTransaction handleChallenge(
                     SipActivator.getProtocolProviderFactory().storePassword(
                         accountID, null);
 
-System.err.println("!!!???!!! - asking for authentication because passwd was wrong");
                     ccEntry = createCcEntryWithNewCredentials(
                         realm, SecurityAuthority.WRONG_PASSWORD);
 

File: src/net/java/sip/communicator/impl/neomedia/ProcessorUtility.java
Patch:
@@ -17,7 +17,8 @@
  * @author Ken Larson
  * @author Lubomir Marinov
  */
-public class ProcessorUtility implements ControllerListener
+public class ProcessorUtility
+    implements ControllerListener
 {
 
     /**
@@ -126,7 +127,7 @@ else if (state == Processor.Realized)
         // Wait until we get an event that confirms the
         // success of the method, or a failure event.
         // See StateListener inner class
-        while ((processor.getState() < state) &&!failed)
+        while ((processor.getState() < state) && !failed)
         {
             Object stateLock = getStateLock();
 

File: src/net/java/sip/communicator/impl/media/transform/srtp/SRTPCryptoContext.java
Patch:
@@ -206,6 +206,7 @@ public SRTPCryptoContext(long ssrcIn)
      *            SRTP policy for this SRTP cryptographic context, defined the
      *            encryption algorithm, the authentication algorithm, etc
      */
+    @SuppressWarnings("fallthrough")
     public SRTPCryptoContext(long ssrcIn, int rocIn, long kdr,
             byte[] masterK, byte[] masterS, SRTPPolicy policyIn)
     {

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackSharing.java
Patch:
@@ -965,8 +965,9 @@ private void logApplicationException(
             = "An error occurred while processing event of type: "
                 + eventClass.getName();
 
-        logger.error(message);
-        logger.debug(message, exc);
+        logger.error(message, exc);
+        if (logger.isDebugEnabled())
+            logger.debug(message, exc);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/CallSipImpl.java
Patch:
@@ -270,6 +270,7 @@ public CallPeerSipImpl findCallPeer(Dialog dialog)
      * @return a reference to the <tt>ProtocolProviderServiceSipImpl</tt>
      * instance that created this call.
      */
+    @Override
     public ProtocolProviderServiceSipImpl getProtocolProvider()
     {
         return (ProtocolProviderServiceSipImpl)super.getProtocolProvider();

File: src/net/java/sip/communicator/impl/protocol/sip/sdp/SdpUtils.java
Patch:
@@ -67,6 +67,7 @@ public static SessionDescription parseSdpString(String sdp)
                 "Failed to parse the SDP description of the peer.", ex);
         }
     }
+
     /**
      * Creates an empty instance of a <tt>SessionDescription</tt> with
      * preinitialized  <tt>s</tt>, <tt>v</tt>, <tt>c</tt>, <tt>o</tt> and

File: src/net/java/sip/communicator/impl/neomedia/format/MediaFormatImpl.java
Patch:
@@ -227,7 +227,7 @@ public boolean equals(Object mediaFormat)
         @SuppressWarnings("unchecked")
         MediaFormatImpl<T> mediaFormatImpl = (MediaFormatImpl<T>) mediaFormat;
 
-        return format.equals(mediaFormatImpl.format)
+        return getFormat().equals(mediaFormatImpl.getFormat())
                 && formatParametersAreEqual(
                         getFormatParameters(),
                         mediaFormatImpl.getFormatParameters());
@@ -324,7 +324,7 @@ public byte getRTPPayloadType()
     @Override
     public int hashCode()
     {
-        return (super.hashCode() | getFormatParameters().hashCode());
+        return (getFormat().hashCode() | getFormatParameters().hashCode());
     }
 
     /**

File: src/net/java/sip/communicator/service/neomedia/MediaType.java
Patch:
@@ -47,6 +47,7 @@ private MediaType(String mediaTypeName)
      *
      * @return the name of this MediaType (e.g. "audio" or "video").
      */
+    @Override
     public String toString()
     {
         return mediaTypeName;

File: src/net/java/sip/communicator/impl/netaddr/NetworkAddressManagerServiceImpl.java
Patch:
@@ -781,7 +781,7 @@ public DatagramSocket createDatagramSocket(InetAddress laddr,
                             + ") and maxPort (" + maxPort + ")");
         }
 
-        ConfigurationService config = NeomediaActivator
+        ConfigurationService config = NetaddrActivator
                         .getConfigurationService();
 
         int bindRetries = config.getInt(BIND_RETRIES_PROPERTY_NAME,

File: src/net/java/sip/communicator/impl/protocol/sip/sdp/SdpUtils.java
Patch:
@@ -106,7 +106,7 @@ private static MediaDescription createMediaDescription(
 
             // is this a dynamic payload type.
             if (payloadType == MediaFormat.RTP_PAYLOAD_TYPE_UNKNOWN)
-            {
+            {/*
                 Integer dynamicPT = dynamicPayloadTypes.get(format);
                 if (dynamicPT == null)
                 {
@@ -117,7 +117,7 @@ private static MediaDescription createMediaDescription(
                 {
                     // we have already registered this format for this session.
                     payloadType = dynamicPT.intValue();
-                }
+                }*/
             }
 
             // a=rtpmap:

File: src/net/java/sip/communicator/impl/neomedia/format/MediaFormatImpl.java
Patch:
@@ -145,9 +145,9 @@ static boolean formatParametersAreEqual(
                  * Since the values are strings, allow null to be equal to the
                  * empty string.
                  */
-                if ((value1 == null) || value1.isEmpty())
+                if ((value1 == null) || (value1.length() == 0))
                 {
-                    if ((value2 != null) && !value2.isEmpty())
+                    if ((value2 != null) && (value2.length() != 0))
                         return false;
                 }
                 else if (!value1.equals(value2))

File: src/net/java/sip/communicator/impl/neomedia/MediaServiceImpl.java
Patch:
@@ -274,8 +274,6 @@ public List<MediaDevice> getDevices(MediaType mediaType)
                     switch (mediaType)
                     {
                     case AUDIO:
-                        device = new AudioMediaDeviceImpl(captureDeviceInfo);
-                        break;
                     case VIDEO:
                         device = new MediaDeviceImpl(captureDeviceInfo, mediaType);
                         break;
@@ -363,7 +361,7 @@ public MediaFormatFactory getFormatFactory()
     private MediaDevice getNonSendAudioDevice()
     {
         if (nonSendAudioDevice == null)
-            nonSendAudioDevice = new AudioMediaDeviceImpl();
+            nonSendAudioDevice = new MediaDeviceImpl(MediaType.AUDIO);
         return nonSendAudioDevice;
     }
 
@@ -392,6 +390,7 @@ void start()
         deviceConfiguration.initialize();
         encodingConfiguration.initializeFormatPreferences();
         encodingConfiguration.registerCustomPackages();
+        encodingConfiguration.registerCustomCodecs();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListCellRenderer.java
Patch:
@@ -117,10 +117,8 @@ public ContactListCellRenderer()
 
         this.nameLabel.setPreferredSize(new Dimension(10, 17));
 
-        this.rightLabel.setPreferredSize(
-            new Dimension(AVATAR_WIDTH, AVATAR_HEIGHT));
         this.rightLabel.setFont(rightLabel.getFont().deriveFont(9f));
-        this.rightLabel.setHorizontalAlignment(JLabel.CENTER);
+        this.rightLabel.setHorizontalAlignment(JLabel.RIGHT);
 
         this.add(nameLabel, BorderLayout.CENTER);
         this.add(rightLabel, BorderLayout.EAST);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -234,9 +234,8 @@ public void componentResized(ComponentEvent e)
                     scrollToBottomIsPending = false;
 
                     /*
-                     * Yana Stamcheva, being the excellent professional that she
-                     * is, pointed out that Java 5 (on Linux only?) needs
-                     * invokeLater for JScrollBar.
+                     * Yana Stamcheva, pointed out that Java 5 (on Linux only?)
+                     * needs invokeLater for JScrollBar.
                      */
                     SwingUtilities.invokeLater(scrollToBottomRunnable);
                 }

File: src/net/java/sip/communicator/impl/neomedia/MediaUtils.java
Patch:
@@ -41,7 +41,7 @@ public class MediaUtils
 
     /**
      * The <tt>MediaFormat</tt>s which do not have RTP payload types assigned by
-     * RFC 3551 and are thus refered to as having dynamic RTP payload types.
+     * RFC 3551 and are thus referred to as having dynamic RTP payload types.
      */
     private static final List<MediaFormat> rtpPayloadTypelessMediaFormats
         = new ArrayList<MediaFormat>();

File: src/net/java/sip/communicator/impl/neomedia/device/MediaDeviceSession.java
Patch:
@@ -785,7 +785,7 @@ public void setFormat(MediaFormat format)
     public void start(MediaDirection direction)
     {
         if (direction == null)
-            throw new IllegalArgumentException("direction");
+            throw new NullPointerException("direction");
 
         if (MediaDirection.SENDRECV.equals(direction)
                 || MediaDirection.SENDONLY.equals(direction))
@@ -810,7 +810,7 @@ public void start(MediaDirection direction)
     public void stop(MediaDirection direction)
     {
         if (direction == null)
-            throw new IllegalArgumentException("direction");
+            throw new NullPointerException("direction");
 
         if (MediaDirection.SENDRECV.equals(direction)
                 || MediaDirection.SENDONLY.equals(direction))

File: src/net/java/sip/communicator/service/neomedia/MediaService.java
Patch:
@@ -52,7 +52,7 @@ public interface MediaService
      * @param connector the connector that the stream should use for sending and
      * receiving media.
      * @param device the device to be used for both capture and playback of
-     * media changed via the specified <tt>StreamConnector</tt>
+     * media exchanged via the specified <tt>StreamConnector</tt>
      *
      * @return the newly created <tt>MediaStream</tt>.
      */

File: src/net/java/sip/communicator/service/neomedia/format/MediaFormatFactory.java
Patch:
@@ -95,7 +95,7 @@ public MediaFormat createMediaFormat(
      * <tt>MediaFormat</tt> for
      * @param clockRate the clock rate in Hz to create a <tt>MediaFormat</tt>
      * for
-     * @param channels the number of availabe channels (1 for mono, 2 for
+     * @param channels the number of available channels (1 for mono, 2 for
      * stereo) if it makes sense for the <tt>MediaFormat</tt> with the specified
      * <tt>encoding</tt>; otherwise, ignored
      * @return a <tt>MediaFormat</tt> with the specified <tt>encoding</tt>,
@@ -144,7 +144,7 @@ public MediaFormat createMediaFormat(
      * <tt>MediaFormat</tt> for
      * @param clockRate the clock rate in Hz to create a <tt>MediaFormat</tt>
      * for
-     * @param channels the number of availabe channels (1 for mono, 2 for
+     * @param channels the number of available channels (1 for mono, 2 for
      * stereo) if it makes sense for the <tt>MediaFormat</tt> with the specified
      * <tt>encoding</tt>; otherwise, ignored
      * @param formatParams any codec specific parameters which have been
@@ -181,7 +181,7 @@ public MediaFormat createMediaFormat(
      * <tt>MediaFormat</tt> for; <tt>null</tt>
      * @param clockRate the clock rate in Hz to create a <tt>MediaFormat</tt>
      * for
-     * @param channels the number of availabe channels (1 for mono, 2 for
+     * @param channels the number of available channels (1 for mono, 2 for
      * stereo) if it makes sense for the <tt>MediaFormat</tt> with the specified
      * <tt>encoding</tt>; otherwise, ignored
      * @param formatParams any codec specific parameters which have been

File: src/net/java/sip/communicator/impl/neomedia/codec/EncodingConfiguration.java
Patch:
@@ -29,7 +29,7 @@ public class EncodingConfiguration
     private final Logger logger = Logger.getLogger(EncodingConfiguration.class);
 
     private static final String PROP_SDP_PREFERENCE
-        = "net.java.sip.communicator.impl.media.sdppref";
+        = "net.java.sip.communicator.impl.neomedia.codec.EncodingConfiguration";
 
     private final Set<MediaFormat> supportedVideoEncodings =
         new TreeSet<MediaFormat>(new EncodingComparator());

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -70,6 +70,9 @@ public CallDialog(Call call)
     {
         this.call = call;
 
+        this.callDurationTimer = new Timer(1000, new CallTimerListener());
+        this.callDurationTimer.setRepeats(true);
+
         // The call duration parameter is not known yet.
         this.setCallTitle(null);
 
@@ -151,9 +154,6 @@ public CallDialog(Call call)
 
         buttonsPanel.setBorder(
             new ExtendedEtchedBorder(EtchedBorder.LOWERED, 1, 0, 0, 0));
-
-        this.callDurationTimer = new Timer(1000, new CallTimerListener());
-        this.callDurationTimer.setRepeats(true);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -393,7 +393,8 @@ public CreateConferenceCallThread(
         public void run()
         {
             OperationSetTelephonyConferencing confOpSet
-            = protocolProvider.getOperationSet(OperationSetTelephonyConferencing.class);
+                = protocolProvider.getOperationSet(
+                    OperationSetTelephonyConferencing.class);
 
             /*
              * XXX If we are here and we just discover that

File: src/net/java/sip/communicator/impl/gui/main/call/conference/BasicConferenceParticipantPanel.java
Patch:
@@ -134,7 +134,7 @@ public void setParticipantName(String participantName)
      */
     public void setParticipantState(String participantState)
     {
-        callStatusLabel.setText(participantState);
+        callStatusLabel.setText(participantState.toLowerCase());
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceFocusPanel.java
Patch:
@@ -171,8 +171,6 @@ private void initTitleBar()
      */
     private Component createStatusBar()
     {
-        callStatusLabel.setText(callPeer.getState().getStateString());
-
         TransparentPanel statusBar
             = new TransparentPanel(
                 new FlowLayout(FlowLayout.RIGHT, 0, 0));
@@ -407,7 +405,7 @@ public void setPeerName(String name)
      */
     public void setPeerState(String state)
     {
-        callStatusLabel.setText(state);
+        callStatusLabel.setText(state.toLowerCase());
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/conference/SoundLevelIndicator.java
Patch:
@@ -123,7 +123,7 @@ public void updateSoundLevel(int soundLevel)
             Component c = getComponent(i);
             if (c instanceof JLabel)
             {
-                if (i <= activeBarNumber)
+                if (i < activeBarNumber)
                     ((JLabel) c).setIcon(soundLevelActiveImage);
                 else
                     ((JLabel) c).setIcon(soundLevelInactiveImage);

File: src/net/java/sip/communicator/service/neomedia/MediaDirection.java
Patch:
@@ -70,6 +70,7 @@ private MediaDirection(String directionName)
      * @return the name of this <tt>MediaDirection</tt> (e.g. "sendonly",
      * "recvonly", "sendrecv").
      */
+    @Override
     public String toString()
     {
         return directionName;

File: src/net/java/sip/communicator/impl/neomedia/AudioMediaStreamImpl.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.impl.neomedia;
 
-import javax.media.*;
 import javax.media.format.*;
 import javax.media.rtp.*;
 

File: src/net/java/sip/communicator/impl/neomedia/format/MediaFormatImpl.java
Patch:
@@ -310,7 +310,7 @@ public String getJMFEncoding()
      * Control"; otherwise, {@link #RTP_PAYLOAD_TYPE_UNKNOWN}
      * @see MediaFormat#getRTPPayloadType()
      */
-    public int getRTPPayloadType()
+    public byte getRTPPayloadType()
     {
         return MediaUtils.getRTPPayloadType(getJMFEncoding(), getClockRate());
     }

File: src/net/java/sip/communicator/service/neomedia/format/MediaFormat.java
Patch:
@@ -30,7 +30,7 @@ public interface MediaFormat
      * type (number) known in RFC 3551 "RTP Profile for Audio and Video
      * Conferences with Minimal Control".
      */
-    public static final int RTP_PAYLOAD_TYPE_UNKNOWN = -1;
+    public static final byte RTP_PAYLOAD_TYPE_UNKNOWN = -1;
 
     /**
      * Returns the type of this <tt>MediaFormat</tt> (e.g. audio or video).
@@ -97,5 +97,5 @@ public interface MediaFormat
      * in RFC 3551 "RTP Profile for Audio and Video Conferences with Minimal
      * Control"; otherwise, {@link #RTP_PAYLOAD_TYPE_UNKNOWN}
      */
-    public int getRTPPayloadType();
+    public byte getRTPPayloadType();
 }

File: src/net/java/sip/communicator/impl/neomedia/format/MediaFormatImpl.java
Patch:
@@ -45,7 +45,7 @@ public abstract class MediaFormatImpl<T extends Format>
      */
     public static MediaFormat createInstance(Format format)
     {
-        MediaFormat mediaFormat = MediaUtils.formatToMediaFormat(format);
+        MediaFormat mediaFormat = MediaUtils.getMediaFormat(format);
 
         if (mediaFormat == null)
         {
@@ -312,7 +312,7 @@ public String getJMFEncoding()
      */
     public int getRTPPayloadType()
     {
-        return MediaUtils.jmfEncodingToRtpPayloadType(getJMFEncoding());
+        return MediaUtils.getRTPPayloadType(getJMFEncoding(), getClockRate());
     }
 
     /**

File: src/net/java/sip/communicator/impl/neomedia/format/VideoMediaFormatImpl.java
Patch:
@@ -28,7 +28,7 @@ public class VideoMediaFormatImpl
      * The default value of the <tt>clockRate</tt> property of
      * <tt>VideoMediaFormatImpl</tt>.
      */
-    private static final double DEFAULT_CLOCK_RATE = 90000;
+    public static final double DEFAULT_CLOCK_RATE = 90000;
 
     /**
      * The clock rate of this <tt>VideoMediaFormat</tt>.

File: src/net/java/sip/communicator/impl/gui/main/call/CallComboBox.java
Patch:
@@ -17,6 +17,7 @@
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.service.callhistory.*;
 import net.java.sip.communicator.service.contactlist.*;
+import net.java.sip.communicator.util.swing.*;
 
 /**
  * The <tt>CallComboBox</tt> is a history editable combo box that is
@@ -53,8 +54,8 @@ public CallComboBox(MainCallPanel parentCallPanel)
         JTextField textField =
             (JTextField) this.getEditor().getEditorComponent();
 
+        textField.setTransferHandler(new ExtendedTransferHandler());
         textField.getDocument().addDocumentListener(this);
-
         textField.getActionMap().put("createCall", new CreateCallAction());
         textField.getInputMap().put(
                 KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), "createCall");

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPanel.java
Patch:
@@ -46,6 +46,8 @@ public OneToOneCallPanel(   CallDialog callDialog,
         this.setBorder(BorderFactory
             .createEmptyBorder(5, 5, 5, 5));
 
+        this.setTransferHandler(new CallTransferHandler(call));
+
         this.addCallPeerPanel(callPeer);
     }
 

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceCallPanel.java
Patch:
@@ -86,6 +86,8 @@ public ConferenceCallPanel(CallDialog callDialog, Call c)
 
         this.getViewport().setOpaque(false);
         this.getViewport().add(mainPanel);
+
+        mainPanel.setTransferHandler(new CallTransferHandler(call));
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -841,7 +841,7 @@ public void securityOn( String securityString,
 
         if (securityPanel == null)
         {
-            SecurityPanel securityPanel = new SecurityPanel(callPeer);
+            securityPanel = new SecurityPanel(callPeer);
 
             GridBagConstraints constraints = new GridBagConstraints();
 

File: src/net/java/sip/communicator/impl/neomedia/format/MediaFormatImpl.java
Patch:
@@ -307,8 +307,7 @@ public String getJMFEncoding()
      */
     public int getRTPPayloadType()
     {
-        // TODO Auto-generated method stub
-        return RTP_PAYLOAD_TYPE_UNKNOWN;
+        return MediaUtils.jmfEncodingToRtpPayloadType(getJMFEncoding());
     }
 
     /**

File: src/net/java/sip/communicator/impl/media/device/PortAudioAuto.java
Patch:
@@ -61,7 +61,7 @@ public class PortAudioAuto
                     new CaptureDeviceInfo(
                         PortAudio.PaDeviceInfo_getName(deviceInfo),
                         new MediaLocator(
-                            PortAudioStream.LOCATOR_PREFIX + deviceIndex),
+                            PortAudioUtils.LOCATOR_PREFIX + deviceIndex),
                         PortAudioStream.getFormats());
 
             if(maxInputChannels > 0)

File: src/net/java/sip/communicator/impl/media/notify/PortAudioClipImpl.java
Patch:
@@ -111,7 +111,7 @@ public void run()
                     if (portAudioStream == 0)
                     {
                         int deviceIndex =
-                            PortAudioStream.getDeviceIndexFromLocator(
+                            PortAudioUtils.getDeviceIndexFromLocator(
                                         audioNotifier.getDeviceConfiguration().
                                         getAudioNotifyDevice().getLocator());
                         long devInfo = PortAudio.Pa_GetDeviceInfo(deviceIndex);
@@ -129,7 +129,8 @@ public void run()
                             = PortAudio.PaStreamParameters_new(
                                     deviceIndex,
                                     outChannels,
-                                    PortAudio.SAMPLE_FORMAT_INT16);
+                                    PortAudioUtils.getPortAudioSampleFormat(
+                                        audioStreamFormat.getSampleSizeInBits()));
                         // check if file samplerate is supported
                         // if it is use it and not resample
                         if(!PortAudio.Pa_IsFormatSupported(

File: src/net/java/sip/communicator/impl/media/renderer/audio/PortAudioRenderer.java
Patch:
@@ -43,8 +43,6 @@ public class PortAudioRenderer
 
     boolean started = false;
 
-//    private final Object bufferSync = new Object();
-
     private static int deviceIndex = -1;
 
     private static int frameSize;
@@ -274,7 +272,7 @@ public Object getControl(String controlType)
      */
     public static void setDevice(MediaLocator locator)
     {
-        deviceIndex = PortAudioStream.getDeviceIndexFromLocator(locator);
+        deviceIndex = PortAudioUtils.getDeviceIndexFromLocator(locator);
 
         long device = PortAudio.Pa_GetDeviceInfo(deviceIndex);
         int outputChannels = 1;

File: src/net/java/sip/communicator/impl/neomedia/device/PortAudioAuto.java
Patch:
@@ -50,7 +50,7 @@ public class PortAudioAuto
                     new CaptureDeviceInfo(
                         PortAudio.PaDeviceInfo_getName(deviceInfo),
                         new MediaLocator(
-                            PortAudioStream.LOCATOR_PREFIX + deviceIndex),
+                            PortAudioUtils.LOCATOR_PREFIX + deviceIndex),
                         PortAudioStream.getFormats());
 
             if(maxInputChannels > 0)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListCellRenderer.java
Patch:
@@ -116,10 +116,8 @@ public ContactListCellRenderer()
 
         this.nameLabel.setPreferredSize(new Dimension(10, 17));
 
-        this.rightLabel.setPreferredSize(
-            new Dimension(AVATAR_WIDTH, AVATAR_HEIGHT));
         this.rightLabel.setFont(rightLabel.getFont().deriveFont(9f));
-        this.rightLabel.setHorizontalAlignment(JLabel.CENTER);
+        this.rightLabel.setHorizontalAlignment(JLabel.RIGHT);
 
         this.add(nameLabel, BorderLayout.CENTER);
         this.add(rightLabel, BorderLayout.EAST);

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceInviteDialog.java
Patch:
@@ -198,6 +198,8 @@ private void initAccountListData()
     /**
      * Initializes the left contact list with the contacts that could be added
      * to the current chat session.
+     * @param protocolProvider the protocol provider from which to initialize
+     * the contact list data
      */
     private void initContactListData(ProtocolProviderService protocolProvider)
     {

File: src/net/java/sip/communicator/impl/gui/utils/InviteDialog.java
Patch:
@@ -256,6 +256,7 @@ public void removeAllMetaContacts()
      * Returns an enumeration of the list of selected contacts.
      * @return an enumeration of the list of selected contacts.
      */
+    @SuppressWarnings("unchecked") //We'd like to force the cast here.
     public Enumeration<MetaContact> getSelectedMetaContacts()
     {
         return (Enumeration<MetaContact>) selectedContactListModel.elements();
@@ -290,6 +291,8 @@ public void addCancelButtonListener(ActionListener l)
 
     /**
      * Closes this dialog by clicking on the "Cancel" button.
+     * @param isEscaped indicates if this <tt>close</tt> is provoked by an
+     * escape
      */
     protected void close(boolean isEscaped)
     {

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetBasicTelephony.java
Patch:
@@ -68,7 +68,8 @@ public void fireCallEvent(int eventID, Call sourceCall)
         logger.debug("Dispatching a CallEvent to " + listeners.size()
             + " listeners. event is: " + cEvent);
 
-        for (Iterator<CallListener> listenerIter = listeners.iterator(); listenerIter.hasNext();)
+        for (Iterator<CallListener> listenerIter
+                = listeners.iterator(); listenerIter.hasNext();)
         {
             CallListener listener = listenerIter.next();
 
@@ -114,7 +115,6 @@ public void removeCallListener(CallListener listener)
      */
     public void setMute(CallPeer peer, boolean mute)
     {
-
         /*
          * While throwing UnsupportedOperationException may be a possible
          * approach, putOnHold/putOffHold just do nothing when not supported so

File: src/net/java/sip/communicator/impl/netaddr/Win32LocalhostRetriever.java
Patch:
@@ -19,9 +19,7 @@ public class Win32LocalhostRetriever
   /* load library */
   static
   {
-      System.out.println("daaaaaaaaaaaaaaaaaaaaa 1");
     System.loadLibrary("LocalhostRetriever");
-      System.out.println("daaaaaaaaaaaaaaaaaaaaa 2");
   }
 
   /**

File: src/net/java/sip/communicator/impl/netaddr/NetworkAddressManagerServiceImpl.java
Patch:
@@ -257,9 +257,7 @@ public synchronized InetAddress getLocalHost(InetAddress intendedDestination)
         {
             try
             {
-logger.info("eeeeeeeee");
               localHost = Win32LocalhostRetriever.getSourceForDestination(intendedDestination);
-logger.info("eeeeeeeee 2 " + localHost);
             }
             catch(Exception e)
             {

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomConfigurationWindow.java
Patch:
@@ -129,7 +129,7 @@ private void loadConfigurationForm()
             ChatRoomConfigurationFormField formField
                 = configurationSet.next();
 
-            Iterator<Object> values = formField.getValues();
+            Iterator<?> values = formField.getValues();
             Iterator<String> options = formField.getOptions();
 
             JComponent field = null;

File: src/net/java/sip/communicator/plugin/defaultresourcepack/DefaultColorPackImpl.java
Patch:
@@ -76,11 +76,11 @@ public String getDescription()
     private void initResources( ResourceBundle resourceBundle,
                                 Map<String, String> resources)
     {
-        Enumeration colorKeys = resourceBundle.getKeys();
+        Enumeration<String> colorKeys = resourceBundle.getKeys();
 
         while (colorKeys.hasMoreElements())
         {
-            String key = (String) colorKeys.nextElement();
+            String key = colorKeys.nextElement();
             String value = resourceBundle.getString(key);
 
             resources.put(key, value);

File: src/net/java/sip/communicator/service/protocol/ChatRoomConfigurationFormField.java
Patch:
@@ -143,7 +143,7 @@ public interface ChatRoomConfigurationFormField
      * @return an Iterator for the default values or answered values of the
      * field
      */
-    public Iterator<Object> getValues();
+    public Iterator<?> getValues();
     
     /**
      * Adds the given value to the values of this field.

File: src/net/java/sip/communicator/service/neomedia/AudioMediaStream.java
Patch:
@@ -65,7 +65,7 @@ public interface AudioMediaStream
     public void addDTMFListener(DTMFListener listener);
 
     /**
-     * Remove <tt>listener</tt> from the list of <tt>DTMFListener</tt>s
+     * Removes <tt>listener</tt> from the list of <tt>DTMFListener</tt>s
      * registered to receive events for incoming DTMF tones.
      * 
      * @param listener the listener that we'd like to unregister

File: src/net/java/sip/communicator/impl/media/transform/zrtp/ZRTPTransformEngine.java
Patch:
@@ -489,7 +489,6 @@ public void cleanup()
      */
     public void setOwnSSRC(long ssrc) {
         ownSSRC = (int)(ssrc & 0xffffffff);
-        System.out.println("Own SSRC: " + ownSSRC);
     }
 
     /**

File: src/net/java/sip/communicator/impl/media/renderer/audio/PortAudioRenderer.java
Patch:
@@ -86,8 +86,8 @@ public void start()
     {
         try
         {
-            started = true;
             PortAudio.Pa_StartStream(stream);
+            started = true;
         }
         catch (PortAudioException e)
         {
@@ -104,9 +104,9 @@ public void stop()
         {
             try
             {
+                started = false;
                 PortAudio.Pa_CloseStream(stream);
                 writerThread = null;
-                started = false;
             }
             catch (PortAudioException e)
             {

File: src/net/java/sip/communicator/impl/gui/main/presence/AccountStatusPanel.java
Patch:
@@ -192,8 +192,7 @@ public void run()
 
                         // do not set empty images
                         if ((accountImage != null) && (accountImage.length > 0))
-                            accountImageLabel
-                                .setImageIcon(new ImageIcon(accountImage));
+                            accountImageLabel.setImageIcon(accountImage);
 
                         String firstName
                             = AccountInfoUtils.getFirstName(accountInfoOpSet);

File: src/net/java/sip/communicator/plugin/simpleaccreg/InitialAccountRegistrationFrame.java
Patch:
@@ -124,10 +124,11 @@ public InitialAccountRegistrationFrame()
         {
             MetaContactListService contactList =
                 SimpleAccountRegistrationActivator.getContactList();
-            Iterator iter = contactList.getRoot().getSubgroups();
+            Iterator<MetaContactGroup> iter
+                = contactList.getRoot().getSubgroups();
             while (iter.hasNext())
             {
-                MetaContactGroup gr = (MetaContactGroup) iter.next();
+                MetaContactGroup gr = iter.next();
                 if (groupName.equals(gr.getGroupName()))
                     return;
             }

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetTypingNotifications.java
Patch:
@@ -295,10 +295,8 @@ public void sentMessage(Conversation c, MessageInfo minfo){}
         public void sendAutomaticallyFailed(
             IcbmService service,
             net.kano.joustsim.oscar.oscar.service.icbm.Message message,
-            Set triedConversations)
+            Set<Conversation> triedConversations)
         {
         }
     }
-
-
 }

File: test/net/java/sip/communicator/slick/protocol/sip/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -207,9 +207,9 @@ public void prepareContactList()
         }
 
         // put the two accounts online
-        Iterator iter = opSetPresence1.getSupportedStatusSet();
+        Iterator<PresenceStatus> iter = opSetPresence1.getSupportedStatusSet();
         while (iter.hasNext()) {
-            PresenceStatus stat = (PresenceStatus) iter.next();
+            PresenceStatus stat = iter.next();
             if (stat.isOnline()) {
                 opSetPresence1.publishPresenceStatus(
                     stat, "online for testing purpose");
@@ -219,7 +219,7 @@ public void prepareContactList()
 
         iter = opSetPresence2.getSupportedStatusSet();
         while (iter.hasNext()) {
-            PresenceStatus stat = (PresenceStatus) iter.next();
+            PresenceStatus stat = iter.next();
             if (stat.isOnline()) {
                 opSetPresence2.publishPresenceStatus(
                     stat, "online for testing purpose");

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetPersistentPresenceYahooImpl.java
Patch:
@@ -678,7 +678,9 @@ private void initContactStatuses()
 
         for (YahooGroup item : groups)
         {
+            @SuppressWarnings("unchecked")
             Iterable<YahooUser> members = item.getMembers();
+
             for (YahooUser user : members)
             {
                 ContactYahooImpl sourceContact =

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -94,15 +94,15 @@ else if(!chatWindow.getCurrentChatPanel().equals(chatPanel)
                 {
                     chatWindow.highlightTab(chatPanel);
 
-                    chatPanel.setCaretToEnd();
+                    chatPanel.scrollConversationToBottom();
                 }
             }
             else
             {
                 chatWindow.setVisible(true);
                 chatWindow.setCurrentChatPanel(chatPanel);
 
-                chatPanel.setCaretToEnd();
+                chatPanel.scrollConversationToBottom();
             }
         }
     }

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetBasicInstantMessagingIcqImpl.java
Patch:
@@ -469,11 +469,10 @@ public void buddyInfoUpdated(IcbmService service, Screenname buddy,
         public void sendAutomaticallyFailed(
             IcbmService service,
             net.kano.joustsim.oscar.oscar.service.icbm.Message message,
-            Set triedConversations)
+            Set<Conversation> triedConversations)
         {
             logger.debug("sendAutomaticallyFailed message : " + message);
         }
-
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetPersistentPresenceIcqImpl.java
Patch:
@@ -1163,13 +1163,13 @@ private class JoustSimBosListener implements MainBosServiceListener
          * or certificate.
          * @param extraInfos List
          */
-        public void handleYourExtraInfo(List extraInfos)
+        public void handleYourExtraInfo(List<ExtraInfoBlock> extraInfos)
         {
             logger.debug("Got extra info: " + extraInfos);
             // @xxx we should one day probably do something here, like check
             // whether the status message has been changed for example.
-            for (int i = 0; i < extraInfos.size(); i ++){
-                ExtraInfoBlock block = (ExtraInfoBlock) extraInfos.get(i);
+            for (ExtraInfoBlock block : extraInfos)
+            {
                 if (block.getType() == ExtraInfoBlock.TYPE_AVAILMSG){
                     String statusMessage = ExtraInfoData.readAvailableMessage(
                                                     block.getExtraData());

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetTypingNotificationsIcqImpl.java
Patch:
@@ -192,10 +192,9 @@ public void buddyInfoUpdated(IcbmService service, Screenname buddy,
         public void sendAutomaticallyFailed(
             IcbmService service,
             net.kano.joustsim.oscar.oscar.service.icbm.Message message,
-            Set triedConversations)
+            Set<Conversation> triedConversations)
         {
         }
-
     }
 
     /**
@@ -242,7 +241,7 @@ public void sentMessage(Conversation conv, MessageInfo minfo){}
         public void sendAutomaticallyFailed(IcbmService service,
                                             net.kano.joustsim.oscar.oscar.
                                             service.icbm.Message message,
-                                            Set triedConversations)
+                                            Set<Conversation> triedConversations)
         {
         }
     }

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -844,7 +844,7 @@ public void buddyInfoUpdated(IcbmService service, Screenname buddy,
         public void sendAutomaticallyFailed(
             IcbmService service,
             net.kano.joustsim.oscar.oscar.service.icbm.Message message,
-            Set triedConversations)
+            Set<Conversation> triedConversations)
         {
         }
     }

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetPersistentPresenceMsnImpl.java
Patch:
@@ -657,8 +657,8 @@ else if(evt.getNewState() == RegistrationState.UNREGISTERED
 
                 //send event notifications saying that all our buddies are
                 //offline.
-                Iterator rootContactsIter =
-                    getServerStoredContactListRoot().contacts();
+                Iterator<Contact> rootContactsIter
+                    = getServerStoredContactListRoot().contacts();
                 while(rootContactsIter.hasNext())
                 {
                     ContactMsnImpl contact

File: src/net/java/sip/communicator/plugin/mailbox/Mailbox.java
Patch:
@@ -574,11 +574,11 @@ private void answerCall(Call call)
                 = call
                     .getProtocolProvider()
                         .getOperationSet(OperationSetBasicTelephony.class);
-            Iterator peers = call.getCallPeers();
+            Iterator<? extends CallPeer> peers = call.getCallPeers();
 
             while(peers.hasNext())
             {
-                CallPeer peer = (CallPeer)peers.next();
+                CallPeer peer = peers.next();
 
                 try
                 {

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -122,7 +122,7 @@ public void actionPerformed(ActionEvent evt)
             if (call != null)
             {
                 OperationSetBasicTelephony telephony =
-                    (OperationSetBasicTelephony) call.getProtocolProvider()
+                    call.getProtocolProvider()
                         .getOperationSet(OperationSetBasicTelephony.class);
 
                 Iterator<? extends CallPeer> peers = call.getCallPeers();

File: src/net/java/sip/communicator/impl/gui/main/call/OneToOneCallPeerPanel.java
Patch:
@@ -290,7 +290,7 @@ private OperationSetVideoTelephony addVideoListener()
             return null;
 
         final OperationSetVideoTelephony telephony =
-            (OperationSetVideoTelephony) call.getProtocolProvider()
+            call.getProtocolProvider()
                 .getOperationSet(OperationSetVideoTelephony.class);
         if (telephony == null)
             return null;

File: src/net/java/sip/communicator/impl/gui/main/call/ParentCallPeerPanel.java
Patch:
@@ -505,7 +505,7 @@ private void createSecurityPanel(CallPeerSecurityOnEvent event)
         if (callPeer != null)
         {
             OperationSetSecureTelephony secure
-                = (OperationSetSecureTelephony) callPeer
+                = callPeer
                     .getProtocolProvider().getOperationSet(
                             OperationSetSecureTelephony.class);
 
@@ -548,7 +548,7 @@ protected Component createTransferCallButton()
         if (callPeer != null)
         {
             OperationSetAdvancedTelephony telephony =
-                (OperationSetAdvancedTelephony) callPeer.getProtocolProvider()
+                callPeer.getProtocolProvider()
                     .getOperationSet(OperationSetAdvancedTelephony.class);
 
             if (telephony != null)

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -53,7 +53,7 @@ public ReceivedCallDialog(Call call)
         this.initComponents();
 
         OperationSetBasicTelephony telephonyOpSet
-            = (OperationSetBasicTelephony) call.getProtocolProvider()
+            = call.getProtocolProvider()
                 .getOperationSet(OperationSetBasicTelephony.class);
 
         telephonyOpSet.addCallListener(this);

File: src/net/java/sip/communicator/impl/gui/main/call/SecurityPanel.java
Patch:
@@ -65,8 +65,9 @@ public void actionPerformed(ActionEvent e)
                 if (call != null)
                 {
                     OperationSetSecureTelephony secure
-                        = (OperationSetSecureTelephony) call
-                            .getProtocolProvider().getOperationSet(
+                        = call
+                            .getProtocolProvider()
+                                .getOperationSet(
                                     OperationSetSecureTelephony.class);
 
                     if (secure != null)

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallButton.java
Patch:
@@ -89,7 +89,7 @@ private void actionPerformed(ActionListener listener, ActionEvent evt)
         if (call != null)
         {
             OperationSetAdvancedTelephony telephony =
-                (OperationSetAdvancedTelephony) call.getProtocolProvider()
+                call.getProtocolProvider()
                     .getOperationSet(OperationSetAdvancedTelephony.class);
 
             if (telephony != null)
@@ -222,7 +222,7 @@ private CallPeer findCallPeer(String address)
         {
             ProtocolProviderService service = (ProtocolProviderService)
                 bundleContext.getService(serviceReference);
-            OperationSetBasicTelephony telephony = (OperationSetBasicTelephony)
+            OperationSetBasicTelephony telephony =
                 service.getOperationSet(telephonyClass);
 
             if (telephony != null)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTransferHandler.java
Patch:
@@ -46,7 +46,7 @@ public ContactListTransferHandler(DefaultContactList contactList)
      * @param t the data to import
      * @return <tt>true</tt> if the data was inserted into the component;
      * <tt>false</tt>, otherwise
-     * @see TransferHandler#importData(JComponent. Transferable)
+     * @see TransferHandler#importData(JComponent, Transferable)
      */
     @SuppressWarnings("unchecked") //taken care of
     public boolean importData(JComponent comp, Transferable t)

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -68,8 +68,7 @@ public PresenceStatusMenu(ProtocolProviderService protocolProvider)
         this.protocolProvider = protocolProvider;
 
         this.presence
-            = (OperationSetPresence) protocolProvider
-                .getOperationSet(OperationSetPresence.class);
+                = protocolProvider.getOperationSet(OperationSetPresence.class);
 
         this.statusIterator = this.presence.getSupportedStatusSet();
 

File: src/net/java/sip/communicator/impl/gui/utils/ImageLoader.java
Patch:
@@ -1341,8 +1341,7 @@ public static ImageIcon getAccountStatusImage(ProtocolProviderService pps)
         ImageIcon statusIcon;
 
         OperationSetPresence presence
-            = (OperationSetPresence) pps
-                .getOperationSet(OperationSetPresence.class);
+            = pps.getOperationSet(OperationSetPresence.class);
 
         Image statusImage;
         if (presence != null)

File: src/net/java/sip/communicator/impl/media/transform/zrtp/ZRTPTransformEngine.java
Patch:
@@ -484,7 +484,7 @@ public void cleanup()
      * The data output stream calls this method to transform outgoing
      * packets.
      * 
-     * @see PacketTransformer#transform(net.java.sip.communicator.impl.media.transform.RawPacket)
+     * @see PacketTransformer#transform(RawPacket)
      */
     public RawPacket transform(RawPacket pkt)
     {
@@ -521,7 +521,7 @@ public RawPacket transform(RawPacket pkt)
      * The input data stream calls this method to transform
      * incoming packets.
      * 
-     * @see PacketTransformer#reverseTransform(net.java.sip.communicator.impl.media.transform.RawPacket)
+     * @see PacketTransformer#reverseTransform(RawPacket)
      */
     public RawPacket reverseTransform(RawPacket pkt)
     {

File: src/net/java/sip/communicator/impl/protocol/facebook/FacebookOutgoingChatMessage.java
Patch:
@@ -45,7 +45,6 @@ public FacebookOutgoingChatMessage(FacebookSession session)
      * Only one message can be sent at a time for a given
      * {@link FacebookSession}
      * 
-     * @return true if the message was sent successfully
      * @throws BrokenFacebookProtocolException
      * @throws IOException
      */

File: src/net/java/sip/communicator/impl/protocol/icq/AdHocChatRoomIcqImpl.java
Patch:
@@ -377,7 +377,7 @@ public void leave()
         {
             Map.Entry<String, Contact> memberEntry = membersSet.next();
 
-            Contact participant = (Contact) memberEntry.getValue();
+            Contact participant = memberEntry.getValue();
 
             fireParticipantPresenceEvent(participant,
                 AdHocChatRoomParticipantPresenceChangeEvent.CONTACT_LEFT,

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetGeolocationJabberImpl.java
Patch:
@@ -63,8 +63,9 @@ public OperationSetGeolocationJabberImpl(
     {
         this.jabberProvider = provider;
 
-        this.opsetprez = (OperationSetPersistentPresence)
-            provider.getOperationSet(OperationSetPersistentPresence.class);
+        this.opsetprez
+                = provider
+                    .getOperationSet(OperationSetPersistentPresence.class);
 
         this.jabberProvider.addRegistrationStateChangeListener(
             new RegistrationStateListener());

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetMultiUserChatJabberImpl.java
Patch:
@@ -63,7 +63,7 @@ public class OperationSetMultiUserChatJabberImpl
         jabberProvider.addRegistrationStateChangeListener(providerRegListener);
 
         OperationSetPersistentPresence presenceOpSet
-            = (OperationSetPersistentPresence) jabberProvider
+            = jabberProvider
                 .getOperationSet(OperationSetPersistentPresence.class);
 
         presenceOpSet.addSubscriptionListener(this);

File: src/net/java/sip/communicator/impl/protocol/rss/UriHandlerRssImpl.java
Patch:
@@ -151,8 +151,7 @@ public void handleUri(String uri)
         }
 
         OperationSetPresence presenceOpSet
-            = (OperationSetPresence) provider
-                .getOperationSet(OperationSetPresence.class);
+            = provider.getOperationSet(OperationSetPresence.class);
 
         try
         {

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetAdHocMultiUserChatYahooImpl.java
Patch:
@@ -369,7 +369,6 @@ public void rejectInvitation(AdHocChatRoomInvitation invitation,
      * @param targetChatRoom the room that invitation refers to
      * @param inviter the inviter that sent the invitation
      * @param reason the reason why the inviter sent the invitation
-     * @param password the password to use when joining the room
      */
     public void fireInvitationEvent(AdHocChatRoom targetChatRoom,
         String inviter, String reason)

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardActivator.java
Patch:
@@ -109,8 +109,7 @@ public static List<OperationSetWhiteboarding> getWhiteboardOperationSets()
                 = (ProtocolProviderService) bundleContext.getService(serRef);
 
             OperationSetWhiteboarding opSet
-                = (OperationSetWhiteboarding)
-                    protocolProvider
+                = protocolProvider
                         .getOperationSet(OperationSetWhiteboarding.class);
 
             if(opSet != null)

File: test/net/java/sip/communicator/slick/contactlist/TestMetaContactGroup.java
Patch:
@@ -46,7 +46,7 @@ protected void setUp() throws Exception
         fixture.setUp();
 
         OperationSetPersistentPresence opSetPresence =
-            (OperationSetPersistentPresence) fixture.mockProvider
+            fixture.mockProvider
                 .getOperationSet(OperationSetPersistentPresence.class);
 
         mockGroup = (MockContactGroup)opSetPresence

File: test/net/java/sip/communicator/slick/protocol/generic/PredictableTransformLayer.java
Patch:
@@ -74,7 +74,7 @@ private Message createMessage(Contact contact, Message message,
         String action)
     {
         OperationSetBasicInstantMessaging imOpSet =
-            (OperationSetBasicInstantMessaging) contact.getProtocolProvider()
+            contact.getProtocolProvider()
                 .getOperationSet(OperationSetBasicInstantMessaging.class);
         return imOpSet.createMessage("__" + action + "__"
             + message.getContent());

File: test/net/java/sip/communicator/slick/protocol/icq/TestProtocolProviderServiceIcqImpl.java
Patch:
@@ -147,8 +147,7 @@ public void testRegister()
         // This message is supposed to be offline message and as one is tested
         // in TestOperationSetBasicInstantMessaging.testReceiveOfflineMessages()
         OperationSetBasicInstantMessaging opSetBasicIM =
-            (OperationSetBasicInstantMessaging) fixture.provider
-                .getOperationSet(OperationSetBasicInstantMessaging.class);
+            fixture.provider.getOperationSet(OperationSetBasicInstantMessaging.class);
         fixture.offlineMsgCollector.register(opSetBasicIM);
 
         //give time for the AIM server to notify everyone of our arrival

File: src/net/java/sip/communicator/impl/neomedia/device/DeviceConfiguration.java
Patch:
@@ -608,6 +608,7 @@ else if(name.equals(AUDIO_SYSTEM_PORTAUDIO))
                             this.audioPlaybackDevice = captureDeviceInfo;
                             setDeviceToRenderer(audioPlaybackDevice);
                             removeJavaSoundRenderer();
+                            initPortAudioRenderer();
                             break;
                         }
                     }

File: src/net/java/sip/communicator/impl/media/device/DeviceConfiguration.java
Patch:
@@ -606,6 +606,7 @@ else if(name.equals(AUDIO_SYSTEM_PORTAUDIO))
                             this.audioPlaybackDevice = captureDeviceInfo;
                             setDeviceToRenderer(audioPlaybackDevice);
                             removeJavaSoundRenderer();
+                            initPortAudioRenderer();
                             break;
                         }
                     }

File: src/net/java/sip/communicator/impl/media/device/PortAudioAuto.java
Patch:
@@ -66,9 +66,6 @@ public class PortAudioAuto
 
         CaptureDeviceManager.commit();
 
-        // Enables Portaudio Renderer
-        DeviceConfiguration.initPortAudioRenderer();
-
         // now add it as available audio system to DeviceConfiguration
         DeviceConfiguration.addAudioSystem(
             DeviceConfiguration.AUDIO_SYSTEM_PORTAUDIO);

File: src/net/java/sip/communicator/impl/gui/main/call/MainCallPanel.java
Patch:
@@ -86,7 +86,8 @@ public MainCallPanel(MainFrame mainFrame)
 
         JLabel callViaLabel
             = new JLabel(
-                GuiActivator.getResources().getI18NString("service.gui.CALL_VIA")
+                GuiActivator.getResources()
+                    .getI18NString("service.gui.CALL_VIA")
                 + " ");
 
         this.createBorder();

File: src/net/java/sip/communicator/impl/gui/utils/InviteDialog.java
Patch:
@@ -113,7 +113,6 @@ public InviteDialog (String title)
             GuiActivator.getResources().getI18nMnemonic("service.gui.CANCEL"));
 
         final DefaultContactList contactList = new DefaultContactList();
-
         final DefaultContactList selectedContactList = new DefaultContactList();
 
         contactList.setModel(contactListModel);
@@ -125,8 +124,7 @@ public void mouseClicked(MouseEvent e)
             {
                 if (e.getClickCount() > 1)
                 {
-                    Object[] metaContacts
-                        = (Object[]) contactList.getSelectedValues();
+                    Object[] metaContacts = contactList.getSelectedValues();
 
                     moveContactsFromLeftToRight(metaContacts);
                 }

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -599,7 +599,9 @@ private boolean stopSendStreaming(RTPManager rtpManager)
     /**
      * Stops and closes all streams currently handled by <tt>rtpManager</tt>.
      *
-     * @param rtpManager the rtpManager whose streams we'll be stopping.
+     * @param rtpManager the <tt>RTPManager</tt> to stop the streams of
+     * @param dispose <tt>true</tt> to dispose of <tt>rtpManager</tt> after
+     * stopping its streams; otherwise, <tt>false</tt>
      * @return <tt>true</tt> if there was an actual change in the streaming i.e.
      *         the streaming wasn't already stopped before this request;
      *         <tt>false</tt>, otherwise

File: src/net/java/sip/communicator/impl/media/codec/audio/g729/Coder.java
Patch:
@@ -189,7 +189,7 @@ void process(short[] sp16, short[] serial)
         int new_speech_offset = codLd8k.new_speech_offset;
 
         for (int i = 0; i < L_FRAME; i++)
-            new_speech[new_speech_offset + i] = (float) sp16[i];
+            new_speech[new_speech_offset + i] = sp16[i];
 
         preProc.pre_process(new_speech, new_speech_offset, L_FRAME);
 

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetPersistentPresenceIcqImpl.java
Patch:
@@ -639,7 +639,7 @@ else if(getPresenceStatus().equals(AimStatusEnum.AWAY))
         }
         else
         {
-            long icqStatus = presenceStatusToStatusLong((IcqStatusEnum)status);
+            long icqStatus = presenceStatusToStatusLong(status);
 
             logger.debug("Will set status: " + status + " long=" + icqStatus);
 

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -12,7 +12,6 @@
 
 import javax.sip.*;
 import javax.sip.address.*;
-import javax.sip.address.URI;
 import javax.sip.header.*;
 import javax.sip.message.*;
 

File: src/net/java/sip/communicator/impl/protocol/sip/EventPackageNotifier.java
Patch:
@@ -252,7 +252,7 @@ private ClientTransaction createNotify( Dialog dialog,
                         ex);
         }
 
-        req.setHeader((Header) viaHeaders.get(0));
+        req.setHeader(viaHeaders.get(0));
 
         // add the content
         try

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetVideoTelephonySipImpl.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.impl.protocol.sip;
 
 import java.awt.*;
-import java.util.*;
 
 import net.java.sip.communicator.service.media.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/protocol/sip/SipMessageFactory.java
Patch:
@@ -10,18 +10,18 @@
 import gov.nist.javax.sip.header.extensions.*;
 import gov.nist.javax.sip.message.*;
 
-import java.net.URLDecoder; //disamgibuates javax.sip.address.URI
+import java.net.*;
 import java.text.*;
 import java.util.*;
 
 import javax.sip.*;
 import javax.sip.address.*;
+import javax.sip.address.URI;
 import javax.sip.header.*;
 import javax.sip.message.*;
-import javax.sip.message.Message;//disambiguates with service.protocol.Message
+import javax.sip.message.Message;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ProtocolProviderServiceZeroconfImpl.java
Patch:
@@ -105,7 +105,7 @@ protected void initialize(String userID,
     {
         synchronized(initializationLock)
         {
-            this.accountID = (ZeroconfAccountID) accountID;
+            this.accountID = accountID;
 
            
            //initialize the presence operationset

File: src/net/java/sip/communicator/util/swing/plaf/SIPCommTabbedPaneUI.java
Patch:
@@ -1019,7 +1019,7 @@ public void actionPerformed(ActionEvent e)
 
                 if (command != null && command.length() > 0)
                 {
-                    int mnemonic = (int) e.getActionCommand().charAt(0);
+                    int mnemonic = e.getActionCommand().charAt(0);
                     if (mnemonic >= 'a' && mnemonic <= 'z')
                     {
                         mnemonic -= ('a' - 'A');

File: test/net/java/sip/communicator/slick/protocol/icq/IcqTesterAgent.java
Patch:
@@ -941,7 +941,7 @@ public void groupAdded(BuddyList list,
                 System.out.println("        buddy is="
                              +((Buddy)buddies.get(i))
                                 .getScreenname().getFormatted());
-                Buddy b = ((Buddy)buddies.get(i));
+                Buddy b = buddies.get(i);
                 conn.getBuddyInfoTracker().addTracker(b.getScreenname(),
                     new BuddyInfoTrackerListener(){});
             }

File: src/net/java/sip/communicator/plugin/otr/ScOtrKeyManagerImpl.java
Patch:
@@ -18,6 +18,8 @@
 public class ScOtrKeyManagerImpl
     implements ScOtrKeyManager
 {
+    private final OtrConfigurator configurator = new OtrConfigurator();
+
     private final List<ScOtrKeyManagerListener> listeners =
         new Vector<ScOtrKeyManagerListener>();
 
@@ -38,8 +40,6 @@ public void removeListener(ScOtrKeyManagerListener l)
         }
     }
 
-    private Configurator configurator = new Configurator();
-
     public void verify(Contact contact)
     {
         if ((contact == null) || isVerified(contact))

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -547,7 +547,9 @@ public void removeGroup(ContactGroupMsnImpl groupToRemove)
         for (int i = 0; i < contacts.length; i++)
         {
             logger.trace("removing contact from group " + contacts[i]);
-            msnProvider.getMessenger().removeFriend(contacts[i].getEmail(), false);
+
+            msnProvider.getMessenger().removeFriend(contacts[i].getEmail(),
+                groupToRemove.getSourceGroup().getGroupId());
         }
 
         // wait max seconds or the last removed contact

File: test/net/java/sip/communicator/slick/protocol/msn/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -147,8 +147,8 @@ public static Test suite()
         //the following 2 need to be run in the specified order.
         suite.addTest(new TestOperationSetBasicInstantMessaging(
                                 "firstTestReceiveMessage"));
-//        suite.addTest(new TestOperationSetBasicInstantMessaging(
-//                                "thenTestSendMessage"));
+        suite.addTest(new TestOperationSetBasicInstantMessaging(
+                                "thenTestSendMessage"));
 
         return suite;
     }

File: test/net/java/sip/communicator/slick/protocol/msn/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -147,8 +147,8 @@ public static Test suite()
         //the following 2 need to be run in the specified order.
         suite.addTest(new TestOperationSetBasicInstantMessaging(
                                 "firstTestReceiveMessage"));
-        suite.addTest(new TestOperationSetBasicInstantMessaging(
-                                "thenTestSendMessage"));
+//        suite.addTest(new TestOperationSetBasicInstantMessaging(
+//                                "thenTestSendMessage"));
 
         return suite;
     }

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetFileTransferMsnImpl.java
Patch:
@@ -94,7 +94,7 @@ public FileTransfer sendFile(   Contact toContact,
                     file);
 
         if(ft == null)
-            new IllegalStateException(
+            throw new IllegalStateException(
                 "A problem occured sending file, contact not found or offline");
 
         FileTransferImpl outFileTransfer = new FileTransferImpl(

File: test/net/java/sip/communicator/slick/protocol/msn/TestOperationSetFileTransferImpl.java
Patch:
@@ -143,8 +143,10 @@ public void prepareContactList()
         throws Exception
     {
         // clear the provider the first time we run a filetransfer list
-        if(getContact1() == null && getContact2() == null)
+        if(contact1 == null && contact2 == null)
+        {
             fixture.clearProvidersLists();
+        }
 
         if(getContact1() == null)
         {

File: src/net/java/sip/communicator/impl/gui/main/account/AccountList.java
Patch:
@@ -166,9 +166,7 @@ public void serviceChanged(ServiceEvent event)
         }
         else if (event.getType() == ServiceEvent.UNREGISTERING)
         {
-            Object[] accountListModelElements = accountListModel.toArray();
-
-            for (Object accountListModelElement : accountListModelElements)
+            for (Object accountListModelElement : accountListModel.toArray())
             {
                 Account account = (Account) accountListModelElement;
 

File: src/net/java/sip/communicator/impl/gui/main/account/AccountList.java
Patch:
@@ -83,7 +83,7 @@ private void accountsInit()
                 protocolProvider.addRegistrationStateChangeListener(this);
 
                 OperationSetPresence presence
-                    = (OperationSetPresence) protocolProvider
+                    = protocolProvider
                         .getOperationSet(OperationSetPresence.class);
 
                 if (presence != null)
@@ -154,7 +154,7 @@ public void serviceChanged(ServiceEvent event)
             // Add a presence listener in order to listen for any status
             // changes.
             OperationSetPresence presence
-                = (OperationSetPresence) protocolProvider
+                = protocolProvider
                     .getOperationSet(OperationSetPresence.class);
 
             if (presence != null)

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomProviderWrapper.java
Patch:
@@ -200,8 +200,7 @@ public int indexOf(ChatRoomWrapper chatRoomWrapper)
     public void synchronizeProvider()
     {
         final OperationSetMultiUserChat groupChatOpSet
-            = (OperationSetMultiUserChat) protocolProvider
-                .getOperationSet(OperationSetMultiUserChat.class);
+            = protocolProvider.getOperationSet(OperationSetMultiUserChat.class);
 
         for(final ChatRoomWrapper chatRoomWrapper : chatRoomsOrderedCopy)
         {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -311,7 +311,7 @@ private void init()
                 this.callContactMenu.add(callContactItem);
             }
 
-            // TODO Why is OperationSetWebContactInfo requested and not used?
+            // FIXME Why is OperationSetWebContactInfo requested and not used?
             protocolProvider.getOperationSet(OperationSetWebContactInfo.class);
         }
 

File: src/net/java/sip/communicator/impl/protocol/facebook/OperationSetPersistentPresenceFacebookImpl.java
Patch:
@@ -654,9 +654,8 @@ public void subscribe(ContactGroup parent, String contactIdentifier)
         if (fbProvider != null)
         {
             OperationSetPersistentPresence opSetPresence
-                = (OperationSetPersistentPresence)
-                    fbProvider
-                        .getOperationSet(OperationSetPersistentPresence.class);
+                = fbProvider
+                    .getOperationSet(OperationSetPersistentPresence.class);
 
             changePresenceStatusForContact(contact,
                 (FacebookStatusEnum) opSetPresence.getPresenceStatus());

File: src/net/java/sip/communicator/impl/protocol/jabber/IncomingFileTransferRequestJabberImpl.java
Patch:
@@ -75,8 +75,8 @@ public IncomingFileTransferRequestJabberImpl(
 
         OperationSetPersistentPresenceJabberImpl opSetPersPresence
             = (OperationSetPersistentPresenceJabberImpl)
-                jabberProvider.getOperationSet(
-                    OperationSetPersistentPresence.class);
+                jabberProvider
+                    .getOperationSet(OperationSetPersistentPresence.class);
 
         sender = opSetPersPresence.findContactByID(fromUserID);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -42,8 +42,9 @@ public class ProtocolProviderServiceJabberImpl
      * The name of the property that tells us whether we are supposed to start
      * experimental support for Jingle.
      */
-    private static final String PNAME_ENABLE_JINGLE = "net.java.sip"
-        + ".communicator.impl.protocol.jabber.ENABLE_EXPERIMENTAL_JINGLE";
+    private static final String PNAME_ENABLE_JINGLE
+        = "net.java.sip.communicator"
+            + ".impl.protocol.jabber.ENABLE_EXPERIMENTAL_JINGLE";
 
     /**
      * Used to connect to a XMPP server.

File: src/net/java/sip/communicator/impl/protocol/sip/UriHandlerSipImpl.java
Patch:
@@ -296,9 +296,8 @@ public void handleUri(String uri)
             return;
         }
 
-        OperationSetBasicTelephony telephonyOpSet =
-            (OperationSetBasicTelephony) provider
-                .getOperationSet(OperationSetBasicTelephony.class);
+        OperationSetBasicTelephony telephonyOpSet
+            = provider.getOperationSet(OperationSetBasicTelephony.class);
 
         try
         {

File: src/net/java/sip/communicator/impl/protocol/mock/MockProvider.java
Patch:
@@ -149,9 +149,10 @@ public Map<String, OperationSet> getSupportedOperationSets()
      * @return returns an OperationSet of the specified <tt>Class</tt> if the
      * undelying implementation supports it or null otherwise.
      */
-    public OperationSet getOperationSet(Class<? extends OperationSet> opsetClass)
+    @SuppressWarnings("unchecked")
+    public <T extends OperationSet> T getOperationSet(Class<T> opsetClass)
     {
-        return getSupportedOperationSets().get(opsetClass.getName());
+        return (T) getSupportedOperationSets().get(opsetClass.getName());
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderService.java
Patch:
@@ -153,7 +153,7 @@ public void removeRegistrationStateChangeListener(
      * @return returns an OperationSet of the specified <tt>Class</tt> if the
      * undelying implementation supports it or null otherwise.
      */
-    public OperationSet getOperationSet(Class<? extends OperationSet> opsetClass);
+    public <T extends OperationSet> T getOperationSet(Class<T> opsetClass);
 
     /**
      * Makes the service implementation close all open sockets and release

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetAdHocMultiUserChatMsnImpl.java
Patch:
@@ -286,7 +286,7 @@ private AdHocChatRoomMsnImpl createLocalAdHocChatRoomInstance(
             MsnSwitchboard switchboard)
     {
         AdHocChatRoomMsnImpl adHocChatRoom = (AdHocChatRoomMsnImpl)
-            this.adHocChatRoomCache.get(String.valueOf(switchboard.hashCode()));
+            this.adHocChatRoomCache.get(switchboard);
 
         if (adHocChatRoom == null)
         {

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetAdHocMultiUserChatIcqImpl.java
Patch:
@@ -195,6 +195,7 @@ public AdHocChatRoom createAdHocChatRoom(String roomName,
      * @param adHocRoomName the name of the ad-hoc room
      * @param contacts the list of contacts
      *
+     * @return the ad-hoc room that has been just created
      * @throws OperationFailedException
      * @throws OperationNotSupportedException
      */

File: src/net/java/sip/communicator/service/neomedia/MediaService.java
Patch:
@@ -46,12 +46,12 @@ public interface MediaService
     /**
      * Creates a <tt>MediaStream</tt> that will be using the specified
      * <tt>MediaDevice</tt> for both capture and playback of media exchanged
-     * via the specified <tt>MediaConnector</tt>.
+     * via the specified <tt>StreamConnector</tt>.
      *
      * @param connector the connector that the stream should use for sending and
      * receiving media.
      * @param device the device to be used for both capture and playback of
-     * media changed via the specified <tt>MediaConnector</tt>
+     * media changed via the specified <tt>StreamConnector</tt>
      *
      * @return the newly created <tt>MediaStream</tt>.
      */

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryServiceImpl.java
Patch:
@@ -980,7 +980,7 @@ private void handleNewCall(Call sourceCall, String direction)
         currentCallRecords.add(newRecord);
 
         // if has already perticipants Dispatch them
-        Iterator<CallPeer> iter = sourceCall.getCallPeers();
+        Iterator<? extends CallPeer> iter = sourceCall.getCallPeers();
         while (iter.hasNext())
         {
             handlePeerAdded(iter.next());

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -321,7 +321,7 @@ public AnswerCallThread(Call call)
         public void run()
         {
             ProtocolProviderService pps = call.getProtocolProvider();
-            Iterator<CallPeer> peers = call.getCallPeers();
+            Iterator<? extends CallPeer> peers = call.getCallPeers();
 
             while (peers.hasNext())
             {
@@ -460,7 +460,7 @@ public HangupCallThread(Call call)
         public void run()
         {
             ProtocolProviderService pps = call.getProtocolProvider();
-            Iterator<CallPeer> peers = call.getCallPeers();
+            Iterator<? extends CallPeer> peers = call.getCallPeers();
 
             while (peers.hasNext())
             {

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -125,7 +125,7 @@ public void actionPerformed(ActionEvent evt)
                     (OperationSetBasicTelephony) call.getProtocolProvider()
                         .getOperationSet(OperationSetBasicTelephony.class);
 
-                Iterator<CallPeer> peers = call.getCallPeers();
+                Iterator<? extends CallPeer> peers = call.getCallPeers();
 
                 while (peers.hasNext())
                 {

File: src/net/java/sip/communicator/impl/gui/main/call/MuteButton.java
Patch:
@@ -112,7 +112,7 @@ public void actionPerformed(ActionEvent evt)
         {
             if (call != null)
             {
-                Iterator<CallPeer> peers
+                Iterator<? extends CallPeer> peers
                     = call.getCallPeers();
 
                 while (peers.hasNext())

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -121,7 +121,7 @@ private void initComponents()
      */
     private void initCallLabel(JLabel callLabel)
     {
-        Iterator<CallPeer> peersIter = incomingCall.getCallPeers();
+        Iterator<? extends CallPeer> peersIter = incomingCall.getCallPeers();
 
         boolean hasMorePeers = false;
         String text = "";

File: src/net/java/sip/communicator/impl/gui/main/call/conference/ConferenceCallPanel.java
Patch:
@@ -60,7 +60,7 @@ public ConferenceCallPanel(CallDialog callDialog, Call c)
 
         this.addLocalCallPeer();
 
-        Iterator<CallPeer> iterator = this.call.getCallPeers();
+        Iterator<? extends CallPeer> iterator = this.call.getCallPeers();
         while (iterator.hasNext())
         {
             this.addCallPeerPanel(iterator.next());

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomConfigurationFormFieldJabberImpl.java
Patch:
@@ -149,7 +149,7 @@ else if(smackType.equals(FormField.TYPE_LIST_MULTI))
      */
     public Iterator<Object> getValues()
     {
-        Iterator<Object> valuesIter = null;
+        Iterator<? extends Object> valuesIter = null;
         List<Object> values = new ArrayList<Object>();
         Iterator<String> smackValues = smackFormField.getValues();
 
@@ -169,9 +169,9 @@ public Iterator<Object> getValues()
             valuesIter = values.iterator();
         }
         else
-            valuesIter = (Iterator) smackValues;
+            valuesIter = (Iterator<? extends Object>) smackValues;
 
-        return valuesIter;
+        return (Iterator<Object>)valuesIter;
     }
 
     /**

File: src/net/java/sip/communicator/plugin/mailbox/Mailbox.java
Patch:
@@ -612,7 +612,7 @@ private void hangupCall(Call call)
                                 OperationSetBasicTelephony.class);
             logger.info("Max Message Length Reached, Mailbox is"
                         +" disconnecting the call");
-            Iterator<CallPeer> callPeers = call.getCallPeers();
+            Iterator<? extends CallPeer> callPeers = call.getCallPeers();
 
             while(callPeers.hasNext())
             {

File: src/net/java/sip/communicator/util/PropertyChangeListener.java
Patch:
@@ -12,17 +12,17 @@
  * A "ConfigurationChange" event gets fired whenever a configuration property
  * changes. Depending on whether the property was constrained or not, the
  * propertyChange or vetoableChange methods get called.
- * 
+ *
  * @author Emil Ivov
  */
 public interface PropertyChangeListener
     extends EventListener
 {
     /**
      * This method gets called when a bound property is changed.
-     * 
+     *
      * @param evt A PropertyChangeEvent object describing the event source and
-     *            the property that has changed.
+     * the property that has changed.
      */
     void propertyChange(PropertyChangeEvent evt);
 }

File: test/net/java/sip/communicator/slick/callhistory/TestCallHistoryService.java
Patch:
@@ -153,7 +153,7 @@ private void generateCall(String participant)
 
             Vector<CallPeer> v = new Vector<CallPeer>();
 
-            Iterator<CallPeer> iter = newCall.getCallPeers();
+            Iterator<? extends CallPeer> iter = newCall.getCallPeers();
             while (iter.hasNext())
             {
                 CallPeer item = iter.next();
@@ -284,7 +284,7 @@ public void checkRecordCompleteness()
 
             Vector<CallPeer> v = new Vector<CallPeer>();
 
-            Iterator<CallPeer> iter = newCall.getCallPeers();
+            Iterator<? extends CallPeer> iter = newCall.getCallPeers();
             while (iter.hasNext())
             {
                 CallPeer item = iter.next();

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -107,7 +107,6 @@ public CallPeerSipImpl(Address     peerAddress,
     {
         this.peerAddress = peerAddress;
         this.call = owningCall;
-        call.addCallPeer(this);
 
         //create the uid
         this.peerID = String.valueOf( System.currentTimeMillis())

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -622,7 +622,7 @@ public void closeCaptureDevices()
      * @return a connected <tt>DataSource</tt> for the media specified by the
      * locator.
      */
-    private DataSource createDataSource(MediaLocator locator)
+    public static DataSource createDataSource(MediaLocator locator)
     {
         try {
             logger.info("Creating datasource for:"

File: src/net/java/sip/communicator/service/neomedia/DTMFTone.java
Patch:
@@ -7,7 +7,7 @@
 package net.java.sip.communicator.service.neomedia;
 
 /**
- * Class for representing all the different DTMF tones.
+ * Represents all DTMF tones.
  *
  * @author JM HEITZ
  */
@@ -102,7 +102,7 @@ public final class DTMFTone
      * Creates a DTMF instance with the specified tone value. The method is
      * private since one would only have to use predefined static instances.
      *
-     * @param value one of te DTMF_XXX fields, indicating the value of the tone.
+     * @param value one of the DTMF_XXX fields, indicating the value of the tone.
      */
     private DTMFTone(String value)
     {

File: src/net/java/sip/communicator/service/neomedia/MediaService.java
Patch:
@@ -21,7 +21,7 @@ public interface MediaService
 {
     /**
      * Returns the default <tt>MediaDevice</tt> for the specified media
-     * <tt>type</tt>. In most cases users
+     * <tt>type</tt>.
      *
      * @param mediaType a <tt>MediaType</tt> value indicating the kind of device
      * that we are trying to obtain.

File: src/net/java/sip/communicator/service/neomedia/MediaStream.java
Patch:
@@ -17,7 +17,6 @@
  * stream between exactly two parties. The class reflects one media stream, in
  * the SDP sense of the word. <tt>MediaStream</tt> instances are created through
  * the <tt>openMediaStream()</tt> method of the <tt>MediaService</tt>.
- * <p>
  *
  * @author Emil Ivov
  */

File: src/net/java/sip/communicator/service/neomedia/VideoMediaStream.java
Patch:
@@ -10,7 +10,6 @@
 
 import net.java.sip.communicator.service.protocol.event.*;
 
-
 /**
  * Extends the <tt>MediaStream</tt> interface and adds methods specific to
  * video streaming.

File: src/net/java/sip/communicator/plugin/otr/OtrMetaContactMenu.java
Patch:
@@ -82,7 +82,8 @@ private void createOtrContactMenus(MetaContact metaContact)
         JMenu menu = getMenu();
 
         // Remove any existing OtrContactMenu items.
-        for (int itemIndex = 0, itemCount = menu.getItemCount(); itemIndex < itemCount;)
+        for (int itemIndex = 0, itemCount = menu.getItemCount();
+                itemIndex < itemCount;)
         {
             JMenuItem menuItem = menu.getItem(itemIndex);
 

File: src/net/java/sip/communicator/impl/gui/main/call/MainCallPanel.java
Patch:
@@ -76,6 +76,7 @@ public class MainCallPanel
 
     /**
      * Initializes and constructs this panel.
+     * @param mainFrame the main application window
      */
     public MainCallPanel(MainFrame mainFrame)
     {
@@ -211,7 +212,7 @@ public void actionPerformed(ActionEvent evt)
                         = telephonyContacts.toArray(contactAddressStrings);
 
                     CallManager.createConferenceCall(
-                        protocolProvider, contactAddressStrings);
+                        contactAddressStrings, protocolProvider);
                 }
             }
             else if (!phoneNumberCombo.isComboFieldEmpty())
@@ -276,6 +277,7 @@ public MainFrame getMainFrame()
 
     /**
      * Gets the protocol provider used for making calls.
+     * @return the protocol provider service
      */
     public ProtocolProviderService getCallProvider()
     {

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -278,7 +278,7 @@ private CallJabberImpl createOutgoingCall(String calleeAddress)
      *
      * @return an iterator over all currently active calls.
      */
-    public Iterator getActiveCalls()
+    public Iterator<CallJabberImpl> getActiveCalls()
     {
         return activeCallsRepository.getActiveCalls();
     }

File: src/net/java/sip/communicator/service/protocol/OperationSetBasicTelephony.java
Patch:
@@ -119,7 +119,7 @@ public void hangupCallPeer(CallPeer peer)
      * Returns an iterator over all currently active calls.
      * @return Iterator
      */
-    public Iterator getActiveCalls();
+    public Iterator<? extends Call> getActiveCalls();
 
     /**
      * Sets the mute state of the audio stream being sent to a specific

File: src/net/java/sip/communicator/service/neomedia/MediaDirection.java
Patch:
@@ -79,9 +79,8 @@ public String toString()
      * @return a <tt>MediaDirection</tt> value corresponding to the specified
      * <tt>mediaDirectionName</tt>.
      *
-     * @throws a <tt>java.lang.IllegalArgumentException</tt> in case
-     * <tt>mediaDirectionName</tt> is not a valid or currently supported media
-     * direction.
+     * @throws IllegalArgumentException in case <tt>mediaDirectionName</tt> is
+     * not a valid or currently supported media direction.
      */
     public static MediaDirection parseString(String mediaDirectionName)
         throws IllegalArgumentException

File: src/net/java/sip/communicator/service/neomedia/MediaType.java
Patch:
@@ -61,8 +61,8 @@ public String toString()
      * @return a <tt>MediaType</tt> value corresponding to the specified
      * <tt>mediaTypeName</tt>.
      *
-     * @throws a <tt>java.lang.IllegalArgumentException</tt> in case
-     * <tt>mediaTypeName</tt> is not a valid or currently supported media type.
+     * @throws IllegalArgumentException in case <tt>mediaTypeName</tt> is not a
+     * valid or currently supported media type.
      */
     public static MediaType parseString(String mediaTypeName)
         throws IllegalArgumentException

File: src/net/java/sip/communicator/impl/gui/main/account/NewAccountDialog.java
Patch:
@@ -171,7 +171,7 @@ private void initNetworkList()
 
                 networksList.add(wizard);
 
-                // is it the prefered protocol ?
+                // is it the preferred protocol ?
                 if(preferredWizardName != null
                     && wizard.getClass().getName().equals(preferredWizardName))
                 {

File: src/net/java/sip/communicator/impl/gui/main/chat/filetransfer/SendFileConversationComponent.java
Patch:
@@ -148,6 +148,8 @@ else if (status == FileTransferStatusChangeEvent.IN_PROGRESS)
             {
                 progressBar.setVisible(true);
             }
+            cancelButton.setVisible(true);
+            retryButton.setVisible(false);
         }
         else if (status == FileTransferStatusChangeEvent.COMPLETED)
         {

File: test/net/java/sip/communicator/slick/protocol/jabber/JabberSlickFixture.java
Patch:
@@ -140,7 +140,6 @@ public void setUp()
             = System.getProperty(
                 JabberProtocolProviderServiceLick.CHAT_ROOM_NAME);
 
-
         //find the protocol providers exported for the two accounts
         ServiceReference[] jabberProvider1Refs
             = bc.getServiceReferences(

File: src/net/java/sip/communicator/plugin/otr/OtrActivator.java
Patch:
@@ -310,7 +310,7 @@ public static List<AccountID> getAllAccountIDs()
     }
 
     /**
-     * Get's an {@link AccountID} by it's UID.
+     * Gets an {@link AccountID} by its UID.
      * 
      * @param uid The {@link AccountID} UID.
      * @return The {@link AccountID} with the requested UID or null.

File: src/net/java/sip/communicator/plugin/otr/OtrConfigurator.java
Patch:
@@ -16,7 +16,6 @@
  * OTR Plugin.
  * 
  * @author George Politis
- * 
  */
 class Configurator
 {
@@ -88,7 +87,7 @@ public byte[] getPropertyBytes(String id)
      * @return the <tt>Boolean</tt> value of the property with the specified
      *         name.
      */
-    public Boolean getPropertyBoolean(String id, boolean defaultValue)
+    public boolean getPropertyBoolean(String id, boolean defaultValue)
     {
         return OtrActivator.configService.getBoolean(this.getID(id),
             defaultValue);
@@ -122,7 +121,7 @@ public void setProperty(String id, Object value)
     }
 
     /**
-     * Removed the property with the specified name (
+     * Removes the property with the specified name (
      * {@link ConfigurationService#removeProperty(String)} proxy).
      * 
      * @param id the name of the property to change.

File: src/net/java/sip/communicator/impl/protocol/facebook/ContactGroupFacebookImpl.java
Patch:
@@ -547,7 +547,7 @@ public String getUID()
      */
     static String createNameFromUID(String uid)
     {
-        return uid.substring(0, uid.length() - (UID_SUFFIX.length()));
+        return uid.substring(0, uid.length() - UID_SUFFIX.length());
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/irc/ChatRoomIrcImpl.java
Patch:
@@ -24,7 +24,8 @@
 public class ChatRoomIrcImpl
     implements  ChatRoom
 {
-    private Logger logger = Logger.getLogger(ChatRoomIrcImpl.class);
+    private static final Logger logger
+        = Logger.getLogger(ChatRoomIrcImpl.class);
     
     /**
      * The name of the chat room.

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -283,7 +283,7 @@ public void addChat(ChatPanel chatPanel)
         chatCount ++;
 
         chatPanel.setShown(true);
-        
+
         for (ChatChangeListener l : this.chatChangeListeners)
         {
             l.chatChanged(chatPanel);

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/AdHocConferenceChatSession.java
Patch:
@@ -37,8 +37,7 @@ public class AdHocConferenceChatSession
     private final AdHocChatRoomWrapper chatRoomWrapper;
 
     private final ChatSessionRenderer sessionRenderer;
-    
-    
+
     /**
      * Creates an instance of <tt>AdHocConferenceChatSession</tt>, by specifying
      * the sessionRenderer to be used for communication with the UI and the 

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatSession.java
Patch:
@@ -40,8 +40,9 @@ public class ConferenceChatSession
 
     private final ChatSessionRenderer sessionRenderer;
     
-    private final java.util.List<ChatSessionChangeListener> chatTransportChangeListeners =
-        new Vector<ChatSessionChangeListener>();
+    private final java.util.List<ChatSessionChangeListener>
+        chatTransportChangeListeners
+            = new Vector<ChatSessionChangeListener>();
 
     /**
      * Creates an instance of <tt>ConferenceChatSession</tt>, by specifying the

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListUI.java
Patch:
@@ -18,8 +18,7 @@
 
 /**
  * The <tt>ChatRoomsListPanel</tt> is the panel that contains the
- * <tt>ChatRoomsList</tt>. It is situated in the second tab in the main
- * application window.
+ * <tt>ChatRoomsList</tt>.
  *
  * @author Yana Stamcheva
  */
@@ -31,7 +30,8 @@ public class ChatRoomListUI
 {
     private final JList chatRoomList = new JList();
 
-    private final ChatRoomListModel chatRoomsListModel = new ChatRoomListModel();
+    private final ChatRoomListModel chatRoomsListModel
+        = new ChatRoomListModel();
 
     private final JPanel treePanel = new JPanel(new BorderLayout());
 

File: src/net/java/sip/communicator/impl/contactlist/MetaContactImpl.java
Patch:
@@ -121,7 +121,6 @@ public class MetaContactImpl
 
     /**
      * Creates new meta contact with a newly generated meta contact UID.
-     * @param mclServiceImpl the service that creates the contact.
      */
     MetaContactImpl()
     {
@@ -134,8 +133,8 @@ public class MetaContactImpl
     /**
      * Creates a new meta contact with the specified UID. This constructor
      * MUST ONLY be used when restoring contacts stored in the contactlist.xml.
+     * 
      * @param metaUID the meta uid that this meta contact should have.
-     * @param mclServiceImpl the service that creates the contact.
      * @param details the already stored details for the contact.
      */
     MetaContactImpl(String metaUID, Map<String, List<String>> details)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -128,7 +128,8 @@ public boolean isChatOpenedForContact(MetaContact metaContact)
     /**
      * Returns TRUE if there is an opened <tt>ChatPanel</tt> for the given
      * <tt>AdHocChatRoom</tt>.
-     * @param chatRoomWrapper the <tt>AdHocChatRoomWrapper</tt>, for which the 
+     * 
+     * @param adHocChatRoomWrapper the <tt>AdHocChatRoomWrapper</tt>, for which the 
      * ad-hoc chat is about
      * @return TRUE if there is an opened <tt>ChatPanel</tt> for the given
      * <tt>AdHocChatRoom</tt>

File: src/net/java/sip/communicator/impl/gui/main/chat/FontChooser.java
Patch:
@@ -258,7 +258,7 @@ public void setColor(Color c)
      * Returns the family name of the selected font
      * @return the family name of the selected font
      * 
-     * @see setFontFamily
+     * @see #setFontFamily
      */
     public String getFontFamily()
     {
@@ -269,7 +269,7 @@ public String getFontFamily()
      * Returns the size of the selected font
      * @return the size of the selected font
      * 
-     * @see setFontSize
+     * @see #setFontSize
      */
     public int getFontSize()
     {

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/AdHocChatRoomWrapper.java
Patch:
@@ -48,7 +48,7 @@ public AdHocChatRoomWrapper(AdHocChatRoomProviderWrapper parentProvider,
      * Creates a <tt>ChatRoomWrapper</tt> by specifying the corresponding chat
      * room.
      * 
-     * @param chatRoom the chat room to which this wrapper corresponds.
+     * @param adHocChatRoom the chat room to which this wrapper corresponds.
      */
     public AdHocChatRoomWrapper( AdHocChatRoomProviderWrapper parentProvider,
                             AdHocChatRoom adHocChatRoom)

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/AdHocConferenceChatTransport.java
Patch:
@@ -136,7 +136,7 @@ public boolean allowsTypingNotifications()
      * Sends the given instant message trough this chat transport, by specifying
      * the mime type (html or plain text).
      * 
-     * @param message The message to send.
+     * @param messageText The message to send.
      * @param mimeType The mime type of the message to send: text/html or
      * text/plain.
      */
@@ -299,4 +299,4 @@ public long getMaximumFileLength()
         // TODO Auto-generated method stub
         return 0;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -619,7 +619,7 @@ public void rejectInvitation(  OperationSetMultiUserChat multiUserChatOpSet,
     /**
      * Rejects the given invitation with the specified reason.
      *
-     * @param multiUserChatOpSet the operation set to use for rejecting the
+     * @param multiUserChatAdHocOpSet the operation set to use for rejecting the
      * invitation
      * @param invitation the invitation to reject
      * @param reason the reason for the rejection

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/AdHocChatRoomList.java
Patch:
@@ -75,9 +75,6 @@ public void loadList()
      *
      * @param pps the <tt>ProtocolProviderService</tt> corresponding to the chat
      * server
-     * @param adHocMultiUserChatOperationSet the 
-     * <tt>OperationSetAdHocMultiUserChat</tt> from which we manage ad-hoc chat 
-     * rooms
      */
     public void addChatProvider(ProtocolProviderService pps)
     {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -570,9 +570,9 @@ else if (typingState == OperationSetTypingNotifications.STATE_UNKNOWN)
     /**
      * When a request has been received we show it to the user through the
      * chat session renderer.
+     * 
      * @param event <tt>FileTransferRequestEvent</tt>
-     * @see FileTransferListener#incomingRequestReceived(
-     * FileTransferRequestEvent)
+     * @see FileTransferListener#fileTransferRequestReceived(FileTransferRequestEvent)
      */
     public void fileTransferRequestReceived(FileTransferRequestEvent event)
     {

File: src/net/java/sip/communicator/impl/gui/main/presence/StatusSelectorMenu.java
Patch:
@@ -21,7 +21,6 @@
  * A parent class for all status selector boxes.
  * 
  * @see SimpleStatusMenu
- * @see PresenceStatusSelectorBox
  * @see GlobalStatusSelectorBox
  * 
  * @author Yana Stamcheva

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -2470,9 +2470,9 @@ else if (rtpManager.equals(videoRtpManager))
      * <p>
      * JMF stores this statically, so it only has to be done once.  FMJ does it
      * dynamically (per instance, so it needs to be done for each instance.
-     * <p>
+     * 
      * @param rtpManager The manager with which to register the formats.
-     * @see MediaControl#registerCustomCodecs()
+     * @see EncodingConfiguration#registerCustomCodecs()
      */
     static void registerCustomCodecFormats(RTPManager rtpManager)
     {

File: src/net/java/sip/communicator/impl/media/codec/audio/g729/DecLd8k.java
Patch:
@@ -252,8 +252,8 @@ int decod_ld8k(
     *-------------------------------------------------------*/
 
    if(bfi != 0) {            /* Bad Frame Error Concealment */
-     parm[parm_offset + 0] = (int) (Util.random_g729() & 0x1fff);      /* 13 bits random*/
-     parm[parm_offset + 1]= (int) (Util.random_g729() & 0x000f);      /*  4 bits random */
+     parm[parm_offset + 0] = (Util.random_g729() & 0x1fff);      /* 13 bits random*/
+     parm[parm_offset + 1]= (Util.random_g729() & 0x000f);      /*  4 bits random */
    }
 
    DeAcelp.decod_ACELP(parm[parm_offset + 1], parm[parm_offset + 0], code);

File: src/net/java/sip/communicator/impl/media/codec/audio/g729/Gainpred.java
Patch:
@@ -78,7 +78,7 @@ static float gain_predict(
 
    /* predicted codebook gain */
    gcode0 = pred_code;
-   gcode0 = (float)Math.pow((double)10.0,(double)(gcode0/20.0));   /* predicted gain */
+   gcode0 = (float)Math.pow(10.0, gcode0/20.0);   /* predicted gain */
 
    return gcode0;
 }

File: src/net/java/sip/communicator/impl/media/codec/audio/g729/Ld8k.java
Patch:
@@ -278,7 +278,7 @@ class Ld8k
  * Error threshold taming
  */
 static final float THRESH_ERR =  60000.0f;  
-static final float INV_L_SUBFR = (float) (1.0f/(float)L_SUBFR); /* =0.025 */
+static final float INV_L_SUBFR = (1.0f/(float)L_SUBFR); /* =0.025 */
 /*-------------------------------------------------------------------------
  * gain quantizer  constants
  *-------------------------------------------------------------------------

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/bitstream.java
Patch:
@@ -169,7 +169,7 @@ public int unpack(
                    index+=((((buffer[buffer_pos]) << (pos)) & 0xFF) >>> (8 - bitno));
                    pos=8;
                } else {
-                   index+=(((int)(((buffer[buffer_pos]) << (pos)) & 0xFF)) << (bitno - 8));
+                   index+=(((buffer[buffer_pos] << pos) & 0xFF) << (bitno - 8));
                    pos=8;
                }
                bitno -= BitsLeft;

File: src/net/java/sip/communicator/impl/protocol/jabber/WhiteboardSessionJabberImpl.java
Patch:
@@ -167,7 +167,7 @@ public void join(byte[] password) throws OperationFailedException
 
     /**
      * Returns true if the local user is currently in the white-board session
-     * (after white-boarding one of the {@link #join(String)} methods).
+     * (after white-boarding one of the {@link #join()} methods).
      *
      * @return true if currently we're currently in this white-board and false
      * otherwise.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/MailThreadInfo.java
Patch:
@@ -687,8 +687,6 @@ private String createParticipantNames()
     /**
      * Creates an html description (table rows) of the specified thread.
      *
-     * @param thread the thread that we are to describe.
-     *
      * @return an html description of <tt>thread</tt>
      */
     public String createHtmlDescription()

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetAdHocMultiUserChatMsnImpl.java
Patch:
@@ -320,12 +320,12 @@ public AdHocChatRoom findRoom(String adHocRoomName)
 
     public AdHocChatRoom findRoom(MsnSwitchboard switchboard)
         throws OperationFailedException,
-        OperationNotSupportedException
+               OperationNotSupportedException
     {
         this.assertConnected();
 
-        AdHocChatRoomMsnImpl adHocRoom = (AdHocChatRoomMsnImpl) 
-            this.adHocChatRoomCache.get(String.valueOf(switchboard.hashCode()));
+        AdHocChatRoomMsnImpl adHocRoom
+            = adHocChatRoomCache.get(String.valueOf(switchboard.hashCode()));
 
         if (adHocRoom == null)
         {

File: src/net/java/sip/communicator/impl/protocol/rss/ContactRssImpl.java
Patch:
@@ -349,8 +349,6 @@ public void setPersistent(boolean isPersistent)
      * initialized. This data contains the key identifying the last displayed
      * item, so that upon restart, items that have already been displayed in
      * older sessions don't get displayed again.
-     *
-     * @see #setPersistentData(String)
      */
     public String getPersistentData()
     {

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -513,7 +513,6 @@ protected void initialize(String    sipAddress,
 
     /**
      * Never called.
-     * @see net.java.sip.communicator.impl.protocol.sip.PersistentService#processIOException(IOExceptionEvent)
      */
     public void processIOException(IOExceptionEvent exceptionEvent) {}
 

File: src/net/java/sip/communicator/service/neomedia/MediaService.java
Patch:
@@ -48,8 +48,9 @@ public interface MediaService
      * <tt>MediaDevice</tt> for both capture and playback of media exchanged
      * via the specified <tt>MediaConnector</tt>.
      *
-     * @param the connector that the stream should use for sending and receiving
+     * @param connector the connector that the stream should use for sending and receiving
      * media.
+     * @param device
      *
      * @return the newly created <tt>MediaStream</tt>.
      */

File: src/net/java/sip/communicator/service/neomedia/event/VideoEvent.java
Patch:
@@ -117,7 +117,7 @@ public void consume()
      * Gets the origin of the video this <code>VideoEvent</code> notifies about
      * which is one of {@link #LOCAL} and {@link #REMOTE}.
      *
-     * @return one of {@link LOCAL} and {@link #REMOTE} which specifies the
+     * @return one of {@link #LOCAL} and {@link #REMOTE} which specifies the
      *         origin of the video this <code>VideoEvent</code> notifies about
      */
     public int getOrigin()

File: src/net/java/sip/communicator/service/protocol/OperationSetAdHocMultiUserChat.java
Patch:
@@ -72,7 +72,7 @@ public AdHocChatRoom createAdHocChatRoom(String adHocRoomName,
      * Returns a reference to an  AdHocChatRoom named <tt>adHocRoomName</tt> or 
      * null if no ad-hoc room with the given name exist on the server.
      * <p>
-     * @param adHocRroomName the name of the <tt>AdHocChatRoom</tt> that we're 
+     * @param adHocRoomName the name of the <tt>AdHocChatRoom</tt> that we're 
      * looking for.
      * @return the <tt>AdHocChatRoom</tt> named <tt>adHocRoomName</tt> if it
      * exists, null otherwise.

File: src/net/java/sip/communicator/service/protocol/WhiteboardSession.java
Patch:
@@ -93,7 +93,7 @@ public void removeWhiteboardChangeListener (
 
     /**
      * Returns true if the local user is currently in the whiteboard session
-     * (after whiteboarding one of the {@link #join(String)} methods).
+     * (after whiteboarding one of the {@link #join()} methods).
      *
      * @return true if currently we're currently in this whiteboard and false
      * otherwise.

File: src/net/java/sip/communicator/service/protocol/event/LocalUserAdHocChatRoomPresenceListener.java
Patch:
@@ -21,7 +21,7 @@ public interface LocalUserAdHocChatRoomPresenceListener
      * Called to notify interested parties that a change in our presence in
      * an ad-hoc chat room has occurred. Changes may include us being join,
      * left.
-     * @param _evt the <tt>LocalUserAdHocChatRoomPresenceChangeEvent</tt>
+     * @param evt the <tt>LocalUserAdHocChatRoomPresenceChangeEvent</tt>
      * instance containing the ad-hoc chat room and the type, and reason of the
      * change
      */

File: src/net/java/sip/communicator/service/protocol/event/VideoEvent.java
Patch:
@@ -117,7 +117,7 @@ public void consume()
      * Gets the origin of the video this <code>VideoEvent</code> notifies about
      * which is one of {@link #LOCAL} and {@link #REMOTE}.
      *
-     * @return one of {@link LOCAL} and {@link #REMOTE} which specifies the
+     * @return one of {@link #LOCAL} and {@link #REMOTE} which specifies the
      *         origin of the video this <code>VideoEvent</code> notifies about
      */
     public int getOrigin()

File: src/net/java/sip/communicator/impl/contactlist/MclStorageManager.java
Patch:
@@ -577,9 +577,9 @@ void extractContactsForAccount(String accountID) throws XMLException
         if (!isStarted())
             return;
 
-        // we don't want to receive meta contact events triggerred by ourselves
+        // we don't want to receive meta contact events triggered by ourselves
         // so we stop listening. it is possible but very unlikely that other
-        // events, not triggerred by us are received while we're off the channel
+        // events, not triggered by us are received while we're off the channel
         // but that would be a very bizzare case ..... I guess we got to live
         // with the risk.
         this.mclServiceImpl.removeMetaContactListListener(this);

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -408,7 +408,7 @@ ContactMsnImpl createVolatileContact(MsnContact contact)
         //First create the new volatile contact;
         VolatileContact volatileBuddy =
             new VolatileContact(contact.getId(),
-                                contact.getEmail().getEmailAddress(),
+                                contact.getEmail(),
                                 contact.getDisplayName());
 
         ContactMsnImpl newVolatileContact

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -460,7 +460,7 @@ public void setCurrentChatPanel(ChatPanel chatPanel)
         mainToolBar.changeHistoryButtonsState(chatPanel);
 
         chatPanel.requestFocusInWriteArea();
-        
+
         for (ChatChangeListener l : this.chatChangeListeners)
         {
             l.chatChanged(chatPanel);

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomList.java
Patch:
@@ -82,7 +82,9 @@ public void addChatProvider(ProtocolProviderService pps)
             = new ChatRoomProviderWrapper(pps);
 
         providersList.add(chatRoomProvider);
-
+        
+   
+        
         ConfigurationService configService
             = GuiActivator.getConfigurationService();
 

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -921,7 +921,7 @@ public void serviceChanged(ServiceEvent event)
             logger.info("Handling registration of a new Plugin Component.");
 
             Object component = pluginComponent.getComponent();
-            if (component == null || !(component instanceof Component))
+            if (!(component instanceof Component))
             {
                 logger.error("Plugin Component type is not supported."
                     + "Should provide a plugin in AWT, SWT or Swing.");

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -1207,9 +1207,6 @@ protected void sendInstantMessage()
         }
 
         this.refreshWriteArea();
-
-        //make sure the focus goes back to the write area
-        this.requestFocusInWriteArea();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/mailnotification/MailThreadInfo.java
Patch:
@@ -164,7 +164,7 @@ public String getFirstName()
             String result = names[0];
 
             //return 14 chars max
-            if(result.length() > 15)
+            if(result.length() > 14)
                 result = result.substring(0, 14);
 
             return result;

File: src/net/java/sip/communicator/impl/contactlist/MetaContactGroupImpl.java
Patch:
@@ -834,7 +834,7 @@ public String toString()
     }
 
     /**
-     * Addes the specified group to the list of protocol specific groups
+     * Adds the specified group to the list of protocol specific groups
      * that we're encapsulating in this meta contact group.
      * @param protoGroup the root to add to the groups merged in this meta contact
      * group.

File: src/net/java/sip/communicator/impl/protocol/icq/ServerStoredContactListIcqImpl.java
Patch:
@@ -62,7 +62,7 @@ public class ServerStoredContactListIcqImpl
     /**
      * The root contagroup. The container for all ICQ buddies and groups.
      */
-    private RootContactGroupIcqImpl rootGroup = new RootContactGroupIcqImpl();
+    private final RootContactGroupIcqImpl rootGroup;
 
     /**
      * The joust sim service that deals with server stored information.
@@ -118,6 +118,7 @@ public class ServerStoredContactListIcqImpl
         this.parentOperationSet = parentOperationSet;
 
         this.icqProvider = icqProvider;
+        this.rootGroup = new RootContactGroupIcqImpl(this.icqProvider);
 
         // waiting for the first contact to come
         // to start retreiving the missing nicknames
@@ -688,8 +689,6 @@ public void moveContact(ContactIcqImpl contact,
      */
     void init(  SsiService joustSimSsiService )
     {
-        this.rootGroup.setOwnerProvider(icqProvider);
-
         this.jSimSsiService = joustSimSsiService;
         jSimSsiService.addItemChangeListener(jsimItemChangeListener);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -69,7 +69,7 @@ public class OperationSetPersistentPresenceJabberImpl
      * The server stored contact list that will be encapsulating smack's
      * buddy list.
      */
-    private ServerStoredContactListJabberImpl ssContactList = null;
+    private final ServerStoredContactListJabberImpl ssContactList;
 
     private JabberSubscriptionListener subscribtionPacketListener = null;
 
@@ -91,11 +91,11 @@ public OperationSetPersistentPresenceJabberImpl(
     }
 
     /**
-     * Registers a listener that would receive events upong changes in server
+     * Registers a listener that would receive events upon changes in server
      * stored groups.
      *
      * @param listener a ServerStoredGroupChangeListener impl that would
-     *   receive events upong group changes.
+     *   receive events upon group changes.
      */
     public void addServerStoredGroupChangeListener(ServerStoredGroupListener
         listener)

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -33,7 +33,7 @@ public class ServerStoredContactListMsnImpl
     /**
      * The root group. The container for all msn buddies and groups.
      */
-    private RootContactGroupMsnImpl rootGroup = new RootContactGroupMsnImpl();
+    private final RootContactGroupMsnImpl rootGroup;
 
     /**
      * The operation set that created us and that we could use when dispatching
@@ -44,7 +44,7 @@ public class ServerStoredContactListMsnImpl
     /**
      * The provider that is on top of us.
      */
-    private ProtocolProviderServiceMsnImpl msnProvider = null;
+    private final ProtocolProviderServiceMsnImpl msnProvider;
 
     private MsnMessenger messenger = null;
 
@@ -86,7 +86,7 @@ public class ServerStoredContactListMsnImpl
         this.parentOperationSet = parentOperationSet;
 
         this.msnProvider = provider;
-        rootGroup.setOwnerProvider(provider);
+        this.rootGroup = new RootContactGroupMsnImpl(this.msnProvider);
 
         // listens for provider registered events to set the isInitialized state
         // of the contact list

File: src/net/java/sip/communicator/impl/protocol/yahoo/ServerStoredContactListYahooImpl.java
Patch:
@@ -44,8 +44,7 @@ public class ServerStoredContactListYahooImpl
     /**
      * The root contagroup. The container for all yahoo buddies and groups.
      */
-    private final RootContactGroupYahooImpl rootGroup
-        = new RootContactGroupYahooImpl();
+    private final RootContactGroupYahooImpl rootGroup;
 
     /**
      * The operation set that created us and that we could use when dispatching
@@ -94,7 +93,7 @@ public class ServerStoredContactListYahooImpl
         this.parentOperationSet = parentOperationSet;
 
         this.yahooProvider = provider;
-        rootGroup.setOwnerProvider(provider);
+        this.rootGroup = new RootContactGroupYahooImpl(this.yahooProvider);
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/ContactGroup.java
Patch:
@@ -92,7 +92,7 @@ public interface ContactGroup
 
     /**
      * Returns the protocol provider that this group belongs to.
-     * @return a regerence to the ProtocolProviderService instance that this
+     * @return a reference to the ProtocolProviderService instance that this
      * ContactGroup belongs to.
      */
     public ProtocolProviderService getProtocolProvider();
@@ -114,14 +114,14 @@ public interface ContactGroup
     public boolean isPersistent();
 
     /**
-     * Returns a <tt>String</tt> that uniquely represnets the group inside
+     * Returns a <tt>String</tt> that uniquely represents the group inside
      * the current protocol. The string MUST be persistent (it must not change
      * across connections or runs of the application). In many cases (Jabber,
      * ICQ) the string may match the name of the group as these protocols
      * only allow a single level of contact groups and there is no danger of
      * having the same name twice in the same contact list. Other protocols
      * (no examples come to mind but that doesn't bother me ;) ) may be
-     * supporting mutilple levels of grooups so it might be possible for group
+     * supporting multiple levels of groups so it might be possible for group
      * A and group B to both contain groups named C. In such cases the
      * implementation must find a way to return a unique identifier in this
      * method and this UID should never change for a given group.

File: src/net/java/sip/communicator/plugin/defaultresourcepack/DefaultImagePackImpl.java
Patch:
@@ -76,11 +76,11 @@ public String getDescription()
     private void initResources( ResourceBundle resourceBundle,
                                 Map<String, String> resources)
     {
-        Enumeration colorKeys = resourceBundle.getKeys();
+        Enumeration<String> colorKeys = resourceBundle.getKeys();
 
         while (colorKeys.hasMoreElements())
         {
-            String key = (String) colorKeys.nextElement();
+            String key = colorKeys.nextElement();
             String value = resourceBundle.getString(key);
 
             resources.put(key, value);

File: src/net/java/sip/communicator/plugin/defaultresourcepack/DefaultSettingsPackImpl.java
Patch:
@@ -76,11 +76,11 @@ public String getDescription()
     private void initResources( ResourceBundle resourceBundle,
                                 Map<String, String> resources)
     {
-        Enumeration colorKeys = resourceBundle.getKeys();
+        Enumeration<String> colorKeys = resourceBundle.getKeys();
 
         while (colorKeys.hasMoreElements())
         {
-            String key = (String) colorKeys.nextElement();
+            String key = colorKeys.nextElement();
             String value = resourceBundle.getString(key);
 
             resources.put(key, value);

File: src/net/java/sip/communicator/plugin/defaultresourcepack/DefaultSoundPackImpl.java
Patch:
@@ -76,11 +76,11 @@ public String getDescription()
     private void initResources( ResourceBundle resourceBundle,
                                 Map<String, String> resources)
     {
-        Enumeration colorKeys = resourceBundle.getKeys();
+        Enumeration<String> colorKeys = resourceBundle.getKeys();
 
         while (colorKeys.hasMoreElements())
         {
-            String key = (String) colorKeys.nextElement();
+            String key = colorKeys.nextElement();
             String value = resourceBundle.getString(key);
 
             resources.put(key, value);

File: src/net/java/sip/communicator/service/version/Version.java
Patch:
@@ -12,7 +12,7 @@
  *
  * @author Emil Ivov
  */
-public interface Version extends Comparable
+public interface Version extends Comparable<Version>
 {
     /**
      * Returns the version major of the current SIP Communicator version. In an

File: src/net/java/sip/communicator/impl/protocol/rss/RssFeedReader.java
Patch:
@@ -76,7 +76,7 @@ public RssFeedReader(URL contactRssURL)
     {
         this.rssURL = contactRssURL;
         this.lastItemKey  = null;
-        // Try to retrieve the feed and to complete this instanciation.
+        // Try to retrieve the feed and to complete this instantiation.
         this.retrieveFlow();
     }
 

File: test/net/java/sip/communicator/slick/protocol/generic/TestOperationSetFileTransfer.java
Patch:
@@ -694,7 +694,7 @@ public void testSenderCancelsWhileTransfering()
                          ,fileTransferCreatedEvent.getFileTransfer().getLocalFile()
                          ,receiveFile);
 
-            receiverStatusListener.waitForEvent(8000, 3);
+            receiverStatusListener.waitForEvent(12000, 3);
             assertTrue("Cancel event must be received",
                 receiverStatusListener.contains(FileTransferStatusChangeEvent.CANCELED));
         }

File: src/net/java/sip/communicator/impl/audionotifier/AudioNotifierActivator.java
Patch:
@@ -37,7 +37,7 @@ public class AudioNotifierActivator implements BundleActivator
     /**
      * Called when this bundle is started.
      *
-     * @param bundleContext The execution context of the bundle being started.
+     * @param bContext The execution context of the bundle being started.
      */
     public void start(BundleContext bContext) throws Exception
     {
@@ -79,7 +79,7 @@ public void start(BundleContext bContext) throws Exception
      * Called when this bundle is stopped so the Framework can perform the
      * bundle-specific activities necessary to stop the bundle.
      *
-     * @param bundleContext The execution context of the bundle being stopped.
+     * @param bContext The execution context of the bundle being stopped.
      * @throws Exception If this method throws an exception, the bundle is
      *   still marked as stopped, and the Framework will remove the bundle's
      *   listeners, unregister all services registered by the bundle, and

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryServiceImpl.java
Patch:
@@ -620,7 +620,7 @@ public void setHistoryService(HistoryService historyService)
     /**
      * Remove a configuration service.
      *
-     * @param historyService HistoryService
+     * @param hService HistoryService
      */
     public void unsetHistoryService(HistoryService hService)
     {

File: src/net/java/sip/communicator/impl/contactlist/MetaContactGroupImpl.java
Patch:
@@ -363,7 +363,7 @@ public Iterator<ContactGroup> getContactGroups()
      * Returns a contact group encapsulated by this meta contact group, having
      * the specified groupName and coming from the indicated ownerProvider.
      *
-     * @param grpName1 the name of the contact group who we're looking for.
+     * @param grpName the name of the contact group who we're looking for.
      * @param ownerProvider a reference to the ProtocolProviderService that
      * the contact we're looking for belongs to.
      * @return a reference to a <tt>ContactGroup</tt>, encapsulated by this

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -794,9 +794,9 @@ public void renameMetaContact(MetaContact metaContact, String newDisplayName)
     /**
      * Sets the avatar for <tt>metaContact</tt> to be <tt>newAvatar</tt>.
      * <p>
-     * @param metaContact the <tt>MetaContact</tt> that we are renaming
-     * @param newDisplayName a <tt>String</tt> containing the new display name
-     * for <tt>metaContact</tt>.
+     * @param metaContact the <tt>MetaContact</tt> that change avatar 
+     * @param protoContact the <tt>Contact> that change avatar
+     * @param newAvatar avatar image bytes
      * @throws IllegalArgumentException if <tt>metaContact</tt> is not an
      * instance that belongs to the underlying implementation.
      */

File: src/net/java/sip/communicator/impl/filehistory/FileHistoryServiceImpl.java
Patch:
@@ -766,7 +766,7 @@ public void fileTransferRequestReceived(FileTransferRequestEvent event)
 
     /**
      * New file transfer was created.
-     * @param fileTransfer
+     * @param event fileTransfer
      */
     public void fileTransferCreated(FileTransferCreatedEvent event)
     {

File: src/net/java/sip/communicator/impl/growlnotification/GrowlNotificationActivator.java
Patch:
@@ -49,7 +49,7 @@ public class GrowlNotificationActivator
     /**
      * Initialize and start Growl Notifications Service
      *
-     * @param bundleContext BundleContext
+     * @param bc BundleContext
      * @throws Exception
      */
     public void start(BundleContext bc) throws Exception
@@ -112,4 +112,4 @@ public static ResourceManagementService getResources()
                 ResourceManagementServiceUtils.getService(bundleContext);
         return resourcesService;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/gui/GuiActivator.java
Patch:
@@ -74,7 +74,7 @@ public class GuiActivator implements BundleActivator
     /**
      * Called when this bundle is started.
      *
-     * @param bundleContext The execution context of the bundle being started.
+     * @param bContext The execution context of the bundle being started.
      */
     public void start(BundleContext bContext)
         throws Exception

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -596,7 +596,7 @@ public String getCurrentPhoneNumber()
     /**
      * Changes the phone number currently entered in the phone number field.
      *
-     * @param number the phone number to enter in the phone number field.
+     * @param phoneNumber the phone number to enter in the phone number field.
      */
     public void setCurrentPhoneNumber(String phoneNumber)
     {

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommMenu.java
Patch:
@@ -63,11 +63,11 @@ public SIPCommMenu(String text)
      * @param actionListener The <tt>ActionListener</tt>, which handles the
      * case, when the item is selected.
      */
-    public void addItem(String text, Icon icon, ActionListener actionLstner)
+    public void addItem(String text, Icon icon, ActionListener actionListener)
     {
         JMenuItem item = new JMenuItem(text, icon);
 
-        item.addActionListener(actionLstner);
+        item.addActionListener(actionListener);
 
         this.add(item);
     }
@@ -76,7 +76,6 @@ public void addItem(String text, Icon icon, ActionListener actionLstner)
      * Selects the given item.
      * 
      * @param selectedObject The object to select.
-     * @param icon The icon to select.
      */
     public void setSelected(SelectedObject selectedObject)
     {

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardModel.java
Patch:
@@ -318,7 +318,7 @@ Boolean getBackButtonEnabled()
 
     /**
      * Enables or disables the Back button.
-     * @param newValue <code>true</code> to enable the Back button,
+     * @param enabled <code>true</code> to enable the Back button,
      * <code>false</code> to disable it.
      */
     void setBackButtonEnabled(boolean enabled)
@@ -345,7 +345,7 @@ Boolean getNextFinishButtonEnabled()
 
     /**
      * Enables or disables the Next/Finish button.
-     * @param newValue <code>true</code> to enable the Next/Finish button,
+     * @param enabled <code>true</code> to enable the Next/Finish button,
      * <code>false</code> to disable it.
      */
     void setNextFinishButtonEnabled(boolean enabled)
@@ -373,7 +373,7 @@ Boolean getCancelButtonEnabled()
 
     /**
      * Enables or disables the Cancel button.
-     * @param newValue <code>true</code> to enable the Cancel button,
+     * @param enabled <code>true</code> to enable the Cancel button,
      * <code>false</code> to disable it.
      */
     void setCancelButtonEnabled(boolean enabled)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransferHandler.java
Patch:
@@ -59,7 +59,7 @@ public ChatTransferHandler(ChatPanel chatPanel)
      * data that needs to be imported.
      * <p>
      * @param comp  the component to receive the transfer;
-     * @param transferable     the data to import
+     * @param t the data to import
      * @return  true if the data was inserted into the component and false
      * otherwise
      * @see #importData(TransferHandler.TransferSupport)

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatContact.java
Patch:
@@ -26,8 +26,6 @@ public class MetaContactChatContact
      *
      * @param metaContact the <tt>MetaContact</tt> encapsulating the given
      * <tt>Contact</tt>
-     * @param contact the <tt>Contact</tt> for which this <tt>ChatContact</tt>
-     * is created
      */
     public MetaContactChatContact(MetaContact metaContact)
     {

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatTransport.java
Patch:
@@ -212,7 +212,8 @@ public void sendInstantMessage( String message,
     /**
      * Sends the given sms message trough this chat transport.
      * 
-     * @param message The message to send.
+     * @param phoneNumber phone number of the destination
+     * @param messageText The message to send.
      */
     public void sendSmsMessage(String phoneNumber, String messageText)
         throws Exception

File: src/net/java/sip/communicator/impl/gui/main/chat/SendSmsDialog.java
Patch:
@@ -61,9 +61,9 @@ public class SendSmsDialog
      * <tt>OperationSetSmsMessaging</tt> to be used for sending the message.
      * 
      * @param chatPanel the chat sending the message
-     * @param message the SMS message
-     * @param opSet the <tt>OperationSetSmsMessaging</tt> that will be used to
+     * @param chatTransport the <tt>ChatTransport> that will be used to 
      * send the message
+     * @param message the SMS message
      */
     public SendSmsDialog(   ChatPanel chatPanel,
                             ChatTransport chatTransport,

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomSubjectPanel.java
Patch:
@@ -48,7 +48,7 @@ public class ChatRoomSubjectPanel
      * Creates the panel containing the chat room subject.
      * 
      * @param chatWindow the chat window, where this panel is added
-     * @param chatRoomWrapper the chat room wrapper, from which we obtain the
+     * @param chatSession the chat session
      * chat room subject and the configuration information.
      */
     public ChatRoomSubjectPanel(ChatWindow chatWindow,

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatTransport.java
Patch:
@@ -134,7 +134,7 @@ public boolean allowsTypingNotifications()
      * Sends the given instant message trough this chat transport, by specifying
      * the mime type (html or plain text).
      * 
-     * @param message The message to send.
+     * @param messageText The message to send.
      * @param mimeType The mime type of the message to send: text/html or
      * text/plain.
      */
@@ -298,4 +298,4 @@ public Object getDescriptor()
     {
         return chatRoom;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -104,7 +104,6 @@ public class HistoryWindow
 
     /**
      * Creates an instance of the <tt>HistoryWindow</tt>.
-     * @param mainFrame the main application window
      * @param historyContact the <tt>MetaContact</tt> or the <tt>ChatRoom</tt>
      */
     public HistoryWindow(Object historyContact)

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomList.java
Patch:
@@ -75,8 +75,6 @@ public void loadList()
      *
      * @param pps the <tt>ProtocolProviderService</tt> corresponding to the chat
      * server
-     * @param multiUserChatOperationSet the <tt>OperationSetMultiUserChat</tt>
-     * from which we manage chat rooms
      */
     public void addChatProvider(ProtocolProviderService pps)
     {

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListDialog.java
Patch:
@@ -23,7 +23,7 @@
  * chat rooms, etc.
  * 
  * @author Yana Stamcheva
- * @authro Lubomir Marinov
+ * @author Lubomir Marinov
  */
 public class ChatRoomListDialog
     extends SIPCommDialog

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomRightButtonMenu.java
Patch:
@@ -46,7 +46,6 @@ public class ChatRoomRightButtonMenu
 
     /**
      * Creates an instance of <tt>ChatRoomsListRightButtonMenu</tt>.
-     * @param mainFrame the main application window
      * @param chatRoomWrapper the chat room wrapper, corresponding to the
      * selected chat room
      */

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomServerRightButtonMenu.java
Patch:
@@ -41,8 +41,7 @@ public class ChatRoomServerRightButtonMenu
     /**
      * Creates an instance of <tt>ChatRoomsListRightButtonMenu</tt>.
      * 
-     * @param mainFrame the main application window
-     * @param protocolProvider the protocol provider corresponding to the multi
+     * @param chatRoomProvider the wrapper protocol provider corresponding to the multi
      * user chat server
      */
     public ChatRoomServerRightButtonMenu(

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/CreateChatRoomDialog.java
Patch:
@@ -47,8 +47,7 @@ public class CreateChatRoomDialog
      * Creates an instance of <tt>CreateChatRoomDialog</tt> that represents a dialog
      * that adds a new chat room to an already existing server.
      * 
-     * @param mainFrame The <tt>MainFrame</tt> parent window.
-     * @param pps The <tt>ProtocolProviderService</tt>.
+     * @param provider The <tt>ChatRoomProviderWrapper</tt>.
      */
     public CreateChatRoomDialog(ChatRoomProviderWrapper provider)
     {

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/ChatRoomAuthenticationWindow.java
Patch:
@@ -62,7 +62,6 @@ public class ChatRoomAuthenticationWindow
 
     /**
      * Creates an instance of the <tt>LoginWindow</tt>.
-     * @param mainFrame the parent <tt>MainFrame</tt> window.
      * @param chatRoom the chat room for which we're authenticating
      */
     public ChatRoomAuthenticationWindow(ChatRoomWrapper chatRoom)

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomDialog.java
Patch:
@@ -45,8 +45,7 @@ public class JoinChatRoomDialog
     /**
      * Creates an instance of <tt>JoinChatRoomDialog</tt>.
      * 
-     * @param mainFrame the <tt>MainFrame</tt> parent window
-     * @param pps the <tt>ProtocolProviderService</tt>, which will be the chat
+     * @param provider the <tt>ChatRoomProviderWrapper</tt>, which will be the chat
      * server for the newly created chat room
      */
     public JoinChatRoomDialog(ChatRoomProviderWrapper provider)
@@ -120,4 +119,4 @@ public void showDialog()
 
         searchPanel.requestFocusInField();
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomWizardPage1.java
Patch:
@@ -41,8 +41,8 @@ public class JoinChatRoomWizardPage1
      * @param wizard the parent wizard container
      * @param joinChatRoom the object that will collect the information through
      * the wizard 
-     * @param protocolProvidersList The list of available installed 
-     * <tt>ProtocolProviderServices</tt>, from which the user could select.
+     * @param chatRoomProviders The list of available installed 
+     * <tt>ChatRoomProviderWrapper</tt>, from which the user could select.
      */
     public JoinChatRoomWizardPage1(
         WizardContainer wizard,
@@ -149,4 +149,4 @@ public void commitPage()
     public void pageBack()
     {
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/SearchChatRoomPanel.java
Patch:
@@ -61,8 +61,7 @@ public SearchChatRoomPanel(WizardContainer wizardContainer)
     /**
      * Creates an instance of <tt>SearchChatRoomPanel</tt>.
      * 
-     * @param parentWindow the window containing this panel
-     * @param protocolProvider the protocol provider corresponding to the
+     * @param provider the chat room provider wrapper corresponding to the
      * account for which the search panel is created
      */
     public SearchChatRoomPanel(ChatRoomProviderWrapper provider)
@@ -209,7 +208,7 @@ public void requestFocusInField()
      * Sets the protocol provider that have been chosen by user on the first
      * page of the join chat room wizard.
      * 
-     * @param protocolProvider the protocol provider for which we'd search a
+     * @param provider the chat room provider wrapper for which we'd search a
      * chat room
      */
     public void setChatRoomProvider(ChatRoomProviderWrapper provider)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -570,7 +570,7 @@ else if (typingState == OperationSetTypingNotifications.STATE_UNKNOWN)
     /**
      * When a request has been received we show it to the user through the
      * chat session renderer.
-     * 
+     * @param event <tt>FileTransferRequestEvent</tt>
      * @see FileTransferListener#incomingRequestReceived(
      * FileTransferRequestEvent)
      */

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListTransferHandler.java
Patch:
@@ -43,7 +43,7 @@ public ContactListTransferHandler(DefaultContactList contactList)
      * data that needs to be imported.
      * <p>
      * @param comp  the component to receive the transfer;
-     * @param transferable     the data to import
+     * @param t the data to import
      * @return  true if the data was inserted into the component and false
      * otherwise
      * @see #importData(TransferHandler.TransferSupport)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactWizardPage2.java
Patch:
@@ -32,8 +32,6 @@ public class AddContactWizardPage2
      * @param wizard the parent wizard, where this page is contained
      * @param newContact An object that collects all user choices through the
      * wizard.
-     * @param groupsList The list of all <tt>MetaContactGroup</tt>s, from which
-     * the user could select.
      */
     public AddContactWizardPage2(   AddContactWizard wizard, 
                                     NewContact newContact)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/SelectGroupPanel.java
Patch:
@@ -60,8 +60,6 @@ public class SelectGroupPanel
      * @param wizard the wizard where this panel is contained
      * @param newContact An object that collects all user choices through the
      * wizard.
-     * @param groupsList The list of all <tt>MetaContactGroup</tt>s, from which
-     * the user could select.
      */
     public SelectGroupPanel(AddContactWizard wizard,
                             NewContact newContact)

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -55,8 +55,6 @@ public class PresenceStatusMenu
      *
      * @param mainFrame The main application window.
      * @param protocolProvider The protocol provider.
-     * @param accountIndex If we have more than one account for a protocol, each
-     *            account has an index.
      */
     public PresenceStatusMenu(  MainFrame mainFrame,
                                 ProtocolProviderService protocolProvider)

File: src/net/java/sip/communicator/impl/gui/utils/ConfigurationManager.java
Patch:
@@ -565,7 +565,7 @@ public static String getSendFileLastDir()
     /**
      * Sets the transparency value for all transparent windows.
      * 
-     * @param the transparency value for all transparent windows.
+     * @param transparency the transparency value for all transparent windows.
      */
     public static void setWindowTransparency(int transparency)
     {
@@ -734,7 +734,7 @@ public static void setChatWriteAreaSize(int size)
      * Updates the "SEND_FILE_LAST_DIR"
      * property through the <tt>ConfigurationService</tt>.
      * 
-     * @param size the new size to set
+     * @param lastDir last download directory
      */
     public static void setSendFileLastDir(String lastDir)
     {

File: src/net/java/sip/communicator/impl/gui/utils/Constants.java
Patch:
@@ -355,7 +355,8 @@ public static void loadAdiumStyle(){
 
     /**
      * Temporary method to load the css style used in the chat window.
-     * @param style
+     * @param styleSheet style sheet
+     * @param defaultFont default font
      */
     public static void loadSimpleStyle(StyleSheet styleSheet, Font defaultFont)
     {

File: src/net/java/sip/communicator/impl/gui/utils/NotificationManager.java
Patch:
@@ -162,7 +162,7 @@ public static void fireNotification(String eventType,
      * Fires a chat message notification for the given event type through the
      * <tt>NotificationService</tt>.
      * 
-     * @param contact the chat contact to which the chat message corresponds;
+     * @param chatContact the chat contact to which the chat message corresponds;
      * the chat contact could be a Contact or a ChatRoom.
      * @param eventType the event type for which we fire a notification
      * @param messageTitle the title of the message

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -3399,7 +3399,7 @@ public void dispose()
      * Sets a <tt>SessionCreatorCallback</tt> that will listen for
      * security events.
      *
-     * @param securityCallBack the <tt>SessionCreatorCallback</tt> to
+     * @param securityCallback the <tt>SessionCreatorCallback</tt> to
      * set
      */
     public void setSessionCreatorCallback(

File: src/net/java/sip/communicator/impl/media/codec/audio/g729/Util.java
Patch:
@@ -181,7 +181,7 @@ static void fwrite(short[] data, int length, OutputStream fp)
  * @param data
  * @param length
  * @param fp
- * @return
+ * @return length of resulting data array
  * @throws java.io.IOException
  */
 static int fread(short[] data, int length, InputStream fp)

File: src/net/java/sip/communicator/impl/media/transform/srtp/SRTPTransformEngine.java
Patch:
@@ -54,7 +54,6 @@ public class SRTPTransformEngine
      * @param masterSalt the master salt key
      * @param srtpPolicy SRTP policy
      * @param srtcpPolicy SRTCP policy
-     * @param cryptoProvider cryptography services provider
      */
     public SRTPTransformEngine(byte[] masterKey, byte[] masterSalt,
                                SRTPPolicy srtpPolicy, SRTPPolicy srtcpPolicy)

File: src/net/java/sip/communicator/impl/metahistory/MetaHistoryServiceImpl.java
Patch:
@@ -396,7 +396,7 @@ public Collection<Object> findByKeyword(String[] services,
      * Returns all the records having the given keywords
      *
      * @param services the services classnames we will query
-     * @param contact CallPeer address(String),
+     * @param descriptor CallPeer address(String),
      *  MetaContact or ChatRoom.
      * @param keywords keyword
      * @return Collection sorted result that conists of records returned from

File: src/net/java/sip/communicator/impl/protocol/facebook/ContactFacebookImpl.java
Patch:
@@ -119,7 +119,7 @@ public String getAddress()
      * 
      * @return a String that can be used for referring to this contact when
      *         interacting with the user.
-     * @Fixme should be facebook "name"
+     * FIXME should be facebook "name"
      */
     public String getDisplayName()
     {
@@ -155,8 +155,6 @@ private void updateContactInfo()
     /**
      * update the user information we just got from the server. so this data
      * shouldn't be modified manually.
-     * 
-     * @param newInfo
      */
     public FacebookUser getContactInfo()
     {

File: src/net/java/sip/communicator/impl/protocol/facebook/FacebookAdapter.java
Patch:
@@ -901,7 +901,7 @@ public void setStatusMessage(String statusMsg)
      * Pause the client.<br>
      * Ensure that initialize() can resume httpclient
      *
-     * @fixme logout first
+     * FIXME logout first
      */
     public void pause()
     {

File: src/net/java/sip/communicator/impl/protocol/facebook/OperationSetBasicInstantMessagingFacebookImpl.java
Patch:
@@ -180,8 +180,7 @@ public void run()
     /**
      * Invoked by the facebook adapter when we got messages from the server.
      * 
-     * @param message
-     * @param from
+     * @param fbmsg message received
      */
     public void receivedInstantMessage(FacebookMessage fbmsg)
     {

File: src/net/java/sip/communicator/impl/protocol/facebook/OperationSetTypingNotificationsFacebookImpl.java
Patch:
@@ -29,9 +29,6 @@ public class OperationSetTypingNotificationsFacebookImpl
      * @param provider a ref to the <tt>ProtocolProviderServiceImpl</tt> that
      *            created us and that we'll use for retrieving the underlying
      *            aim connection.
-     * @param opSetPersPresence the currently valid
-     *            <tt>OperationSetPersistentPresenceFacebookImpl</tt>
-     *            instance.
      */
     OperationSetTypingNotificationsFacebookImpl(
         ProtocolProviderServiceFacebookImpl provider)

File: src/net/java/sip/communicator/impl/protocol/facebook/ProtocolProviderFactoryFacebookImpl.java
Patch:
@@ -107,8 +107,6 @@ public AccountID installAccount(
      * accounts. Note that if the given accountID doesn't correspond to any
      * registered account this method would do nothing.
      * 
-     * @param accountID the user identifier uniquely representing the newly
-     *            created account within the protocol namespace.
      * @param accountProperties a set of protocol (or implementation) specific
      *            properties defining the new account.
      * 

File: src/net/java/sip/communicator/impl/protocol/gibberish/MessageGibberishImpl.java
Patch:
@@ -11,7 +11,7 @@
  * Very simple message implementation for the Gibberish protocol.
  * 
  * @author Emil Ivov
- * @authro Lubomir Marinov
+ * @author Lubomir Marinov
  */
 public class MessageGibberishImpl
     extends AbstractMessage

File: src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolProviderFactoryGibberishImpl.java
Patch:
@@ -80,8 +80,6 @@ public AccountID installAccount( String userIDStr,
      * accounts. Note that if the given accountID doesn't correspond to any
      * registered account this method would do nothing.
      *
-     * @param accountID the user identifier uniquely representing the newly
-     * created account within the protocol namespace.
      * @param accountProperties a set of protocol (or implementation) specific
      * properties defining the new account.
      * 

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetFileTransferIcqImpl.java
Patch:
@@ -46,7 +46,7 @@ public class OperationSetFileTransferIcqImpl
 
     /**
      * Create a new FileTransfer OperationSet over the specified Icq provider
-     * @param provider
+     * @param icqProvider ICQ protocol provider service
      */
     public OperationSetFileTransferIcqImpl(
         ProtocolProviderServiceIcqImpl icqProvider)
@@ -343,7 +343,7 @@ void fireFileTransferRequestCanceled(FileTransferRequestEvent event)
     /**
      * Delivers the file transfer to all registered listeners.
      *
-     * @param fileTransfer the <tt>FileTransfer</tt> that we'd like delivered to
+     * @param event the <tt>FileTransferEvent</tt> that we'd like delivered to
      * all registered file transfer listeners.
      */
     void fireFileTransferCreated(FileTransferCreatedEvent event)

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetMultiUserChatIcqImpl.java
Patch:
@@ -222,7 +222,7 @@ public List<ChatRoom> getCurrentlyJoinedChatRooms()
     * Returns a list of the names of all chat rooms that <tt>contact</tt> is
     * currently a  member of.
     *
-    * @param contact the contact whose current ChatRooms we will be
+    * @param chatRoomMember the contact whose current ChatRooms we will be
     *   querying.
     * @return a list of <tt>String</tt> indicating the names of  the chat rooms
     * that <tt>contact</tt> has joined and is currently active in.

File: src/net/java/sip/communicator/impl/protocol/icq/ServerStoredContactListIcqImpl.java
Patch:
@@ -418,7 +418,7 @@ public ContactIcqImpl findContactByScreenName(String screenName)
      * Returns the Contact with the specified screenname (or icq UIN) or null if
      * no such screenname was found.
      *
-     * @param screenName the screen name (or ICQ UIN) of the contact to find.
+     * @param buddy the buddy (or ICQ UIN) of the contact to find.
      * @return the <tt>Contact</tt> carrying the specified
      * <tt>screenName</tt> or <tt>null</tt> if no such contact exits.
      */

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -1741,7 +1741,7 @@ public boolean isPersistent()
     /**
      * Finds the member of this chat room corresponding to the given nick name.
      * 
-     * @param nickName the nick name to search for.
+     * @param jabberID the nick name to search for.
      * @return the member of this chat room corresponding to the given nick name.
      */
     public ChatRoomMemberJabberImpl findMemberForNickName(String jabberID)

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactJabberImpl.java
Patch:
@@ -129,7 +129,7 @@ byte[] getImage(boolean retrieveIfNecessary)
     /**
      *  Set the image of the contact
      *
-     *  @param the bytes of the image that we'd like to set.
+     *  @param imgBytes the bytes of the image that we'd like to set.
      */
     void setImage(byte[] imgBytes)
     {

File: src/net/java/sip/communicator/impl/protocol/jabber/IncomingFileTransferRequestJabberImpl.java
Patch:
@@ -60,8 +60,6 @@ public class IncomingFileTransferRequestJabberImpl
      * @param jabberProvider the protocol provider
      * @param fileTransferOpSet file transfer operation set
      * @param fileTransferRequest the request coming from the Jabber protocol
-     * @param thumbnailCid the content-ID used to match the thumbnail that
-     * would be send after this request is created.
      */
     public IncomingFileTransferRequestJabberImpl(
         ProtocolProviderServiceJabberImpl jabberProvider,

File: src/net/java/sip/communicator/impl/protocol/jabber/UriHandlerJabberImpl.java
Patch:
@@ -83,7 +83,7 @@ public class UriHandlerJabberImpl
      * URIs by passing them to the providers registered by <tt>protoFactory</tt>
      * .
      *
-     * @param parentProvider the provider that created us.
+     * @param protoFactory the provider that created us.
      *
      * @throws NullPointerException if <tt>protoFactory</tt> is <tt>null</tt>.
      */

File: src/net/java/sip/communicator/impl/protocol/jabber/WhiteboardSessionJabberImpl.java
Patch:
@@ -621,9 +621,7 @@ public void deleteWhiteboardObject(WhiteboardObject obj)
     }
 
     /**
-     * Sends the <tt>message</tt> to the destination indicated by the
-     * <tt>to</tt> contact.
-     * @param to the <tt>Contact</tt> to send <tt>message</tt> to
+     * Sends the <tt>message</tt> to the destination.
      * @param message the <tt>Message</tt> to send.
      * @throws java.lang.IllegalStateException if the underlying stack is
      * not registered and initialized.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/whiteboard/WhiteboardObjectCircleJabberImpl.java
Patch:
@@ -174,7 +174,7 @@ public void setFill (boolean fill)
      * must be encoded with standard RGB encoding: bits 24-31 are alpha, 16-23
      * are red, 8-15 are green, 0-7 are blue.
      *
-     * @param bgColor the color that we'd like to set for the background of this
+     * @param backColor the color that we'd like to set for the background of this
      * <tt>WhiteboardObject</tt> (using standard RGB encoding).
      */
     public void setBackgroundColor (int backColor)
@@ -217,4 +217,4 @@ public String toXML ()
 
         return s;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/protocol/msn/IncomingFileTransferRequestMsnImpl.java
Patch:
@@ -46,7 +46,7 @@ public class IncomingFileTransferRequestMsnImpl
     /**
      * Constructor
      *
-     * @param fileTransfer msn file transfer request that was received
+     * @param incomingFileTransfer MSN file transfer request that was received
      */
     public IncomingFileTransferRequestMsnImpl(
         OperationSetFileTransferMsnImpl fileTransferOpSet,

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetFileTransferMsnImpl.java
Patch:
@@ -45,7 +45,7 @@ public class OperationSetFileTransferMsnImpl
 
     /**
      * Create a new FileTransfer OperationSet over the specified Msn provider
-     * @param provider
+     * @param msnProvider MSN protocol provider service
      */
     public OperationSetFileTransferMsnImpl(
         ProtocolProviderServiceMsnImpl msnProvider)
@@ -265,7 +265,7 @@ void fireFileTransferRequestCanceled(FileTransferRequestEvent event)
     /**
      * Delivers the file transfer to all registered listeners.
      *
-     * @param fileTransfer the <tt>FileTransfer</tt> that we'd like delivered to
+     * @param event the <tt>FileTransferEvent</tt> that we'd like delivered to
      * all registered file transfer listeners.
      */
     void fireFileTransferCreated(FileTransferCreatedEvent event)

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetMultiUserChatMsnImpl.java
Patch:
@@ -281,7 +281,7 @@ public List<ChatRoom> getCurrentlyJoinedChatRooms()
      * Returns a list of the names of all chat rooms that <tt>contact</tt> is
      * currently a member of.
      * 
-     * @param contact the contact whose current ChatRooms we will be querying.
+     * @param chatRoomMember the contact whose current ChatRooms we will be querying.
      * @return a list of <tt>String</tt> indicating the names of the chat rooms
      *         that <tt>contact</tt> has joined and is currently active in.
      * 

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -400,7 +400,7 @@ public void addContact(final ContactGroupMsnImpl parent, final String id)
      * also create (if necessary) a group for volatile contacts that would not
      * be added to the server stored contact list. This method would have no
      * effect on the server stored contact list.
-     * @param id the address of the contact to create.
+     * @param contact the address of the contact to create.
      * @return the newly created volatile <tt>ContactImpl</tt>
      */
     ContactMsnImpl createVolatileContact(MsnContact contact)

File: src/net/java/sip/communicator/impl/protocol/msn/mail/utils/MimeUtility.java
Patch:
@@ -103,7 +103,7 @@ public static String decodeText(String etext)
   /**
    * Decodes the specified string using the RFC 2047 rules for parsing an
    * "encoded-word".
-   * @param eword the possibly encoded value
+   * @param text the possibly encoded value
    * @exception Exception if the string is not an encoded-word
    * @exception UnsupportedEncodingException if the decoding failed
    */

File: src/net/java/sip/communicator/impl/protocol/rss/ContactRssImpl.java
Patch:
@@ -84,8 +84,6 @@ public class ContactRssImpl
      * as a name and identifier.
      *
      * @param rssURL the URL of the rss feed that this contact will be wrapping.
-     * @param rssFeedReader the feed reader that we'll be using to retrieve
-     * the rss flow associated with this contact.
      * @param parentProvider the provider that created us.
      */
     public ContactRssImpl(String contactID,
@@ -236,7 +234,7 @@ byte[] getImage(boolean retrieveIfNecessary)
     /**
      *  Set the image of the contact.
      *
-     * @param the bytes of the image that we'd like to set.
+     * @param imgBytes the bytes of the image that we'd like to set.
      */
     void setImage(byte[] imgBytes)
     {

File: src/net/java/sip/communicator/impl/protocol/rss/MessageRssImpl.java
Patch:
@@ -11,7 +11,7 @@
  * Very simple message implementation for the Rss protocol.
  * 
  * @author Emil Ivov
- * @authro Lubomir Marinov
+ * @author Lubomir Marinov
  */
 public class MessageRssImpl
     extends AbstractMessage

File: src/net/java/sip/communicator/impl/protocol/rss/RssFeedReader.java
Patch:
@@ -135,7 +135,6 @@ private void retrieveFlow()
      * Returns the textual representation of the feed's items with regard to the
      * key of the last item shown to the user. The items are sorted in reverse
      * chronological order, if possible.
-     * @param itemKey key identifying the last item retrieved.
      * @return textual representation of the feed items.
      */
     public synchronized String getNewFeeds()

File: src/net/java/sip/communicator/impl/protocol/sip/CallPeerSipImpl.java
Patch:
@@ -474,7 +474,8 @@ public void securityOff(int sessionType)
      * information coming from the encryption protocol.
      *
      * @param messageType the type of the message.
-     * @param message the message
+     * @param i18nMessage the message
+     * @param severity severity level
      */
     public void securityMessage( String messageType,
                                     String i18nMessage,

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -345,8 +345,6 @@ public void unregister()
      * about to create
      * @param accountID the identifier of the account that this protocol
      * provider represents.
-     * @param isInstall indicates if this initialization is made due to a new
-     * account installation or just an existing account loading
      *
      * @throws OperationFailedException with code INTERNAL_ERROR if we fail
      * initializing the SIP Stack.

File: src/net/java/sip/communicator/impl/protocol/sip/SipLogger.java
Patch:
@@ -50,7 +50,7 @@ public void logStackTrace(int traceLevel)
 	/**
      * Get the line count in the log stream.
      *
-     * @return
+     * @return line count
      */
 	public int getLineCount()
     {
@@ -230,4 +230,4 @@ public void logException(Exception ex)
     }
 
     public void setSipStack(SipStack sipStack) {}
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/protocol/sip/UriHandlerSipImpl.java
Patch:
@@ -77,7 +77,7 @@ public class UriHandlerSipImpl
      * URIs by passing them to the providers registered by <tt>protoFactory</tt>
      * .
      * 
-     * @param parentProvider the provider that created us.
+     * @param protoFactory the provider that created us.
      * 
      * @throws NullPointerException if <tt>protoFactory</tt> is <tt>null</tt>.
      */

File: src/net/java/sip/communicator/impl/protocol/yahoo/ChatRoomMemberYahooImpl.java
Patch:
@@ -50,7 +50,7 @@ public class ChatRoomMemberYahooImpl implements ChatRoomMember
     * Creates a yahoo chat room member with the specified containing chat room
     * parent.
     * 
-    * @param containingChatRoom
+    * @param chatRoom
     *            the room that this <tt>ChatRoomMemberYahooImpl</tt> is a
     *            member of.
     * @param nickName

File: src/net/java/sip/communicator/impl/protocol/yahoo/MessageYahooImpl.java
Patch:
@@ -12,7 +12,7 @@
  * message only supports test contents and no binary data.
  * 
  * @author Damian Minkov
- * @authro Lubomir Marinov
+ * @author Lubomir Marinov
  */
 public class MessageYahooImpl
     extends AbstractMessage

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetFileTransferYahooImpl.java
Patch:
@@ -198,7 +198,7 @@ else if (!yahooProvider.isRegistered())
     /**
      * Delivers the file transfer to all registered listeners.
      *
-     * @param fileTransfer the <tt>FileTransfer</tt> that we'd like delivered to
+     * @param event the <tt>FileTransferEvent</tt> that we'd like delivered to
      * all registered file transfer listeners.
      */
     void fireFileTransferCreated(FileTransferCreatedEvent event)

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetMultiUserChatYahooImpl.java
Patch:
@@ -218,7 +218,7 @@ public List<ChatRoom> getCurrentlyJoinedChatRooms()
     * Returns a list of the names of all chat rooms that <tt>contact</tt> is
     * currently a member of.
     * 
-    * @param contact
+    * @param chatRoomMember
     *            the contact whose current ChatRooms we will be querying.
     * @return a list of <tt>String</tt> indicating the names of the chat rooms
     *         that <tt>contact</tt> has joined and is currently active in.

File: src/net/java/sip/communicator/impl/protocol/yahoo/ServerStoredContactListYahooImpl.java
Patch:
@@ -800,7 +800,7 @@ private YahooGroup findGroup(String name)
 
     /**
      * Process incoming authorization requests.
-     * @param e the event to process.
+     * @param ev the event to process.
      */
     void processAuthorizationRequest(SessionAuthorizationEvent ev)
     {

File: src/net/java/sip/communicator/plugin/accountinfo/AccountInfoPanel.java
Patch:
@@ -38,8 +38,6 @@ public class AccountInfoPanel
      * Constructs a frame with an AccuontInfoAccountPanel to display all
      * registered accounts on the left, and an information interface,
      * AccountDetailsPanel, on the right.
-     * 
-     * @param metaContact
      */
     public AccountInfoPanel()
     {

File: src/net/java/sip/communicator/plugin/dictaccregwizz/StrategiesList.java
Patch:
@@ -122,7 +122,7 @@ public ListModel()
         
         /**
          * Stores the strategies into this model
-         * @param data the strategies list
+         * @param strategies the strategies list
          */
         public void setStrategies(List<Strategy> strategies)
         {

File: src/net/java/sip/communicator/plugin/dictaccregwizz/ThreadManager.java
Patch:
@@ -67,7 +67,7 @@ public void cancel()
     
     /**
      * Wait for the searching thread to stop
-     * @return
+     * @return true if success, false otherwise
      */
     public boolean waitThread()
     {

File: src/net/java/sip/communicator/plugin/facebookaccregwizz/FirstWizardPage.java
Patch:
@@ -68,8 +68,6 @@ public class FirstWizardPage
 
     /**
      * Creates an instance of <tt>FirstWizardPage</tt>.
-     * @param registration the <tt>FacebookAccountRegistration</tt>, where
-     * all data through the wizard are stored
      * @param wizard the parent wizard
      */
     public FirstWizardPage(FacebookAccountRegistrationWizard wizard)

File: src/net/java/sip/communicator/plugin/generalconfig/ConfigurationManager.java
Patch:
@@ -435,11 +435,11 @@ public static void setHistoryLoggingEnabled(
     }
     
     /**
-     * Updates the "isHistoryLoggingEnabled" property through the
+     * Updates the "isHistoryShown" property through the
      * <tt>ConfigurationService</tt>.
      * 
-     * @param isHistoryLoggingEnabled indicates if the history logging is
-     * enabled.
+     * @param isHistoryShown indicates if the message history is
+     * shown
      */
     public static void setHistoryShown(boolean isHistoryShown)
     {

File: src/net/java/sip/communicator/plugin/generalconfig/Resources.java
Patch:
@@ -50,7 +50,7 @@ public static String getSettingsString(String key)
 
     /**
      * Loads an image from a given image identifier.
-     * @param imageID The identifier of the image.
+     * @param imageId The identifier of the image.
      * @return The image for the given identifier.
      */
     public static byte[] getImage(String imageId)

File: src/net/java/sip/communicator/plugin/gibberishaccregwizz/FirstWizardPage.java
Patch:
@@ -62,8 +62,6 @@ public class FirstWizardPage
 
     /**
      * Creates an instance of <tt>FirstWizardPage</tt>.
-     * @param registration the <tt>GibberishAccountRegistration</tt>, where
-     * all data through the wizard are stored
      * @param wizard the parent wizard
      */
     public FirstWizardPage(GibberishAccountRegistrationWizard wizard)

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/GoogleTalkAccountRegistrationWizard.java
Patch:
@@ -186,7 +186,7 @@ public ProtocolProviderService signin(String userName, String password)
      * 
      * @param providerFactory the ProtocolProviderFactory which will create
      * the account
-     * @param user the user identifier
+     * @param userName the user identifier
      * @param passwd the password
      * @return the <tt>ProtocolProviderService</tt> for the new account.
      */

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -181,7 +181,7 @@ public ProtocolProviderService signin(String userName, String password)
      *
      * @param providerFactory the ProtocolProviderFactory which will create
      * the account
-     * @param user the user identifier
+     * @param userName the user identifier
      * @param passwd the password
      * @return the <tt>ProtocolProviderService</tt> for the new account.
      */

File: src/net/java/sip/communicator/plugin/notificationconfiguration/SoundFilter.java
Patch:
@@ -20,7 +20,7 @@ public class SoundFilter
     /**
      * Method which describes differents permits extensions and defines which file or
      * directory will be displayed in the filechoser.
-     * @param File file for the test
+     * @param f file for the test
      * @return boolean true if the File is a Directory or a sound file. And
      * return false in the other cases.
      */

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistration.java
Patch:
@@ -175,7 +175,7 @@ public String getProxyPort()
     /**
      * Sets the identifier of the sip registration account.
      *
-     * @param uin the identifier of the sip registration account.
+     * @param id the identifier of the sip registration account.
      */
     public void setUserID(String id)
     {

File: src/net/java/sip/communicator/plugin/updatechecker/UpdateCheckActivator.java
Patch:
@@ -34,7 +34,7 @@
  * Activates the UpdateCheck plugin
  * 
  * @author Damian Minkov
- * @authod Lubomir Marinov
+ * @author Lubomir Marinov
  */
 public class UpdateCheckActivator
     implements BundleActivator

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardSessionManager.java
Patch:
@@ -120,7 +120,6 @@ public void run()
      * @param wbSession the white-board session, to which the object would be
      * send
      * @param ws WhiteboardShape to convert and send
-     * @param c contact
      * @return WhiteboardObject sent
      */
     public WhiteboardObject sendWhiteboardObject (  WhiteboardSession wbSession,

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShape.java
Patch:
@@ -268,7 +268,6 @@ public void drawSelectedPoint ( Graphics g,
     /**
      * Translates the shape point at p
      *
-     * @param p point position
      * @param deltaX x coord
      * @param deltaY y coord
      */

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapeCircle.java
Patch:
@@ -239,7 +239,6 @@ public void translate (double deltaX, double deltaY)
     /**
      * Translates a point from the shape
      *
-     * @param p point position
      * @param deltaX x coordinate
      * @param deltaY y coordinate
      */

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapeImage.java
Patch:
@@ -196,7 +196,6 @@ public void translate (double deltaX, double deltaY)
     /**
      * Translates a point from the shape.
      *
-     * @param p point position
      * @param deltaX x coordinate
      * @param deltaY y coordinate
      */

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapeLine.java
Patch:
@@ -164,7 +164,6 @@ public void translate (double deltaX, double deltaY)
     /**
      * Translates a point from the shape.
      *
-     * @param p point position
      * @param deltaX x coordinate
      * @param deltaY y coordinate
      */

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapePath.java
Patch:
@@ -197,7 +197,6 @@ public void translate (double deltaX, double deltaY)
     /**
      * Translates a point from the shape.
      *
-     * @param p point position
      * @param deltaX x coordinate
      * @param deltaY y coordinate
      */

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapePolyLine.java
Patch:
@@ -280,7 +280,6 @@ public void translate (double deltaX, double deltaY)
     /**
      * Translates a point from the shape.
      *
-     * @param p point position
      * @param deltaX x coordinate
      * @param deltaY y coordinate
      */

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapePolygon.java
Patch:
@@ -282,7 +282,6 @@ public void translate (double deltaX, double deltaY)
     /**
      * Translates a point from the shape.
      *
-     * @param p point position
      * @param deltaX x coord
      * @param deltaY y coord
      */

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapeRect.java
Patch:
@@ -273,7 +273,6 @@ public void translate (double deltaX, double deltaY)
     /**
      * Translates a point from the shape.
      *
-     * @param p point position
      * @param deltaX x coordinate
      * @param deltaY y coordinate
      */

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapeText.java
Patch:
@@ -225,7 +225,6 @@ public void translate (double deltaX, double deltaY)
     /**
      * Translates a point from the shape.
      *
-     * @param p point position
      * @param deltaX x coordinate
      * @param deltaY y coordinate
      */

File: src/net/java/sip/communicator/service/configuration/ConfigurationService.java
Patch:
@@ -123,7 +123,6 @@ public void setProperties(Map<String, Object> properties)
      * All properties with prefix propertyName will also be removed.
      * <p>
      * @param propertyName the name of the property to change.
-     * @param property the new value of the specified property.
      * @throws PropertyVetoException in case the changed has been refused by
      * at least one propertychange listener.
      */

File: src/net/java/sip/communicator/service/media/CallSession.java
Patch:
@@ -87,7 +87,7 @@ public String createSdpOffer(String peerSdpDescription)
      *
      * @param peerSdpDescription the last SDP description of the remote
      *            callee
-     * @param on <tt>true</tt> if the SDP description should offer the remote
+     * @param onHold <tt>true</tt> if the SDP description should offer the remote
      *            callee to be put on hold or answer an offer from the remote
      *            callee to be put on hold; <tt>false</tt> to work in the
      *            context of a put-off-hold offer
@@ -252,7 +252,7 @@ public void startStreaming()
         throws MediaException;
 
     /**
-     * Calls {@link #startStreaming() in order to start the streaming of the
+     * Calls {@link #startStreaming()} in order to start the streaming of the
      * local media and then begins processing the received and sent media
      * streams.
      */

File: src/net/java/sip/communicator/service/media/event/SessionCreatorCallback.java
Patch:
@@ -39,8 +39,9 @@ public void securityOn( int sessionType,
      * Indicates that a security message has occurred associated with a
      * failure/warning or information coming from the encryption protocol.
      * 
-     * @param messageType the type of the message.
-     * @param message the message
+     * @param message the message.
+     * @param i18nMessage the internationalized message
+     * @param severity severity level 
      */
     public void securityMessage(String message,
                                 String i18nMessage,

File: src/net/java/sip/communicator/service/metahistory/MetaHistoryService.java
Patch:
@@ -137,7 +137,7 @@ public Collection<Object> findByKeyword(String[] services,
      * Returns all the records having the given keywords
      *
      * @param services the services classnames we will query
-     * @param contact CallPeer address(String),
+     * @param descriptor CallPeer address(String),
      *  MetaContact or ChatRoom.
      * @param keywords keyword
      * @return Collection sorted result that conists of records returned from

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetPersistentPresence.java
Patch:
@@ -189,7 +189,7 @@ public void fireContactPresenceStatusChangeEvent(Contact source,
      * change event.
      * 
      * @param eventID the String ID of the event to dispatch
-     * @param sourceContact the ContactJabberImpl instance that this event is
+     * @param source the ContactJabberImpl instance that this event is
      *            pertaining to.
      * @param oldValue the value that the changed property had before the change
      *            occurred.
@@ -234,9 +234,9 @@ protected void fireProviderStatusChangeEvent(PresenceStatus oldValue)
     /**
      * Notify all provider presence listeners of the corresponding event change
      * 
-     * @param oldStatus
+     * @param oldValue
      *            the status our stack had so far
-     * @param newStatus
+     * @param newValue
      *            the status we have from now on
      */
     protected void fireProviderStatusChangeEvent(

File: src/net/java/sip/communicator/service/protocol/OperationSetSecureTelephony.java
Patch:
@@ -32,7 +32,6 @@ public interface OperationSetSecureTelephony
      * @param peer the peer who toggled (or for whom is remotely
      *        toggled) the SAS verified flag
      * @param verified the new SAS verification status
-     * @param source the source who generated the call change
      */
     public boolean setSasVerified(CallPeer peer, boolean verified);
 }

File: src/net/java/sip/communicator/service/protocol/OperationSetVideoTelephony.java
Patch:
@@ -63,7 +63,7 @@ public Component createLocalVisualComponent(
     /**
      * Disposes of a visual <code>Component</code> depicting the local video for
      * a specific <code>CallPeer</code> (previously obtained through
-     * {@link createLocalVisualComponent(CallPeer, VideoListener) createLocalVisualComponent}).
+     * {@link #createLocalVisualComponent(CallPeer, VideoListener) createLocalVisualComponent}).
      * The disposal may include, but is not limited to, releasing the
      * <code>Player</code> which provides the <code>component</code> and renders
      * the local video into it, disconnecting from the video capture device.

File: src/net/java/sip/communicator/service/protocol/WhiteboardPoint.java
Patch:
@@ -74,7 +74,7 @@ public double getY()
     /**
      * Sets a new value to the x coordinate.
      * 
-     * @param y the new value of the x coordinate
+     * @param x the new value of the x coordinate
      */
     public void setX(double x)
     {

File: src/net/java/sip/communicator/service/protocol/event/CallPeerSecurityMessageEvent.java
Patch:
@@ -60,11 +60,10 @@ public class CallPeerSecurityMessageEvent
      * call peer, event type and message associated with this event.
      *
      * @param callPeer the call peer implied in this event.
-     * @param eventType the type of the event. One of the constants defined in
-     * this class.
      * @param eventMessage the message associated with this event.
      * @param i18nMessage the internationalized message associated with this
      * event that could be shown to the user.
+     * @param eventSeverity severity level.
      */
     public CallPeerSecurityMessageEvent( CallPeer callPeer,
                                                 String eventMessage,

File: src/net/java/sip/communicator/service/protocol/event/FileTransferCreatedEvent.java
Patch:
@@ -28,7 +28,7 @@ public class FileTransferCreatedEvent
      * Creates a <tt>FileTransferCreatedEvent</tt> representing creation of a
      * file transfer.
      *
-     * @param request the <tt>FileTransfer</tt> whose creation this event
+     * @param fileTransfer the <tt>FileTransfer</tt> whose creation this event
      * represents.
      * @param timestamp the timestamp indicating the exact date when the event
      * occurred

File: src/net/java/sip/communicator/service/protocol/event/FileTransferRequestEvent.java
Patch:
@@ -34,7 +34,7 @@ public class FileTransferRequestEvent
      * Creates a <tt>FileTransferRequestEvent</tt> representing reception
      * of an incoming file transfer request.
      *
-     * @param the operation set, where this event initially occurred
+     * @param fileTransferOpSet the operation set, where this event initially occurred
      * @param request the <tt>IncomingFileTranferRequest</tt> whose reception
      * this event represents.
      * @param timestamp the timestamp indicating the exact date when the event

File: src/net/java/sip/communicator/service/resources/ResourceManagementService.java
Patch:
@@ -121,7 +121,8 @@ public interface ResourceManagementService
      * Returns an internationalized string corresponding to the given key.
      *
      * @param key The identifier of the string in the resources properties file.
-     * @param locale The locale.
+     * @param params An array of parameters to be replaced in the returned
+     * string.
      * @return An internationalized string corresponding to the given key and
      * given locale.
      */
@@ -142,7 +143,6 @@ public interface ResourceManagementService
      * Returns an internationalized string corresponding to the given key.
      *
      * @param key The identifier of the string in the resources properties file.
-     * @param locale The locale that we'd like to receive the result in.
      * @return An internationalized string corresponding to the given key.
      */
     public char getI18nMnemonic(String key);

File: src/net/java/sip/communicator/service/systray/PopupMessageHandler.java
Patch:
@@ -54,15 +54,15 @@ public interface PopupMessageHandler
      * 3) being able to match a click to a message
      * 4) using a native popup mechanism
      * 
-     * @returns an integer representing preference index of this popup handler
+     * @return an integer representing preference index of this popup handler
      */
     public int getPreferenceIndex();
 
     /**
      * Returns a readable description of this popup handler. It is expected
      * to be a localized string.
      *
-     * @returns a string describing this popup handler
+     * @return a string describing this popup handler
      */
     @Override
     public String toString();

File: src/net/java/sip/communicator/util/GuiUtils.java
Patch:
@@ -189,7 +189,7 @@ public static String formatTime(Date date)
     /**
      * Formats the time for the given date. The result format is the following:
      * [Hour]:[Minute]:[Second]. For example: 12:25:30. 
-     * @param date the date to format
+     * @param time the date to format
      * @return the formatted hour string
      */
     public static String formatTime(long time)

File: src/net/java/sip/communicator/util/ImageUtils.java
Patch:
@@ -69,7 +69,7 @@ public static ImageIcon scaleIconWithinBounds(Image image, int width,
     /**
      * Creates a rounded avatar image.
      *
-     * @param avatarBytes The bytes of the initial avatar image.
+     * @param image image of the initial avatar image.
      *
      * @return The rounded corner image.
      */

File: src/net/java/sip/communicator/util/Sha1Crypto.java
Patch:
@@ -30,7 +30,7 @@ public static String encode(String text)
     /**
      * Encodes the given text with the SHA-1 algorithm.
      * 
-     * @param byteArreay the byte array to encode
+     * @param byteArray the byte array to encode
      * @return the encoded text
      * @throws NoSuchAlgorithmException
      * @throws UnsupportedEncodingException

File: src/net/java/sip/communicator/util/swing/FileDragLabel.java
Patch:
@@ -58,7 +58,7 @@ public void setFile(File file)
      * the operable part of the drop site for the <code>DropTarget</code>
      * registered with this listener.
      * 
-     * @param dtde the <code>DropTargetDragEvent</code> 
+     * @param dropTargetDragEvent the <code>DropTargetDragEvent</code> 
      */
     public void dragEnter(DropTargetDragEvent dropTargetDragEvent)
     {
@@ -99,7 +99,7 @@ public synchronized void drop(DropTargetDropEvent event)
      * is notifying this listener
      * in order for it to initiate the action for the user.
      * <P>
-     * @param dge the <code>DragGestureEvent</code> describing 
+     * @param dragGestureEvent the <code>DragGestureEvent</code> describing 
      * the gesture that has just occurred
      */
     public void dragGestureRecognized(DragGestureEvent dragGestureEvent)

File: src/net/java/sip/communicator/util/swing/FramedImage.java
Patch:
@@ -80,7 +80,7 @@ public void setImageIcon(ImageIcon imageIcon)
     /**
      * Paints the contained image in a frame.
      *
-     * @overrides {@link JComponent#paintComponent(Graphics)}.
+     * Overrides {@link JComponent#paintComponent(Graphics)}.
      */
     public void paintComponent(Graphics g)
     {

File: src/net/java/sip/communicator/impl/protocol/icq/InfoRetreiver.java
Patch:
@@ -151,7 +151,7 @@ protected List<GenericDetail> getContactDetails(String uin)
      */
     private class UserInfoResponseRetriever extends SnacRequestAdapter
     {
-        int requestID;
+        private final int requestID;
         List<GenericDetail> result = null;
 
         UserInfoResponseRetriever(int requestID)
@@ -588,6 +588,6 @@ private void readInterestsUserInfo(MetaInterestsInfoCmd cmd)
      */
     private void readAffilationsUserInfo(MetaAffiliationsInfoCmd cmd)
     {
-//        Vector infoData = getInfoForRequest(cmd.getId());
+//        Vector<GenericDetail> infoData = getInfoForRequest(cmd.getId());
     }
 }

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetServerStoredContactInfoIcqImpl.java
Patch:
@@ -126,4 +126,4 @@ private void assertConnected() throws IllegalStateException
                 "The icq provider must be signed on the ICQ service before "
                 +"being able to communicate.");
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapeLine.java
Patch:
@@ -131,9 +131,9 @@ public boolean contains (Point2D p)
      *
      * @return list of selected points
      */
-    public List getSelectionPoints ()
+    public List<WhiteboardPoint> getSelectionPoints ()
     {
-        ArrayList selectionPoints = new ArrayList();
+        ArrayList<WhiteboardPoint> selectionPoints = new ArrayList<WhiteboardPoint>();
 
         selectionPoints.add (startPoint);
         selectionPoints.add (endPoint);
@@ -246,4 +246,4 @@ public void setWhiteboardPointEnd (WhiteboardPoint whiteboardPointEnd)
     {
         this.endPoint = whiteboardPointEnd;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/plugin/whiteboard/gui/whiteboardshapes/WhiteboardShapeText.java
Patch:
@@ -153,9 +153,9 @@ public void paintShape (Graphics2D g, AffineTransform t)
      *
      * @return list of selected points
      */
-    public List getSelectionPoints ()
+    public List<WhiteboardPoint> getSelectionPoints ()
     {
-        List list = new ArrayList ();
+        List<WhiteboardPoint> list = new ArrayList<WhiteboardPoint>();
         list.add (point);
 
         return list;
@@ -319,4 +319,4 @@ public void setFontName (String fontName)
     {
         this.fontName = fontName;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/service/notification/NotificationService.java
Patch:
@@ -280,7 +280,8 @@ public void removeEventNotificationAction(  String eventType,
      * an event with the specified name has occurred, or null if no actions
      * have been defined for <tt>eventType</tt>.
      */
-    public Map getEventNotifications(String eventType);
+    public Map<String, NotificationActionHandler> getEventNotifications(
+        String eventType);
 
     /**
      * Returns the <tt>NotificationActionHandler</tt> corresponding to the given

File: test/net/java/sip/communicator/slick/metahistory/TestMetaHistoryService.java
Patch:
@@ -300,7 +300,7 @@ private void generateCall(String participant)
             iter = v.iterator();
             while (iter.hasNext())
             {
-                CallPeer item = (CallPeer) iter.next();
+                CallPeer item = iter.next();
                 mockBTelphonyOpSet.hangupCallPeer(item);
             }
         }
@@ -704,7 +704,7 @@ public void fileTests()
 
         it = rs.iterator();
         assertTrue("Filetransfers not found",
-                    ((FileRecord)it.next()).getFile().getName().
+                    it.next().getFile().getName().
                         equals(files[2].getName()));
 
         rs = getFileRecords(

File: test/net/java/sip/communicator/slick/protocol/icq/FullUserInfoCmd.java
Patch:
@@ -166,8 +166,7 @@ public void writeData(OutputStream out)
     private Hashtable<String, Object> getInfoForRequest(int requestID)
     {
         Hashtable<String, Object> res
-            = (Hashtable<String, Object>)
-                retreivedInfo.get(new Integer(requestID));
+            = retreivedInfo.get(new Integer(requestID));
 
         if (res == null)
         {

File: src/net/java/sip/communicator/impl/media/protocol/alsa/AlsaStream.java
Patch:
@@ -181,7 +181,7 @@ public void run() {
         if (started && transferHandler != null) {
         transferHandler.transferData(this);
         try {
-            Thread.currentThread().sleep(1);
+            Thread.sleep(1);
         } catch (InterruptedException ise) {
         }
         }
@@ -204,7 +204,7 @@ public void run() {
      */
     public Object getControl(String controlType) {
        try {
-          Class  cls = Class.forName(controlType);
+          Class<?>  cls = Class.forName(controlType);
           Object cs[] = getControls();
           for (int i = 0; i < cs.length; i++) {
              if (cls.isInstance(cs[i]))

File: src/net/java/sip/communicator/plugin/accountinfo/AccountDetailsPanel.java
Patch:
@@ -259,7 +259,7 @@ private void initUnsupportedPanel()
      */
     private void loadSummaryDetails()
     {
-        Iterator contactDetails;
+        Iterator<GenericDetail> contactDetails;
 
         // Avatar details.
         contactDetails
@@ -414,7 +414,7 @@ private void initExtendedPanel()
             BorderFactory.createEmptyBorder(0, 5, 5, 5)));
 
         // Obtain all the details for a contact.
-        Iterator iter = accountInfoOpSet.getAllAvailableDetails();
+        Iterator<GenericDetail> iter = accountInfoOpSet.getAllAvailableDetails();
 
         GenericDetail detail;
         JLabel detailLabel;
@@ -423,7 +423,7 @@ private void initExtendedPanel()
 
         while (iter.hasNext())
         {
-            detail = (GenericDetail) iter.next();
+            detail = iter.next();
 
             if (detail.getDetailValue().toString().equals(""))
                 continue;

File: src/net/java/sip/communicator/plugin/notificationconfiguration/ListMulti.java
Patch:
@@ -21,7 +21,7 @@ class ListModel extends DefaultTableModel
         super(columns, rowCount);
     }
 
-    public Class getColumnClass(int c)
+    public Class<?> getColumnClass(int c)
     {
         return getValueAt(0, c).getClass();
     }

File: test/net/java/sip/communicator/slick/protocol/icq/IcqSlickFixture.java
Patch:
@@ -48,7 +48,7 @@ public class IcqSlickFixture extends TestCase
      * and initialise the ss contact list before the tested implementation has
      * actually done so.
      */
-    public static Hashtable preInstalledBuddyList  = null;
+    public static Hashtable<String, List<String>> preInstalledBuddyList  = null;
 
     public ServiceReference        icqServiceRef   = null;
     public ProtocolProviderService provider        = null;
@@ -57,7 +57,7 @@ public class IcqSlickFixture extends TestCase
 
     /**
      * A reference to the bundle containing the tested pp implementation. This
-     * reference is set during the accoung uninstallation testing and used during
+     * reference is set during the account uninstallation testing and used during
      * the account uninstallation persistence testing.
      */
     public static Bundle           providerBundle  = null;

File: test/net/java/sip/communicator/slick/runner/ScTestRunner.java
Patch:
@@ -29,7 +29,7 @@ public class ScTestRunner extends BaseTestRunner {
      */
     public ScTestRunner(XmlFormatter printer)
     {
-        this.testPrinter = printer;
+        testPrinter = printer;
     }
 
     /**

File: test/net/java/sip/communicator/slick/callhistory/CallHistoryServiceLick.java
Patch:
@@ -34,7 +34,7 @@ public void start(BundleContext bundleContext)
         CallHistoryServiceLick.bc = bundleContext;
 
         setName("CallHistoryServiceLick");
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         addTest(TestCallHistoryService.suite());

File: test/net/java/sip/communicator/slick/configuration/ConfigurationServiceLick.java
Patch:
@@ -31,7 +31,7 @@ public void start(BundleContext bundleContext) throws Exception
     {
         ConfigurationServiceLick.bc = bundleContext;
         setName("ConfigurationServiceLick");
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         addTestSuite(TestConfigurationService.class);

File: test/net/java/sip/communicator/slick/contactlist/MclSlickFixture.java
Patch:
@@ -238,7 +238,7 @@ static void assertGroupEquals(  MockContactGroup expectedGroup,
                 , actualMetaContact.getContacts().hasNext());
 
             Contact actualProtoContact
-                = (Contact)actualMetaContact.getContacts().next();
+                = actualMetaContact.getContacts().next();
 
             assertNotNull("getContactForProvider returned null for MockProvider"
                           , actualProtoContact);

File: test/net/java/sip/communicator/slick/contactlist/MetaContactListServiceLick.java
Patch:
@@ -58,7 +58,7 @@ public void start(BundleContext context)
         MclSlickFixture.bundleContext = context;
 
         setName("MetaContactListServiceLick");
-        Hashtable slickServiceProperties = new Hashtable();
+        Hashtable<String, String> slickServiceProperties = new Hashtable<String, String>();
         slickServiceProperties.put("service.pid", getName());
 
         logger.debug("Service  " + getClass().getName() + " [  STARTED ]");
@@ -150,7 +150,7 @@ public static ServiceRegistration registerMockProviderService(
         //properties of the newly registered provider.
         System.setProperty(MetaContactListService.PROVIDER_MASK_PROPERTY, "1");
 
-        Hashtable mockProvProperties = new Hashtable();
+        Hashtable<String, String> mockProvProperties = new Hashtable<String, String>();
         mockProvProperties.put(MetaContactListService.PROVIDER_MASK_PROPERTY,
                                "1");
 

File: test/net/java/sip/communicator/slick/fileaccess/FileAccessServiceLick.java
Patch:
@@ -35,7 +35,7 @@ public void start(BundleContext bundleContext)
     {
         FileAccessServiceLick.bc = bundleContext;
         setName("FileAccessServiceLick");
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         addTestSuite(TestFileAccessService.class);

File: test/net/java/sip/communicator/slick/history/HistoryServiceLick.java
Patch:
@@ -36,7 +36,7 @@ public void start(BundleContext bundleContext)
         HistoryServiceLick.bc = bundleContext;
 
         setName("HistoryServiceLick");
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         addTest(TestHistoryService.suite());

File: test/net/java/sip/communicator/slick/history/TestHistoryService.java
Patch:
@@ -82,12 +82,12 @@ protected void tearDown()
 
     public void testCreateDB()
     {
-        ArrayList al = new ArrayList();
+        ArrayList<String> al = new ArrayList<String>();
 
-        Iterator i = this.historyService.getExistingIDs();
+        Iterator<HistoryID> i = this.historyService.getExistingIDs();
         while (i.hasNext())
         {
-            HistoryID id = (HistoryID) i.next();
+            HistoryID id = i.next();
             String[] components = id.getID();
 
             if (components.length == 2 && "test".equals(components[0]))

File: test/net/java/sip/communicator/slick/media/MediaServiceLick.java
Patch:
@@ -42,7 +42,7 @@ public void start(BundleContext bundleContext) throws Exception
     {
         MediaServiceLick.bc = bundleContext;
         setName("MediaServiceLick");
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         // disable video support when testing

File: test/net/java/sip/communicator/slick/metahistory/MetaHistoryServiceLick.java
Patch:
@@ -37,7 +37,7 @@ public void start(BundleContext bundleContext)
         MetaHistoryServiceLick.bc = bundleContext;
 
         setName("MetaHistoryServiceSLick");
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         addTest(TestMetaHistoryService.suite());

File: test/net/java/sip/communicator/slick/msghistory/MsgHistoryServiceLick.java
Patch:
@@ -34,7 +34,7 @@ public void start(BundleContext bundleContext)
         MsgHistoryServiceLick.bc = bundleContext;
 
         setName("MsgHistoryServiceLick");
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         addTest(TestMsgHistoryService.suite());

File: test/net/java/sip/communicator/slick/netaddr/NetworkAddressManagerServiceLick.java
Patch:
@@ -35,7 +35,7 @@ public void start(BundleContext bundleContext) throws Exception
     {
         this.bc = bundleContext;
         setName("NetworkAddressManagerServiceLick");
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
 //        addTestSuite(TestNetworkAddressManagerService.class);

File: test/net/java/sip/communicator/slick/popupmessagehandler/PopupMessageHandlerSLick.java
Patch:
@@ -36,7 +36,7 @@ public void start(BundleContext bc) throws Exception
 
         setName("PopupMessageHandlerSLick");
 
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
 
         properties.put("service.pid", getName());
         

File: test/net/java/sip/communicator/slick/protocol/gibberish/GibberishProtocolProviderServiceLick.java
Patch:
@@ -61,7 +61,7 @@ public void start(BundleContext context)
     {
         setName("GibberishProtocolProviderServiceLick");
 
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         GibberishSlickFixture.bc = context;

File: test/net/java/sip/communicator/slick/protocol/gibberish/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -398,7 +398,7 @@ public void testCreateMessage2()
      */
     private class ImEventCollector implements MessageListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called when a new incoming <tt>Message</tt> has been received.
          * @param evt the <tt>MessageReceivedEvent</tt> containing the newly

File: test/net/java/sip/communicator/slick/protocol/gibberish/TestOperationSetTypingNotifications.java
Patch:
@@ -270,7 +270,7 @@ public void testTypingNotificationsEventDelivery()
      */
     private class TypingEventCollector implements TypingNotificationsListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called to indicate that a remote <tt>Contact</tt> has sent us a typing
          * notification. The method adds the <tt>event</tt> to the list of

File: test/net/java/sip/communicator/slick/protocol/gibberish/TestProtocolProviderServiceGibberishImpl.java
Patch:
@@ -170,7 +170,7 @@ public void testOperationSetTypes() throws Exception
     public class RegistrationEventCollector
         implements RegistrationStateChangeListener
     {
-        public List collectedNewStates = new LinkedList();
+        public List<RegistrationState> collectedNewStates = new LinkedList<RegistrationState>();
 
         /**
          * The method would simply register all received events so that they

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetPersistentPresence.java
Patch:
@@ -424,7 +424,7 @@ public void postTestRenameGroup()
      */
     private class GroupChangeCollector implements ServerStoredGroupListener
     {
-        public ArrayList collectedEvents = new ArrayList();
+        public ArrayList<EventObject> collectedEvents = new ArrayList<EventObject>();
 
         /**
          * Blocks until at least one event is received or until waitFor
@@ -525,7 +525,7 @@ public void groupResolved(ServerStoredGroupEvent evt)
      */
     private class SubscriptionEventCollector implements SubscriptionListener
     {
-        public ArrayList collectedEvents = new ArrayList();
+        public ArrayList<EventObject> collectedEvents = new ArrayList<EventObject>();
 
         /**
          * Blocks until at least one event is received or until waitFor

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetTypingNotifications.java
Patch:
@@ -173,7 +173,7 @@ public void thenTestSendTypingNotification()
      */
     private class TypingEventCollector implements TypingNotificationsListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called to indicate that a remote <tt>Contact</tt> has sent us a typing
          * notification. The method adds the <tt>event</tt> to the list of
@@ -222,7 +222,7 @@ public void waitForEvent(long waitFor)
     private class JoustSimTypingEventCollector
         implements IcbmListener, TypingListener
     {
-        private List collectedTypingInfo = new LinkedList();
+        private List<TypingInfo> collectedTypingInfo = new LinkedList<TypingInfo>();
 
 
         /**

File: test/net/java/sip/communicator/slick/protocol/icq/TestProtocolProviderServiceIcqImpl.java
Patch:
@@ -259,7 +259,7 @@ public void testOperationSetTypes() throws Exception
      */
     public class RegistrationEventCollector implements RegistrationStateChangeListener
     {
-        public List collectedNewStates = new LinkedList();
+        public List<RegistrationState> collectedNewStates = new LinkedList<RegistrationState>();
 
         /**
          * The method would simply register all received events so that they

File: test/net/java/sip/communicator/slick/protocol/jabber/JabberProtocolProviderServiceLick.java
Patch:
@@ -67,7 +67,7 @@ public void start(BundleContext context)
     {
         setName("JabberProtocolProviderSlick");
 
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         JabberSlickFixture.bc = context;

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -402,7 +402,7 @@ public void testCreateMessage2()
      */
     private class ImEventCollector implements MessageListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called when a new incoming <tt>Message</tt> has been received.
          * @param evt the <tt>MessageReceivedEvent</tt> containing the newly

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetMultiUserChat2.java
Patch:
@@ -1110,7 +1110,7 @@ class MUCEventCollector
                    ChatRoomMemberRoleListener,
                    ChatRoomLocalUserRoleListener
     {
-        private final ArrayList collectedEvents = new ArrayList();
+        private final ArrayList<EventObject> collectedEvents = new ArrayList<EventObject>();
 
         private int waitCount = 0;
 

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetTypingNotifications.java
Patch:
@@ -274,7 +274,7 @@ public void testTypingNotificationsEventDelivery()
      */
     private class TypingEventCollector implements TypingNotificationsListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called to indicate that a remote <tt>Contact</tt> has sent us a typing
          * notification. The method adds the <tt>event</tt> to the list of

File: test/net/java/sip/communicator/slick/protocol/jabber/TestProtocolProviderServiceJabberImpl.java
Patch:
@@ -170,12 +170,12 @@ public void testOperationSetTypes() throws Exception
     public class RegistrationEventCollector
         implements RegistrationStateChangeListener
     {
-        public List collectedNewStates = new LinkedList();
+        public List<RegistrationState> collectedNewStates = new LinkedList<RegistrationState>();
 
         /**
          * The method would simply register all received events so that they
          * could be available for later inspection by the unit tests. In the
-         * case where a registraiton event notifying us of a completed
+         * case where a registration event notifying us of a completed
          * registration is seen, the method would call notifyAll().
          *
          * @param evt ProviderStatusChangeEvent the event describing the status

File: test/net/java/sip/communicator/slick/protocol/msn/MsnProtocolProviderServiceLick.java
Patch:
@@ -59,7 +59,7 @@ public void start(BundleContext context)
     {
         setName("MsnProtocolProviderSlick");
 
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         MsnSlickFixture.bc = context;

File: test/net/java/sip/communicator/slick/protocol/msn/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -369,7 +369,7 @@ public void testCreateMessage2()
      */
     private class ImEventCollector implements MessageListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called when a new incoming <tt>Message</tt> has been received.
          * @param evt the <tt>MessageReceivedEvent</tt> containing the newly

File: test/net/java/sip/communicator/slick/protocol/msn/TestOperationSetTypingNotifications.java
Patch:
@@ -248,7 +248,7 @@ public void testTypingNotificationsEventDelivery()
      */
     private class TypingEventCollector implements TypingNotificationsListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called to indicate that a remote <tt>Contact</tt> has sent us a typing
          * notification. The method adds the <tt>event</tt> to the list of

File: test/net/java/sip/communicator/slick/protocol/msn/TestProtocolProviderServiceMsnImpl.java
Patch:
@@ -171,7 +171,7 @@ public void testOperationSetTypes() throws Exception
     public class RegistrationEventCollector
         implements RegistrationStateChangeListener
     {
-        public List collectedNewStates = new LinkedList();
+        public List<RegistrationState> collectedNewStates = new LinkedList<RegistrationState>();
 
         /**
          * The method would simply register all received events so that they

File: test/net/java/sip/communicator/slick/protocol/rss/RssProtocolProviderServiceLick.java
Patch:
@@ -36,7 +36,7 @@ public void start(BundleContext bundleContext)
 
         setName("RssProtocolProviderServiceLick");
 
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         RssSlickFixture.bc = bundleContext;

File: test/net/java/sip/communicator/slick/protocol/rss/TestAccountInstallation.java
Patch:
@@ -50,7 +50,7 @@ protected void tearDown() throws Exception
      */
     public void testInstallAccount()
     {
-        Hashtable accountProperties = new Hashtable();
+        Hashtable<String, String> accountProperties = new Hashtable<String, String>();
 
         ServiceReference[] serRefs = null;
         String osgiFilter = "(" + ProtocolProviderFactory.PROTOCOL + "="

File: test/net/java/sip/communicator/slick/protocol/rss/TestProtocolProviderServiceRssImpl.java
Patch:
@@ -153,7 +153,7 @@ public class RegistrationEventCollector
          * We store all the received events in this list. It's made public to
          * ease later inspection by unit tests.
          */
-        public List collectedStates = new LinkedList();
+        public List<RegistrationState> collectedStates = new LinkedList<RegistrationState>();
 
         /**
          * This method simply records all received events in a <code>List</code>

File: test/net/java/sip/communicator/slick/protocol/sip/SipProtocolProviderServiceLick.java
Patch:
@@ -59,7 +59,7 @@ public void start(BundleContext context)
     {
         setName("SipProtocolProviderServiceLick");
 
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         SipSlickFixture.bc = context;

File: test/net/java/sip/communicator/slick/protocol/sip/TestAccountUninstallation.java
Patch:
@@ -329,7 +329,7 @@ public void testUninstallAccount()
     public class UnregistrationEventCollector
         implements RegistrationStateChangeListener
     {
-        public List collectedNewStates = new LinkedList();
+        public List<RegistrationState> collectedNewStates = new LinkedList<RegistrationState>();
 
         /**
          * The method would simply register all received events so that they

File: test/net/java/sip/communicator/slick/protocol/sip/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -444,7 +444,7 @@ public void testCreateMessage2()
      */
     private class ImEventCollector implements MessageListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called when a new incoming <tt>Message</tt> has been received.
          * @param evt the <tt>MessageReceivedEvent</tt> containing the newly

File: test/net/java/sip/communicator/slick/protocol/sip/TestProtocolProviderServiceSipImpl.java
Patch:
@@ -170,7 +170,7 @@ public void testOperationSetTypes() throws Exception
     public class RegistrationEventCollector
         implements RegistrationStateChangeListener
     {
-        public List collectedNewStates = new LinkedList();
+        public List<RegistrationState> collectedNewStates = new LinkedList<RegistrationState>();
 
         /**
          * The method would simply register all received events so that they

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -379,7 +379,7 @@ public void testCreateMessage2()
      */
     private class ImEventCollector implements MessageListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called when a new incoming <tt>Message</tt> has been received.
          * @param evt the <tt>MessageReceivedEvent</tt> containing the newly

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestOperationSetTypingNotifications.java
Patch:
@@ -251,7 +251,7 @@ public void testTypingNotificationsEventDelivery()
      */
     private class TypingEventCollector implements TypingNotificationsListener
     {
-        private List collectedEvents = new LinkedList();
+        private List<EventObject> collectedEvents = new LinkedList<EventObject>();
         /**
          * Called to indicate that a remote <tt>Contact</tt> has sent us a typing
          * notification. The method adds the <tt>event</tt> to the list of

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestProtocolProviderServiceYahooImpl.java
Patch:
@@ -170,7 +170,7 @@ public void testOperationSetTypes() throws Exception
     public class RegistrationEventCollector
         implements RegistrationStateChangeListener
     {
-        public List collectedNewStates = new LinkedList();
+        public List<RegistrationState> collectedNewStates = new LinkedList<RegistrationState>();
 
         /**
          * The method would simply register all received events so that they

File: test/net/java/sip/communicator/slick/protocol/yahoo/YahooProtocolProviderServiceLick.java
Patch:
@@ -59,7 +59,7 @@ public void start(BundleContext context)
     {
         setName("YahooProtocolProviderSlick");
 
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put("service.pid", getName());
 
         YahooSlickFixture.bc = context;

File: src/net/java/sip/communicator/impl/growlnotification/GrowlNotificationServiceImpl.java
Patch:
@@ -177,7 +177,7 @@ private void firePopupMessageClicked(SystrayPopupMessageEvent evt)
      */
     public void growlNotificationTimedOut(Object context)
     {
-        PopupMessage m = (PopupMessage)shownPopups.get(context);
+        PopupMessage m = shownPopups.get(context);
         if (m != null) {
             synchronized(shownPopups) {
                 shownPopups.remove(context);
@@ -194,7 +194,7 @@ public void growlNotificationTimedOut(Object context)
      */
     public void growlNotificationWasClicked(Object context)
     {
-        PopupMessage m = (PopupMessage)shownPopups.get(context);
+        PopupMessage m = shownPopups.get(context);
         if (m != null) {
             synchronized(shownPopups) {
                 shownPopups.remove(context);

File: src/net/java/sip/communicator/impl/protocol/dict/DictAccountID.java
Patch:
@@ -24,7 +24,7 @@ public class DictAccountID
      * @param userID the user identifier correspnding to the account
      * @param accountProperties any other properties necessary for the account.
      */
-    DictAccountID(String userID, Map accountProperties)
+    DictAccountID(String userID, Map<String, String> accountProperties)
     {
         super(userID, accountProperties, ProtocolNames.DICT, "dict.org");
     }

File: src/net/java/sip/communicator/impl/protocol/dict/ProtocolProviderFactoryDictImpl.java
Patch:
@@ -47,7 +47,7 @@ public ProtocolProviderFactoryDictImpl()
      * @return the AccountID of the newly created account.
      */
     public AccountID installAccount( String userIDStr,
-                                     Map accountProperties)
+                                     Map<String, String> accountProperties)
     {
         BundleContext context = DictActivator.getBundleContext();
         if (context == null)
@@ -89,7 +89,7 @@ public AccountID installAccount( String userIDStr,
         return accountID;
     }
 
-    protected AccountID createAccountID(String userID, Map accountProperties)
+    protected AccountID createAccountID(String userID, Map<String, String> accountProperties)
     {
         return new DictAccountID(userID, accountProperties);
     }

File: src/net/java/sip/communicator/impl/protocol/facebook/ContactGroupFacebookImpl.java
Patch:
@@ -315,7 +315,7 @@ public Contact getContact(String id)
      */
     public ContactGroup getGroup(int index)
     {
-        return (ContactGroup)subGroups.get(index);
+        return subGroups.get(index);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/facebook/FacebookAccountID.java
Patch:
@@ -26,7 +26,7 @@ public class FacebookAccountID
      * @param accountProperties
      *            any other properties necessary for the account.
      */
-    protected FacebookAccountID(String userID, Map accountProperties)
+    protected FacebookAccountID(String userID, Map<String, String> accountProperties)
     {
         super(
             userID,

File: src/net/java/sip/communicator/impl/protocol/facebook/FacebookActivator.java
Patch:
@@ -58,7 +58,7 @@ public void start(BundleContext context) throws Exception
     {
         FacebookActivator.bundleContext = context;
 
-        Hashtable hashtable = new Hashtable();
+        Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, "Facebook");
 
         facebookProviderFactory = new ProtocolProviderFactoryFacebookImpl();

File: src/net/java/sip/communicator/impl/protocol/facebook/OperationSetPersistentPresenceFacebookImpl.java
Patch:
@@ -446,7 +446,7 @@ private void changePresenceStatusForAllContacts(ContactGroup parent,
 
         while (subgroups.hasNext())
         {
-            ContactGroup subgroup = (ContactGroup) subgroups.next();
+            ContactGroup subgroup = subgroups.next();
             changePresenceStatusForAllContacts(subgroup, newStatus);
         }
     }

File: src/net/java/sip/communicator/impl/protocol/facebook/OperationSetServerStoredContactInfoFacebookImpl.java
Patch:
@@ -401,4 +401,4 @@ public static byte[] getImage(String urlStr){
         }
         return byteArrayOS.toByteArray();
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/protocol/facebook/ProtocolProviderFactoryFacebookImpl.java
Patch:
@@ -136,8 +136,7 @@ public void modifyAccount(
         if (!registeredAccounts.containsKey(accountID))
             return;
 
-        ServiceRegistration registration =
-            (ServiceRegistration) registeredAccounts.get(accountID);
+        ServiceRegistration registration = registeredAccounts.get(accountID);
 
         // kill the service
         if (registration != null)
@@ -162,7 +161,7 @@ public void modifyAccount(
          */
         this.storeAccount(accountID);
 
-        Hashtable properties = new Hashtable();
+        Hashtable<String, String> properties = new Hashtable<String, String>();
         properties.put(PROTOCOL, ProtocolNames.FACEBOOK);
         properties.put(USER_ID, accountID.getUserID());
 

File: src/net/java/sip/communicator/impl/protocol/gibberish/GibberishAccountID.java
Patch:
@@ -22,7 +22,7 @@ public class GibberishAccountID
      * @param userID the user identifier correspnding to thi account
      * @param accountProperties any other properties necessary for the account.
      */
-    GibberishAccountID(String userID, Map accountProperties)
+    GibberishAccountID(String userID, Map<String, String> accountProperties)
     {
         super(userID
               , accountProperties

File: src/net/java/sip/communicator/impl/protocol/gibberish/GibberishActivator.java
Patch:
@@ -60,7 +60,7 @@ public void start(BundleContext context)
     {
         GibberishActivator.bundleContext = context;
 
-        Hashtable hashtable = new Hashtable();
+        Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, "Gibberish");
 
         gibberishProviderFactory = new ProtocolProviderFactoryGibberishImpl();

File: src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolProviderServiceGibberishImpl.java
Patch:
@@ -101,9 +101,7 @@ protected void initialize(String userID,
             //initialize the IM operation set
             OperationSetBasicInstantMessagingGibberishImpl basicInstantMessaging
                 = new OperationSetBasicInstantMessagingGibberishImpl(
-                    this
-                    , (OperationSetPersistentPresenceGibberishImpl)
-                            persistentPresence);
+                    this, persistentPresence);
 
             supportedOperationSets.put(
                 OperationSetBasicInstantMessaging.class.getName(),

File: src/net/java/sip/communicator/impl/protocol/icq/IcqAccountID.java
Patch:
@@ -24,7 +24,7 @@ public class IcqAccountID
      * @param uin the uin identifying this account
      * @param accountProperties any other properties necessary for the account.
      */
-    IcqAccountID(String uin, Map accountProperties )
+    IcqAccountID(String uin, Map<String, String> accountProperties )
     {
         super(uin, accountProperties, 
             isAIM(accountProperties) ? ProtocolNames.AIM : ProtocolNames.ICQ, 

File: src/net/java/sip/communicator/impl/protocol/icq/IcqActivator.java
Patch:
@@ -41,10 +41,10 @@ public void start(BundleContext context) throws Exception
     {
         IcqActivator.bundleContext = context;
 
-        Hashtable icqHashtable = new Hashtable();
+        Hashtable<String, String> icqHashtable = new Hashtable<String, String>();
         icqHashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.ICQ);
         
-        Hashtable aimHashtable = new Hashtable();
+        Hashtable<String, String> aimHashtable = new Hashtable<String, String>();
         aimHashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.AIM);
 
         icqProviderFactory = new ProtocolProviderFactoryIcqImpl(false);

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetBasicInstantMessagingIcqImpl.java
Patch:
@@ -104,7 +104,8 @@ public class OperationSetBasicInstantMessagingIcqImpl
     /**
      * The queue holding the received packets
      */
-    private LinkedList receivedKeepAlivePackets = new LinkedList();
+    private final LinkedList<String> receivedKeepAlivePackets
+        = new LinkedList<String>();
 
     /**
      * The ping message prefix that we use in our keep alive thread.
@@ -674,8 +675,7 @@ public void run()
         boolean checkFirstPacket()
             throws Exception
         {
-            String receivedStr =
-                    (String)receivedKeepAlivePackets.removeLast();
+            String receivedStr = receivedKeepAlivePackets.removeLast();
 
             logger.trace("Last keep alive message is: " + receivedStr);
 

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetPersistentPresenceIcqImpl.java
Patch:
@@ -1450,9 +1450,9 @@ public boolean authorizationRequired(Screenname screenname, Group parentGroup)
                 ContactGroupIcqImpl parent =
                     ssContactList.findContactGroup(parentGroup);
                 srcContact = ssContactList.
-                    createUnresolvedContact((ContactGroupIcqImpl)parent, screenname);
+                    createUnresolvedContact(parent, screenname);
 
-                Buddy buddy = ((ContactIcqImpl)srcContact).getJoustSimBuddy();
+                Buddy buddy = srcContact.getJoustSimBuddy();
 
                 if(buddy instanceof VolatileBuddy)
                     ((VolatileBuddy)buddy).setAwaitingAuthorization(true);
@@ -1481,7 +1481,7 @@ public boolean authorizationRequired(Screenname screenname, Group parentGroup)
                 }
 
 
-                 ((ContactGroupIcqImpl)parent).removeContact(srcContact);
+                 parent.removeContact(srcContact);
                  theAwaitingAuthorizationGroup.addContact(srcContact);
 
                  try

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetServerStoredAccountInfoIcqImpl.java
Patch:
@@ -316,7 +316,7 @@ else if(detail.equals(ServerStoredDetails.GenderDetail.MALE))
                     Iterator i = getDetails(SpokenLanguageDetail.class);
                     while (i.hasNext())
                     {
-                        Object item = (Object) i.next();
+                        Object item = i.next();
                         langs[count++] = getLanguageCode(((SpokenLanguageDetail)item).getLocale());
                     }
                     langs[count] = getLanguageCode(((SpokenLanguageDetail)detail).getLocale());
@@ -642,7 +642,7 @@ else if(newDetailValue.equals(ServerStoredDetails.GenderDetail.MALE))
                     Iterator i = getDetails(SpokenLanguageDetail.class);
                     while (i.hasNext())
                     {
-                        Object item = (Object) i.next();
+                        Object item = i.next();
                         if(item.equals(currentDetailValue))
                             langs[count++] = getLanguageCode(((SpokenLanguageDetail)newDetailValue).getLocale());
                         else

File: src/net/java/sip/communicator/impl/protocol/irc/IrcAccountID.java
Patch:
@@ -25,7 +25,7 @@ public class IrcAccountID
      * @param userID the user identifier corresponding to this account
      * @param accountProperties any other properties necessary for the account.
      */
-    IrcAccountID(String userID, Map accountProperties)
+    IrcAccountID(String userID, Map<String, String> accountProperties)
     {
         super(  userID,
                 accountProperties,
@@ -53,4 +53,4 @@ private static String getServiceName(Map accountProperties)
         else
             return ProtocolNames.IRC;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/protocol/irc/IrcActivator.java
Patch:
@@ -55,7 +55,7 @@ public void start(BundleContext context)
     {
         bundleContext = context;
 
-        Hashtable hashtable = new Hashtable();
+        Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.IRC);
 
         ircProviderFactory = new ProtocolProviderFactoryIrcImpl();
@@ -117,4 +117,4 @@ public static ResourceManagementService getResources()
 
         return resourceService;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/protocol/irc/OperationSetMultiUserChatIrcImpl.java
Patch:
@@ -328,4 +328,4 @@ protected ChatRoomMemberIrcImpl findSystemMember()
                 "", // We don't specify a hostname.
                 ChatRoomMemberRole.GUEST);
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/protocol/irc/UserInfo.java
Patch:
@@ -35,7 +35,7 @@ public class UserInfo
     /**
      * A list of the chat rooms this user is in.
      */
-    private List joinedChatRoom = new LinkedList();
+    private List<String> joinedChatRoom = new LinkedList<String>();
     
     /**
      * Information about the server.
@@ -127,7 +127,7 @@ public long getIdle()
      * 
      * @return a list of the joined chat rooms of this user
      */
-    public List getJoinedChatRooms()
+    public List<String> getJoinedChatRooms()
     {
         return joinedChatRoom;
     }
@@ -212,4 +212,4 @@ protected void setServerInfo(String serverInfo)
     {
         this.serverInfo = serverInfo;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/protocol/jabber/ActiveCallsRepository.java
Patch:
@@ -73,7 +73,7 @@ public void callStateChanged(CallChangeEvent evt)
         if(evt.getEventType().equals(CallChangeEvent.CALL_STATE_CHANGE)
            && ((CallState)evt.getNewValue()).equals(CallState.CALL_ENDED))
         {
-            CallJabberImpl sourceCall = (CallJabberImpl)this.activeCalls
+            CallJabberImpl sourceCall = this.activeCalls
                 .remove(evt.getSourceCall().getCallID());
 
             logger.trace(  "Removing call " + sourceCall + " from the list of "

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberAccountID.java
Patch:
@@ -23,7 +23,7 @@ public class JabberAccountID
      * @param id the id identifying this account
      * @param accountProperties any other properties necessary for the account.
      */
-    JabberAccountID(String id, Map accountProperties )
+    JabberAccountID(String id, Map<String, String> accountProperties )
     {
         super(id, accountProperties, ProtocolNames.JABBER,
               getServiceName(accountProperties));

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetGeolocationJabberImpl.java
Patch:
@@ -84,7 +84,7 @@ public OperationSetGeolocationJabberImpl(
      *
      * @param geolocation our current Geolocation ready to be sent
      */
-    public void publishGeolocation(Map geolocation)
+    public void publishGeolocation(Map<String, String> geolocation)
     {
         GeolocationPresence myGeolocPrez = new GeolocationPresence(opsetprez);
 
@@ -107,7 +107,7 @@ public void publishGeolocation(Map geolocation)
      * geolocation by its identifier.
      * @return the <tt>Geolocation</tt> of the contact.
      */
-    public Map queryContactGeolocation(String contactIdentifier)
+    public Map<String, String> queryContactGeolocation(String contactIdentifier)
     {
         /** @todo implement queryContactGeolocation() */
         return null;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -607,7 +607,7 @@ else if(mode.equals(Presence.Mode.xa))
      */
     public static Presence.Mode presenceStatusToJabberMode(PresenceStatus status)
     {
-        return (Presence.Mode) scToJabberModesMappings.get(status
+        return scToJabberModesMappings.get(status
             .getStatusName());
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetTypingNotificationsJabberImpl.java
Patch:
@@ -46,7 +46,8 @@ public class OperationSetTypingNotificationsJabberImpl
      */
     private MessageEventManager messageEventManager = null;
 
-    private Hashtable packetIDsTable = new Hashtable();
+    private final Map<String, String> packetIDsTable
+        = new Hashtable<String, String>();
 
     /**
      * The listener instance that we use to track chat states according to

File: src/net/java/sip/communicator/impl/protocol/mock/MockAccountID.java
Patch:
@@ -19,7 +19,7 @@ public class MockAccountID
     protected MockAccountID(String userName)
     {
         super(  userName
-              , new java.util.Hashtable()
+              , new java.util.Hashtable<String, String>()
               , ProtocolNames.SIP_COMMUNICATOR_MOCK
               , MOCK_SERVICE_NAME);
     }

File: src/net/java/sip/communicator/impl/protocol/mock/MockProvider.java
Patch:
@@ -151,8 +151,7 @@ public Map<String, OperationSet> getSupportedOperationSets()
      */
     public OperationSet getOperationSet(Class<? extends OperationSet> opsetClass)
     {
-        return (OperationSet) getSupportedOperationSets()
-            .get(opsetClass.getName());
+        return getSupportedOperationSets().get(opsetClass.getName());
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/msn/MsnAccountID.java
Patch:
@@ -17,7 +17,7 @@ public class MsnAccountID
      * @param id the id identifying this account
      * @param accountProperties any other properties necessary for the account.
      */
-    MsnAccountID(String id, Map accountProperties )
+    MsnAccountID(String id, Map<String, String> accountProperties )
     {
         super(id, accountProperties, ProtocolNames.MSN, "msn.com");
     }

File: src/net/java/sip/communicator/impl/protocol/msn/MsnActivator.java
Patch:
@@ -44,7 +44,7 @@ public void start(BundleContext context) throws Exception
     {
         MsnActivator.bundleContext = context;
 
-        Hashtable hashtable = new Hashtable();
+        Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.MSN);
 
         msnProviderFactory = new ProtocolProviderFactoryMsnImpl();

File: src/net/java/sip/communicator/impl/protocol/rss/ImageRetriever.java
Patch:
@@ -80,7 +80,7 @@ public void run()
                                 .iterator();
                 while (iter.hasNext())
                 {
-                    ContactRssImpl contact = (ContactRssImpl) iter.next();
+                    ContactRssImpl contact = iter.next();
 
                     byte[] imgBytes = getAvatar(contact);
 

File: src/net/java/sip/communicator/impl/protocol/rss/ProtocolProviderFactoryRssImpl.java
Patch:
@@ -43,7 +43,7 @@ public ProtocolProviderFactoryRssImpl()
      * @return the AccountID of the newly created account.
      */
     public AccountID installAccount( String userIDStr,
-                                     Map accountProperties)
+                                     Map<String, String> accountProperties)
     {
         BundleContext context
             = RssActivator.getBundleContext();
@@ -76,7 +76,7 @@ public AccountID installAccount( String userIDStr,
         return accountID;
     }
 
-    protected AccountID createAccountID(String userID, Map accountProperties)
+    protected AccountID createAccountID(String userID, Map<String, String> accountProperties)
     {
         return new RssAccountID(userID, accountProperties);
     }
@@ -93,7 +93,7 @@ protected ProtocolProviderService createService(String userID,
 
     @Override
     public void modifyAccount(  ProtocolProviderService protocolProvider,
-                                Map accountProperties)
+                                Map<String, String> accountProperties)
         throws NullPointerException
     {
         // TODO Auto-generated method stub

File: src/net/java/sip/communicator/impl/protocol/rss/ProtocolProviderServiceRssImpl.java
Patch:
@@ -108,9 +108,7 @@ protected void initialize(String userID,
             //OperationSetBasicInstantMessagingRssImpl
                     basicInstantMessaging
                 = new OperationSetBasicInstantMessagingRssImpl(
-                    this
-                    , (OperationSetPersistentPresenceRssImpl)
-                            persistentPresence);
+                    this, persistentPresence);
 
             supportedOperationSets.put(
                 OperationSetBasicInstantMessaging.class.getName(),

File: src/net/java/sip/communicator/impl/protocol/rss/RssAccountID.java
Patch:
@@ -7,7 +7,7 @@
 package net.java.sip.communicator.impl.protocol.rss;
 
 import net.java.sip.communicator.service.protocol.*;
-import java.util.Map;
+import java.util.*;
 
 /**
  * The Rss implementation of a sip-communicator account id.
@@ -22,7 +22,7 @@ public class RssAccountID
      * @param userID the user identifier correspnding to the account
      * @param accountProperties any other properties necessary for the account.
      */
-    RssAccountID(String userID, Map accountProperties)
+    RssAccountID(String userID, Map<String, String> accountProperties)
     {
         super(  userID,
                 accountProperties,

File: src/net/java/sip/communicator/impl/protocol/rss/RssActivator.java
Patch:
@@ -79,7 +79,7 @@ public void start(BundleContext context)
     {
         this.bundleContext = context;
 
-        Hashtable hashtable = new Hashtable();
+        Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, "RSS");
 
         rssProviderFactory = new ProtocolProviderFactoryRssImpl();

File: src/net/java/sip/communicator/impl/protocol/sip/ClientCapabilities.java
Patch:
@@ -72,7 +72,7 @@ public boolean processRequest(RequestEvent requestEvent)
             //add to the allows header all methods that we support
             while(supportedMethods.hasNext())
             {
-                String method = (String)supportedMethods.next();
+                String method = supportedMethods.next();
 
                 //don't support REGISTERs
                 if(method.equals(Request.REGISTER))
@@ -282,7 +282,7 @@ public void run()
                 //add to the allows header all methods that we support
                 while(supportedMethods.hasNext())
                 {
-                    String method = (String)supportedMethods.next();
+                    String method = supportedMethods.next();
 
                     //don't support REGISTERs
                     if(method.equals(Request.REGISTER))
@@ -299,7 +299,7 @@ public void run()
                 {
                     while (events.hasNext())
                     {
-                        String event = (String) events.next();
+                        String event = events.next();
 
                         request.addHeader(provider.getHeaderFactory()
                                 .createAllowEventsHeader(event));

File: src/net/java/sip/communicator/impl/protocol/sip/ContactGroupSipImpl.java
Patch:
@@ -285,7 +285,7 @@ public Contact getContact(String id)
      */
     public ContactGroup getGroup(int index)
     {
-        return (ContactGroup)subGroups.get(index);
+        return subGroups.get(index);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderFactorySipImpl.java
Patch:
@@ -134,8 +134,7 @@ public void modifyAccount(  ProtocolProviderService protocolProvider,
         if(!registeredAccounts.containsKey(accountID))
             return;
 
-        ServiceRegistration registration
-            = (ServiceRegistration) registeredAccounts.get(accountID);
+        ServiceRegistration registration = registeredAccounts.get(accountID);
 
         // kill the service
         if (registration != null)

File: src/net/java/sip/communicator/impl/protocol/sip/SipAccountID.java
Patch:
@@ -39,11 +39,11 @@ private static String stripServerNameFromUserID(String userID)
      * @param accountProperties any other properties necessary for the account.
      * @param serverName the name of the server that the user belongs to.
      */
-    protected SipAccountID(String userID, Map accountProperties,
+    protected SipAccountID(String userID, Map<String, String> accountProperties,
         String serverName)
     {
         super(stripServerNameFromUserID(userID), accountProperties,
-            (String) accountProperties.get(ProtocolProviderFactory.PROTOCOL),
+            accountProperties.get(ProtocolProviderFactory.PROTOCOL),
             serverName);
     }
 

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackSharing.java
Patch:
@@ -775,7 +775,7 @@ private ProtocolProviderServiceSipImpl findTargetFor(Request request)
             // one of ours usernames
             for(ProtocolProviderServiceSipImpl listener : currentListeners)
             {
-                String ourUserID = (String) listener.getAccountID().getUserID();
+                String ourUserID = listener.getAccountID().getUserID();
                 //logger.trace(ourUserID + " *** " + requestUser);
                 if(ourUserID.equals(requestUser))
                 {

File: src/net/java/sip/communicator/impl/protocol/sip/security/CredentialsCacheEntry.java
Patch:
@@ -28,7 +28,7 @@ class CredentialsCacheEntry
      * has not reached this class). The transactionHistory's elements are Strings
      * corresponding to branch ids.
      */
-    private Vector transactionHistory = new Vector();
+    private Vector<String> transactionHistory = new Vector<String>();
 
     /**
      * Adds the specified branch id to the transaction history list so that we

File: src/net/java/sip/communicator/impl/protocol/ssh/OperationSetPersistentPresenceSSHImpl.java
Patch:
@@ -745,7 +745,7 @@ public Contact createUnresolvedContact(
      */
     public List findContactsPointingToUs()
     {
-        List contacts = new LinkedList();
+        List<Contact> contacts = new LinkedList<Contact>();
         BundleContext bc = SSHActivator.getBundleContext();
         
         String osgiQuery =

File: src/net/java/sip/communicator/impl/protocol/ssh/ProtocolProviderFactorySSHImpl.java
Patch:
@@ -48,7 +48,7 @@ public ProtocolProviderFactorySSHImpl()
      */
     public AccountID installAccount( 
             String userIDStr,
-            Map accountProperties)
+            Map<String, String> accountProperties)
     {
         BundleContext context = SSHActivator.getBundleContext();
         if (context == null)
@@ -104,7 +104,7 @@ public AccountID installAccount(
         return accountID;
     }
 
-    protected AccountID createAccountID(String userID, Map accountProperties)
+    protected AccountID createAccountID(String userID, Map<String, String> accountProperties)
     {
         return new SSHAccountID(userID, accountProperties);
     }
@@ -160,7 +160,7 @@ protected ProtocolProviderService createService(String userID,
 
     @Override
     public void modifyAccount(  ProtocolProviderService protocolProvider,
-                                Map accountProperties)
+                                Map<String, String> accountProperties)
         throws NullPointerException
     {
         // TODO Auto-generated method stub

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHAccountID.java
Patch:
@@ -28,7 +28,7 @@ public class SSHAccountID
      * @param userID the user identifier correspnding to thi account
      * @param accountProperties any other properties necessary for the account.
      */
-    SSHAccountID(String userID, Map accountProperties)
+    SSHAccountID(String userID, Map<String, String> accountProperties)
     {
         super(userID
               , accountProperties

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHActivator.java
Patch:
@@ -65,7 +65,7 @@ public void start(BundleContext context)
     {
         this.bundleContext = context;
         
-        Hashtable hashtable = new Hashtable();
+        Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, "SSH");
 
         sshProviderFactory = new ProtocolProviderFactorySSHImpl();

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetMultiUserChatYahooImpl.java
Patch:
@@ -206,7 +206,7 @@ public List<ChatRoom> getCurrentlyJoinedChatRooms()
 
            while (joinedRoomsIter.hasNext())
            {
-               if (!((ChatRoom) joinedRoomsIter.next()).isJoined())
+               if (!joinedRoomsIter.next().isJoined())
                    joinedRoomsIter.remove();
            }
 

File: src/net/java/sip/communicator/impl/protocol/yahoo/YahooAccountID.java
Patch:
@@ -23,7 +23,7 @@ public class YahooAccountID
      * @param id the id identifying this account
      * @param accountProperties any other properties necessary for the account.
      */
-    YahooAccountID(String id, Map accountProperties )
+    YahooAccountID(String id, Map<String, String> accountProperties )
     {
         super(YahooSession.getYahooUserID(id), 
               accountProperties, ProtocolNames.YAHOO, "yahoo.com");

File: src/net/java/sip/communicator/impl/protocol/yahoo/YahooActivator.java
Patch:
@@ -43,7 +43,7 @@ public class YahooActivator
     public void start(BundleContext context) throws Exception
     {
         this.bundleContext = context;
-        Hashtable hashtable = new Hashtable();
+        Hashtable<String, String> hashtable = new Hashtable<String, String>();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.YAHOO);
 
         yahooProviderFactory = new ProtocolProviderFactoryYahooImpl();

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ProtocolProviderFactoryZeroconfImpl.java
Patch:
@@ -44,7 +44,7 @@ public ProtocolProviderFactoryZeroconfImpl()
      * @return the AccountID of the newly created account.
      */
     public AccountID installAccount( String userIDStr,
-                                     Map accountProperties)
+                                     Map<String, String> accountProperties)
     {
         BundleContext context
             = ZeroconfActivator.getBundleContext();
@@ -81,7 +81,7 @@ public AccountID installAccount( String userIDStr,
         return accountID;
     }
 
-    protected AccountID createAccountID(String userID, Map accountProperties)
+    protected AccountID createAccountID(String userID, Map<String, String> accountProperties)
     {
         return new ZeroconfAccountID(userID, accountProperties);
     }
@@ -98,7 +98,7 @@ protected ProtocolProviderService createService(String userID,
 
     @Override
     public void modifyAccount(  ProtocolProviderService protocolProvider,
-                                Map accountProperties)
+                                Map<String, String> accountProperties)
         throws NullPointerException
     {
         // TODO Auto-generated method stub

File: src/net/java/sip/communicator/impl/protocol/zeroconf/jmdns/DNSState.java
Patch:
@@ -69,7 +69,7 @@ public final String toString()
     public final DNSState advance()
     {
         return (isProbing() || isAnnouncing()) ? 
-            (DNSState) sequence.get(ordinal + 1) : 
+            sequence.get(ordinal + 1) : 
             this;
     }
 
@@ -121,4 +121,4 @@ public int compareTo(DNSState state)
     {
         return ordinal - state.ordinal;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/plugin/autoaway/AutoAwayConfigurationPanel.java
Patch:
@@ -114,7 +114,7 @@ private void initValues()
             this.timer.setEnabled(false);
         }
 
-        String t = (String) configService.getString(Preferences.TIMER);
+        String t = configService.getString(Preferences.TIMER);
         if (t != null)
         {
             try

File: src/net/java/sip/communicator/plugin/autoaway/StatusUpdateThread.java
Patch:
@@ -194,7 +194,7 @@ private int getTimer()
             return 0;
         }
 
-        String t = (String) configService.getString(Preferences.TIMER);
+        String t = configService.getString(Preferences.TIMER);
         int timer = 0;
         try
         {

File: src/net/java/sip/communicator/plugin/callhistoryform/ExtendedCallHistorySearchDialog.java
Patch:
@@ -411,7 +411,7 @@ private void loadTableRecords(Collection<CallRecord> historyCalls,
         {
             addMe = true;
 
-            CallRecord callRecord = (CallRecord) lastCalls.next();
+            CallRecord callRecord = lastCalls.next();
 
             /* DATE Checking */
             Date callStartDate = callRecord.getStartTime();

File: src/net/java/sip/communicator/plugin/facebookaccregwizz/FirstWizardPage.java
Patch:
@@ -315,7 +315,7 @@ public void pageBack()
     public void loadAccount(ProtocolProviderService protocolProvider)
     {
         AccountID accountID = protocolProvider.getAccountID();
-        String password = (String) accountID.getAccountProperties()
+        String password = accountID.getAccountProperties()
             .get(ProtocolProviderFactory.PASSWORD);
 
         this.emailField.setEnabled(false);

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberServerChooserDialog.java
Patch:
@@ -67,7 +67,7 @@ public class JabberServerChooserDialog
     private JButton cancelButton = new JButton(Resources
         .getString("cancelLabel"));
 
-    private Vector servers = new Vector();
+    private Vector<String> servers = new Vector<String>();
     
     private FileAccessService faService = null;
 

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardActivator.java
Patch:
@@ -84,7 +84,7 @@ public static UIService getUiService()
      */
     public static List getWhiteboardOperationSets()
     {
-        List whiteboardOpSets = new ArrayList();
+        List<OperationSet> whiteboardOpSets = new ArrayList<OperationSet>();
 
         ServiceReference[] serRefs = null;
         try
@@ -118,4 +118,4 @@ public static List getWhiteboardOperationSets()
 
         return whiteboardOpSets;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardSessionManager.java
Patch:
@@ -462,7 +462,7 @@ private WhiteboardFrame getWhiteboardFrame (Contact contact)
 
         for(int i =0; i < wbFrames.size (); i++)
         {
-            whiteboardFrame = (WhiteboardFrame) wbFrames.get (i);
+            whiteboardFrame = wbFrames.get (i);
 
             if (whiteboardFrame.getContact() != null
                 && whiteboardFrame.getContact().equals (contact))
@@ -654,4 +654,4 @@ public void removeWhiteboardWindow(WhiteboardFrame frame)
             wbFrames.remove(frame);
         }
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/service/protocol/OperationSetGeolocation.java
Patch:
@@ -145,7 +145,7 @@ public interface OperationSetGeolocation
      * @param geolocation a <tt>java.uil.Map</tt> containing the geolocation
      * details of the position we'd like to publish.
      */
-    public void publishGeolocation(Map geolocation);
+    public void publishGeolocation(Map<String, String> geolocation);
 
     /**
      * Retrieve the geolocation of the contact corresponding to
@@ -157,7 +157,7 @@ public interface OperationSetGeolocation
      * @return a <tt>java.util.Map</tt> containing the geolocation details of
      * the contact with address <tt>contactIdentifier</tt>.
      */
-    public Map queryContactGeolocation(String contactIdentifier);
+    public Map<String, String> queryContactGeolocation(String contactIdentifier);
 
     /**
      * Registers a listener that would get notifications any time a contact

File: src/net/java/sip/communicator/service/protocol/msnconstants/MsnStatusEnum.java
Patch:
@@ -103,7 +103,8 @@ public class MsnStatusEnum
     /**
      * The minimal set of states that any implementation must support.
      */
-    public static final ArrayList msnStatusSet =new ArrayList();
+    public static final ArrayList<MsnStatusEnum> msnStatusSet
+        = new ArrayList<MsnStatusEnum>();
     static{
             msnStatusSet.add(OUT_TO_LUNCH);
             msnStatusSet.add(ON_THE_PHONE);

File: src/net/java/sip/communicator/service/protocol/yahooconstants/YahooStatusEnum.java
Patch:
@@ -133,7 +133,8 @@ public class YahooStatusEnum
     /**
      * The minimal set of states that any implementation must support.
      */
-    public static final ArrayList yahooStatusSet =new ArrayList();
+    public static final ArrayList<YahooStatusEnum> yahooStatusSet
+        = new ArrayList<YahooStatusEnum>();
     static{
             yahooStatusSet.add(AVAILABLE);
             yahooStatusSet.add(BE_RIGHT_BACK);

File: src/net/java/sip/communicator/util/swing/plaf/SIPCommTabbedPaneUI.java
Patch:
@@ -50,7 +50,7 @@ public class SIPCommTabbedPaneUI
     // Instance variables initialized at installation
     private ContainerListener containerListener;
 
-    private Vector htmlViews;
+    private Vector<View> htmlViews;
 
     private Map<Integer, Integer> mnemonicToIndexMap;
 
@@ -1600,9 +1600,9 @@ public void componentRemoved(ContainerEvent e)
         }
     }
 
-    private Vector createHTMLVector()
+    private Vector<View> createHTMLVector()
     {
-        Vector htmlViews = new Vector();
+        Vector<View> htmlViews = new Vector<View>();
         int count = tabPane.getTabCount();
         if (count > 0) {
             for (int i = 0; i < count; i++)

File: src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolIconGibberishImpl.java
Patch:
@@ -73,7 +73,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolIconAimImpl.java
Patch:
@@ -73,7 +73,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolIconIcqImpl.java
Patch:
@@ -73,7 +73,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/irc/ProtocolIconIrcImpl.java
Patch:
@@ -73,7 +73,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**
@@ -132,4 +132,4 @@ public static ResourceManagementService getResources()
 
         return resourcesService;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolIconJabberImpl.java
Patch:
@@ -88,7 +88,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolIconMsnImpl.java
Patch:
@@ -67,7 +67,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/rss/ProtocolIconRssImpl.java
Patch:
@@ -73,7 +73,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolIconSipImpl.java
Patch:
@@ -93,7 +93,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/ssh/ProtocolIconSSHImpl.java
Patch:
@@ -76,7 +76,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/yahoo/ProtocolIconYahooImpl.java
Patch:
@@ -72,7 +72,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ProtocolIconZeroconfImpl.java
Patch:
@@ -77,7 +77,7 @@ public boolean isSizeSupported(String iconSize)
      */
     public byte[] getIcon(String iconSize)
     {
-        return (byte[])iconsTable.get(iconSize);
+        return iconsTable.get(iconSize);
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/SelectGroupPanel.java
Patch:
@@ -188,11 +188,10 @@ private static class GroupWrapper
 
         public GroupWrapper(MetaContactGroup group)
         {
-            this.group = group;
-            this.groupName = group.getGroupName();
+            this(group, group.getGroupName());
         }
 
-        public GroupWrapper(String groupName, MetaContactGroup group)
+        public GroupWrapper(MetaContactGroup group, String groupName)
         {
             this.group = group;
             this.groupName = groupName;

File: src/net/java/sip/communicator/plugin/accountinfo/AccountDetailsPanel.java
Patch:
@@ -542,12 +542,11 @@ private class SubmitActionListener implements ActionListener
         public void actionPerformed(ActionEvent e)
         {
             String firstName = firstNameField.getText();
-            String middleName = middleNameField.getText();
+//            String middleName = middleNameField.getText();
             String lastName = lastNameField.getText();
             String gender = genderField.getText();
             String email = emailField.getText();
             String phoneNumber = phoneField.getText();
-            Icon avatar = avatarLabel.getIcon();
 
             Calendar birthDateCalendar = Calendar.getInstance();
 

File: src/net/java/sip/communicator/plugin/icqaccregwizz/IcqAccountRegistration.java
Patch:
@@ -30,8 +30,6 @@ public class IcqAccountRegistration
 
     private String proxyPassword;
 
-    private boolean isAdvancedSettingsEnabled = false;
-
     /**
      * Returns the password of the icq registration account.
      * @return the password of the icq registration account.

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatBuffer.java
Patch:
@@ -8,7 +8,7 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
+import net.java.sip.communicator.service.gui.*;
 
 /**
  * Should be used to limit the number of messages shown in the chat conversation
@@ -25,15 +25,15 @@ public class ChatBuffer<E> extends ArrayList<E> {
      * <tt>Constants</tt> class.
      */
     public ChatBuffer() {
-        super(Constants.CHAT_BUFFER_SIZE);
+        super(Chat.CHAT_BUFFER_SIZE);
     }
 
     /**
      * Removes the first buffer element when the buffer limit is
      * reached.
      */
     private void recalculateBuffer() {
-        if (this.size() >= Constants.CHAT_BUFFER_SIZE) {
+        if (this.size() >= Chat.CHAT_BUFFER_SIZE) {
             this.remove(0);
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/chat/SendSmsDialog.java
Patch:
@@ -13,7 +13,7 @@
 
 import net.java.sip.communicator.impl.gui.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
+import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
 
@@ -134,7 +134,7 @@ private void sendSmsMessage(String phoneNumber, String message)
             chatPanel.addMessage(
                 phoneNumber,
                 System.currentTimeMillis(),
-                Constants.OUTGOING_MESSAGE,
+                Chat.OUTGOING_MESSAGE,
                 message,
                 "text/plain");
 
@@ -152,7 +152,7 @@ private void sendSmsMessage(String phoneNumber, String message)
             chatPanel.addMessage(
                 phoneNumber,
                 System.currentTimeMillis(),
-                Constants.OUTGOING_MESSAGE,
+                Chat.OUTGOING_MESSAGE,
                 message,
                 "text/plain");
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.event.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.main.chat.menus.*;
 import net.java.sip.communicator.impl.gui.main.chat.toolBars.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/MessageWindowMenuBar.java
Patch:
@@ -12,7 +12,6 @@
 import org.osgi.framework.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetFileTransferIcqImpl.java
Patch:
@@ -81,8 +81,8 @@ public FileTransfer sendFile(   Contact toContact,
         assertConnected();
 
         if(file.length() > getMaximumFileLength())
-                throw new IllegalArgumentException(
-                    "File length exceeds the allowed one for this protocol");
+            throw new IllegalArgumentException(
+                "File length exceeds the allowed one for this protocol");
 
         // Get the aim connection
         AimConnection aimConnection = icqProvider.getAimConnection();

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetFileTransferMsnImpl.java
Patch:
@@ -80,8 +80,8 @@ public FileTransfer sendFile(   Contact toContact,
         assertConnected();
 
         if(file.length() > getMaximumFileLength())
-                throw new IllegalArgumentException(
-                    "File length exceeds the allowed one for this protocol");
+            throw new IllegalArgumentException(
+                "File length exceeds the allowed one for this protocol");
 
         if( !(toContact instanceof ContactMsnImpl) )
             throw new IllegalArgumentException(

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -532,12 +532,13 @@ protected void initialize(String screenname,
                     OperationSetExtendedAuthorizations.class.getName(),
                     extendedAuth);
 
-                OperationSetFileTransferIcqImpl fileTransferOpSet =
+            }
+
+            OperationSetFileTransferIcqImpl fileTransferOpSet =
                     new OperationSetFileTransferIcqImpl(this);
                 supportedOperationSets.put(
                     OperationSetFileTransfer.class.getName(),
                     fileTransferOpSet);
-            }
 
             isInitialized = true;
         }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -715,7 +715,7 @@ protected void close(boolean isEscaped)
             WritePanelRightButtonMenu writePanelRightMenu =
                 chatWritePanel.getRightButtonMenu();
 
-            SIPCommMenu selectedMenu = menuBar.getSelectedMenu();
+            JMenu selectedMenu = menuBar.getSelectedMenu();
             // SIPCommMenu contactMenu = getCurrentChatPanel()
             // .getProtoContactSelectorBox().getMenu();
 

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/MessageWindowMenuBar.java
Patch:
@@ -121,13 +121,13 @@ private void init()
     /**
      * Returns the currently selected menu.
      */
-    public SIPCommMenu getSelectedMenu()
+    public JMenu getSelectedMenu()
     {
         int menuCount = this.getMenuCount();
 
         for (int i = 0; i < menuCount; i++)
         {
-            SIPCommMenu menu = (SIPCommMenu) this.getMenu(i);
+            JMenu menu = this.getMenu(i);
 
             if (menu.isSelected())
             {

File: src/net/java/sip/communicator/plugin/aimaccregwizz/AimAccountRegistrationWizard.java
Patch:
@@ -29,7 +29,8 @@ public class AimAccountRegistrationWizard
 
     private FirstWizardPage firstWizardPage;
 
-    private AimAccountRegistration registration = new AimAccountRegistration();
+    private final AimAccountRegistration registration
+        = new AimAccountRegistration();
 
     private WizardContainer wizardContainer;
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -427,7 +427,7 @@ public void setCaretToEnd()
      */
     public void requestFocusInWriteArea()
     {
-        getChatWritePanel().getEditorPane().requestFocus();
+        getChatWritePanel().getEditorPane().requestFocusInWindow();
     }
 
     /**

File: src/net/java/sip/communicator/util/FileUtils.java
Patch:
@@ -75,7 +75,7 @@ public static Icon getIcon(File file)
             }
             catch (Exception e1)
             {
-                logger.debug("Failed to obtain file icon from JFileChooser.", e);
+                logger.debug("Failed to obtain file icon from JFileChooser.", e1);
             }
         }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -543,9 +543,9 @@ public ChatPanel getMultiChat(  ChatRoom chatRoom,
     }
 
     /**
-     * Returns all open ChatPanel�s
+     * Returns all open <code>ChatPanel</code>s.
      *
-     * @return  A list of ChatPanels
+     * @return  A list of <code>ChatPanel</code>s
      */
     public List<ChatPanel> getChatPanels()
     {

File: src/net/java/sip/communicator/impl/configuration/PropertyConfigurationStore.java
Patch:
@@ -19,7 +19,9 @@ public class PropertyConfigurationStore
 
     public Object getProperty(String name)
     {
-        return properties.get(name);
+        Object value = properties.get(name);
+
+        return (value != null) ? value : System.getProperty(name);
     }
 
     public String[] getPropertyNames()

File: src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolIconGibberishImpl.java
Patch:
@@ -54,7 +54,7 @@ public class ProtocolIconGibberishImpl
      * an iterator to a set containing the supported icon sizes.
      * @return an iterator to a set containing the supported icon sizes
      */
-    public Iterator getSupportedSizes()
+    public Iterator<String> getSupportedSizes()
     {
         return iconsTable.keySet().iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolIconMsnImpl.java
Patch:
@@ -48,7 +48,7 @@ public class ProtocolIconMsnImpl
      * an iterator to a set containing the supported icon sizes.
      * @return an iterator to a set containing the supported icon sizes
      */
-    public Iterator getSupportedSizes()
+    public Iterator<String> getSupportedSizes()
     {
         return iconsTable.keySet().iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ZeroconfStatusEnum.java
Patch:
@@ -113,7 +113,7 @@ static Iterator<PresenceStatus> supportedStatusSet()
      */
     static ZeroconfStatusEnum statusOf(String status)
     {
-        Iterator statusIter = supportedStatusSet();
+        Iterator<PresenceStatus> statusIter = supportedStatusSet();
         while (statusIter.hasNext())
         {
             ZeroconfStatusEnum state = (ZeroconfStatusEnum)statusIter.next();

File: src/net/java/sip/communicator/impl/protocol/facebook/FacebookAdapter.java
Patch:
@@ -1189,7 +1189,7 @@ int reconnect()
         JSONObject payload = response.getJSONObject("payload");
 
         String host = payload.getString("host");
-        channel = host.substring("channel".length());
+        channel = substring(host, "channel".length(), host.length());
 
         return payload.getInt("seq");
     }

File: src/net/java/sip/communicator/impl/protocol/facebook/ProtocolProviderFactoryFacebookImpl.java
Patch:
@@ -8,7 +8,6 @@
 import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
 
 import org.osgi.framework.*;
 

File: src/net/java/sip/communicator/impl/protocol/ssh/OperationSetFileTransferSSHImpl.java
Patch:
@@ -14,8 +14,6 @@
 import java.io.*;
 import java.util.*;
 
-import javax.management.*;
-
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/filehistory/FileHistoryServiceImpl.java
Patch:
@@ -785,12 +785,12 @@ public void fileTransferCreated(FileTransferCreatedEvent event)
                     STRUCTURE_NAMES[4],
                     fileTransfer.getID(),
                     STRUCTURE_NAMES[0],
-                    fileTransfer.getFile().getCanonicalPath());
+                    fileTransfer.getLocalFile().getCanonicalPath());
             }
             else if (fileTransfer.getDirection() == FileTransfer.OUT)
             {
                 historyWriter.addRecord(new String[]{
-                    fileTransfer.getFile().getCanonicalPath(),
+                    fileTransfer.getLocalFile().getCanonicalPath(),
                     getDirection(FileTransfer.OUT),
                     String.valueOf(event.getTimestamp().getTime()),
                     FILE_TRANSFER_ACTIVE,

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -1906,6 +1906,7 @@ public void statusChanged(FileTransferStatusChangeEvent event)
             || newStatus == FileTransferStatusChangeEvent.REFUSED)
         {
             removeActiveFileTransfer(fileTransfer.getID());
+            fileTransfer.removeStatusListener(this);
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/geolocation/GeolocationPacketExtension.java
Patch:
@@ -241,7 +241,7 @@ public class GeolocationPacketExtension
     private String timestamp = null;
 
     /**
-     * Returns the XML reppresentation of the PacketExtension.
+     * Returns the XML representation of the PacketExtension.
      *
      * @return the packet extension as XML.
      * @todo Implement this org.jivesoftware.smack.packet.PacketExtension

File: src/net/java/sip/communicator/impl/protocol/mock/MockFileTransferImpl.java
Patch:
@@ -18,8 +18,8 @@ public class MockFileTransferImpl
     extends AbstractFileTransfer
 {
     private String id = null;
-    private int direction;
-    private File file = null;
+    private final int direction;
+    private final File file;
     private Contact contact = null;
 
     public MockFileTransferImpl(Contact c, File file, String id, int direction)
@@ -61,7 +61,7 @@ public int getDirection()
         return direction;
     }
 
-    public File getFile()
+    public File getLocalFile()
     {
         return file;
     }

File: src/net/java/sip/communicator/impl/protocol/ssh/FileTransferSSHImpl.java
Patch:
@@ -61,7 +61,7 @@ public int getDirection()
         return IN;
     }
 
-    public File getFile()
+    public File getLocalFile()
     {
         return null;
     }

File: src/net/java/sip/communicator/impl/protocol/ssh/OperationSetFileTransferSSHImpl.java
Patch:
@@ -14,6 +14,8 @@
 import java.io.*;
 import java.util.*;
 
+import javax.management.*;
+
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/protocol/yahoo/FileTransferImpl.java
Patch:
@@ -79,7 +79,7 @@ public int getDirection()
      *
      * @return the file
      */
-    public File getFile()
+    public File getLocalFile()
     {
         return file;
     }

File: src/net/java/sip/communicator/service/protocol/FileTransfer.java
Patch:
@@ -50,11 +50,11 @@ public interface FileTransfer
     public int getDirection();
 
     /**
-     * Returns the file that is transfered.
+     * Returns the local file that is being transferred or to which we transfer.
      *
      * @return the file
      */
-    public File getFile();
+    public File getLocalFile();
 
     /**
      * Returns the contact that we are transfering files with.

File: src/net/java/sip/communicator/impl/protocol/icq/FileTransferImpl.java
Patch:
@@ -221,7 +221,7 @@ public void run()
 
                                 setTransferedBytes(transfered);
                                 fireProgressChangeEvent(
-                                    System.currentTimeMillis(), (int)transfered);
+                                    System.currentTimeMillis(), transfered);
 
                                 try {
                                     Thread.sleep(100);

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetFileTransferJabberImpl.java
Patch:
@@ -385,7 +385,7 @@ public FileTransferProgressThread(
         public void run()
         {
             int status;
-            double progress;
+            long progress;
 
             while (true)
             {
@@ -406,7 +406,7 @@ public void run()
 
                     fileTransfer.fireStatusChangeEvent(status);
                     fileTransfer.fireProgressChangeEvent(
-                        System.currentTimeMillis(), (int) progress);
+                        System.currentTimeMillis(), progress);
                 }
                 catch (InterruptedException e)
                 {
@@ -423,7 +423,7 @@ public void run()
 
             fileTransfer.fireStatusChangeEvent(status);
             fileTransfer.fireProgressChangeEvent(
-                System.currentTimeMillis(), (int) progress);
+                System.currentTimeMillis(), progress);
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetFileTransferYahooImpl.java
Patch:
@@ -398,7 +398,7 @@ public void statusChanged(SessionFileTransferEvent ev)
 
             ft.setTransferedBytes(ev.getProgress());
             ft.fireProgressChangeEvent(
-                System.currentTimeMillis(), (int)ev.getProgress());
+                System.currentTimeMillis(), ev.getProgress());
         }
         else
             ft.fireStatusChangeEvent(getStateMapping(newState));

File: src/net/java/sip/communicator/service/protocol/AbstractFileTransfer.java
Patch:
@@ -158,8 +158,10 @@ public void fireStatusChangeEvent(int newStatus)
     /**
      * Notifies all status listeners that a new
      * <tt>FileTransferProgressEvent</tt> occured.
+     * @param timestamp the date on which the event occured
+     * @param progress the bytes representing the progress of the transfer
      */
-    public void fireProgressChangeEvent(long timestamp, int progress)
+    public void fireProgressChangeEvent(long timestamp, long progress)
     {
         Collection<FileTransferProgressListener> listeners = null;
         synchronized (progressListeners)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatSessionRenderer.java
Patch:
@@ -8,8 +8,6 @@
 
 import java.util.*;
 
-import java.util.*;
-
 import net.java.sip.communicator.service.protocol.*;
 
 /**

File: src/net/java/sip/communicator/service/protocol/FileTransfer.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.service.protocol;
 
 import java.io.*;
-import java.util.*;
 
 import net.java.sip.communicator.service.protocol.event.*;
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetVideoTelephonySipImpl.java
Patch:
@@ -26,7 +26,7 @@
  * <code>OperationSetVideoTelephony</code> is the provider because other
  * implementation may not provider their video through the
  * <code>CallSession</code>.
- * 
+ *
  * @author Lubomir Marinov
  */
 public class OperationSetVideoTelephonySipImpl
@@ -288,7 +288,7 @@ private static class InternalVideoListener
          * <code>OperationSetVideoTelephony</code> for a specific
          * <code>VideoListener</code> interested in the videos of a specific
          * <code>CallParticipant</code>.
-         * 
+         *
          * @param telephony the <code>OperationSetVideoTelephony</code> which is
          *            to be stated as the source of the <code>VideoEvent</code>
          *            sent to the specified delegate <code>VideoListener</code>

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -200,6 +200,7 @@ public String processMessage(ChatMessage chatMessage)
         String contentType = chatMessage.getContentType();
         long date = chatMessage.getDate();
         String messageType = chatMessage.getMessageType();
+        String messageTitle = chatMessage.getMessageTitle();
         String message = chatMessage.getMessage();
 
         String msgID = "message";
@@ -320,8 +321,7 @@ else if (messageType.equals(Constants.ERROR_MESSAGE))
                 + "' </IMG>";
 
             chatString += errorIcon
-                + GuiActivator.getResources()
-                    .getI18NString("service.gui.MSG_DELIVERY_FAILURE")
+                + messageTitle
                 + endHeaderTag + "<h5>" + message + "</h5>";
         }
         else if (messageType.equals(Constants.HISTORY_INCOMING_MESSAGE))

File: src/net/java/sip/communicator/impl/gui/main/contactlist/DefaultContactList.java
Patch:
@@ -36,6 +36,7 @@ public DefaultContactList()
         this.getSelectionModel().setSelectionMode(
                 ListSelectionModel.SINGLE_SELECTION);
 
+        this.setTransferHandler(new ContactListTransferHandler(this));
         this.setCellRenderer(new ContactListCellRenderer());
     }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationComponent.java
Patch:
@@ -46,8 +46,6 @@ public abstract class ChatConversationComponent
     protected static final ResourceManagementService resources
         = GuiActivator.getResources();
 
-    private Date date;
-
     /**
      * Creates a <tt>ChatConversationComponent</tt>.
      */

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -76,7 +76,7 @@ public ChatWritePanel(ChatPanel panel)
             JEditorPane.HONOR_DISPLAY_PROPERTIES, Boolean.TRUE);
 
         this.editorPane.setCaretPosition(0);
-        this.editorPane.setEditorKit(new SIPCommHTMLEditorKit());
+        this.editorPane.setEditorKit(new SIPCommHTMLEditorKit(this));
         this.editorPane.getDocument().addUndoableEditListener(this);
         this.editorPane.addKeyListener(this);
         this.editorPane.addMouseListener(this);

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -93,7 +93,8 @@ private CallParticipantPanel addCallParticipant(
 
         if (participantPanel == null)
         {
-            participantPanel = new CallParticipantPanel(participant);
+            participantPanel
+                = new CallParticipantPanel(callDialog, participant);
 
             this.mainPanel.add(participantPanel);
 

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -117,7 +117,7 @@ public class MediaControl
      * expresses the desire of the user to have the local video streamed in the
      * case the system is actually able to do so.
      */
-    private boolean localVideoAllowed = true;
+    private boolean localVideoAllowed = false;
 
     /**
      * The default constructor.

File: src/net/java/sip/communicator/impl/protocol/sip/SipRegistrarConnection.java
Patch:
@@ -951,7 +951,7 @@ else if (response.getStatusCode() == Response.FORBIDDEN)
             processed = true;
         }
         //errors
-        else if ( response.getStatusCode() / 100 == 4 )
+        else if ( response.getStatusCode() >= 400 )
         {
             logger.error("Received an error response.");
 

File: src/net/java/sip/communicator/impl/protocol/sip/security/SipSecurityManager.java
Patch:
@@ -500,9 +500,9 @@ private CredentialsCacheEntry createCcEntryWithNewCredentials(
         String authName = accountID.getAccountPropertyString(
                                     ProtocolProviderFactory.AUTHORIZATION_NAME);
         if(authName != null && authName.length() > 0)
-            ccEntry.userCredentials.setUserName(authName);
+            defaultCredentials.setUserName(authName);
         else
-            ccEntry.userCredentials.setUserName(accountID.getUserID());
+            defaultCredentials.setUserName(accountID.getUserID());
 
         UserCredentials newCredentials = 
             getSecurityAuthority().obtainCredentials(

File: src/net/java/sip/communicator/impl/media/MediaConfigurationPanel.java
Patch:
@@ -150,10 +150,12 @@ private Component createEncodingControls(int type)
         key = "impl.media.configform.UP";
         final JButton upButton = new JButton(resources.getI18NString(key));
         upButton.setMnemonic(resources.getI18nMnemonic(key));
+        upButton.setOpaque(false);
 
         key = "impl.media.configform.DOWN";
         final JButton downButton = new JButton(resources.getI18NString(key));
         downButton.setMnemonic(resources.getI18nMnemonic(key));
+        downButton.setOpaque(false);
 
         Container buttonBar = new TransparentPanel(new GridLayout(0, 1));
         buttonBar.add(upButton);

File: src/net/java/sip/communicator/plugin/pluginmanager/NewBundleDialog.java
Patch:
@@ -60,6 +60,7 @@ public NewBundleDialog ()
         this.installButton.addActionListener(this);
         this.cancelButton.addActionListener(this);
         this.fileChooserButton.addActionListener(this);
+        this.fileChooserButton.setOpaque(false);
 
         this.dataPanel.add(bundlePathLabel, BorderLayout.WEST);
 

File: src/net/java/sip/communicator/impl/gui/GuiActivator.java
Patch:
@@ -19,7 +19,6 @@
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.keybindings.*;
 import net.java.sip.communicator.service.metahistory.*;
-import net.java.sip.communicator.service.msghistory.*;
 import net.java.sip.communicator.service.notification.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.resources.*;

File: src/net/java/sip/communicator/impl/gui/utils/Constants.java
Patch:
@@ -10,10 +10,8 @@
 import java.awt.event.*;
 import java.awt.image.*;
 import java.io.*;
-import java.util.*;
 
 import javax.swing.*;
-import javax.swing.text.*;
 import javax.swing.text.html.*;
 
 import net.java.sip.communicator.impl.gui.*;

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetPersistentPresenceIcqImpl.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.impl.protocol.icq;
 
-import java.beans.PropertyChangeEvent;
 import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestOperationSetTypingNotifications.java
Patch:
@@ -219,6 +219,9 @@ public void testTypingNotificationsEventDelivery()
         opSetBasicIM2.sendInstantMessage(contactToNotify,
                                          opSetBasicIM2.createMessage("pong"));
 
+        Object w = new Object();
+        synchronized(w){try {w.wait(500);}catch (Exception e) {}}
+
         opSetTypingNotifs2.sendTypingNotification(
             contactToNotify, OperationSetTypingNotifications.STATE_TYPING);
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -586,7 +586,7 @@ public void fileTransferRequestReceived(FileTransferRequestEvent event)
         final ChatPanel chatPanel = chatWindowManager
             .getContactChat(metaContact, sourceContact);
 
-        chatPanel.addIncomingFileTransferRequest(request);
+        chatPanel.addIncomingFileTransferRequest(request, event.getTimestamp());
 
         ChatTransport chatTransport
             = chatPanel.getChatSession()
@@ -619,7 +619,7 @@ public void run()
      * Nothing to do here, because we already know when a file transfer is
      * created.
      */
-    public void fileTransferCreated(FileTransfer fileTransfer)
+    public void fileTransferCreated(FileTransferCreatedEvent event)
     {}
 
     /**

File: src/net/java/sip/communicator/impl/protocol/ssh/OperationSetFileTransferSSHImpl.java
Patch:
@@ -122,7 +122,7 @@ public FileTransfer sendFile(
                     remotePath,
                     localPath);
 
-            return new FileTransferSSHImpl(fileTransferDaemon);
+            return new FileTransferSSHImpl(fileTransferDaemon, new Date());
         }
         else if(fromContact == null)
         {
@@ -135,7 +135,7 @@ else if(fromContact == null)
                     remotePath,
                     localPath);
 
-            return new FileTransferSSHImpl(fileTransferDaemon);
+            return new FileTransferSSHImpl(fileTransferDaemon, new Date());
         }
 
         // code should not reach here

File: src/net/java/sip/communicator/util/swing/FileDragLabel.java
Patch:
@@ -8,14 +8,11 @@
 
 import java.awt.datatransfer.*;
 import java.awt.dnd.*;
-import java.awt.event.*;
 import java.io.*;
-import java.net.*;
 import java.util.*;
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/utils/SoundProperties.java
Patch:
@@ -18,6 +18,8 @@ public final class SoundProperties
 {
     public static final String INCOMING_MESSAGE;
 
+    public static final String INCOMING_FILE;
+
     public static final String OUTGOING_CALL;
 
     public static final String INCOMING_CALL;
@@ -66,6 +68,7 @@ public final class SoundProperties
         ResourceManagementService resources = GuiActivator.getResources();
 
         INCOMING_MESSAGE = resources.getSoundPath("INCOMING_MESSAGE");
+        INCOMING_FILE = resources.getSoundPath("INCOMING_FILE");
         OUTGOING_CALL = resources.getSoundPath("OUTGOING_CALL");
         INCOMING_CALL = resources.getSoundPath("INCOMING_CALL");
         DIAL_ZERO = resources.getSoundPath("DIAL_ZERO");

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -760,11 +760,11 @@ else if (e.getEventType() == HyperlinkEvent.EventType.EXITED)
     }
 
     /**
-     * Returns the editor of this conversation panel.
+     * Returns the text pane of this conversation panel.
      *
-     * @return The editor of this conversation panel.
+     * @return The text pane of this conversation panel.
      */
-    public JEditorPane getChatEditorPane()
+    public JTextPane getChatTextPane()
     {
         return chatTextPane;
     }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -1152,8 +1152,6 @@ public void addComponent(Component component)
         {
             document.insertString(  document.getLength(),
                                     "ignored text", style);
-            document.insertString(document.getLength(),
-                                    "\n", document.getStyle("body"));
         }
         catch (BadLocationException e)
         {

File: src/net/java/sip/communicator/impl/osdependent/Desktop.java
Patch:
@@ -346,7 +346,8 @@ public void open(final File file) throws IOException
                 else
                 {
                     if (!file.isDirectory())
-                        org.jdesktop.jdic.desktop.Desktop.browse(file.toURL());
+                        org.jdesktop.jdic.desktop.Desktop.browse(
+                            file.toURI().toURL());
                     else
                         Runtime.getRuntime().exec("open "
                             + file.getCanonicalPath());

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -30,7 +30,6 @@
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
-import net.java.sip.communicator.util.swing.SwingWorker;
 
 /**
  * The <tt>ChatPanel</tt> is the panel, where users can write and send messages,
@@ -566,7 +565,7 @@ public void addMessage(String contactName, long date,
         ChatMessage chatMessage = new ChatMessage(contactName, date,
             messageType, message, contentType);
 
-        if (!isHistoryLoaded)
+        if (ConfigurationManager.isHistoryShown() && !isHistoryLoaded)
         {
             synchronized (incomingEventBuffer)
             {
@@ -1560,7 +1559,7 @@ public void addIncomingFileTransferRequest(
         ReceiveFileConversationComponent component
             = new ReceiveFileConversationComponent(request);
 
-        if (!isHistoryLoaded)
+        if (ConfigurationManager.isHistoryShown() && !isHistoryLoaded)
         {
             synchronized (incomingEventBuffer)
             {

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetMultiUserChat2.java
Patch:
@@ -798,8 +798,8 @@ public void testRoomSubject()
 
         opSet1Room.setSubject(newSubjet);
 
-        opSet1RoomCollector.waitForEvent(10000);
-        opSet2RoomCollector.waitForEvent(10000);
+        opSet1RoomCollector.waitForEvent(20000);
+        opSet2RoomCollector.waitForEvent(20000);
 
         assertEquals("user1 didnt received an event for room subject change"
             , 1, opSet1RoomCollector.collectedEvents.size());

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -545,8 +545,6 @@ else if(o instanceof ChatRoomMessageReceivedEvent)
             conversationPanel.appendMessageToEnd(historyString);
         }
 
-        isHistoryLoaded = true;
-
         getChatWindow().getMainToolBar()
             .changeHistoryButtonsState(this);
     }
@@ -1292,6 +1290,8 @@ public void finished()
                     processHistory(historyList, escapedMessageID);
                 }
 
+                isHistoryLoaded = true;
+
                 // Add incoming events accumulated while the history was loading
                 // at the end of the chat.
                 addIncomingEvents();

File: src/net/java/sip/communicator/impl/osdependent/Desktop.java
Patch:
@@ -167,7 +167,7 @@ public AWTDesktopPeer(Class<?> clazz)
                 open = clazz.getMethod("open", new Class<?>[]{ File.class });
                 print = clazz.getMethod("print", new Class<?>[]{ File.class });
                 edit = clazz.getMethod("edit", new Class<?>[]{ File.class });
-                browse = clazz.getMethod("edit", new Class<?>[]{ URI.class });
+                browse = clazz.getMethod("browse", new Class<?>[]{ URI.class });
             }
             catch (NoSuchMethodException ex)
             {

File: src/net/java/sip/communicator/impl/osdependent/Resources.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.impl.systray;
+package net.java.sip.communicator.impl.osdependent;
 
 import java.net.*;
 
@@ -82,7 +82,7 @@ public static ResourceManagementService getResources()
         if (resourcesService == null)
             resourcesService =
                 ResourceManagementServiceUtils
-                    .getService(SystrayActivator.bundleContext);
+                    .getService(OsDependentActivator.bundleContext);
         return resourcesService;
     }
 }

File: src/net/java/sip/communicator/impl/osdependent/StatusMessageMenu.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.impl.systray;
+package net.java.sip.communicator.impl.osdependent;
 
 import java.awt.*;
 import java.awt.event.*;

File: src/net/java/sip/communicator/impl/osdependent/jdic/ProviderRegistration.java
Patch:
@@ -5,9 +5,9 @@
  * See terms of license at gnu.org.
  */
 
-package net.java.sip.communicator.impl.systray.jdic;
+package net.java.sip.communicator.impl.osdependent.jdic;
 
-import net.java.sip.communicator.impl.systray.*;
+import net.java.sip.communicator.impl.osdependent.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 
@@ -52,7 +52,7 @@ public void run()
     {
         try
         {
-            protocolProvider.register(SystrayActivator.getUIService()
+            protocolProvider.register(OsDependentActivator.getUIService()
                             .getDefaultSecurityAuthority(protocolProvider));
         }
         catch (OperationFailedException ex)

File: src/net/java/sip/communicator/impl/osdependent/jdic/ProviderUnRegistration.java
Patch:
@@ -5,7 +5,7 @@
  * See terms of license at gnu.org.
  */
 
-package net.java.sip.communicator.impl.systray.jdic;
+package net.java.sip.communicator.impl.osdependent.jdic;
 
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/osdependent/jdic/StatusSelector.java
Patch:
@@ -4,15 +4,15 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.impl.systray.jdic;
+package net.java.sip.communicator.impl.osdependent.jdic;
 
 import java.awt.*;
 import java.awt.event.*;
 import java.util.*;
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.systray.*;
+import net.java.sip.communicator.impl.osdependent.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/osdependent/jdic/StatusSimpleSelector.java
Patch:
@@ -4,14 +4,14 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.impl.systray.jdic;
+package net.java.sip.communicator.impl.osdependent.jdic;
 
 import java.awt.*;
 import java.awt.event.*;
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.systray.*;
+import net.java.sip.communicator.impl.osdependent.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetBasicInstantMessagingMsnImpl.java
Patch:
@@ -316,5 +316,5 @@ public void activityEmailNotificationReceived(MsnSwitchboard switchboard,
                                                       MsnContact contact)
         {
         }
-    }    
+    }
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -719,9 +719,9 @@ public void connectionClosed()
             OperationSetPersistentPresenceJabberImpl opSetPersPresence =
                 (OperationSetPersistentPresenceJabberImpl) getOperationSet(OperationSetPersistentPresence.class);
 
-            opSetPersPresence.fireProviderPresenceStatusChangeEvent(
-                opSetPersPresence.getPresenceStatus(), getJabberStatusEnum()
-                    .getStatus(JabberStatusEnum.OFFLINE));
+            opSetPersPresence.fireProviderStatusChangeEvent(
+                opSetPersPresence.getPresenceStatus(),
+                getJabberStatusEnum().getStatus(JabberStatusEnum.OFFLINE));
         }
 
         /**

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -1503,7 +1503,7 @@ private Header stripReplacesHeader(Address address)
 
             if (replacesHeaderValue != null)
             {
-                for (Iterator<String> headerNameIter = sipURI.getHeaderNames();
+                for (Iterator<?> headerNameIter = sipURI.getHeaderNames();
                         headerNameIter.hasNext();)
                 {
                     if (ReplacesHeader.NAME.equals(headerNameIter.next()))

File: src/net/java/sip/communicator/impl/protocol/yahoo/ProtocolProviderServiceYahooImpl.java
Patch:
@@ -165,7 +165,7 @@ private void connectAndLogin(   SecurityAuthority authority,
 
                 if(yahooSession.getSessionStatus()==StatusConstants.MESSAGING)
                 {
-                    persistentPresence.fireProviderPresenceStatusChangeEvent(
+                    persistentPresence.fireProviderStatusChangeEvent(
                         persistentPresence.getPresenceStatus(),
                         persistentPresence.yahooStatusToPresenceStatus(
                             yahooSession.getStatus()));

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -168,7 +168,7 @@ private void init()
             this.setDefaultCloseOperation(JFrame.HIDE_ON_CLOSE);
 
         this.setKeybindingInput(KeybindingSet.Category.MAIN);
-        this.addKeybindingAction("plugin.keybindings.MAIN_RENAME",
+        this.addKeybindingAction("main-rename",
                                 new RenameAction());
 
         TransparentPanel northPanel = new TransparentPanel(new BorderLayout());

File: src/net/java/sip/communicator/impl/protocol/ssh/ContactSSHImpl.java
Patch:
@@ -892,7 +892,6 @@ public String getPassword()
     public void setPassword(String password)
     {
         this.sshConfigurationForm.setPasswordField(password);
-        System.out.println("22222222222222222");
         savePersistentDetails();
     }
     

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -212,7 +212,7 @@ private void init()
             ProviderAwareMenuItem menuItem 
                 = new ProviderAwareMenuItem(pps, 
                     pps.getAccountID().getDisplayName(),
-                    new ImageIcon(ImageLoader.getAccountStatusImage(pps)));
+                    ImageLoader.getAccountStatusImage(pps));
 
             menuItem.setName(addSubcontactPrefix + protocolName);
             menuItem.addActionListener(this);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GroupRightButtonMenu.java
Patch:
@@ -86,8 +86,9 @@ public GroupRightButtonMenu(MainFrame mainFrame,
 
             String protocolName = pps.getProtocolName();
 
-            AccountMenuItem menuItem = new AccountMenuItem(pps,
-                    new ImageIcon(ImageLoader.getAccountStatusImage(pps)));
+            AccountMenuItem menuItem
+                = new AccountMenuItem(  pps,
+                                        ImageLoader.getAccountStatusImage(pps));
 
             menuItem.setName(protocolName);
             menuItem.addActionListener(this);

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -180,7 +180,8 @@ else if (evt.getReasonCode() == RegistrationStateChangeEvent
 
                 new ErrorDialog(
                     null,
-                    GuiActivator.getResources().getI18NString("service.gui.ERROR"),
+                    GuiActivator.getResources()
+                        .getI18NString("service.gui.ERROR"),
                     msgText).showDialog();
             }
 

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -62,7 +62,7 @@ public PresenceStatusMenu(  MainFrame mainFrame,
                                 ProtocolProviderService protocolProvider)
     {
         super(protocolProvider.getAccountID().getDisplayName(),
-            new ImageIcon(ImageLoader.getAccountStatusImage(protocolProvider)));
+            ImageLoader.getAccountStatusImage(protocolProvider));
 
         this.protocolProvider = protocolProvider;
 
@@ -225,10 +225,10 @@ public void updateStatus(Object presenceStatus)
      */
     public void setSelectedStatus(PresenceStatus status)
     {
-        Image statusImage = ImageLoader.getAccountStatusImage(protocolProvider);
+        Icon statusImage = ImageLoader.getAccountStatusImage(protocolProvider);
 
         SelectedObject selectedObject
-            = new SelectedObject(new ImageIcon(statusImage),
+            = new SelectedObject(statusImage,
                                 status.getStatusName());
 
         this.setSelected(selectedObject);

File: src/net/java/sip/communicator/impl/protocol/dict/ContactDictImpl.java
Patch:
@@ -25,7 +25,7 @@ public class ContactDictImpl
      * Icon
      */
     private static byte[] icon = DictActivator.getResources()
-        .getImageInBytes("service.protocol.dict.PROTOCOL_LARGE_ICON");
+        .getImageInBytes("service.protocol.dict.DICT_64x64");
     
     /**
      * The id of the contact.

File: src/net/java/sip/communicator/impl/protocol/dict/DictStatusEnum.java
Patch:
@@ -38,7 +38,7 @@ public class DictStatusEnum
         = new DictStatusEnum(
             65, "Online",
             DictActivator.getResources()
-                .getImageInBytes("service.protocol.dict.PROTOCOL_ICON"));
+                .getImageInBytes("service.protocol.dict.DICT_16x16"));
 
     /**
      * Initialize the list of supported status states.

File: src/net/java/sip/communicator/impl/protocol/icq/AimStatusEnum.java
Patch:
@@ -29,7 +29,7 @@ public class AimStatusEnum
      */
     public static final AimStatusEnum ONLINE
         = new AimStatusEnum(65, "Online",
-                getImageInBytes("service.protocol.aim.PROTOCOL_ICON"));
+                getImageInBytes("service.protocol.aim.AIM_16x16"));
 
     /**
      * The Invisible AIM status. Indicates that the user has connectivity even

File: src/net/java/sip/communicator/impl/protocol/rss/RssStatusEnum.java
Patch:
@@ -41,7 +41,7 @@ public class RssStatusEnum
         = new RssStatusEnum(
             65,
             "Online",
-            getImageInBytes("service.protocol.rss.PROTOCOL_ICON"));
+            getImageInBytes("service.protocol.rss.RSS_16x16"));
 
     /**
      * Initialize the list of supported status states.

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHStatusEnum.java
Patch:
@@ -67,7 +67,7 @@ public class SSHStatusEnum
             65,
             "Online",
             ProtocolIconSSHImpl
-                .getImageInBytes("service.protocol.ssh.PROTOCOL_ICON"));
+                .getImageInBytes("service.protocol.ssh.SSH_16x16"));
 
 
     /**

File: src/net/java/sip/communicator/plugin/aimaccregwizz/Resources.java
Patch:
@@ -22,13 +22,13 @@ public class Resources
      * A constant pointing to the Aim protocol logo image.
      */
     public static ImageID AIM_LOGO
-        = new ImageID("service.protocol.aim.PROTOCOL_ICON");
+        = new ImageID("service.protocol.aim.AIM_16x16");
 
     /**
      * A constant pointing to the Aim protocol wizard page image.
      */
     public static ImageID PAGE_IMAGE 
-        = new ImageID("service.protocol.aim.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.aim.AIM_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/dictaccregwizz/Resources.java
Patch:
@@ -20,10 +20,10 @@ public class Resources
     private static ResourceManagementService resourcesService;
 
     public static ImageID DICT_LOGO
-        = new ImageID("service.protocol.dict.PROTOCOL_ICON");
+        = new ImageID("service.protocol.dict.DICT_16x16");
 
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.dict.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.dict.DICT_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/dictaccregwizz/ThreadManager.java
Patch:
@@ -115,7 +115,7 @@ static class StrategyThread
                 Resources.getString(
                     "plugin.dictaccregwizz.POPULATE_LIST"),
                 Resources.getString(
-                    "dict.plugin.dictaccregwizz.CLOSING_CONNECTION")
+                    "plugin.dictaccregwizz.CLOSING_CONNECTION")
         };
         
         /**

File: src/net/java/sip/communicator/plugin/gibberishaccregwizz/Resources.java
Patch:
@@ -22,13 +22,13 @@ public class Resources
      * A constant pointing to the Gibberish protocol logo icon.
      */
     public static ImageID GIBBERISH_LOGO
-        = new ImageID("service.protocol.gibberish.PROTOCOL_ICON");
+        = new ImageID("service.protocol.gibberish.GIBBERISH_16x16");
 
     /**
      * A constant pointing to the Gibberish protocol wizard page image.
      */
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.gibberish.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.gibberish.GIBBERISH_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/Resources.java
Patch:
@@ -21,13 +21,13 @@ public class Resources
      * A constant pointing to the Google Talk protocol logo image.
      */
     public static ImageID PROTOCOL_ICON
-        = new ImageID("service.protocolgoogletalk.PROTOCOL_ICON");
+        = new ImageID("service.protocol.googletalk.GTALK_16x16");
 
     /**
      * A constant pointing to the Aim protocol wizard page image.
      */
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocolgoogletalk.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.googletalk.GTALK_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/icqaccregwizz/Resources.java
Patch:
@@ -19,10 +19,10 @@ public class Resources
     private static ResourceManagementService resourcesService;
 
     public static ImageID ICQ_LOGO
-        = new ImageID("service.protocol.icq.PROTOCOL_ICON");
+        = new ImageID("service.protocol.icq.ICQ_16x16");
 
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.icq.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.icq.ICQ_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/ircaccregwizz/Resources.java
Patch:
@@ -22,13 +22,13 @@ public class Resources
      * A constant pointing to the IRC protocol logo image.
      */
     public static ImageID IRC_LOGO
-        = new ImageID("service.protocol.irc.PROTOCOL_ICON");
+        = new ImageID("service.protocol.irc.IRC_16x16");
 
     /**
      * A constant pointing to the IRC protocol wizard page image.
      */
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.irc.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.irc.IRC_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/Resources.java
Patch:
@@ -24,13 +24,13 @@ public class Resources
      * A constant pointing to the Jabber protocol logo image.
      */
     public static ImageID PROTOCOL_ICON
-        = new ImageID("service.protocol.jabber.PROTOCOL_ICON");
+        = new ImageID("service.protocol.jabber.JABBER_16x16");
 
     /**
      * A constant pointing to the Aim protocol wizard page image.
      */
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.jabber.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.jabber.JABBER_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/msnaccregwizz/Resources.java
Patch:
@@ -22,13 +22,13 @@ public class Resources
      * A constant pointing to the MSN protocol logo image.
      */
     public static ImageID MSN_LOGO
-        = new ImageID("service.protocol.msn.PROTOCOL_ICON");
+        = new ImageID("service.protocol.msn.MSN_16x16");
 
     /**
      * A constant pointing to the Aim protocol wizard page image.
      */
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.msn.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.msn.MSN_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/rssaccregwizz/Resources.java
Patch:
@@ -22,13 +22,13 @@ public class Resources
      * A constant pointing to the RSS protocol logo image.
      */
     public static ImageID RSS_LOGO
-        = new ImageID("service.protocol.rss.PROTOCOL_ICON");
+        = new ImageID("service.protocol.rss.RSS_16x16");
 
     /**
      * A constant pointing to the RSS protocol wizard page image.
      */
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.rss.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.rss.RSS_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/sipaccregwizz/Resources.java
Patch:
@@ -19,10 +19,10 @@ public class Resources
     private static ResourceManagementService resourcesService;
 
     public static ImageID SIP_LOGO
-        = new ImageID("service.protocol.sip.PROTOCOL_ICON");
+        = new ImageID("service.protocol.sip.SIP_16x16");
 
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.sip.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.sip.SIP_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/sshaccregwizz/Resources.java
Patch:
@@ -26,10 +26,10 @@ public class Resources
     private static ResourceManagementService resourcesService;
 
     public static ImageID SSH_LOGO
-        = new ImageID("service.protocol.ssh.PROTOCOL_ICON");
+        = new ImageID("service.protocol.ssh.SSH_16x16");
 
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.ssh.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.ssh.SSH_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/Resources.java
Patch:
@@ -19,10 +19,10 @@ public class Resources
     private static ResourceManagementService resourcesService;
 
     public static ImageID YAHOO_LOGO
-        = new ImageID("service.protocol.yahoo.PROTOCOL_ICON");
+        = new ImageID("service.protocol.yahoo.YAHOO_16x16");
 
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.yahoo.PROTOCOL_LARGE_IMAGE");
+        = new ImageID("service.protocol.yahoo.YAHOO_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/plugin/zeroconfaccregwizz/Resources.java
Patch:
@@ -20,10 +20,10 @@ public class Resources
     private static ResourceManagementService resourcesService;
 
     public static ImageID ZEROCONF_LOGO
-        = new ImageID("service.protocol.zeroconf.PROTOCOL_ICON");
+        = new ImageID("service.protocol.zeroconf.ZEROCONF_16x16");
 
     public static ImageID PAGE_IMAGE
-        = new ImageID("service.protocol.zeroconf.PROTOCOL_LARGE_ICON");
+        = new ImageID("service.protocol.zeroconf.ZEROCONF_64x64");
 
     /**
      * Returns an internationalized string corresponding to the given key.

File: src/net/java/sip/communicator/impl/gui/main/account/NewAccountDialog.java
Patch:
@@ -13,7 +13,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -10,7 +10,6 @@
 import java.awt.datatransfer.*;
 import java.awt.event.*;
 import java.io.*;
-import java.net.*;
 import java.util.*;
 import java.util.regex.*;
 

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigFormDescriptor.java
Patch:
@@ -10,7 +10,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/resources/ResourceManagementServiceImpl.java
Patch:
@@ -6,16 +6,16 @@
  */
 package net.java.sip.communicator.impl.resources;
 
-import java.awt.image.*;
 import java.io.*;
 import java.net.*;
 import java.text.*;
 import java.util.*;
 
-import javax.imageio.*;
 import javax.swing.*;
+
 import net.java.sip.communicator.service.resources.*;
 import net.java.sip.communicator.util.*;
+
 import org.osgi.framework.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/account/NewAccountDialog.java
Patch:
@@ -245,8 +245,7 @@ public Component getListCellRendererComponent(JList list, Object value,
 
             if( icon != null && icon.length > 0)
             {
-                this.setIcon(new ImageIcon(
-                                ImageLoader.getBytesInImage(icon)));
+                this.setIcon(new ImageIcon(icon));
             }
             else
             {

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -10,6 +10,7 @@
 import java.awt.datatransfer.*;
 import java.awt.event.*;
 import java.io.*;
+import java.net.*;
 import java.util.*;
 import java.util.regex.*;
 
@@ -319,8 +320,8 @@ else if (messageType.equals(Constants.ERROR_MESSAGE))
             endHeaderTag = "</h6>";
 
             String errorIcon = "<IMG SRC='"
-                + ImageLoader.getImagePath(ImageLoader
-                    .getImage(ImageLoader.EXCLAMATION_MARK)) + "' </IMG>";
+                + ImageLoader.getImageUri(ImageLoader.EXCLAMATION_MARK)
+                + "' </IMG>";
 
             chatString += errorIcon
                 + GuiActivator.getResources()

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigFormDescriptor.java
Patch:
@@ -57,8 +57,7 @@ public ConfigFormDescriptor(ConfigurationForm configForm)
         }
         
         if(icon != null)
-            configFormIcon
-                = new ImageIcon(ImageLoader.getBytesInImage(icon));
+            configFormIcon = new ImageIcon(icon);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusMenu.java
Patch:
@@ -106,8 +106,7 @@ else if ((onlineStatus != null
             }
 
             this.addItem(status.getStatusName(),
-                new ImageIcon(
-                    ImageLoader.getBytesInImage(status.getStatusIcon())),
+                new ImageIcon(status.getStatusIcon()),
                 new ItemActionListener());
         }
 

File: src/net/java/sip/communicator/impl/protocol/jabber/mediamgr/AudioMediaSession.java
Patch:
@@ -109,8 +109,8 @@ public void initialize()
                     " <-> " + remoteIp + ":" + remotePort);
 //        }
 
-        Hashtable mediaEncoding = MediaUtils.getAudioEncoding(
-                getPayloadType().getId());
+        Map<String, List<String>> mediaEncoding
+            = MediaUtils.getAudioEncoding(getPayloadType().getId());
         try
         {
             rtpFlow = JabberActivator.getMediaService().

File: src/net/java/sip/communicator/impl/protocol/jabber/mediamgr/MediaUtils.java
Patch:
@@ -42,10 +42,10 @@ public abstract class MediaUtils
      * @param payloadType the payload type
      * @return an hashtable ready to be passed to media service
      */
-    public static Hashtable getAudioEncoding(int payloadType)
+    public static Map<String, List<String>> getAudioEncoding(int payloadType)
     {
-        Hashtable ht = new Hashtable();
-        List list = new ArrayList();
+        Map<String, List<String>> ht = new Hashtable<String, List<String>>();
+        List<String> list = new ArrayList<String>();
         ht.put("audio", list);
         // most of the format aren't handled by SC now
         // but itsn't a problem. it will facilitates

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -310,7 +310,7 @@ public Window getConversationContainerWindow() {
      */
     public void setStatusMessage(String statusMessage)
     {
-        this.sendPanel.setStatusMessage(statusMessage);
+        this.sendPanel.getStatusPanel().setStatusMessage(statusMessage);
     }
 
     /**

File: src/net/java/sip/communicator/plugin/branding/AboutWindow.java
Patch:
@@ -110,7 +110,7 @@ public AboutWindow(Frame owner)
             logoArea.getFont().deriveFont(Font.BOLD, logoAreaFontSize));
         logoArea.setForeground(Constants.TITLE_COLOR);
         logoArea.setOpaque(false);
-        logoArea.setLineWrap(false);
+        logoArea.setLineWrap(true);
         logoArea.setWrapStyleWord(true);
         logoArea.setEditable(false);
         logoArea.setPreferredSize(new Dimension(100, 20));

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackProperties.java
Patch:
@@ -246,7 +246,7 @@ else if (logLevel.equals(Level.WARNING.getName())
         {
             jainSipTraceLevel = "ERROR";
         }
-        else if (logLevel.equals(Level.OFF))
+        else if (logLevel.equals(Level.OFF.getName()))
         {
             jainSipTraceLevel = "OFF";
         }

File: src/net/java/sip/communicator/impl/protocol/icq/ContactGroupIcqImpl.java
Patch:
@@ -157,7 +157,7 @@ void removeContact(ContactIcqImpl contact)
                 = buddies.entrySet().iterator();
              buddyIter.hasNext();)
         {
-            if (buddyIter.next().getKey().equals(contact))
+            if (buddyIter.next().getValue().equals(contact))
             {
                 buddyIter.remove();
                 break;

File: src/net/java/sip/communicator/impl/protocol/yahoo/ContactGroupYahooImpl.java
Patch:
@@ -179,7 +179,8 @@ public Contact getContact(String id)
     public String getGroupName()
     {
         if(isResolved)
-            return yahooGroup.getName();
+            return ServerStoredContactListYahooImpl
+                .replaceIllegalChars(yahooGroup.getName());
         else
             return tempId;
     }

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactGroupJabberImpl.java
Patch:
@@ -26,6 +26,7 @@
  * source group is changed.
  *
  * @author Damian Minkov
+ * @author Emil Ivov
  */
 public class ContactGroupJabberImpl
     extends AbstractContactGroupJabberImpl

File: src/net/java/sip/communicator/impl/protocol/jabber/RootContactGroupJabberImpl.java
Patch:
@@ -14,6 +14,7 @@
  * A dummy ContactGroup implementation representing the ContactList root for
  * Jabber contact lists.
  * @author Damian Minkov
+ * @author Emil Ivov
  */
 public class RootContactGroupJabberImpl
     extends AbstractContactGroupJabberImpl

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -24,6 +24,7 @@
  * corresponding sip-communicator events to all events coming from smack.
  *
  * @author Damian Minkov
+ * @author Emil Ivov
  */
 public class ServerStoredContactListJabberImpl
 {

File: src/net/java/sip/communicator/impl/protocol/yahoo/ContactYahooImpl.java
Patch:
@@ -14,6 +14,7 @@
 /**
  * The Yahoo implementation of the service.protocol.Contact interface.
  * @author Damian Minkov
+ * @author Emil Ivov
  */
 public class ContactYahooImpl
     implements Contact

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -236,7 +236,8 @@ void reregister(int authReasonCode)
      * @throws  OperationFailedException if login parameters
      *          as server port are not correct
      */
-    private void connectAndLogin(SecurityAuthority authority, int reasonCode)
+    private synchronized void connectAndLogin(SecurityAuthority authority,
+                                              int reasonCode)
         throws XMPPException, OperationFailedException
     {
         synchronized(initializationLock)
@@ -623,7 +624,7 @@ protected void initialize(String screenname,
             //initialize the telephony opset
             String enableJingle = (String)JabberActivator
                 .getConfigurationService().getProperty(PNAME_ENABLE_JINGLE);
-            if( Boolean.getBoolean(enableJingle)    
+            if( Boolean.getBoolean(enableJingle)
                 && JabberActivator.getMediaService() != null)
             {
                 OperationSetBasicTelephony opSetBasicTelephony

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -655,8 +655,8 @@ public DataSource createDataSourceForEncodings(
             logger.debug(
                 "sourceProcessor is in state "
                     + sourceProcessor.getState()
-                    + "which is > Processor.Configured"
-                    + "and then TrackControl.setFormat(Format) may not work.");
+                    + " which is > Processor.Configured"
+                    + " and then TrackControl.setFormat(Format) may not work.");
         boolean atLeastOneTrack = false;
         // Program the tracks.
         for (int i = 0; i < tracks.length; i++)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -13,7 +13,6 @@
 
 import javax.swing.*;
 import javax.swing.event.*;
-import javax.swing.text.*;
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -994,7 +994,7 @@ public void moveMetaContact(MetaContact metaContact,
                 {
                     /** @todo handle non persistent presence operation sets */
                 }
-                else 
+                else
                 {
                     opSetPresence.moveContactToGroup(protoContact, protoGroup);
                 }

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetTypingNotificationsYahooImpl.java
Patch:
@@ -206,7 +206,7 @@ private class ProviderRegListener
         implements RegistrationStateChangeListener
     {
         /**
-         * The method is called by a ProtocolProvider implementation whenver
+         * The method is called by a ProtocolProvider implementation whenever
          * a change in the registration state of the corresponding provider had
          * occurred.
          * @param evt ProviderStatusChangeEvent the event describing the status

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -599,7 +599,9 @@ public void joinChatRoom(ChatRoomWrapper chatRoomWrapper)
             new ErrorDialog(
                 GuiActivator.getUIService().getMainFrame(),
                 GuiActivator.getResources().getI18NString("service.gui.WARNING"),
-                GuiActivator.getResources().getI18NString("haveToBeConnectedToJoin"))
+                GuiActivator.getResources().getI18NString(
+                        "service.gui.CHAT_ROOM_NOT_CONNECTED",
+                        new String[]{chatRoomWrapper.getChatRoomName()}))
                     .showDialog();
 
             return;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomMemberListPanel.java
Patch:
@@ -45,6 +45,7 @@ public ChatRoomMemberListPanel(ChatPanel chat)
         // this.chatPanel = chat;
 
         this.memberList.setModel(memberListModel);
+        this.memberList.addKeyListener(new CListKeySearchListener(memberList));
         this.memberList.setCellRenderer(new ChatContactCellRenderer());
 
         JScrollPane contactsScrollPane = new SCScrollPane();

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -2179,8 +2179,7 @@ private void initializeRtpManager(RTPManager rtpManager,
                 // The crypto provider solution should be queried somehow
                 // or taken from a resources file
                 TransformConnector transConnector
-                    = TransformManager.createZRTPConnector(
-                                            bindAddress, this);
+                    = TransformManager.createZRTPConnector(bindAddress);
 
                 rtpManager.initialize(transConnector);
                 this.transConnectors.put(rtpManager, transConnector);

File: src/net/java/sip/communicator/impl/media/protocol/alsa/DataSource.java
Patch:
@@ -103,7 +103,7 @@ public void stop() throws IOException {
      */
     public Object getControl(String controlType) {
        try {
-          Class  cls = Class.forName(controlType);
+          Class<?>  cls = Class.forName(controlType);
           Object cs[] = getControls();
           for (int i = 0; i < cs.length; i++) {
              if (cls.isInstance(cs[i]))

File: src/net/java/sip/communicator/impl/media/transform/srtp/PacketManipulator.java
Patch:
@@ -34,7 +34,7 @@ public static int GetRTPPaddingSize(RawPacket pkt)
         }
         else
         {
-            return (int)pkt.readByte(pkt.getLength() - 1);
+            return pkt.readByte(pkt.getLength() - 1);
         }
     }
 
@@ -53,7 +53,7 @@ public static int GetRTPHeaderLength(RawPacket pkt)
             return -1;
         }
 
-        int csrcNum = (int)(pkt.readByte(0) & 0xF);
+        int csrcNum = pkt.readByte(0) & 0xF;
         return 12 + 4 * csrcNum; 
     }
 

File: src/net/java/sip/communicator/impl/media/transform/srtp/SRTCPTransformer.java
Patch:
@@ -19,7 +19,6 @@
 public class SRTCPTransformer
     implements PacketTransformer
 {
-    private SRTPTransformEngine engine;
     
     /**
      * Constructs a SRTCPTransformer object
@@ -28,7 +27,6 @@ public class SRTCPTransformer
      */
     public SRTCPTransformer(SRTPTransformEngine engine)
     {
-        this.engine = engine;
     }
 
     /**

File: src/net/java/sip/communicator/impl/media/transform/srtp/SRTPCryptoContext.java
Patch:
@@ -427,8 +427,8 @@ else if (policy.getEncType() == SRTPPolicy.AESF8_ENCRYPTION) {
      */
     public void processPacketAESCM(RawPacket pkt) {
         long ssrc = PacketManipulator.GetRTPSSRC(pkt);
-        int seqNum = PacketManipulator.GetRTPSequenceNumber(pkt);
-        long index = ((long) this.roc << 16) | (long) seqNum;
+        int seqNo = PacketManipulator.GetRTPSequenceNumber(pkt);
+        long index = ((long) this.roc << 16) | seqNo;
 
         // byte[] iv = new byte[16];
         ivStore[0] = saltKey[0];
@@ -508,7 +508,7 @@ private void authenticatePacketHMCSHA1(RawPacket pkt, int rocIn) {
      * Sequence Number is guaranteed to be real (not faked) through 
      * authentication.
      * 
-     * @param seqNum sequence number of the packet
+     * @param seqNo sequence number of the packet
      * @return true if this sequence number indicates the packet is not a
      * replayed one, false if not
      */

File: src/net/java/sip/communicator/impl/netaddr/NetaddrActivator.java
Patch:
@@ -47,7 +47,7 @@ public void start(BundleContext bundleContext) throws Exception
             //end ugly property set
 
             //keep a reference to the bundle context for later usage.
-            this.bundleContext = bundleContext;
+            NetaddrActivator.bundleContext = bundleContext;
 
             //Create and start the network address manager.
             networkAMS =

File: src/net/java/sip/communicator/impl/netaddr/NetworkAddressManagerServiceImpl.java
Patch:
@@ -97,7 +97,8 @@ public class NetworkAddressManagerServiceImpl
      * <br>
      * {@link http://ietf.org/rfc/rfc3927.txt}
      */
-    private static final String DYNAMIC_CONF_FOR_IPV4_ADDR_PREFIX = "169.254";
+    // TODO Remove after confirmation that it is not used
+//    private static final String DYNAMIC_CONF_FOR_IPV4_ADDR_PREFIX = "169.254";
 
     /**
      * The name of the property containing the number of binds that we should

File: src/net/java/sip/communicator/impl/notification/EventNotification.java
Patch:
@@ -32,7 +32,7 @@ public class EventNotification
      * Contains all actions which will be executed when this event notification
      * is fired.
      */
-    private final Hashtable actionsTable = new Hashtable();
+    private final Hashtable<String, Action> actionsTable = new Hashtable<String, Action>();
     
     /**
      * Creates an instance of <tt>EventNotification</tt> by specifying the
@@ -79,7 +79,7 @@ public void removeAction(String actionType)
      * 
      * @return the set of actions registered for this event notification
      */
-    public Map getActions()
+    public Map<String, Action> getActions()
     {   
         return actionsTable;
     }
@@ -95,7 +95,7 @@ public Map getActions()
      */
     public Action getAction(String actionType)
     {
-        return (Action) actionsTable.get(actionType);
+        return actionsTable.get(actionType);
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/dict/ContactGroupDictImpl.java
Patch:
@@ -203,7 +203,7 @@ public void removeSubGroup(ContactGroupDictImpl subgroup)
      */
     public Contact getContact(int index)
     {
-        return (ContactDictImpl)contacts.get(index);
+        return contacts.get(index);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/dict/ProtocolIconDictImpl.java
Patch:
@@ -40,7 +40,7 @@ public class ProtocolIconDictImpl
      * an iterator to a set containing the supported icon sizes.
      * @return          Returns an iterator to a set containing the supported icon sizes
      */
-    public Iterator getSupportedSizes()
+    public Iterator<String> getSupportedSizes()
     {
         return iconsTable.keySet().iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/dict/ProtocolProviderServiceDictImpl.java
Patch:
@@ -114,9 +114,7 @@ protected void initialize(String userID,
             //initialize the IM operation set
             OperationSetBasicInstantMessagingDictImpl basicInstantMessaging
                 = new OperationSetBasicInstantMessagingDictImpl(
-                    this
-                    , (OperationSetPersistentPresenceDictImpl)
-                            persistentPresence);
+                    this, persistentPresence);
 
             supportedOperationSets.put(
                 OperationSetBasicInstantMessaging.class.getName(),

File: src/net/java/sip/communicator/service/notification/NotificationService.java
Patch:
@@ -264,7 +264,7 @@ public void removeEventNotificationAction(  String eventType,
      * @return an iterator over a list of all events registered in this
      * notifications service
      */
-    public Iterator getRegisteredEvents();
+    public Iterator<String> getRegisteredEvents();
     
     /**
      * Returns a Map containing all action types (as keys) and actionDescriptors

File: src/net/java/sip/communicator/service/protocol/ProtocolIcon.java
Patch:
@@ -50,7 +50,7 @@ public interface ProtocolIcon
      * icon sizes. Each icon size in the set is one of the ICON_SIZE_XXX
      * constants.
      */
-    public Iterator getSupportedSizes();
+    public Iterator<String> getSupportedSizes();
     
     /**
      * Checks if the given icon size is supported by the current protocol

File: src/net/java/sip/communicator/impl/media/codec/audio/alaw/JavaEncoder.java
Patch:
@@ -59,7 +59,6 @@ protected Format[] getMatchingOutputFormats(Format in)
     {
 
         AudioFormat inFormat = (AudioFormat) in;
-        int channels = inFormat.getChannels();
         int sampleRate = (int) (inFormat.getSampleRate());
 
         supportedOutputFormats = new AudioFormat[]
@@ -130,7 +129,6 @@ public int process(Buffer inputBuffer, Buffer outputBuffer)
             initConverter( (AudioFormat) newFormat);
         }
 
-        int inpLength = inputBuffer.getLength();
         int outLength = calculateOutputSize(inputBuffer.getLength());
 
         byte[] inpData = (byte[]) inputBuffer.getData();

File: src/net/java/sip/communicator/impl/media/codec/audio/alaw/Packetizer.java
Patch:
@@ -90,7 +90,7 @@ public java.lang.Object[] getControls()
             controls = new Control[1];
             controls[0] = new PacketSizeAdapter(this, packetSize, true);
         }
-        return (Object[]) controls;
+        return controls;
     }
 
     public synchronized void setPacketSize(int newPacketSize)

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/JavaDecoder.java
Patch:
@@ -136,6 +136,6 @@ public java.lang.Object[] getControls()
             controls = new Control[1];
             controls[0] = new com.sun.media.controls.SilenceSuppressionAdapter(this, false, false);
         }
-        return (Object[]) controls;
+        return controls;
     }
 }

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/JavaEncoder.java
Patch:
@@ -52,8 +52,6 @@ public JavaEncoder()
 
     protected Format[] getMatchingOutputFormats(Format in)
     {
-        AudioFormat af = (AudioFormat) in;
-
         supportedOutputFormats = new AudioFormat[]
             {new AudioFormat(
                 Constants.ILBC_RTP,
@@ -149,6 +147,6 @@ public java.lang.Object[] getControls()
             controls = new Control[1];
             controls[0] = new com.sun.media.controls.SilenceSuppressionAdapter(this, false, false);
         }
-        return (Object[]) controls;
+        return controls;
     }
 }

File: src/net/java/sip/communicator/impl/media/codec/audio/speex/JavaEncoder.java
Patch:
@@ -21,7 +21,6 @@ public class JavaEncoder
     extends com.ibm.media.codec.audio.AudioCodec
 {
     private Format lastFormat = null;
-    private int numberOfChannels = 0;
 
     private static int FRAME_SIZE = 320;
 
@@ -76,7 +75,6 @@ public void close()
     private void initConverter(AudioFormat inFormat)
     {
         lastFormat = inFormat;
-        numberOfChannels = inFormat.getChannels();
 
         encoder = new SpeexEncoder();
 

File: src/net/java/sip/communicator/impl/media/device/FMJCivilVideoAuto.java
Patch:
@@ -26,7 +26,7 @@ public FMJCivilVideoAuto() throws Exception
     {
         // Done using reflection to avoid compile-time dependency on FMJ:
         //new net.sf.fmj.media.cdp.civil.CaptureDevicePlugger().addCaptureDevices();
-        final Class clazz 
+        final Class<?> clazz 
             = Class.forName("net.sf.fmj.media.cdp.civil.CaptureDevicePlugger");
         final Method addCaptureDevices = clazz.getMethod("addCaptureDevices");
         final Object captureDevicePlugger = clazz.newInstance();

File: src/net/java/sip/communicator/impl/media/device/FMJJavaSoundAuto.java
Patch:
@@ -27,7 +27,7 @@ public FMJJavaSoundAuto() throws Exception
         // Done using reflection to avoid compile-time dependency on FMJ:
         //new net.sf.fmj.media.cdp.javasound.CaptureDevicePlugger()
         //.addCaptureDevices();
-        final Class clazz = Class.forName(
+        final Class<?> clazz = Class.forName(
             "net.sf.fmj.media.cdp.javasound.CaptureDevicePlugger");
         final Method addCaptureDevices = clazz.getMethod("addCaptureDevices");
         final Object captureDevicePlugger = clazz.newInstance();

File: src/net/java/sip/communicator/impl/media/device/JmfDeviceDetector.java
Patch:
@@ -271,7 +271,7 @@ private void detectDirectAudio()
                 PlugInManager.addPlugIn(dar, inputFormats, new Format[0],
                                         plType);
                 // Move it to the top of the list
-                Vector rendList =
+                Vector<String> rendList =
                     PlugInManager.getPlugInList(null, null, plType);
                 int listSize = rendList.size();
                 if (rendList.elementAt(listSize - 1).equals(dar))
@@ -380,7 +380,7 @@ private static void setupRenderers()
              * DDRenderer will cause Windows Vista to switch its theme from Aero
              * to Vista Basic so try to pick up a different Renderer.
              */
-            Vector renderers =
+            Vector<String> renderers =
                 PlugInManager.getPlugInList(null, null, PlugInManager.RENDERER);
 
             if (renderers.contains("com.sun.media.renderer.video.GDIRenderer"))
@@ -392,7 +392,7 @@ private static void setupRenderers()
         }
         else if(!isLinux32())
         {
-            Vector renderers =
+            Vector<String> renderers =
                 PlugInManager.getPlugInList(null, null, PlugInManager.RENDERER);
             
             if (renderers.contains("com.sun.media.renderer.video.LightWeightRenderer") ||

File: src/net/java/sip/communicator/impl/media/device/S8DirectAudioAuto.java
Patch:
@@ -16,7 +16,7 @@ public class S8DirectAudioAuto
 {
     public S8DirectAudioAuto() throws Exception
     {
-        Class cls;
+        Class<?> cls;
         int plType = PlugInManager.RENDERER;
         String dar = "com.sun.media.renderer.audio.DirectAudioRenderer";
 
@@ -33,15 +33,15 @@ public S8DirectAudioAuto() throws Exception
             ! ( (ExclusiveUse) rend).isExclusive())
         {
             // sol8+, DAR supports mixing
-            Vector rendList = PlugInManager.getPlugInList(null, null,
+            Vector<String> rendList = PlugInManager.getPlugInList(null, null,
                 plType);
             int listSize = rendList.size();
             boolean found = false;
             String rname = null;
 
             for (int i = 0; i < listSize; i++)
             {
-                rname = (String) (rendList.elementAt(i));
+                rname = rendList.elementAt(i);
                 if (rname.equals(dar))
                 { // DAR is in the registry
                     found = true;

File: src/net/java/sip/communicator/impl/media/device/V4LAuto.java
Patch:
@@ -42,12 +42,12 @@ public V4LAuto()
      */
     public int autoDetectDevices()
     {
-        Vector devices
+        Vector<CaptureDeviceInfo> devices
             = (Vector) CaptureDeviceManager.getDeviceList(null).clone();
-        Enumeration enumeration = devices.elements();
+        Enumeration<CaptureDeviceInfo> enumeration = devices.elements();
         while (enumeration.hasMoreElements())
         {
-            CaptureDeviceInfo cdi = (CaptureDeviceInfo) enumeration.nextElement();
+            CaptureDeviceInfo cdi = enumeration.nextElement();
             String name = cdi.getName();
             if (name.startsWith("v4l:"))
                 CaptureDeviceManager.removeDevice(cdi);

File: src/net/java/sip/communicator/impl/media/device/VFWAuto.java
Patch:
@@ -40,13 +40,13 @@ public VFWAuto()
      */
     public int autoDetectDevices()
     {
-        Vector devices
+        Vector<CaptureDeviceInfo> devices
             = (Vector) CaptureDeviceManager.getDeviceList(null).clone();
-        Enumeration devicesEnum = devices.elements();
+        Enumeration<CaptureDeviceInfo> devicesEnum = devices.elements();
 
         while (devicesEnum.hasMoreElements())
         {
-            CaptureDeviceInfo cdi = (CaptureDeviceInfo)devicesEnum.nextElement();
+            CaptureDeviceInfo cdi = devicesEnum.nextElement();
             String name = cdi.getName();
             if (name.startsWith("vfw:"))
                 CaptureDeviceManager.removeDevice(cdi);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -29,7 +29,7 @@
  * The <tt>ChatConversationPanel</tt> is the panel, where all sent and received
  * messages appear. All data is stored in an HTML document. An external CSS file
  * is applied to the document to provide the look&feel. All smilies and link
- * strings are processed and finally replaced by corresponding images and html
+ * strings are processed and finally replaced by corresponding images and HTML
  * links.
  *
  * @author Yana Stamcheva

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetMultiUserChatIcqImpl.java
Patch:
@@ -209,7 +209,7 @@ private ChatRoom createLocalChatRoomInstance(ChatInvitation chatInvitation)
     * @return ChatRoom the chat room that we've just created.
     */
    public ChatRoom createChatRoom( String roomName,
-                                   Hashtable roomProperties)
+                                   Map<String, Object> roomProperties)
            throws  OperationFailedException,
                    OperationNotSupportedException
    {

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetMultiUserChatMsnImpl.java
Patch:
@@ -208,7 +208,7 @@ public boolean isMultiChatSupportedByContact(Contact contact)
      * @return ChatRoom the chat room that we've just created.
      */
     public ChatRoom createChatRoom( String roomName,
-                                    Hashtable roomProperties)
+                                    Map<String, Object> roomProperties)
         throws  OperationFailedException,
                 OperationNotSupportedException
     {

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetMultiUserChatYahooImpl.java
Patch:
@@ -211,8 +211,9 @@ public void removePresenceListener(
     * @return ChatRoom the chat room that we've just created.
     */
    public ChatRoom createChatRoom(String roomName, 
-                                   Hashtable<String, Object> roomProperties)
-           throws OperationFailedException, OperationNotSupportedException
+                                  Map<String, Object> roomProperties)
+           throws OperationFailedException,
+                  OperationNotSupportedException
    {
        ChatRoom chatRoom = null;
        try

File: src/net/java/sip/communicator/service/protocol/ChatRoomMember.java
Patch:
@@ -7,7 +7,7 @@
 package net.java.sip.communicator.service.protocol;
 
 /**
- * This interface representes chat room participants. Instances are retrieved
+ * This interface represents chat room participants. Instances are retrieved
  * through implementations of the <tt>ChatRoom</tt> interface and offer methods
  * that allow querying member properties, such as, moderation permissions,
  * associated chat room and other.

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetMultiUserChat.java
Patch:
@@ -184,7 +184,7 @@ public void testCreateChatRoom()
     {
         //create room
         ChatRoom testChatRoom = opSetMultiChat1
-            .createChatRoom(fixture.chatRoomName, new Hashtable());
+            .createChatRoom(fixture.chatRoomName, null);
 
         //get available rooms
         assertNotNull("createChatRoom() returned null", testChatRoom);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommComboBoxEditor.java
Patch:
@@ -46,15 +46,15 @@ public void paintBorder(Component c, Graphics g, int x, int y, int w,
             g = g.create();
             try
             {
-                internalPaintBorder(c, g, x, y, w, h);
+                internalPaintBorder(g, x, y, w, h);
             }
             finally
             {
                 g.dispose();
             }
         }
 
-        private void internalPaintBorder(Component c, Graphics g, int x, int y,
+        private void internalPaintBorder(Graphics g, int x, int y,
                 int w, int h)
         {
             Graphics2D g2d = (Graphics2D)g;

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommDefaultTheme.java
Patch:
@@ -333,12 +333,12 @@ public SIPCommDefaultTheme()
 
     public void addCustomEntriesToTable(UIDefaults table)
     {
-        List buttonGradient
+        List<Object> buttonGradient
             = Arrays.asList(new Object[]
                { new Float(.3f), new Float(0f), BUTTON_GRADIENT_DARK_COLOR,
                 getWhite(), BUTTON_GRADIENT_LIGHT_COLOR });
 
-        List sliderGradient
+        List<Object> sliderGradient
             = Arrays.asList(new Object[]
                { new Float(.3f), new Float(.2f), SLIDER_GRADIENT_DARK_COLOR,
                 getWhite(), SLIDER_GRADIENT_LIGHT_COLOR });

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommSplitPaneDivider.java
Patch:
@@ -306,11 +306,11 @@ public void addLayoutComponent(String string, Component c) {}
     */
     
     int getOneTouchSizeFromSuper() {
-        return super.ONE_TOUCH_SIZE;
+        return BasicSplitPaneDivider.ONE_TOUCH_SIZE;
     }
     
     int getOneTouchOffsetFromSuper() {
-        return super.ONE_TOUCH_OFFSET;
+        return BasicSplitPaneDivider.ONE_TOUCH_OFFSET;
     }
     
     int getOrientationFromSuper() {

File: src/net/java/sip/communicator/impl/gui/main/account/AccountsConfigurationPanel.java
Patch:
@@ -186,7 +186,7 @@ public void serviceChanged(ServiceEvent event)
         }
         else if (event.getType() == ServiceEvent.UNREGISTERING)
         {
-            this.accountsPanel.remove((JPanel) accounts.get(pps));
+            this.accountsPanel.remove(accounts.get(pps));
             this.accountsPanel.revalidate();
             this.accountsPanel.repaint();
         }
@@ -302,7 +302,7 @@ public void save()
             ProtocolProviderFactory providerFactory =
                 GuiActivator.getProtocolProviderFactory(protocolProvider);
 
-            Map accountProperties =
+            Map<String, String> accountProperties =
                 protocolProvider.getAccountID().getAccountProperties();
 
             String password = new String(passwordField.getPassword());

File: src/net/java/sip/communicator/impl/gui/main/account/EmptyAccountRegistrationWizardPage.java
Patch:
@@ -149,7 +149,7 @@ public void commitPage()
      * Empty interface method implementation, unused in the case of the
      * {@link EmptyAccountRegistrationWizardPage}
      */
-    public void changedUpdate(DocumentEvent e)
+    public void changedUpdate(@SuppressWarnings("unused") DocumentEvent e)
     {
     }
 

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallButton.java
Patch:
@@ -173,9 +173,9 @@ public void callStateChanged(CallChangeEvent evt)
     private CallParticipant findCallParticipant(
         OperationSetBasicTelephony telephony, String address)
     {
-        for (Iterator callIter = telephony.getActiveCalls(); callIter.hasNext();)
+        for (Iterator<Call> callIter = telephony.getActiveCalls(); callIter.hasNext();)
         {
-            Call call = (Call) callIter.next();
+            Call call = callIter.next();
 
             for (Iterator<CallParticipant> participantIter =
                 call.getCallParticipants(); participantIter.hasNext();)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatSession.java
Patch:
@@ -89,7 +89,7 @@ public interface ChatSession
      * @param count The number of messages from history to return.
      * @return a collection of the last N number of messages given by count.
      */
-    public Collection getHistory(int count);
+    public Collection<EventObject> getHistory(int count);
 
     /**
      * Returns a collection of the last N number of messages given by count.
@@ -98,7 +98,7 @@ public interface ChatSession
      * @param count The number of messages from history to return.
      * @return a collection of the last N number of messages given by count.
      */
-    public Collection getHistoryBeforeDate(Date date, int count);
+    public Collection<EventObject> getHistoryBeforeDate(Date date, int count);
 
     /**
      * Returns a collection of the last N number of messages given by count.
@@ -107,7 +107,7 @@ public interface ChatSession
      * @param count The number of messages from history to return.
      * @return a collection of the last N number of messages given by count.
      */
-    public Collection getHistoryAfterDate(Date date, int count);
+    public Collection<EventObject> getHistoryAfterDate(Date date, int count);
 
     /**
      * Returns the start date of the history of this chat session.

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransportSelectorBox.java
Patch:
@@ -40,6 +40,9 @@ public class ChatTransportSelectorBox
 
     private final ChatSession chatSession;
 
+    /**
+     * @param chatPanel Currently not used 
+     */
     public ChatTransportSelectorBox(ChatPanel chatPanel,
                                     ChatSession chatSession,
                                     ChatTransport selectedChatTransport)

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatContactCellRenderer.java
Patch:
@@ -34,8 +34,6 @@ public Component getListCellRendererComponent(  JList list,
 
         this.photoLabel.setIcon(null);
 
-        DefaultContactList contactList = (DefaultContactList) list;
-
         ChatContact chatContact = (ChatContact) value;
 
         this.setPreferredSize(new Dimension(20, 30));

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomMemberListPanel.java
Patch:
@@ -36,6 +36,7 @@ public class ChatRoomMemberListPanel
 
     /**
      * Creates an instance of <tt>ChatContactListPanel</tt>.
+     * @param chat Currently not used
      */
     public ChatRoomMemberListPanel(ChatPanel chat)
     {

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -43,7 +43,8 @@ public class ConferenceChatManager
     private static final Logger logger
         = Logger.getLogger(ConferenceChatManager.class);
 
-    private final Hashtable chatRoomHistory = new Hashtable();
+    private final Hashtable<ChatRoomWrapper, HistoryWindow> chatRoomHistory =
+        new Hashtable<ChatRoomWrapper, HistoryWindow>();
 
     private final ChatRoomList chatRoomList = new ChatRoomList();
 
@@ -763,7 +764,7 @@ public boolean containsHistoryWindowForChatRoom(
     public HistoryWindow getHistoryWindowForChatRoom(
         ChatRoomWrapper chatRoomWrapper)
     {
-        return (HistoryWindow) chatRoomHistory.get(chatRoomWrapper);
+        return chatRoomHistory.get(chatRoomWrapper);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindowManager.java
Patch:
@@ -15,7 +15,7 @@
  */
 public class HistoryWindowManager
 {
-    private Hashtable contactHistory = new Hashtable();
+    private Hashtable<Object, HistoryWindow> contactHistory = new Hashtable<Object, HistoryWindow>();
 
     /**
      * Checks if there's an open history window for the given history contact.
@@ -37,7 +37,7 @@ public boolean containsHistoryWindowForContact(Object historyContact)
      */
     public HistoryWindow getHistoryWindowForContact(Object historyContact)
     {
-        return (HistoryWindow) contactHistory.get(historyContact);
+        return contactHistory.get(historyContact);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomCommonRightButtonMenu.java
Patch:
@@ -50,6 +50,8 @@ public class ChatRoomCommonRightButtonMenu
     private ChatRoomProviderWrapper chatRoomProvider;
     /**
      * Creates an instance of <tt>ChatRoomsListRightButtonMenu</tt>.
+     * 
+     * @param mainFrame Currently not used
      */
     public ChatRoomCommonRightButtonMenu(   MainFrame mainFrame,
                                             ChatRoomProviderWrapper provider)

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListUI.java
Patch:
@@ -36,8 +36,8 @@ public class ChatRoomListUI
 
     /**
      * Creates the scroll panel containing the chat rooms list.
-     *
-     * @param frame the main application frame
+     * 
+     * @param parentDialog Currently not used
      */
     public ChatRoomListUI(ChatRoomListDialog parentDialog)
     {

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/CreateChatRoomWizardPage1.java
Patch:
@@ -12,6 +12,7 @@
 import javax.swing.event.*;
 
 import net.java.sip.communicator.service.gui.*;
+import net.java.sip.communicator.service.protocol.*;
 
 /**
  * The <tt>CreateChatRoomWizardPage1</tt> is the first page of the
@@ -41,7 +42,7 @@ public class CreateChatRoomWizardPage1
      */
     public CreateChatRoomWizardPage1(WizardContainer wizard,
             NewChatRoom newChatRoom, 
-            Iterator protocolProvidersList)
+            Iterator<ProtocolProviderService> protocolProvidersList)
     {
         this.wizard = wizard;
 

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/SelectAccountPanel.java
Patch:
@@ -132,8 +132,7 @@ private void tableInit()
 
         while(protocolProvidersList.hasNext())
         {
-            ProtocolProviderService pps 
-                = (ProtocolProviderService)protocolProvidersList.next();
+            ProtocolProviderService pps = protocolProvidersList.next();
 
             OperationSet opSet = pps.getOperationSet(
                 OperationSetMultiUserChat.class);

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/SearchChatRoomPanel.java
Patch:
@@ -125,7 +125,7 @@ public void actionPerformed(ActionEvent e)
      */
     public void loadChatRoomsList()
     {
-        List list = GuiActivator.getUIService().getConferenceChatManager()
+        List<String> list = GuiActivator.getUIService().getConferenceChatManager()
             .getExistingChatRooms(chatRoomProvider);
 
         if(list != null)
@@ -136,7 +136,7 @@ public void loadChatRoomsList()
                     .getI18NString("service.gui.NO_AVAILABLE_ROOMS"));
             }
 
-            chatRoomsList.setListData(new Vector(list));
+            chatRoomsList.setListData(new Vector<String>(list));
             chatRoomsList.setBorder(
                     BorderFactory.createLineBorder(Color.LIGHT_GRAY));
             

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/SelectAccountPanel.java
Patch:
@@ -141,8 +141,7 @@ private void tableInit()
 
         while(chatRoomProvidersList.hasNext())
         {
-            ChatRoomProviderWrapper provider 
-                = (ChatRoomProviderWrapper) chatRoomProvidersList.next();
+            ChatRoomProviderWrapper provider = chatRoomProvidersList.next();
 
             String pName = provider.getName();
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -1341,13 +1341,12 @@ else if(isShowOffline && newListSize > 0)
             if (selectedObject instanceof MetaContact)
             {
                 this.setSelectedIndex(
-                    listModel.indexOf((MetaContact) selectedObject));
+                    listModel.indexOf(selectedObject));
             }
             else
             {
                 this.setSelectedIndex(
-                    listModel.indexOf(
-                            (MetaContactGroup) selectedObject));
+                    listModel.indexOf(selectedObject));
             }
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListModel.java
Patch:
@@ -277,7 +277,7 @@ public int countContactsAndSubgroups(MetaContactGroup parentGroup)
                 Iterator<MetaContact> i = parentGroup.getChildContacts();
                 while (i.hasNext())
                 {
-                    MetaContact contact = (MetaContact) i.next();
+                    MetaContact contact = i.next();
 
                     if (isContactOnline(contact))
                         count++;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -205,8 +205,7 @@ private void init()
 
         while (providers.hasNext())
         {
-            ProtocolProviderService pps
-                = (ProtocolProviderService)providers.next();
+            ProtocolProviderService pps = providers.next();
 
             String protocolName = pps.getProtocolName();
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GroupRightButtonMenu.java
Patch:
@@ -73,10 +73,9 @@ public GroupRightButtonMenu(MainFrame mainFrame,
 
         this.add(addContactMenu);
 
-        Iterator providers = mainFrame.getProtocolProviders();
+        Iterator<ProtocolProviderService> providers = mainFrame.getProtocolProviders();
         while(providers.hasNext()) {
-            ProtocolProviderService pps
-                = (ProtocolProviderService)providers.next();
+            ProtocolProviderService pps = providers.next();
 
             boolean isHidden =
                 pps.getAccountID().getAccountProperty(

File: src/net/java/sip/communicator/impl/gui/main/menus/AboutWindow.java
Patch:
@@ -55,7 +55,7 @@ public AboutWindow()
         {
             public void mouseClicked(MouseEvent e)
             {
-                AboutWindow.this.close(false);
+                AboutWindow.this.close();
             }
         });
 
@@ -71,7 +71,7 @@ public void mouseClicked(MouseEvent e)
         imap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0), "close");
     }
 
-    protected void close(boolean isEscaped)
+    protected void close()
     {
         this.dispose();
     }
@@ -83,7 +83,7 @@ private class CloseAction extends AbstractAction
     {
         public void actionPerformed(ActionEvent e)
         {
-            AboutWindow.this.close(true);
+            AboutWindow.this.close();
         }
     }
 

File: src/net/java/sip/communicator/impl/gui/main/presence/SimpleStatusMenu.java
Patch:
@@ -165,6 +165,9 @@ public void updateStatus()
         }
     }
 
+    /**
+     * @param status Currently unused 
+     */
     public void updateStatus(Object status)
     {
     }

File: src/net/java/sip/communicator/impl/gui/utils/Constants.java
Patch:
@@ -407,7 +407,7 @@ else if (status.equals(FREE_FOR_CHAT_STATUS))
      */
     public static void loadAdiumStyle(){
 
-        File is = new File(Constants.class.getClassLoader()
+        new File(Constants.class.getClassLoader()
             .getResource(DEFAULT_STYLE_PATH + "/TotallyClear").toString());
     }
 

File: src/net/java/sip/communicator/impl/gui/utils/ContactListDraggable.java
Patch:
@@ -66,7 +66,7 @@ public class ContactListDraggable extends JComponent
      * A set of 2 cursors indicating if the dragged element is currently
      * located over the contactlist or not.
      */
-    private static Hashtable cursors = new Hashtable(2);
+    private static Hashtable<String, Cursor> cursors = new Hashtable<String, Cursor>(2);
     static {
         try
         {
@@ -237,11 +237,11 @@ public void paintComponent(Graphics g)
         Point p = SwingUtilities.convertPoint(this, location, contactList);
         if (contactList.contains(p))
         {
-            setCursor((Cursor) cursors.get("valid"));
+            setCursor(cursors.get("valid"));
         }
         else
         {
-            setCursor((Cursor) cursors.get("invalid"));
+            setCursor(cursors.get("invalid"));
         }
     }
 }

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -451,6 +451,7 @@ public void startStreaming()
 
         if(!startedAtLeastOneAudioStream
                 && !startedAtLeastOneVideoStream
+                && sendStreams != null 
                 && (sendStreams.size() > 0))
         {
             stopStreaming();

File: src/net/java/sip/communicator/impl/media/MediaServiceImpl.java
Patch:
@@ -8,6 +8,7 @@
 
 import java.net.*;
 import java.util.*;
+
 import javax.sdp.*;
 import javax.media.Time;
 
@@ -189,13 +190,13 @@ public RtpFlow createRtpFlow(String localIP,
                                  int localPort,
                                  String remoteIP,
                                  int remotePort,
-                                 Map mediaEncodings)
+                                 Map<String, List<String>> mediaEncodings)
         throws MediaException
     {
         waitUntilStarted();
 
         return new RtpFlowImpl(this, localIP, remoteIP,
-                localPort, remotePort, new Hashtable(mediaEncodings));
+                localPort, remotePort, new Hashtable<String, List<String>>(mediaEncodings));
     }
 
 

File: src/net/java/sip/communicator/service/media/MediaService.java
Patch:
@@ -7,6 +7,7 @@
 package net.java.sip.communicator.service.media;
 
 import java.util.*;
+
 import net.java.sip.communicator.service.media.event.*;
 import net.java.sip.communicator.service.protocol.*;
 import java.net.*;
@@ -117,7 +118,7 @@ public RtpFlow createRtpFlow(String localIP,
                                  int localPort,
                                  String remoteIP,
                                  int remotePort,
-                                 Map mediaEncodings)
+                                 Map<String, List<String>> mediaEncodings)
         throws MediaException;
 
     /**

File: src/net/java/sip/communicator/service/protocol/ChatRoomConfigurationForm.java
Patch:
@@ -32,7 +32,7 @@ public interface ChatRoomConfigurationForm
      * @return a list of <tt>ChatRoomConfigurationFormField</tt>s, containing
      * the current configuration of the chat room
      */
-    public Iterator getConfigurationSet();
+    public Iterator<ChatRoomConfigurationFormField> getConfigurationSet();
     
     /**
      * Submits the information in this configuration form to the server.

File: src/net/java/sip/communicator/service/protocol/ChatRoomConfigurationFormField.java
Patch:
@@ -115,7 +115,7 @@ public interface ChatRoomConfigurationFormField
      *
      * @return Iterator for the available options.
      */
-    public Iterator getOptions();
+    public Iterator<String> getOptions();
     
     /**
      * Returns true if the question must be answered in order to complete the
@@ -143,7 +143,7 @@ public interface ChatRoomConfigurationFormField
      * @return an Iterator for the default values or answered values of the
      * field
      */
-    public Iterator getValues();
+    public Iterator<Object> getValues();
     
     /**
      * Adds the given value to the values of this field.

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -451,7 +451,8 @@ public void joinChatRoom(   ChatRoomWrapper chatRoomWrapper,
                 GuiActivator.getUIService().getMainFrame(),
                 GuiActivator.getResources().getI18NString("service.gui.WARNING"),
                 GuiActivator.getResources().getI18NString(
-                    "haveToBeConnectedToJoin"))
+                    "service.gui.CHAT_ROOM_NOT_CONNECTED",
+                    new String[]{chatRoomWrapper.getChatRoomName()}))
                     .showDialog();
 
             return;

File: src/net/java/sip/communicator/impl/gui/main/authorization/RequestAuthorizationDialog.java
Patch:
@@ -89,8 +89,10 @@ public RequestAuthorizationDialog(MainFrame mainFrame, Contact contact,
         this.setTitle(title);
         
         titleLabel.setHorizontalAlignment(JLabel.CENTER);
-        titleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18f));
         titleLabel.setText(title);
+
+        Font font = titleLabel.getFont();
+        titleLabel.setFont(font.deriveFont(Font.BOLD, font.getSize2D() + 6));
         
         this.mainPanel.setPreferredSize(new Dimension(400, 230));
         

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatInviteDialog.java
Patch:
@@ -85,7 +85,7 @@ public ChatInviteDialog (ChatPanel chatPanel)
         infoTextArea.setText(GuiActivator.getResources()
             .getI18NString("service.gui.INVITE_CONTACT_MSG"));
 
-        infoTextArea.setFont(Constants.FONT.deriveFont(Font.BOLD));
+        infoTextArea.setFont(infoTextArea.getFont().deriveFont(Font.BOLD));
         infoTextArea.setLineWrap(true);
         infoTextArea.setOpaque(false);
         infoTextArea.setWrapStyleWord(true);

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/InvitationReceivedDialog.java
Patch:
@@ -121,8 +121,8 @@ public InvitationReceivedDialog (ConferenceChatManager multiUserChatManager,
 
             this.dataPanel.add(invitationReasonTextArea, BorderLayout.CENTER);
         }
-        
-        this.infoTextArea.setFont(Constants.FONT.deriveFont(Font.BOLD));
+
+        this.infoTextArea.setFont(infoTextArea.getFont().deriveFont(Font.BOLD));
         this.infoTextArea.setLineWrap(true);
         this.infoTextArea.setOpaque(false);
         this.infoTextArea.setWrapStyleWord(true);

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/createforms/SelectAccountPanel.java
Patch:
@@ -17,7 +17,6 @@
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
 
 /**
@@ -90,7 +89,9 @@ public SelectAccountPanel(NewChatRoom newChatRoom,
 
         this.infoLabel.setEditable(false);
 
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(
+            font.deriveFont(Font.BOLD, font.getSize2D() + 6));
 
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoLabel);

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/ChatRoomAuthenticationWindow.java
Patch:
@@ -113,15 +113,15 @@ private void init()
         this.infoTextArea.setOpaque(false);
         this.infoTextArea.setLineWrap(true);
         this.infoTextArea.setWrapStyleWord(true);
-        this.infoTextArea.setFont(Constants.FONT.deriveFont(Font.BOLD, 12f));
+        this.infoTextArea.setFont(infoTextArea.getFont().deriveFont(Font.BOLD));
         this.infoTextArea.setEditable(false);
         this.infoTextArea.setText(
             GuiActivator.getResources().getI18NString(
                 "service.gui.CHAT_ROOM_REQUIRES_PASSWORD",
                 new String[]{chatRoom.getChatRoomName()}));
 
-        this.idLabel.setFont(Constants.FONT.deriveFont(Font.BOLD));
-        this.passwdLabel.setFont(Constants.FONT.deriveFont(Font.BOLD));
+        this.idLabel.setFont(idLabel.getFont().deriveFont(Font.BOLD));
+        this.passwdLabel.setFont(passwdLabel.getFont().deriveFont(Font.BOLD));
 
         this.labelsPanel.add(idLabel);
         this.labelsPanel.add(passwdLabel);

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/SelectAccountPanel.java
Patch:
@@ -96,7 +96,9 @@ public SelectAccountPanel(
 
         this.infoLabel.setEditable(false);
 
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(
+            font.deriveFont(Font.BOLD, font.getSize2D() + 6));
 
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoLabel);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MoveSubcontactMessageDialog.java
Patch:
@@ -97,7 +97,9 @@ public void actionPerformed(ActionEvent e) {
         });
 
         this.infoTitleLabel.setHorizontalAlignment(JLabel.CENTER);
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(font.deriveFont(Font.BOLD, font.getSize2D() + 6));
 
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoArea);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameContactPanel.java
Patch:
@@ -69,7 +69,9 @@ public RenameContactPanel(String oldName)
         this.dataPanel.add(textField, BorderLayout.CENTER);
 
         this.infoTitleLabel.setHorizontalAlignment(JLabel.CENTER);
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(font.deriveFont(Font.BOLD, font.getSize2D() + 6));
 
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoLabel);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameGroupPanel.java
Patch:
@@ -69,7 +69,9 @@ public RenameGroupPanel(String groupName)
         this.dataPanel.add(textField, BorderLayout.CENTER);
 
         this.infoTitleLabel.setHorizontalAlignment(JLabel.CENTER);
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(font.deriveFont(Font.BOLD, font.getSize2D() + 6));
 
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoLabel);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactPanel.java
Patch:
@@ -87,7 +87,9 @@ public AddContactPanel(WizardContainer wizard)
         this.dataPanel.add(textField, BorderLayout.CENTER);
 
         this.infoTitleLabel.setHorizontalAlignment(JLabel.CENTER);
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(font.deriveFont(Font.BOLD, font.getSize2D() + 6));
 
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoLabel);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/SelectAccountPanel.java
Patch:
@@ -19,7 +19,6 @@
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.main.account.*;
 import net.java.sip.communicator.impl.gui.utils.*;
-import net.java.sip.communicator.impl.gui.utils.Constants;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
@@ -112,7 +111,8 @@ public SelectAccountPanel(NewContact newContact,
 
         this.infoLabel.setEditable(false);
 
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(font.deriveFont(Font.BOLD, font.getSize2D() + 6));
 
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoLabel);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/SelectGroupPanel.java
Patch:
@@ -84,7 +84,9 @@ public SelectGroupPanel(AddContactWizard wizard,
         this.infoLabel.setEditable(false);
 
         this.infoTitleLabel.setHorizontalAlignment(JLabel.CENTER);
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(font.deriveFont(Font.BOLD, font.getSize2D() + 6));
 
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoLabel);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addgroup/CreateGroupPanel.java
Patch:
@@ -68,7 +68,9 @@ public CreateGroupPanel()
         this.dataPanel.add(textField, BorderLayout.CENTER);
         
         this.infoTitleLabel.setHorizontalAlignment(JLabel.CENTER);
-        this.infoTitleLabel.setFont(Constants.FONT.deriveFont(Font.BOLD, 18));
+
+        Font font = infoTitleLabel.getFont();
+        infoTitleLabel.setFont(font.deriveFont(Font.BOLD, font.getSize2D() + 6));
         
         this.labelsPanel.add(infoTitleLabel);
         this.labelsPanel.add(infoLabel);

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetMultiUserChatYahooImpl.java
Patch:
@@ -3,11 +3,10 @@
 import java.io.IOException;
 import java.util.*;
 
-import org.jivesoftware.smackx.muc.*;
-
 import ymsg.network.*;
 import ymsg.network.event.*;
 import ymsg.support.MessageDecoder;
+
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/plugin/autoaway/StatusUpdateThread.java
Patch:
@@ -9,17 +9,17 @@
 import java.awt.*;
 import java.util.*;
 
-import net.java.sip.communicator.service.configuration.ConfigurationService;
+import net.java.sip.communicator.service.configuration.*;
 import net.java.sip.communicator.service.protocol.*;
 
 /**
  * A Runnable, which permanently looks at the mouse position. If the mouse is
  * not moved, all accounts are set to "Away" or similar states.
  * 
  * @author Thomas Hofer
- * 
  */
-public class StatusUpdateThread implements Runnable
+public class StatusUpdateThread
+    implements Runnable
 {
     private boolean run = false;
     private Point lastPosition = null;

File: src/net/java/sip/communicator/impl/gui/customcontrols/SCScrollPane.java
Patch:
@@ -46,7 +46,7 @@ public SCScrollPane()
     public void setViewportView(JComponent view)
     {
         view.setBorder(BorderFactory.createEmptyBorder(3, 3, 3, 3));
-        this.setOpaque(false);
+        view.setOpaque(false);
 
         super.setViewportView(view);
     }

File: test/net/java/sip/communicator/slick/history/TestHistoryService.java
Patch:
@@ -155,7 +155,7 @@ public void testReadRecords()
     {
         HistoryReader reader = this.history.getReader();
 
-        QueryResultSet result = reader.findByKeyword("name2", "name");
+        QueryResultSet<HistoryRecord> result = reader.findByKeyword("name2", "name");
 
         assertTrue("Nothing found", result.hasNext());
 

File: src/net/java/sip/communicator/impl/history/HistoryServiceImpl.java
Patch:
@@ -137,7 +137,7 @@ public History getHistory(HistoryID id)
         {
             if (histories.containsKey(id))
             {
-                retVal = (History) histories.get(id);
+                retVal = histories.get(id);
             } else {
                 throw new IllegalArgumentException(
                         "No history corresponds to the specified ID.");

File: src/net/java/sip/communicator/impl/history/HistoryWriterImpl.java
Patch:
@@ -162,12 +162,12 @@ private void createNewDoc(Date date, boolean loadLastFile)
 
         if (loadLastFile)
         {
-            Iterator files = historyImpl.getFileList();
+            Iterator<String> files = historyImpl.getFileList();
 
             String file = null;
             while (files.hasNext())
             {
-                file = (String) files.next();
+                file = files.next();
             }
 
             if (file != null)

File: src/net/java/sip/communicator/service/history/BidirectionalIterator.java
Patch:
@@ -16,7 +16,7 @@
  * 
  * @author Alexander Pelov
  */
-public interface BidirectionalIterator extends Iterator {
+public interface BidirectionalIterator<T> extends Iterator<T> {
     /**
      * Returns true if the iteration has elements preceeding the current one.
      * (In other words, returns true if <tt>prev</tt> would return an element
@@ -34,5 +34,5 @@ public interface BidirectionalIterator extends Iterator {
      * @throws NoSuchElementException
      *             iteration has no more elements.
      */
-    Object prev() throws NoSuchElementException;
+    T prev() throws NoSuchElementException;
 }

File: src/net/java/sip/communicator/impl/gui/customcontrols/SCScrollPane.java
Patch:
@@ -63,6 +63,8 @@ private static class SCViewport
 
         public SCViewport()
         {
+            this.setBackground(Color.WHITE);
+
             if (getSettingsBoolean("impl.gui.IS_WINDOW_BACKGROUND_ENABLED"))
             {
                 bgImage =
@@ -74,6 +76,7 @@ public SCViewport()
                     texture =
                         new TexturePaint(bgImage, new Rectangle(0, 0, bgImage
                             .getWidth(null), bgImage.getHeight(null)));
+
                     color = null;
                 }
                 else

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -1529,11 +1529,11 @@ protected void onUserList(String channel, User[] users)
             String userPrefix = user.getPrefix();
             ChatRoomMemberRole newMemberRole;
 
-            if ("@".equalsIgnoreCase(userPrefix))
+            if (userPrefix.contains("@"))
                 newMemberRole = ChatRoomMemberRole.ADMINISTRATOR;
-            else if ("%".equalsIgnoreCase(userPrefix))
+            else if (userPrefix.contains("%"))
                 newMemberRole = ChatRoomMemberRole.MODERATOR;
-            else if ("+".equalsIgnoreCase(userPrefix))
+            else if (userPrefix.contains("+"))
                 newMemberRole = ChatRoomMemberRole.MEMBER;
             else
                 newMemberRole = ChatRoomMemberRole.GUEST;

File: src/net/java/sip/communicator/impl/protocol/irc/OperationSetMultiUserChatIrcImpl.java
Patch:
@@ -62,7 +62,8 @@ public class OperationSetMultiUserChatIrcImpl
      * are a result of exchange of private messages between the local user and
      * some of the other chat room members.
      */
-    private Hashtable privateRoomCache = new Hashtable();
+    private final Map<String, ChatRoomIrcImpl> privateRoomCache
+        = new Hashtable<String, ChatRoomIrcImpl>();
 
     /**
      * The <tt>ChatRoom</tt> corresponding to the IRC server channel. This chat
@@ -376,7 +377,7 @@ protected ChatRoomIrcImpl findPrivateChatRoom(String nickIdentifier)
         synchronized(privateRoomCache)
         {
             if(privateRoomCache.containsKey(nickIdentifier))
-                return (ChatRoomIrcImpl) privateRoomCache.get(nickIdentifier);
+                return privateRoomCache.get(nickIdentifier);
 
             ChatRoomIrcImpl chatRoom
                 = new ChatRoomIrcImpl(nickIdentifier, ircProvider, true, false);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -136,8 +136,7 @@ public void stateChanged(ChangeEvent evt)
             mainToolBar = new MainToolBar(this);
 
         boolean chatToolbarVisible = ConfigurationManager.isChatToolbarVisible();
-        mainToolBar.setVisible(chatToolbarVisible);
-        contactPhotoPanel.setVisible(chatToolbarVisible);
+        northPanel.setVisible(chatToolbarVisible);
 
         northPanel.setBorder(BorderFactory.createEmptyBorder(3, 0, 3, 0));
         northPanel.add(mainToolBar, BorderLayout.CENTER);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactDialog.java
Patch:
@@ -186,7 +186,7 @@ public void run()
                                     GuiActivator.getResources().getI18NString(
                                     "addContactErrorTitle"),
                                     GuiActivator.getResources().getI18NString(
-                                            "addContactExistError",
+                                            "service.gui.ADD_CONTACT_EXIST_ERROR",
                                             new String[]{uin}),
                                     ex)
                                 .showDialog();

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactWizard.java
Patch:
@@ -146,7 +146,7 @@ public void run() {
                             GuiActivator.getResources().getI18NString(
                             "addContactErrorTitle"),
                             GuiActivator.getResources().getI18NString(
-                                    "addContactExistError",
+                                    "service.gui.ADD_CONTACT_EXIST_ERROR",
                                     new String[]{newContact.getUin()}),
                             ex)
                         .showDialog();

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -563,7 +563,7 @@ public boolean processRequest(RequestEvent requestEvent)
             try
             {
                 serverTransaction =
-                    jainSipProvider.getNewServerTransaction(request);
+                    SipStackSharing.getOrCreateServerTransaction(requestEvent);
             }
             catch (TransactionAlreadyExistsException ex)
             {

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -710,8 +710,8 @@ public void processRequest(RequestEvent requestEvent)
                 {
                     try
                     {
-                        serverTransaction = jainSipProvider
-                            .getNewServerTransaction(request);
+                        serverTransaction = SipStackSharing.
+                            getOrCreateServerTransaction(requestEvent);
                     }
                     catch (TransactionAlreadyExistsException ex)
                     {

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -197,8 +197,8 @@ public void setHierarchicallyOpaque(boolean isOpaque)
      */
     public void setToolbarVisible(boolean b)
     {
-        mainToolBar.setVisible(b);
-        contactPhotoPanel.setVisible(b);
+        // The north panel is the one containing the toolbar and contact photo.
+        northPanel.setVisible(b);
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -545,6 +545,9 @@ public void processMessage(String contactName, long date,
             = this.conversationPanel.processMessage(contactName, date,
                                             messageType, message, contentType);
         this.conversationPanel.appendMessageToEnd(processedMessage);
+
+        // change the last history message timestamp after we add one.
+        this.lastHistoryMsgTimestamp = date;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/customcontrols/events/CloseTabbedPaneEvent.java
Patch:
@@ -19,6 +19,8 @@
  * @author Yana Stamcheva
  */
 public class CloseTabbedPaneEvent extends Event {
+    private static final long serialVersionUID = 1L;
+
     private final String description;
 
     private final MouseEvent e;

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/Wizard.java
Patch:
@@ -34,6 +34,8 @@ public class Wizard
                 PropertyChangeListener
 {
 
+    private static final long serialVersionUID = 1L;
+
     /**
      * Indicates that the 'Finish' button was pressed to close the dialog.
      */

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardEvent.java
Patch:
@@ -11,6 +11,8 @@
 public class WizardEvent
     extends EventObject
 {
+    private static final long serialVersionUID = 1L;
+
     private final int eventCode;
     
     /**

File: src/net/java/sip/communicator/impl/gui/event/PluginComponentEvent.java
Patch:
@@ -17,6 +17,8 @@
 public class PluginComponentEvent
     extends EventObject
 {
+    private static final long serialVersionUID = 1L;
+
     private final int eventID;
 
     /**

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommComboBoxEditor.java
Patch:
@@ -41,6 +41,8 @@ public SIPCommComboBoxEditor()
     private static class EditorBorder
         extends AbstractBorder
     {
+        private static final long serialVersionUID = 1L;
+
         public void paintBorder(Component c, Graphics g, int x, int y, int w,
                 int h) {
             g = g.create();

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommDefaultTheme.java
Patch:
@@ -333,12 +333,12 @@ public SIPCommDefaultTheme()
 
     public void addCustomEntriesToTable(UIDefaults table)
     {
-        List buttonGradient
+        List<Object> buttonGradient
             = Arrays.asList(new Object[]
                { new Float(.3f), new Float(0f), BUTTON_GRADIENT_DARK_COLOR,
                 getWhite(), BUTTON_GRADIENT_LIGHT_COLOR });
 
-        List sliderGradient
+        List<Object> sliderGradient
             = Arrays.asList(new Object[]
                { new Float(.3f), new Float(.2f), SLIDER_GRADIENT_DARK_COLOR,
                 getWhite(), SLIDER_GRADIENT_LIGHT_COLOR });

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegSummaryPage.java
Patch:
@@ -28,6 +28,8 @@ public class AccountRegSummaryPage
     extends SCScrollPane
     implements WizardPage
 {
+    private static final long serialVersionUID = 1L;
+
     private final Logger logger = Logger.getLogger(AccountRegSummaryPage.class);
 
     private final JPanel keysPanel

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -31,6 +31,8 @@ public class AccountRegWizardContainerImpl
     implements  WizardContainer,
                 ServiceListener
 {
+    private static final long serialVersionUID = 1L;
+
     private static final Logger logger =
         Logger.getLogger(AccountRegWizardContainerImpl.class);
 

File: src/net/java/sip/communicator/impl/gui/main/account/EmptyAccountRegistrationWizardPage.java
Patch:
@@ -148,6 +148,7 @@ public void commitPage()
     /**
      * Empty interface method implementation, unused in the case of the
      * {@link EmptyAccountRegistrationWizardPage}
+     * @param e Not used in this method
      */
     public void changedUpdate(DocumentEvent e)
     {

File: src/net/java/sip/communicator/impl/gui/main/account/NewAccountDialog.java
Patch:
@@ -25,6 +25,8 @@ public class NewAccountDialog
     extends SIPCommDialog
     implements  ActionListener
 {
+    private static final long serialVersionUID = 1L;
+
     private final Logger logger = Logger.getLogger(NewAccountDialog.class);
 
     private TransparentPanel mainPanel

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationRequestedDialog.java
Patch:
@@ -26,6 +26,8 @@ public class AuthorizationRequestedDialog
     extends SIPCommDialog
     implements ActionListener {
     
+    private static final long serialVersionUID = 1L;
+
     public static final int ACCEPT_CODE = 0;
     
     public static final int REJECT_CODE = 1;

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationResponseDialog.java
Patch:
@@ -22,6 +22,8 @@
 public class AuthorizationResponseDialog extends SIPCommDialog
     implements ActionListener {
     
+    private static final long serialVersionUID = 1L;
+
     private JTextArea infoTextArea = new JTextArea();
     
     private JTextArea responseArea = new JTextArea();

File: src/net/java/sip/communicator/impl/gui/main/authorization/RequestAuthorizationDialog.java
Patch:
@@ -28,6 +28,8 @@ public class RequestAuthorizationDialog
     extends SIPCommDialog
     implements ActionListener
 {
+    private static final long serialVersionUID = 1L;
+
     public static final int OK_RETURN_CODE = 1;
     
     public static final int CANCEL_RETURN_CODE = 0;

File: src/net/java/sip/communicator/impl/gui/main/call/AccountSelectorBox.java
Patch:
@@ -33,6 +33,8 @@ public class AccountSelectorBox
     extends SIPCommMenuBar
     implements ActionListener
 {
+    private static final long serialVersionUID = 1L;
+
     private static final Logger logger =
         Logger.getLogger(AccountSelectorBox.class);
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -29,6 +29,8 @@ public class CallDialog
     implements ActionListener,
                MouseListener
 {
+    private static final long serialVersionUID = 1L;
+
     private static final String DIAL_BUTTON = "DIAL_BUTTON";
 
     private static final String HANGUP_BUTTON = "HANGUP_BUTTON";

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -35,6 +35,8 @@ public class CallPanel
                 PropertyChangeListener,
                 CallParticipantSecurityListener
 {
+    private static final long serialVersionUID = 1L;
+
     private final TransparentPanel mainPanel = new TransparentPanel();
 
     private final Hashtable<CallParticipant, CallParticipantPanel>

File: src/net/java/sip/communicator/impl/gui/main/call/CallParticipantPanel.java
Patch:
@@ -31,6 +31,8 @@
 public class CallParticipantPanel
     extends TransparentPanel
 {
+    private static final long serialVersionUID = 1L;
+
     private static final Logger logger =
         Logger.getLogger(CallParticipantPanel.class);
 

File: src/net/java/sip/communicator/impl/gui/main/call/DialPanel.java
Patch:
@@ -32,6 +32,8 @@ public class DialPanel
     extends JPanel
     implements MouseListener
 {
+    private static final long serialVersionUID = 1L;
+
     private final Logger logger = Logger.getLogger(DialPanel.class);
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/DialpadDialog.java
Patch:
@@ -24,6 +24,7 @@ public class DialpadDialog
     extends JDialog
     implements WindowFocusListener
 {
+    private static final long serialVersionUID = 1L;
     private DialPanel dialPanel;
 
     /**
@@ -83,6 +84,8 @@ private void init()
      */
     private static class BackgroundPanel extends JPanel
     {
+        private static final long serialVersionUID = 1L;
+
         public void paintComponent(Graphics g)
         {
             super.paintComponent(g);

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -92,6 +92,7 @@ private static class HoldButtonModel
         implements ActionListener
     {
 
+        private static final long serialVersionUID = 1L;
         /**
          * The <tt>CallParticipant</tt> whose state is being adapted for the
          * purposes of depicting as a toggle button.

File: src/net/java/sip/communicator/impl/gui/main/call/LocalVideoButton.java
Patch:
@@ -44,6 +44,8 @@ private static class LocalVideoButtonModel
         implements ActionListener,
                    Runnable
     {
+        private static final long serialVersionUID = 1L;
+
         private final Call call;
 
         private Thread runner;

File: src/net/java/sip/communicator/impl/gui/main/call/MainCallPanel.java
Patch:
@@ -41,6 +41,8 @@ public class MainCallPanel
                 PluginComponentListener,
                 MouseListener
 {
+    private static final long serialVersionUID = 1L;
+
     private final Logger logger = Logger.getLogger(MainCallPanel.class);
 
     private static final String CALL_BUTTON = "CALL_BUTTON";

File: src/net/java/sip/communicator/impl/gui/main/call/MuteButton.java
Patch:
@@ -88,6 +88,7 @@ private static class MuteButtonModel
         implements ActionListener
     {
 
+        private static final long serialVersionUID = 1L;
         /**
          * The <tt>CallParticipant</tt> whose state is being adapted for the
          * purposes of depicting as a toggle button.

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -30,6 +30,8 @@ public class ReceivedCallDialog
     implements  ActionListener,
                 CallListener
 {
+    private static final long serialVersionUID = 1L;
+
     private static final String CALL_BUTTON = "CallButton";
 
     private static final String HANGUP_BUTTON = "HangupButton";

File: src/net/java/sip/communicator/impl/gui/main/call/SecurityPanel.java
Patch:
@@ -19,6 +19,8 @@
 public class SecurityPanel
     extends TransparentPanel
 {
+    private static final long serialVersionUID = 1L;
+
     private final CallParticipant participant;
 
     private final Image iconEncr;

File: src/net/java/sip/communicator/impl/gui/main/call/SecurityStatusLabel.java
Patch:
@@ -16,6 +16,8 @@
 public class SecurityStatusLabel
     extends JLabel
 {
+    private static final long serialVersionUID = 1L;
+
     private final CallParticipantPanel callParticipantPanel;
 
     public SecurityStatusLabel( CallParticipantPanel callParticipantPanel,

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallDialog.java
Patch:
@@ -26,6 +26,8 @@
 public class TransferCallDialog
     extends SIPCommDialog
 {
+    private static final long serialVersionUID = 1L;
+
     private final JButton cancelButton;
 
     private final JButton okButton;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -46,6 +46,8 @@ public class ChatPanel
                 Chat,
                 ChatConversationContainer
 {
+    private static final long serialVersionUID = 1L;
+
     private static final Logger logger = Logger.getLogger(ChatPanel.class);
 
     private final JSplitPane messagePane = new JSplitPane(JSplitPane.VERTICAL_SPLIT);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -152,7 +152,7 @@ public void stateChanged(ChangeEvent evt)
 
         this.setKeybindingInput(KeybindingSet.Category.CHAT);
         this.addKeybindingAction(   "plugin.keybindings.CHAT_NEXT_TAB",
-                                    new ForwordTabAction());
+                                    new ForwardTabAction());
         this.addKeybindingAction(   "plugin.keybindings.CHAT_PREVIOUS_TAB",
                                     new BackwordTabAction());
         this.addKeybindingAction(   "plugin.keybindings.CHAT_COPY",
@@ -531,11 +531,11 @@ public void setTabTitle(ChatPanel chatPanel, String title)
     }
 
     /**
-     * The <tt>ForwordTabAction</tt> is an <tt>AbstractAction</tt> that
+     * The <tt>ForwardTabAction</tt> is an <tt>AbstractAction</tt> that
      * changes the currently selected tab with the next one. Each time when the
      * last tab index is reached the first one is selected.
      */
-    private class ForwordTabAction
+    private class ForwardTabAction
         extends AbstractAction
     {
         public void actionPerformed(ActionEvent e)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatSendPanel.java
Patch:
@@ -13,7 +13,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.lookandfeel.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -32,7 +32,7 @@ public class ChatWindowManager
     private final Object syncChat = new Object();
 
     /**
-     * Opens a the specified chatPanel and brings it to the front if so
+     * Opens the specified chatPanel and brings it to the front if so
      * specified.
      *
      * @param chatPanel the chat panel that we will be opening

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GroupRightButtonMenu.java
Patch:
@@ -167,15 +167,14 @@ private void initPluginComponents()
      */
     public void actionPerformed(ActionEvent e) {
         JMenuItem item = (JMenuItem)e.getSource();
-        String itemText = item.getText();
         String itemName = item.getName();
 
         if(itemName.equals("removeGroup"))
         {
             if(group != null)
                 new RemoveGroupThread(group).start();
         }
-        else if(itemName.equals("service.gui.RENAME_GROUP"))
+        else if(itemName.equals("renameGroup"))
         {
 
             RenameGroupDialog dialog = new RenameGroupDialog(

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/FileMenu.java
Patch:
@@ -45,8 +45,8 @@ public class FileMenu extends SIPCommMenu
      * Creates an instance of <tt>FileMenu</tt>.
      * @param parentWindow The parent <tt>ChatWindow</tt>.
      */
-    public FileMenu(ChatWindow parentWindow) {
-
+    public FileMenu(ChatWindow parentWindow)
+    {
         super(GuiActivator.getResources().getI18NString("service.gui.FILE"));
 
         this.setOpaque(false);
@@ -126,7 +126,7 @@ else if (itemText.equals("history"))
                     .addHistoryWindowForContact(chatSession.getDescriptor(), history);
             }
         }
-        else if (itemText.equalsIgnoreCase("service.gui.CLOSE"))
+        else if (itemText.equalsIgnoreCase("close"))
         {
             this.parentWindow.setVisible(false);
             this.parentWindow.dispose();

File: src/net/java/sip/communicator/impl/gui/customcontrols/SCScrollPane.java
Patch:
@@ -32,7 +32,6 @@ public SCScrollPane()
     {
 	    this.setBorder(BorderFactory.createMatteBorder(
             1, 0, 1, 0, Color.GRAY));
-        this.setOpaque(false);
 
         this.setViewport(new SCViewport());
 

File: src/net/java/sip/communicator/impl/gui/customcontrols/SCScrollPane.java
Patch:
@@ -46,7 +46,6 @@ public SCScrollPane()
      */
     public void setViewportView(JComponent view)
     {
-        view.setOpaque(false);
         view.setBorder(BorderFactory.createEmptyBorder(3, 3, 3, 3));
 
         super.setViewportView(view);

File: src/net/java/sip/communicator/impl/gui/main/call/AccountSelectorBox.java
Patch:
@@ -187,7 +187,8 @@ public void setSelected(ProtocolProviderService pps, ImageIcon icon)
      */
     public void setSelected(ProtocolProviderService pps)
     {
-        this.setSelected(pps, new ImageIcon(ImageLoader.getAccountStatusImage(pps)));
+        this.setSelected(pps,
+            new ImageIcon(ImageLoader.getAccountStatusImage(pps)));
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/MainCallPanel.java
Patch:
@@ -65,7 +65,7 @@ public class MainCallPanel
         = new TransparentPanel(new BorderLayout());
 
     private TransparentPanel callViaPanel
-        = new TransparentPanel(new FlowLayout(FlowLayout.RIGHT, 0, 4));
+        = new TransparentPanel(new FlowLayout(FlowLayout.RIGHT, 0, 2));
 
     private AccountSelectorBox accountSelectorBox = new AccountSelectorBox(this);
 

File: src/net/java/sip/communicator/impl/gui/main/presence/AccountStatusPanel.java
Patch:
@@ -42,7 +42,7 @@ public class AccountStatusPanel
 
     private final TexturePaint texture = new TexturePaint(bgImage, rect);
 
-    private JMenuBar statusMenuBar = new JMenuBar();
+    private SIPCommMenuBar statusMenuBar = new SIPCommMenuBar();
 
     private GlobalStatusSelectorBox statusComboBox;
 
@@ -73,11 +73,9 @@ public AccountStatusPanel(MainFrame mainFrame)
             this.setUI(new SIPCommOpaquePanelUI());
 
         this.accountNameLabel.setOpaque(false);
-        this.statusMenuBar.setOpaque(false);
 
         // Align status combo box with account name field.
         statusMenuBar.setLayout(new BorderLayout(0, 0));
-        statusMenuBar.setUI(new SIPCommMenuBarUI());
         statusComboBox.setBorder(BorderFactory.createEmptyBorder(0, 0, 0, 0));
 
         accountNameLabel.setFont(

File: src/net/java/sip/communicator/util/swing/SIPCommMenuBar.java
Patch:
@@ -8,6 +8,7 @@
 
 import javax.swing.*;
 
+import net.java.sip.communicator.util.swing.plaf.*;
 /**
  * The SIPCommMenuBar is a <tt>JMenuBar</tt> without border decoration that can
  * be used as a container for other components, like selector boxes that won't
@@ -20,6 +21,7 @@ public class SIPCommMenuBar
 {
     public SIPCommMenuBar()
     {
-        this.setBorder(null);
+        this.setBorder(BorderFactory.createEmptyBorder());
+        this.setUI(new SIPCommMenuBarUI());
     }
 }

File: src/net/java/sip/communicator/util/swing/plaf/SIPCommMenuBarUI.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.impl.gui.lookandfeel;
+package net.java.sip.communicator.util.swing.plaf;
 
 import javax.swing.*;
 import javax.swing.plaf.*;

File: src/net/java/sip/communicator/impl/gui/customcontrols/ChatToolbarButton.java
Patch:
@@ -28,6 +28,6 @@ public ChatToolbarButton(Image iconImage)
     {
         super(null, iconImage);
 
-        this.setPreferredSize(new Dimension(26, 26));
+        this.setPreferredSize(new Dimension(25, 25));
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/call/AccountSelectorBox.java
Patch:
@@ -16,6 +16,7 @@
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
+import net.java.sip.communicator.util.swing.*;
 
 /**
  * The AccountSelectorBox is located in the main application window under the
@@ -29,7 +30,7 @@
  * @author Yana Stamcheva
  */
 public class AccountSelectorBox
-    extends JMenuBar
+    extends SIPCommMenuBar
     implements ActionListener
 {
     private static final Logger logger =

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContact.java
Patch:
@@ -16,9 +16,9 @@
  */
 public abstract class ChatContact
 {
-    public static final int AVATAR_ICON_HEIGHT = 30;
+    public static final int AVATAR_ICON_HEIGHT = 25;
 
-    public static final int AVATAR_ICON_WIDTH = 30;
+    public static final int AVATAR_ICON_WIDTH = 25;
 
     private boolean isSelected;
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatTransportSelectorBox.java
Patch:
@@ -29,7 +29,7 @@
  * @author Yana Stamcheva
  */
 public class ChatTransportSelectorBox
-    extends JMenuBar
+    extends SIPCommMenuBar
     implements ActionListener
 {
     private static final Logger logger
@@ -128,7 +128,8 @@ public void actionPerformed(ActionEvent e)
     {
         JMenuItem menuItem = (JMenuItem) e.getSource();
 
-        for (Map.Entry<ChatTransport, JMenuItem> transportMenuItem : transportMenuItems.entrySet())
+        for (Map.Entry<ChatTransport, JMenuItem> transportMenuItem
+                : transportMenuItems.entrySet())
         {
             ChatTransport chatTransport = transportMenuItem.getKey();
 

File: src/net/java/sip/communicator/impl/gui/main/chat/SmiliesSelectorBox.java
Patch:
@@ -14,6 +14,7 @@
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.utils.*;
+import net.java.sip.communicator.util.swing.*;
 
 /**
  * The <tt>SmiliesSelectorBox</tt> is the component where user could choose a
@@ -22,7 +23,7 @@
  * @author Yana Stamcheva
  */
 public class SmiliesSelectorBox
-    extends JMenuBar
+    extends SIPCommMenuBar
     implements ActionListener
 {
     private final ChatWritePanel chatWritePanel;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ActionMenuPanel.java
Patch:
@@ -147,10 +147,10 @@ public void paintComponent(Graphics g)
                     height, endBgColor);
 
             g2.setPaint(p);
-            g2.fillRoundRect(0, 0, width - 1, height - 1, 15, 15);
+            g2.fillRect(0, 0, width - 1, height - 1);
 
             g2.setColor(baseStartColor);
-            g2.drawRoundRect(0, 0, width - 1, height - 1, 15, 15);
+            g2.drawRect(0, 0, width - 1, height - 1);
         }
         finally
         {

File: src/net/java/sip/communicator/impl/gui/main/menus/MoreButton.java
Patch:
@@ -18,6 +18,9 @@
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;
 
+/**
+ * @author Yana Stamcheva
+ */
 public class MoreButton
     extends JLabel
     implements  PluginComponent,

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -98,7 +98,7 @@ public GlobalStatusSelectorBox(MainFrame mainFrame)
         this.mainFrame = mainFrame;
 
         this.setUI(new SIPCommStatusMenuUI());
-
+        this.setBorder(null);
         this.setOpaque(false);
 
         this.setText("Offline");

File: src/net/java/sip/communicator/util/swing/SIPCommDialog.java
Patch:
@@ -159,7 +159,7 @@ private void setSizeAndLocation()
         ConfigurationService configService =
             UtilActivator.getConfigurationService();
 
-        String className = this.getClass().getName();
+        String className = this.getClass().getName().replaceAll("\\$", "_");
         
         String widthString = configService.getString(
             className + ".width");

File: src/net/java/sip/communicator/util/swing/SIPCommFrame.java
Patch:
@@ -152,7 +152,7 @@ static void saveSizeAndLocation(Component component)
         throws PropertyVetoException
     {
         ConfigurationService config = UtilActivator.getConfigurationService();
-        String className = component.getClass().getName();
+        String className = component.getClass().getName().replaceAll("\\$", "_");
 
         config.setProperty(className + ".width", component.getWidth());
         config.setProperty(className + ".height", component.getHeight());

File: src/net/java/sip/communicator/impl/history/HistoryImpl.java
Patch:
@@ -38,7 +38,8 @@ public class HistoryImpl implements History {
 
     private HistoryWriter writer;
 
-    private SortedMap historyDocuments = new TreeMap();
+    private SortedMap<String, Object> historyDocuments
+        = new TreeMap<String, Object>();
 
     protected HistoryImpl(HistoryID id, File directory,
             HistoryRecordStructure historyRecordStructure,
@@ -194,7 +195,7 @@ protected void writeFile(String filename, Document doc)
         }
     }
 
-    protected Iterator getFileList()
+    protected Iterator<String> getFileList()
     {
         return this.historyDocuments.keySet().iterator();
     }

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -399,8 +399,9 @@ public void addProtocolSupportedOperationSets(
      */
     public Iterator<ProtocolProviderService> getProtocolProviders()
     {
-        return ((Map<ProtocolProviderService, Integer>)
-            protocolProviders.clone()).keySet().iterator();
+        return new LinkedList<ProtocolProviderService>(
+                        protocolProviders.keySet())
+                        .iterator();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/account/EmptyAccountRegistrationWizard.java
Patch:
@@ -132,7 +132,7 @@ public String getProtocolName()
      */
     public Object getSimpleForm()
     {
-        return page;
+        return page.getSimpleForm();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegSummaryPage.java
Patch:
@@ -72,11 +72,11 @@ public AccountRegSummaryPage(AccountRegWizardContainerImpl wizardContainer)
      *
      * @param summaryData The data to insert in the summary page.
      */
-    private void init(Iterator<Map.Entry> summaryData)
+    private void init(Iterator<Map.Entry<String, String>> summaryData)
     {
         while (summaryData.hasNext())
         {
-            Map.Entry entry = summaryData.next();
+            Map.Entry<String, String> entry = summaryData.next();
 
             JLabel keyLabel = new JLabel(entry.getKey().toString() + ":");
             JLabel valueLabel = new JLabel(entry.getValue().toString());

File: src/net/java/sip/communicator/plugin/ircaccregwizz/IrcAccountRegistrationWizard.java
Patch:
@@ -117,9 +117,9 @@ public Iterator<WizardPage> getPages()
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator<Map.Entry> getSummary()
+    public Iterator<Map.Entry<String,String>> getSummary()
     {
-        Hashtable summaryTable = new Hashtable();
+        Hashtable<String,String> summaryTable = new Hashtable<String,String>();
         String pass = new String();
         String port = new String();
 

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -116,17 +116,17 @@ public Iterator<WizardPage> getPages()
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator<Map.Entry> getSummary()
+    public Iterator<Map.Entry<String,String>> getSummary()
     {
-        Hashtable summaryTable = new Hashtable();
+        Hashtable<String,String> summaryTable = new Hashtable<String,String>();
 
         summaryTable.put(
             Resources.getString("plugin.jabberaccregwizz.USERNAME"),
             registration.getUserID());
 
         summaryTable.put(
             Resources.getString("service.gui.REMEMBER_PASSWORD"),
-            new Boolean(registration.isRememberPassword()));
+            Boolean.toString(registration.isRememberPassword()));
 
         summaryTable.put(
             Resources.getString("plugin.jabberaccregwizz.SERVER"),

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -108,7 +108,8 @@ public Iterator<WizardPage> getPages() {
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator<Map.Entry> getSummary() {
+    public Iterator<Map.Entry<String, String>> getSummary() 
+    {
         Map<String, String> summaryTable = new Hashtable<String, String>();
         boolean rememberPswd = registration.isRememberPassword();
         String rememberPswdString = Resources.getString(
@@ -189,7 +190,7 @@ public Iterator<Map.Entry> getSummary() {
             Resources.getString("plugin.sipaccregwizz.KEEP_ALIVE_INTERVAL"),
             registration.getKeepAliveInterval());
 
-        return ((Map) summaryTable).entrySet().iterator();
+        return summaryTable.entrySet().iterator();
     }
 
     /**

File: src/net/java/sip/communicator/plugin/sshaccregwizz/SSHAccountRegistrationWizard.java
Patch:
@@ -123,8 +123,8 @@ public Iterator<WizardPage> getPages() {
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator<Map.Entry> getSummary() {
-        Hashtable summaryTable = new Hashtable();
+    public Iterator<Map.Entry<String, String>> getSummary() {
+        Hashtable<String, String> summaryTable = new Hashtable<String, String>();
         
         /*
          * Hashtable arranges the entries alphabetically so the order 

File: src/net/java/sip/communicator/plugin/zeroconfaccregwizz/ZeroconfAccountRegistrationWizard.java
Patch:
@@ -119,9 +119,9 @@ public Iterator<WizardPage> getPages()
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator<Map.Entry> getSummary()
+    public Iterator<Map.Entry<String, String>> getSummary()
     {
-        Hashtable summaryTable = new Hashtable();
+        Hashtable<String, String> summaryTable = new Hashtable<String, String>();
 
         summaryTable.put("User ID", registration.getUserID());
         summaryTable.put("First Name", registration.getFirst());

File: src/net/java/sip/communicator/service/gui/AccountRegistrationWizard.java
Patch:
@@ -113,7 +113,7 @@ public interface AccountRegistrationWizard
      * @return a set of key-value pairs that will represent the summary for
      * this wizard. 
      */
-    public Iterator<Map.Entry> getSummary();
+    public Iterator<Map.Entry<String, String>> getSummary();
 
     /**
      * Defines the operations that will be executed when the user clicks on

File: src/net/java/sip/communicator/plugin/keybindingchooser/KeybindingChooserActivator.java
Patch:
@@ -45,7 +45,9 @@ public void start(BundleContext context)
                     "net.java.sip.communicator.plugin.keybindingchooser.KeybindingsConfigPanel",
                     getClass().getClassLoader(),
                     "plugin.keybinding.PLUGIN_ICON",
-                    "plugin.keybindings.PLUGIN_NAME"), null);
+                    "plugin.keybindings.PLUGIN_NAME",
+                    900),
+                null);
     }
 
     /**

File: src/net/java/sip/communicator/plugin/notificationconfiguration/NotificationConfigurationActivator.java
Patch:
@@ -42,7 +42,9 @@ public void start(BundleContext bc) throws Exception
                     "net.java.sip.communicator.plugin.notificationconfiguration.NotificationConfigurationPanel",
                     getClass().getClassLoader(),
                     "plugin.notificationconfig.PLUGIN_ICON",
-                    "service.gui.NOTIFICATIONS"), null);
+                    "service.gui.NOTIFICATIONS",
+                    30),
+                null);
 
         logger.trace("Notification Configuration: [ STARTED ]");
     }

File: src/net/java/sip/communicator/plugin/pluginmanager/PluginManagerActivator.java
Patch:
@@ -40,7 +40,9 @@ public void start(BundleContext bc) throws Exception
                     "net.java.sip.communicator.plugin.pluginmanager.PluginManagerPanel",
                     getClass().getClassLoader(),
                     "plugin.pluginmanager.PLUGIN_ICON",
-                    "plugin.pluginmanager.PLUGINS"), null);
+                    "plugin.pluginmanager.PLUGINS",
+                    1000),
+                null);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomProviderWrapper.java
Patch:
@@ -152,10 +152,11 @@ public boolean containsChatRoom(ChatRoomWrapper chatRoom)
      */
     public ChatRoomWrapper findChatRoomWrapperForChatRoom(ChatRoom chatRoom)
     {
+        // compare ids, cause saved chatrooms don't have ChatRoom object
+        // but Id's are the same
         for (ChatRoomWrapper chatRoomWrapper : chatRoomsOrderedCopy)
         {
-            if (chatRoomWrapper.getChatRoom() != null
-                && chatRoomWrapper.getChatRoom().equals(chatRoom))
+            if (chatRoomWrapper.getChatRoomID().equals(chatRoom.getIdentifier()))
             {
                 return chatRoomWrapper;
             }

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -691,7 +691,7 @@ public void leaveChatRoom(ChatRoomWrapper chatRoomWrapper)
                 GuiActivator.getUIService().getMainFrame(),
                 GuiActivator.getResources().getI18NString("service.gui.WARNING"),
                 GuiActivator.getResources().getI18NString(
-                    "service.gui.CHAT_ROOM_LEAVE_NOT_CONNECTED="))
+                    "service.gui.CHAT_ROOM_LEAVE_NOT_CONNECTED"))
                     .showDialog();
 
             return;

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -543,7 +543,8 @@ public void removeGroup(ContactGroupJabberImpl groupToRemove)
             while (iter.hasNext())
             {
                 ContactJabberImpl item = (ContactJabberImpl) iter.next();
-                roster.removeEntry(item.getSourceEntry());
+                if(item.isPersistent())
+                    roster.removeEntry(item.getSourceEntry());
             }
         }
         catch (XMPPException ex)

File: src/net/java/sip/communicator/impl/protocol/dict/ContactDictImpl.java
Patch:
@@ -25,7 +25,7 @@ public class ContactDictImpl
      * Icon
      */
     private static byte[] icon = DictActivator.getResources()
-        .getImageInBytes("pageImageDict");
+        .getImageInBytes("service.protocol.dict.PROTOCOL_LARGE_ICON");
     
     /**
      * The id of the contact.

File: src/net/java/sip/communicator/impl/protocol/dict/ProtocolProviderFactoryDictImpl.java
Patch:
@@ -160,7 +160,7 @@ private void createDefaultContact(AccountID accountID)
         
         // Gets contact name
         String contactName = DictActivator.getResources()
-            .getI18NString("dict.plugin.dictaccregwizz.ANY_DICTIONARY_FORM",
+            .getI18NString("plugin.dictaccregwizz.ANY_DICTIONARY_FORM",
                 new String[] {accountID.getUserID()});
         
         // Gets the MetaContactGroup for the "dictionaries" group.

File: src/net/java/sip/communicator/plugin/msnaccregwizz/MsnAccountRegistration.java
Patch:
@@ -75,7 +75,7 @@ public String getId()
      * 
      * @param id the identifier of the MSN registration account.
      */
-    public void setId(String id)
+    public void setUserID(String id)
     {
         this.id = id;
     }

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistration.java
Patch:
@@ -163,7 +163,7 @@ public String getProxyPort()
      *
      * @param uin the identifier of the sip registration account.
      */
-    public void setId(String id)
+    public void setUserID(String id)
     {
         this.id = id;
     }

File: src/net/java/sip/communicator/plugin/sshaccregwizz/SSHAccountRegistration.java
Patch:
@@ -49,7 +49,7 @@ public String getAccountID()
      * 
      * @param accountID the accountID of the ssh registration account.
      */
-    public void setAccountID(String accountID)
+    public void setUserID(String accountID)
     {
         this.accountID = accountID;
     }

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/YahooAccountRegistration.java
Patch:
@@ -65,7 +65,7 @@ public String getUin() {
      * Sets the UIN of the yahoo registration account.
      * @param uin the UIN of the yahoo registration account.
      */
-    public void setUin(String uin) {
+    public void setUserID(String uin) {
         this.uin = uin;
     }
 

File: src/net/java/sip/communicator/impl/protocol/rss/RssActivator.java
Patch:
@@ -8,14 +8,14 @@
 
 import org.osgi.framework.*;
 
-import net.java.sip.communicator.util.*;
 import java.util.*;
 
 import javax.net.ssl.*;
 
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.resources.*;
+import net.java.sip.communicator.util.*;
 
 /**
  * Loads the Rss provider factory and registers its services in the OSGI

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatContactCellRenderer.java
Patch:
@@ -34,7 +34,7 @@ public Component getListCellRendererComponent(  JList list,
 
         this.photoLabel.setIcon(null);
 
-        ContactList contactList = (ContactList) list;
+        DefaultContactList contactList = (DefaultContactList) list;
 
         ChatContact chatContact = (ChatContact) value;
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListCellRenderer.java
Patch:
@@ -95,7 +95,7 @@ public ContactListCellRenderer()
 
     /**
      * Implements the <tt>ListCellRenderer</tt> method.
-     * 
+     *
      * Returns this panel that has been configured to display the meta contact
      * and meta contact group cells.
      */
@@ -106,7 +106,7 @@ public Component getListCellRendererComponent(JList list, Object value,
 
         this.photoLabel.setIcon(null);
 
-        ContactList contactList = (ContactList) list;
+        DefaultContactList contactList = (DefaultContactList) list;
 
         if (value instanceof MetaContact)
         {
@@ -185,7 +185,7 @@ else if (value instanceof MetaContactGroup)
             // make getComponentAt work properly.
             this.setBounds(0, 0, list.getWidth() - 2, 20);
 
-            if(((ContactListModel)list.getModel()).isGroupClosed(groupItem))
+            if(contactList.isGroupClosed(groupItem))
                 this.nameLabel.setIcon(closedGroupIcon);
             else
                 this.nameLabel.setIcon(openedGroupIcon);

File: src/net/java/sip/communicator/impl/gui/main/login/AuthenticationWindow.java
Patch:
@@ -173,8 +173,9 @@ private void init()
         else
             this.uinValue = new JTextField(userCredentials.getUserName());
 
-        if(userCredentials.getPassword() != null) {
-            this.passwdField.setText(userCredentials.getPassword().toString());
+        char[] password = userCredentials.getPassword();
+        if (password != null) {
+            this.passwdField.setText(String.valueOf(password));
         }
 
         this.realmTextArea.setEditable(false);

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommDefaultTheme.java
Patch:
@@ -333,7 +333,6 @@ public SIPCommDefaultTheme()
 
     public void addCustomEntriesToTable(UIDefaults table)
     {
-
         List buttonGradient
             = Arrays.asList(new Object[]
                { new Float(.3f), new Float(0f), BUTTON_GRADIENT_DARK_COLOR,
@@ -400,9 +399,9 @@ public void addCustomEntriesToTable(UIDefaults table)
 
                 "SplitPane.oneTouchButtonsOpaque", Boolean.FALSE,
                 "SplitPane.dividerFocusColor", SPLIT_PANE_DEVIDER_FOCUS_COLOR,
-                "SplitPane.dividerSize", new Integer(5),
+                "SplitPane.dividerSize", Integer.valueOf(5),
 
-                "ScrollBar.width", new Integer(12),
+                "ScrollBar.width", Integer.valueOf(12),
                 "ScrollBar.horizontalThumbIcon",
                 ImageLoader.getImage(ImageLoader.SCROLLBAR_THUMB_HORIZONTAL),
                 "ScrollBar.verticalThumbIcon",

File: src/net/java/sip/communicator/impl/gui/main/contactlist/CListKeySearchListener.java
Patch:
@@ -64,7 +64,7 @@ public void keyReleased(KeyEvent e) {
      * Searches the contact list when any key, different from "space", "+" or
      * "-" is typed. Selects the Contact name closest to the typed string. The
      * time between two button presses is checked to determine whether the user
-     * makes a new search or a continious search. When user types the same
+     * makes a new search or a continuous search. When user types the same
      * letter consecutively the search mechanism selects the next Contact name
      * starting with the same letter.
      */

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -983,7 +983,7 @@ public Image createContactStatusImage(Contact protoContact)
             g.setFont(Constants.FONT.deriveFont(Font.BOLD, 9));
             g.drawImage(statusImage, 0, 0, null);
             g.setComposite(ac);
-            g.drawString(new Integer(index+1).toString(), 14, 8);
+            g.drawString(Integer.toString(index+1), 14, 8);
 
             img = buffImage;
         }

File: src/net/java/sip/communicator/impl/media/MediaServiceImpl.java
Patch:
@@ -343,7 +343,7 @@ public MediaControl getMediaControl()
      * <tt>call</tt> is not mapped to a particular <tt>MediaControl</tt>
      * instance, the default instance will be returned
      *
-     * @param call the call whose MediaControl we will fetch
+     * @param call the call to fetch the MediaControl of
      * @return the instance of MediaControl that is mapped to <tt>call</tt>
      * or the <tt>defaultMediaControl</tt> if no custom one is registered for
      * <tt>call</tt>.

File: src/net/java/sip/communicator/impl/media/transform/TransformOutputStream.java
Patch:
@@ -70,7 +70,7 @@ public TransformOutputStream(DatagramSocket socket,
     public void addTarget(InetAddress remoteAddr, int remotePort)
     {
         this.remoteAddrs.add(remoteAddr);
-        this.remotePorts.add(new Integer(remotePort));
+        this.remotePorts.add(remotePort);
     }
 
     /**
@@ -84,7 +84,7 @@ public void addTarget(InetAddress remoteAddr, int remotePort)
     public boolean removeTarget(InetAddress remoteAddr, int remotePort)
     {
         return remoteAddrs.remove(remoteAddr)
-            && remotePorts.remove(new Integer(remotePort));
+            && remotePorts.remove(Integer.valueOf(remotePort));
     }
 
     /**

File: src/net/java/sip/communicator/impl/notification/NotificationServiceImpl.java
Patch:
@@ -530,7 +530,7 @@ private void saveNotification(  String eventType,
             
             configService.setProperty(
                 actionTypeNodeName + ".loopInterval",
-                new Integer(soundHandler.getLoopInterval()));
+                soundHandler.getLoopInterval());
             
             configService.setProperty(
                 actionTypeNodeName + ".enabled",
@@ -632,7 +632,7 @@ private void loadNotifications()
 
                     handler = new SoundNotificationHandlerImpl(
                         soundFileDescriptor,
-                        new Integer(loopInterval).intValue());
+                        Integer.parseInt(loopInterval));
                     
                     handler.setEnabled(
                         isEnabled(actionPropName + ".enabled"));

File: src/net/java/sip/communicator/impl/protocol/icq/InfoRetreiver.java
Patch:
@@ -303,7 +303,7 @@ public String getNickName(String uin)
      */
     private List getInfoForRequest(int requestID)
     {
-        List res = (List) retreivedInfo.get(new Integer(requestID));
+        List res = (List) retreivedInfo.get(requestID);
 
         if (res == null)
         {
@@ -312,7 +312,7 @@ private List getInfoForRequest(int requestID)
             // from the sequence (basic info)
 
             res = new LinkedList();
-            retreivedInfo.put(new Integer(requestID), res);
+            retreivedInfo.put(requestID, res);
         }
 
         return res;

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetBasicInstantMessagingIcqImpl.java
Patch:
@@ -629,8 +629,7 @@ public void run()
                 // check till we find a correct message
                 // or if NoSuchElementException is thrown
                 // there is no message
-                while(!checkFirstPacket())
-                {}
+                while(!checkFirstPacket());
             }
             catch (Exception ex)
             {

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -453,7 +453,7 @@ else if (on)
      *            specified call participant with the sent invite
      * @throws OperationFailedException
      */
-    private void sendInviteRequest(CallParticipantSipImpl sipParticipant,
+    void sendInviteRequest(CallParticipantSipImpl sipParticipant,
         String sdpOffer) throws OperationFailedException
     {
         Dialog dialog = sipParticipant.getDialog();

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHContactInfo.java
Patch:
@@ -109,7 +109,7 @@ public SSHContactInfo(ContactSSH sshContact) {
      * initialize the form.
      */
     public void initForm() {
-        updateTimer.setValue(new Integer(30));
+        updateTimer.setValue(30);
         MaskFormatter maskFormatter = new MaskFormatter();
         try {
             maskFormatter.setMask("#####");
@@ -118,7 +118,7 @@ public void initForm() {
         }
         maskFormatter.setAllowsInvalid(false);
         portField = new JFormattedTextField(maskFormatter);
-        portField.setValue(new Integer(22));
+        portField.setValue(22);
         
         userNameField.setEnabled(false);
         passwordField.setEditable(false);
@@ -314,7 +314,7 @@ public void setTerminalType(String termType) {
      *
      * @param interval to be associated
      */
-    public void setUpdateInterval(Integer interval) {
+    public void setUpdateInterval(int interval) {
         this.updateTimer.setValue(interval);
     }
     

File: src/net/java/sip/communicator/impl/protocol/zeroconf/jmdns/DNSOutgoing.java
Patch:
@@ -261,7 +261,7 @@ void writeName(String name) throws IOException
                 writeByte(val);
                 return;
             }
-            names.put(name, new Integer(off));
+            names.put(name, off);
             writeUTF(name, 0, n);
             name = name.substring(n);
             if (name.startsWith("."))

File: src/net/java/sip/communicator/plugin/accountinfo/AccountDetailsPanel.java
Patch:
@@ -359,7 +359,7 @@ private void loadSummaryDetails()
             if (c.get(Calendar.MONTH) < calendarDetail.get(Calendar.MONTH))
                 age--;
 
-            ageDetail = new Integer(age).toString().trim();
+            ageDetail = Integer.toString(age).trim();
         }
 
         birthdayField.setText(birthDateDetailString);

File: src/net/java/sip/communicator/plugin/contactinfo/ContactInfoDetailsPanel.java
Patch:
@@ -339,7 +339,7 @@ private JPanel createSummaryInfoPanel()
             if (c.get(Calendar.MONTH) < calendarDetail.get(Calendar.MONTH))
                 age--;
 
-            ageDetail = new Integer(age).toString().trim();
+            ageDetail = Integer.toString(age).trim();
         }
 
         if (birthDateDetail.equals(""))

File: src/net/java/sip/communicator/service/protocol/CallParticipantState.java
Patch:
@@ -80,7 +80,7 @@ public class CallParticipantState
 
     /**
      * This constant value indicates that the state of the call participant is
-     * is CONNECTING - which means that a network connection to that participant
+     * CONNECTING - which means that a network connection to that participant
      * is currently being established.
      */
     public static final CallParticipantState CONNECTING =
@@ -95,7 +95,7 @@ public class CallParticipantState
 
     /**
      * This constant value indicates that the state of the call participant is
-     * is CONNECTING - which means that a network connection to that participant
+     * CONNECTING - which means that a network connection to that participant
      * is currently being established.
      */
     public static final CallParticipantState CONNECTING_WITH_EARLY_MEDIA =

File: src/net/java/sip/communicator/util/swing/plaf/SIPCommTabbedPaneEnhancedUI.java
Patch:
@@ -36,8 +36,8 @@ public class SIPCommTabbedPaneEnhancedUI
     private static final Color whiteColor = Color.white;
 
     private static final int TAB_OVERLAP
-        = new Integer(UtilActivator.getResources().
-            getSettingsString("impl.gui.TAB_OVERLAP")).intValue();
+        = Integer.parseInt(UtilActivator.getResources().
+            getSettingsString("impl.gui.TAB_OVERLAP"));
 
     private static final int PREFERRED_WIDTH = 150;
 

File: src/net/java/sip/communicator/util/xml/XMLUtils.java
Patch:
@@ -254,7 +254,7 @@ public static void writeXML(Document document,
            // not working for jdk 1.4
            try
            {
-                tf.setAttribute("indent-number", new Integer(4));
+                tf.setAttribute("indent-number", 4);
            }catch(Exception e){}
            
            Transformer serializer = tf.newTransformer();

File: src/net/java/sip/communicator/impl/browserlauncher/BrowserLauncherImpl.java
Patch:
@@ -31,9 +31,9 @@ public void openURL(String url)
     /**
      * Launch browser in a separate thread.
      */
-    private class LaunchBrowser extends Thread
+    private static class LaunchBrowser extends Thread
     {
-        private String url;
+        private final String url;
         
         public LaunchBrowser(String url)
         {

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryServiceImpl.java
Patch:
@@ -1057,7 +1057,7 @@ void clear()
      * Used to compare CallRecords and to be ordered in TreeSet according their
      * timestamp
      */
-    private class CallRecordComparator
+    private static class CallRecordComparator
         implements Comparator<CallRecord>
     {
         public int compare(CallRecord o1, CallRecord o2)

File: src/net/java/sip/communicator/impl/configuration/ConfigurationServiceImpl.java
Patch:
@@ -1104,9 +1104,9 @@ public int getInt(String propertyName, int defaultValue)
      * PropertyReference instance that will retrive it from the system
      * properties when necessary.
      */
-    private class PropertyReference
+    private static class PropertyReference
     {
-        private String propertyName = null;
+        private final String propertyName;
 
         PropertyReference(String propertyName)
         {

File: src/net/java/sip/communicator/impl/gui/GuiActivator.java
Patch:
@@ -401,7 +401,7 @@ public static NotificationService getNotificationService()
      * passed event concerns a <tt>NotificationService</tt> and if so
      * intiates the gui NotificationManager.
      */
-    private class NotificationServiceListener implements ServiceListener
+    private static class NotificationServiceListener implements ServiceListener
     {
         /**
          * Implements the <tt>ServiceListener</tt> method. Verifies whether the

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommCallComboBoxUI.java
Patch:
@@ -33,11 +33,11 @@ protected ComboPopup createPopup()
         return popup;
     }
     
-    private class SIPCommComboPopup extends BasicComboPopup
+    private static class SIPCommComboPopup extends BasicComboPopup
     {
         private static final long serialVersionUID = 0L;
 
-		public SIPCommComboPopup(JComboBox combo)
+        public SIPCommComboPopup(JComboBox combo)
         {
             super(combo);
         }

File: src/net/java/sip/communicator/impl/gui/main/account/AccountsConfigurationPanel.java
Patch:
@@ -206,7 +206,7 @@ public void providerStatusChanged(ProviderPresenceStatusChangeEvent evt)
 
     public void providerStatusMessageChanged(PropertyChangeEvent evt) {}
 
-    private class AccountPanel
+    private static class AccountPanel
         extends TransparentPanel
         implements ActionListener
     {

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -851,10 +851,10 @@ public void removeChatChangeListener(ChatChangeListener listener)
      * The logo bar is positioned on the top of the window and is meant to
      * contain the application logo.
      */
-    private class LogoBar
+    private static class LogoBar
         extends JPanel
     {
-        private TexturePaint texture;
+        private final TexturePaint texture;
 
         /**
          * Creates the logo bar and specify the size.

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/Wizard.java
Patch:
@@ -248,7 +248,10 @@ public void setCurrentPage(Object id)
         // the dialog.
 
         if (id == null)
+        {
             close(Wizard.ERROR_RETURN_CODE);
+            return;
+        }
 
         WizardPage oldPanelDescriptor = wizardModel.getCurrentWizardPage();
         if (oldPanelDescriptor != null)

File: src/net/java/sip/communicator/impl/configuration/ConfigurationActivator.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.configuration;
 
-import java.util.*;
-
 import org.osgi.framework.*;
 
 import net.java.sip.communicator.service.configuration.*;
@@ -43,7 +41,7 @@ public void start(BundleContext bundleContext) throws Exception
 
         bundleContext.registerService(ConfigurationService.class.getName(),
                                       impl,
-                                      new Hashtable());
+                                      null);
 
         logger.debug("Service Impl: " + getClass().getName() + " [REGISTERED]");
     }

File: src/net/java/sip/communicator/plugin/ircaccregwizz/FirstWizardPage.java
Patch:
@@ -318,7 +318,7 @@ private void setNextButtonAccordingToUserID()
                 || serverField.getText() == null
                 || serverField.getText().equals("")
                 || (!passwordNotRequired.isSelected()
-                        && passField.equals("")))
+                        && passField.getText().equals("")))
         {
             wizard.getWizardContainer().setNextFinishButtonEnabled(false);
         }

File: src/net/java/sip/communicator/util/Html2Text.java
Patch:
@@ -36,6 +36,9 @@ public class Html2Text
      */
     public static synchronized String extractText(String html)
     {
+        if(html == null)
+            return null;
+
         if (parser == null)
             parser = new HTMLParserCallBack();
 

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1492,7 +1492,7 @@ public Address getOurSipAddress(SipURI intendedDestination)
     {
         SipRegistrarConnection src = getRegistrarConnection();
 
-        if( src != null & !src.isRegistrarless() )
+        if( src != null && !src.isRegistrarless() )
             return src.getAddressOfRecord();
 
         //we are apparently running in "No Registrar" mode so let's create an

File: src/net/java/sip/communicator/plugin/contactinfo/ContactInfoDetailsPanel.java
Patch:
@@ -47,12 +47,12 @@ public class ContactInfoDetailsPanel
     /**
      * The default width of hte avater area.
      */
-    private final int AVATAR_AREA_WIDTH = 105;
+    private static final int AVATAR_AREA_WIDTH = 105;
 
     /**
      * The default height of hte avater area.
      */
-    private final int AVATAR_AREA_HEIGHT = 130;
+    private static final int AVATAR_AREA_HEIGHT = 130;
 
     /**
      * Construct a tabbed pane that will have one tab with a summary of info for
@@ -531,4 +531,4 @@ public void hyperlinkUpdate(HyperlinkEvent e)
 
         return mainExtendedPanel;
     }
-}
\ No newline at end of file
+}

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -180,6 +180,9 @@ public void propertyChange(PropertyChangeEvent evt)
     private void initCaptureDevices()
         throws MediaException
     {
+        if (avDataSource != null)
+            avDataSource.disconnect();
+
         // Init Capture devices
         DataSource audioDataSource = null;
         DataSource videoDataSource = null;

File: src/net/java/sip/communicator/impl/media/device/DirectSoundAuto.java
Patch:
@@ -45,7 +45,7 @@ public DirectSoundAuto() {
         boolean supported = false;
         // instance JavaSoundDetector to check is javasound's capture is availabe
         try {
-            Class cls = Class.forName(detectClass);
+            Class.forName(detectClass);
             supported = true;
         } catch (Throwable t) {
             supported = false;

File: src/net/java/sip/communicator/impl/media/device/JMFInit.java
Patch:
@@ -137,9 +137,9 @@ private void detectCaptureDevices() {
             }
         }
         try {
-            Object instance = auto.newInstance();
+            auto.newInstance();
             if (autoPlus != null) {
-                Object instancePlus = autoPlus.newInstance();
+                autoPlus.newInstance();
             }
             logger.info("Finished detecting video capture devices");
         }
@@ -250,7 +250,7 @@ public static void setupJMF()
 //            runLinuxPreInstall();
 
             if (jmfProperties.length() == 0) {
-                JMFInit init = new JMFInit();
+                new JMFInit();
             }
         }
         finally

File: src/net/java/sip/communicator/impl/media/device/SunVideoAuto.java
Patch:
@@ -100,7 +100,6 @@ private void doDevice(int index)
     {
 
         xilCap = new XILCapture(null);
-        VideoFormat vf;
         formats = new Vector();
         //boolean gotPort = false;
 

File: src/net/java/sip/communicator/impl/notification/EventNotification.java
Patch:
@@ -20,7 +20,7 @@ public class EventNotification
     /**
      * The event type as declared by the bundle registering it.
      */
-    private String eventType;
+    private final String eventType;
  
     /**
      * Indicates if this event notification is currently active. By default all
@@ -32,7 +32,7 @@ public class EventNotification
      * Contains all actions which will be executed when this event notification
      * is fired.
      */
-    private Hashtable actionsTable = new Hashtable();
+    private final Hashtable actionsTable = new Hashtable();
     
     /**
      * Creates an instance of <tt>EventNotification</tt> by specifying the

File: src/net/java/sip/communicator/impl/protocol/dict/DictStatusEnum.java
Patch:
@@ -43,7 +43,7 @@ public class DictStatusEnum
     /**
      * Initialize the list of supported status states.
      */
-    private static List supportedStatusSet = new LinkedList();
+    private static List<PresenceStatus> supportedStatusSet = new LinkedList<PresenceStatus>();
     static
     {
         supportedStatusSet.add(OFFLINE);
@@ -70,7 +70,7 @@ private DictStatusEnum(int status,
      * @return an <tt>Iterator</tt> over all status instances supported by the
      * rss provider.
      */
-    static Iterator supportedStatusSet()
+    static Iterator<PresenceStatus> supportedStatusSet()
     {
         return supportedStatusSet.iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/dict/OperationSetPersistentPresenceDictImpl.java
Patch:
@@ -356,7 +356,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return DictStatusEnum.supportedStatusSet();
     }

File: src/net/java/sip/communicator/impl/protocol/gibberish/GibberishActivator.java
Patch:
@@ -58,7 +58,7 @@ public class GibberishActivator
     public void start(BundleContext context)
         throws Exception
     {
-        this.bundleContext = context;
+        GibberishActivator.bundleContext = context;
 
         Hashtable hashtable = new Hashtable();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, "Gibberish");
@@ -110,7 +110,7 @@ public static BundleContext getBundleContext()
     public void stop(BundleContext context)
         throws Exception
     {
-        this.gibberishProviderFactory.stop();
+        gibberishProviderFactory.stop();
         gibberishPpFactoryServReg.unregister();
         logger.info("Gibberish protocol implementation [STOPPED].");
     }

File: src/net/java/sip/communicator/impl/protocol/gibberish/GibberishStatusEnum.java
Patch:
@@ -109,7 +109,7 @@ public class GibberishStatusEnum
     /**
      * Initialize the list of supported status states.
      */
-    private static List supportedStatusSet = new LinkedList();
+    private static List<PresenceStatus> supportedStatusSet = new LinkedList<PresenceStatus>();
     static
     {
         supportedStatusSet.add(OFFLINE);
@@ -142,7 +142,7 @@ private GibberishStatusEnum(int status,
      * @return an <tt>Iterator</tt> over all status instances supported by the
      * gibberish provider.
      */
-    static Iterator supportedStatusSet()
+    static Iterator<PresenceStatus> supportedStatusSet()
     {
         return supportedStatusSet.iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/gibberish/OperationSetPersistentPresenceGibberishImpl.java
Patch:
@@ -354,7 +354,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return GibberishStatusEnum.supportedStatusSet();
     }

File: src/net/java/sip/communicator/impl/protocol/icq/ChatRoomIcqImpl.java
Patch:
@@ -20,7 +20,6 @@
  * 
  * @author Rupert Burchardi
  */
-
 @SuppressWarnings("unchecked")
 public class ChatRoomIcqImpl implements ChatRoom
 {

File: src/net/java/sip/communicator/impl/protocol/icq/IcqActivator.java
Patch:
@@ -39,7 +39,8 @@ public class IcqActivator
      */
     public void start(BundleContext context) throws Exception
     {
-        this.bundleContext = context;
+        IcqActivator.bundleContext = context;
+
         Hashtable icqHashtable = new Hashtable();
         icqHashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.ICQ);
         

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetPersistentPresenceIcqImpl.java
Patch:
@@ -137,7 +137,7 @@ public class OperationSetPersistentPresenceIcqImpl
      * The array list we use when returning from the getSupportedStatusSet()
      * method.
      */
-    private ArrayList supportedPresenceStatusSet = new ArrayList();
+    private final List<PresenceStatus> supportedPresenceStatusSet = new ArrayList<PresenceStatus>();
 
     /**
      * A map containing bindings between SIP Communicator's icq presence status
@@ -887,7 +887,7 @@ public PresenceStatus getPresenceStatus()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         if(supportedPresenceStatusSet.size() == 0)
         {
@@ -959,7 +959,6 @@ public void handleResponse(SnacResponseEvent e) {
                     ran = true;
                 }
 
-                Object value = null;
                 if (snac instanceof UserInfoCmd)
                 {
                     UserInfoCmd uic = (UserInfoCmd) snac;

File: src/net/java/sip/communicator/impl/protocol/jabber/JabberActivator.java
Patch:
@@ -60,7 +60,8 @@ public class JabberActivator
      */
     public void start(BundleContext context) throws Exception
     {
-        this.bundleContext = context;
+        JabberActivator.bundleContext = context;
+
         Hashtable hashtable = new Hashtable();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.JABBER);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -320,7 +320,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return parentProvider.getJabberStatusEnum().getSupportedStatusSet();
     }

File: src/net/java/sip/communicator/impl/protocol/mock/MockPersistentPresenceOperationSet.java
Patch:
@@ -326,7 +326,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return MockStatusEnum.supportedStatusSet();
     }

File: src/net/java/sip/communicator/impl/protocol/mock/MockStatusEnum.java
Patch:
@@ -87,7 +87,7 @@ public class MockStatusEnum
         = new MockStatusEnum(100, "MockStatus100");
 
 
-    private static List supportedStatusSet = new LinkedList();
+    private static List<PresenceStatus> supportedStatusSet = new LinkedList<PresenceStatus>();
     static{
         supportedStatusSet.add(MOCK_STATUS_00);
         supportedStatusSet.add(MOCK_STATUS_10);
@@ -119,7 +119,7 @@ private MockStatusEnum(int status, String statusName)
      * @return an <tt>Iterator</tt> over all status instances supported by the
      * mock provider.
      */
-    static Iterator supportedStatusSet()
+    static Iterator<PresenceStatus> supportedStatusSet()
     {
         return supportedStatusSet.iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/msn/MsnActivator.java
Patch:
@@ -42,7 +42,8 @@ public class MsnActivator
      */
     public void start(BundleContext context) throws Exception
     {
-        this.bundleContext = context;
+        MsnActivator.bundleContext = context;
+
         Hashtable hashtable = new Hashtable();
         hashtable.put(ProtocolProviderFactory.PROTOCOL, ProtocolNames.MSN);
 

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetPersistentPresenceMsnImpl.java
Patch:
@@ -67,7 +67,7 @@ public class OperationSetPersistentPresenceMsnImpl
      * The array list we use when returning from the getSupportedStatusSet()
      * method.
      */
-    private static final ArrayList supportedPresenceStatusSet = new ArrayList();
+    private static final List<PresenceStatus> supportedPresenceStatusSet = new ArrayList<PresenceStatus>();
     static{
         supportedPresenceStatusSet.add(MsnStatusEnum.AWAY);
         supportedPresenceStatusSet.add(MsnStatusEnum.BE_RIGHT_BACK);
@@ -341,7 +341,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return supportedPresenceStatusSet.iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/rss/OperationSetPersistentPresenceRssImpl.java
Patch:
@@ -365,7 +365,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return RssStatusEnum.supportedStatusSet();
     }

File: src/net/java/sip/communicator/impl/protocol/rss/RssStatusEnum.java
Patch:
@@ -46,7 +46,7 @@ public class RssStatusEnum
     /**
      * Initialize the list of supported status states.
      */
-    private static List supportedStatusSet = new LinkedList();
+    private static List<PresenceStatus> supportedStatusSet = new LinkedList<PresenceStatus>();
     static
     {
         supportedStatusSet.add(OFFLINE);
@@ -73,7 +73,7 @@ private RssStatusEnum(int status,
      * @return an <tt>Iterator</tt> over all status instances supported by the
      * rss provider.
      */
-    static Iterator supportedStatusSet()
+    static Iterator<PresenceStatus> supportedStatusSet()
     {
         return supportedStatusSet.iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -1003,7 +1003,7 @@ private Request createPublish(int expires, boolean insertPresDoc)
      * @return Iterator a PresenceStatus array containing "enterable"
      * status instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return sipStatusEnum.getSupportedStatusSet();
     }

File: src/net/java/sip/communicator/impl/protocol/sip/SipStatusEnum.java
Patch:
@@ -92,8 +92,8 @@ public class SipStatusEnum
      * The supported status set stores all statuses supported by this protocol
      * implementation.
      */
-    public final List<SipPresenceStatus> supportedStatusSet
-        = new LinkedList<SipPresenceStatus>();
+    public final List<PresenceStatus> supportedStatusSet
+        = new LinkedList<PresenceStatus>();
 
     public SipStatusEnum(String iconPath)
     {
@@ -163,7 +163,7 @@ else if (statusName.equals(AWAY))
      * @return an <tt>Iterator</tt> over all status instances supported by the
      * sip provider.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return supportedStatusSet.iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/ssh/OperationSetPersistentPresenceSSHImpl.java
Patch:
@@ -382,7 +382,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return SSHStatusEnum.supportedStatusSet();
     }

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHStatusEnum.java
Patch:
@@ -95,7 +95,7 @@ public class SSHStatusEnum
     /**
      * Initialize the list of supported status states.
      */
-    private static List supportedStatusSet = new LinkedList();
+    private static List<PresenceStatus> supportedStatusSet = new LinkedList<PresenceStatus>();
     static
     {
         supportedStatusSet.add(OFFLINE);
@@ -124,7 +124,7 @@ private SSHStatusEnum(int status,
      * @return an <tt>Iterator</tt> over all status instances supported by the
      * ssh provider.
      */
-    static Iterator supportedStatusSet()
+    static Iterator<PresenceStatus> supportedStatusSet()
     {
         return supportedStatusSet.iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetPersistentPresenceYahooImpl.java
Patch:
@@ -65,7 +65,7 @@ public class OperationSetPersistentPresenceYahooImpl
      * The array list we use when returning from the getSupportedStatusSet()
      * method.
      */
-    private static final ArrayList supportedPresenceStatusSet = new ArrayList();
+    private static final List<PresenceStatus> supportedPresenceStatusSet = new ArrayList<PresenceStatus>();
     static{
         supportedPresenceStatusSet.add(YahooStatusEnum.AVAILABLE);
         supportedPresenceStatusSet.add(YahooStatusEnum.BE_RIGHT_BACK);
@@ -358,7 +358,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return supportedPresenceStatusSet.iterator();
     }

File: src/net/java/sip/communicator/impl/protocol/zeroconf/OperationSetPersistentPresenceZeroconfImpl.java
Patch:
@@ -346,7 +346,7 @@ public ContactGroup getServerStoredContactListRoot()
      * @return Iterator a PresenceStatus array containing "enterable" status
      *   instances.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return ZeroconfStatusEnum.supportedStatusSet();
     }

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ZeroconfStatusEnum.java
Patch:
@@ -69,7 +69,7 @@ public class ZeroconfStatusEnum
     /**
      * Initialize the list of supported status states.
      */
-    private static List supportedStatusSet = new LinkedList();
+    private static List<PresenceStatus> supportedStatusSet = new LinkedList<PresenceStatus>();
     static
     {
         supportedStatusSet.add(OFFLINE);
@@ -102,7 +102,7 @@ private ZeroconfStatusEnum(int status,
      * @return an <tt>Iterator</tt> over all status instances supported by the
      * zeroconf provider.
      */
-    static Iterator supportedStatusSet()
+    static Iterator<PresenceStatus> supportedStatusSet()
     {
         return supportedStatusSet.iterator();
     }

File: src/net/java/sip/communicator/plugin/autoaway/StatusUpdateThread.java
Patch:
@@ -148,13 +148,13 @@ public void stop()
      */
     private PresenceStatus findAwayStatus(OperationSetPresence presence)
     {
-        Iterator statusSet = presence.getSupportedStatusSet();
+        Iterator<PresenceStatus> statusSet = presence.getSupportedStatusSet();
 
         PresenceStatus status = null;
 
         while (statusSet.hasNext())
         {
-            PresenceStatus possibleState = (PresenceStatus) statusSet.next();
+            PresenceStatus possibleState = statusSet.next();
 
             if (possibleState.getStatus() < PresenceStatus.AVAILABLE_THRESHOLD
                     && possibleState.getStatus() >= PresenceStatus.ONLINE_THRESHOLD)

File: src/net/java/sip/communicator/service/protocol/OperationFailedException.java
Patch:
@@ -129,7 +129,7 @@ public class OperationFailedException
     /**
      * The error code of the exception
      */
-    private int errorCode = GENERAL_ERROR;
+    private final int errorCode;
 
     /**
      * Creates an exception with the specified error message and error code.

File: src/net/java/sip/communicator/service/protocol/OperationNotSupportedException.java
Patch:
@@ -15,7 +15,9 @@
 public class OperationNotSupportedException
     extends Exception
 {
-    /**
+    private static final long serialVersionUID = 0L;
+
+	/**
      * Creates an OperationNotSupportedException instance with the specified
      * reason phrase.
      * @param message a detailed message explaining any particular details as
@@ -26,5 +28,4 @@ public OperationNotSupportedException(String message)
     {
         super(message);
     }
-
 }

File: src/net/java/sip/communicator/service/protocol/OperationSetPresence.java
Patch:
@@ -71,7 +71,7 @@ public void publishPresenceStatus(PresenceStatus status,
      * @return Iterator a PresenceStatus array containing "enterable" status
      *         instances.
      */
-    public Iterator getSupportedStatusSet();
+    public Iterator<PresenceStatus> getSupportedStatusSet();
 
     /**
      * Get the PresenceStatus for a particular contact. This method is not meant

File: src/net/java/sip/communicator/service/protocol/event/CallParticipantChangeEvent.java
Patch:
@@ -72,7 +72,7 @@ public class CallParticipantChangeEvent
      * would be mostly used for events issued upon a CallParticipantState
      * transition that has led to a FAILED state.
      */
-    private String reason = null;
+    private final String reason;
 
     /**
      * Creates a CallParticipantChangeEvent with the specified source, type,

File: src/net/java/sip/communicator/service/protocol/event/CallParticipantEvent.java
Patch:
@@ -20,7 +20,7 @@ public class CallParticipantEvent
     /**
      * The call that the source call participant is associated with.
      */
-    private Call sourceCall = null;
+    private final Call sourceCall;
 
     /**
      * An event id value indicating that this event is about the fact that
@@ -37,7 +37,7 @@ public class CallParticipantEvent
     /**
      * The id indicating the type of this event.
      */
-    private int eventID = -1;
+    private final int eventID;
 
     /**
      * Creates a call participant event instance indicating that an event with

File: src/net/java/sip/communicator/service/protocol/event/CallReceivedEvent.java
Patch:
@@ -18,7 +18,9 @@
 public class CallReceivedEvent
     extends EventObject
 {
-    public CallReceivedEvent(Call call)
+    private static final long serialVersionUID = 0L;
+
+	public CallReceivedEvent(Call call)
     {
         super(call);
     }

File: src/net/java/sip/communicator/service/protocol/event/ChatRoomInvitationReceivedEvent.java
Patch:
@@ -23,12 +23,12 @@ public class ChatRoomInvitationReceivedEvent
     /**
      * The invitation corresponding to this event.
      */
-    private ChatRoomInvitation invitation;
+    private final ChatRoomInvitation invitation;
     
     /**
      * A timestamp indicating the exact date when the event occurred.
      */
-    private Date timestamp;
+    private final Date timestamp;
 
     /**
      * Creates an <tt>InvitationReceivedEvent</tt> representing reception of

File: src/net/java/sip/communicator/service/protocol/jabberconstants/JabberStatusEnum.java
Patch:
@@ -105,8 +105,8 @@ public class JabberStatusEnum
      * The supported status set stores all statuses supported by this protocol
      * implementation.
      */
-    public final List<JabberPresenceStatus> supportedStatusSet =
-        new LinkedList<JabberPresenceStatus>();
+    public final List<PresenceStatus> supportedStatusSet =
+        new LinkedList<PresenceStatus>();
 
     /**
      * The Unknown status. Indicate that we don't know if the user is present or
@@ -217,7 +217,7 @@ else if (statusName.equals(EXTENDED_AWAY))
      * @return an <tt>Iterator</tt> over all status instances supported by the
      *         sip provider.
      */
-    public Iterator getSupportedStatusSet()
+    public Iterator<PresenceStatus> getSupportedStatusSet()
     {
         return supportedStatusSet.iterator();
     }

File: src/net/java/sip/communicator/util/swing/SIPCommCheckBox.java
Patch:
@@ -14,7 +14,9 @@
 public class SIPCommCheckBox
     extends JCheckBox
 {
-    private static final boolean setContentAreaFilled = isWindows();
+    private static final long serialVersionUID = 0L;
+
+	private static final boolean setContentAreaFilled = isWindows();
 
     private static boolean isWindows()
     {

File: src/net/java/sip/communicator/impl/gui/main/presence/AccountStatusPanel.java
Patch:
@@ -11,7 +11,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.lookandfeel.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.utils.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetMultiUserChatJabberImpl.java
Patch:
@@ -206,7 +206,7 @@ public ChatRoom createChatRoom(String roomName, Hashtable roomProperties)
 
         if(room != null)
             throw new OperationFailedException(
-                            "There is already a room with"
+                            "There is already a room with this name."
                             , OperationFailedException.IDENTIFICATION_CONFLICT);
 
         MultiUserChat muc = new MultiUserChat(getXmppConnection(), roomName);

File: src/net/java/sip/communicator/service/notification/NotificationService.java
Patch:
@@ -333,11 +333,14 @@ public void removeNotificationChangeListener(
      * (e.g. with systray)
      * @param message the message to use if and where appropriate (e.g. with
      * systray or log notification.)
+     * @param icon the icon to show in the notification if and where
+     * appropriate
      * @param tag additional info to be used by the notification handler
      */
     public void fireNotification(   String eventType,
                                     String messageTitle,
                                     String message,
+                                    byte[] icon,
                                     Object tag);
 
     /**

File: src/net/java/sip/communicator/service/systray/PopupMessage.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.service.systray;
 
 import javax.swing.*;
-import net.java.sip.communicator.service.protocol.*;
 
 /**
  * The <tt>PopupMessage</tt> class encloses informations to show in a popup.

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ActionMenuPanel.java
Patch:
@@ -19,7 +19,6 @@
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.swing.*;
 
-import org.jvnet.lafwidget.animation.*;
 import org.osgi.framework.*;
 
 public class ActionMenuPanel
@@ -173,8 +172,6 @@ public void paintComponent(Graphics g)
                 new GradientPaint(width / 2, 0, startBgColor, width / 2,
                     height, endBgColor);
 
-            FadeTracker fadeTracker = FadeTracker.getInstance();
-
             g2.setPaint(p);
             g2.fillRoundRect(0, 0, width - 1, height - 1, 15, 15);
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -895,8 +895,8 @@ public void paintComponent(Graphics g)
                  = ImageLoader.getImage(ImageLoader.WINDOW_TITLE_BAR);
 
             g.drawImage(logoImage, 0, 0, null);
-            g.setColor(new Color(
-                GuiActivator.getResources().getColor("logoBarBackground")));
+            g.setColor(new Color(GuiActivator.getResources()
+                .getColor("service.gui.LOGO_BAR_BACKGROUND")));
 
             Graphics2D g2 = (Graphics2D) g;
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -3291,3 +3291,4 @@ private Address parseAddressString(String addressString)
         return address;
     }
 }
+

File: src/net/java/sip/communicator/impl/media/codec/video/FFMPEG.java
Patch:
@@ -6,6 +6,9 @@
  */
 package net.java.sip.communicator.impl.media.codec.video;
 
+/**
+ * @author Lubomir Marinov
+ */
 public class FFMPEG
 {
     public static final int CODEC_FLAG_LOOP_FILTER = 0x00000800;

File: src/net/java/sip/communicator/service/protocol/Call.java
Patch:
@@ -65,7 +65,7 @@ protected Call(ProtocolProviderService sourceProvider)
 
         defaultEncryption =
             accountID.getAccountPropertyBoolean(
-                ProtocolProviderFactory.DEFAULT_ENCRYPTION, false);
+                ProtocolProviderFactory.DEFAULT_ENCRYPTION, true);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommToggleButton.java
Patch:
@@ -29,7 +29,7 @@ public class SIPCommToggleButton
 
     private Image iconImage;
 
-    private Image pressedImage;
+    private final Image pressedImage;
 
     /**
      * Creates a button with custom background image, rollover image and
@@ -69,6 +69,7 @@ public SIPCommToggleButton(Image bgImage, Image rolloverImage)
     {
         this.bgImage = bgImage;
         this.bgRolloverImage = rolloverImage;
+        this.pressedImage = null;
 
         this.setPreferredSize(new Dimension(this.bgImage.getWidth(null),
                 this.bgImage.getHeight(null)));

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardEvent.java
Patch:
@@ -11,7 +11,7 @@
 public class WizardEvent
     extends EventObject
 {
-    private int eventCode = -1;
+    private final int eventCode;
     
     /**
      * Indicates that the wizard triggering this event has finished
@@ -31,9 +31,9 @@ public class WizardEvent
     public static final int ERROR = 3;
     
     /**
-     * Creates a new WizardEvent accoriding to the given source and event code.
+     * Creates a new WizardEvent according to the given source and event code.
      * 
-     * @param source the source where this event occured
+     * @param source the source where this event occurred
      * @param eventCode the event code : SUCCESS or ERROR
      */
     public WizardEvent(Object source, int eventCode) {

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommCallComboBoxUI.java
Patch:
@@ -35,7 +35,9 @@ protected ComboPopup createPopup()
     
     private class SIPCommComboPopup extends BasicComboPopup
     {
-        public SIPCommComboPopup(JComboBox combo)
+        private static final long serialVersionUID = 0L;
+
+		public SIPCommComboPopup(JComboBox combo)
         {
             super(combo);
         }

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommSplitPaneDivider.java
Patch:
@@ -23,9 +23,9 @@
  */
 class SIPCommSplitPaneDivider extends BasicSplitPaneDivider {
 
-    private BufferedImage horizontalDivider 
+    private final BufferedImage horizontalDivider 
         = ImageLoader.getImage(ImageLoader.SPLITPANE_HORIZONTAL);
-    private BufferedImage verticalDivider 
+    private final BufferedImage verticalDivider 
         = ImageLoader.getImage(ImageLoader.SPLITPANE_VERTICAL);
     
     public SIPCommSplitPaneDivider(BasicSplitPaneUI ui) {

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegSummaryPage.java
Patch:
@@ -36,7 +36,7 @@ public class AccountRegSummaryPage
     private final JPanel valuesPanel
         = new TransparentPanel(new GridLayout(0, 1, 10, 10));
 
-    private AccountRegWizardContainerImpl wizardContainer;
+    private final AccountRegWizardContainerImpl wizardContainer;
 
     /**
      * Creates an <tt>AccountRegSummaryPage</tt>.

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -35,11 +35,11 @@ public class AccountRegWizardContainerImpl
     private static final Logger logger =
         Logger.getLogger(AccountRegWizardContainerImpl.class);
 
-    private AccountRegSummaryPage summaryPage;
+    private final AccountRegSummaryPage summaryPage;
 
     private AccountRegistrationWizard currentWizard;
 
-    ConfigurationService configService = GuiActivator.getConfigurationService();
+    private final ConfigurationService configService = GuiActivator.getConfigurationService();
 
     private final Map<String, AccountRegistrationWizard> registeredWizards =
         new Hashtable<String, AccountRegistrationWizard>();

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -23,7 +23,9 @@
 public class HoldButton
     extends SIPCommToggleButton
 {
-    /**
+    private static final long serialVersionUID = 0L;
+
+	/**
      * Initializes a new <tt>HoldButton</tt> instance which is to put a specific
      * <tt>CallParticipant</tt> on/off hold.
      * 

File: src/net/java/sip/communicator/impl/gui/main/call/MuteButton.java
Patch:
@@ -23,7 +23,9 @@
 public class MuteButton
     extends SIPCommToggleButton
 {
-    /**
+    private static final long serialVersionUID = 0L;
+
+	/**
      * Initializes a new <tt>MuteButton</tt> instance which is to mute the audio
      * stream to a specific <tt>CallParticipant</tt>.
      * 

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -37,7 +37,7 @@ public class ReceivedCallDialog
 
     private static final int HGAP = 5;
 
-    private Call incomingCall;
+    private final Call incomingCall;
 
     /**
      * Creates a <tt>ReceivedCallDialog</tt> by specifying the associated call.
@@ -46,8 +46,6 @@ public class ReceivedCallDialog
      */
     public ReceivedCallDialog(Call call)
     {
-        super();
-
         this.incomingCall = call;
 
         this.setUndecorated(true);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatBuffer.java
Patch:
@@ -4,7 +4,6 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.impl.gui.main.chat;
 
 import java.util.*;
@@ -18,8 +17,9 @@
  * @author Yana Stamcheva
  */
 public class ChatBuffer extends ArrayList {
+	private static final long serialVersionUID = 0L;
 
-    /**
+	/**
      * Creates an instance of <tt>ChatBuffer</tt>. The buffer
      * is initialized with the CHAT_BUFFER_SIZE constant in the
      * <tt>Constants</tt> class.
@@ -33,7 +33,6 @@ public ChatBuffer() {
      * reached.
      */
     private void recalculateBuffer() {
-
         if (this.size() >= Constants.CHAT_BUFFER_SIZE) {
             this.remove(0);
         }

File: src/net/java/sip/communicator/impl/media/transform/zrtp/SecurityEventManager.java
Patch:
@@ -31,7 +31,6 @@
  * @author Emanuel Onica
  * @author Werner Dittmann
  * @author Yana Stamcheva
- *
  */
 public class SecurityEventManager extends ZrtpUserCallback
 {
@@ -48,7 +47,7 @@ public class SecurityEventManager extends ZrtpUserCallback
 
     private CallParticipant callParticipant;
 
-    private CallSession callSession;
+    private final CallSession callSession;
 
     /**
      * Is this a ZRTP DH (Master) session?

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -592,13 +592,13 @@ private String processKeyword(String message, String contentType,
     private String formatMessage(String message, String contentType)
     {
         String processedString = message;
-        
+
         // If the message content type is HTML we won't process links and
         // new lines, but only the smilies.
         if (contentType == null || !contentType.equals(HTML_CONTENT_TYPE))
-        {   
+        {
             String linkProcessedString = processLinks(message, contentType);
-            
+
             processedString = processNewLines(linkProcessedString,
                 contentType);
         }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -783,7 +783,5 @@ private void disposeChatWindow(ChatWindow chatWindow)
 
         // Remove the envelope from the all active contacts in the contact list.
         clist.removeAllActiveContacts();
-
-        clist.refreshAll();
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -1727,6 +1727,8 @@ public void removeAllActiveContacts()
                    SystrayService.SC_IMG_TYPE);
             }
         }
+
+        this.refreshAll();
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/SecurityPanel.java
Patch:
@@ -13,7 +13,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
-import net.java.sip.communicator.impl.gui.main.call.CallParticipantPanel.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.notification.*;
 import net.java.sip.communicator.service.protocol.*;
@@ -49,6 +48,8 @@ public SecurityPanel(CallParticipant participant)
 
         this.setLayout(new GridLayout(1, 0, 5, 5));
 
+        this.setPreferredSize(new Dimension(200, 60));
+
         this.setBorder(
             BorderFactory.createTitledBorder("Compare with partner"));
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallParticipantPanel.java
Patch:
@@ -833,7 +833,7 @@ private Component createFullScreenButtonBar()
     {
         Component[] buttons =
             new Component[]
-            {   new HoldButton(callParticipant.getCall(), true),
+            {   new HoldButton(callParticipant.getCall()),
                 new MuteButton(callParticipant.getCall()),
                 createExitFullScreenButton() };
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -18,7 +18,6 @@
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.main.chat.menus.*;
 import net.java.sip.communicator.impl.gui.main.chat.toolBars.*;
-import net.java.sip.communicator.impl.gui.main.contactlist.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.gui.*;
@@ -1107,7 +1106,7 @@ public void setChatSession(ChatSession chatSession)
          */
         public JToolTip createToolTip()
         {
-            MetaContactTooltip tip = new MetaContactTooltip();
+            ExtendedTooltip tip = new ExtendedTooltip();
 
             if (tooltipIcon != null)
                 tip.setImage(tooltipIcon);
@@ -1131,7 +1130,7 @@ public JToolTip createToolTip()
 
                 String transportAddress = transport.getName();
 
-                tip.addProtocolContact( protocolStatusIcon,
+                tip.addLine( protocolStatusIcon,
                                         transportAddress);
             }
 

File: src/net/java/sip/communicator/impl/gui/main/call/SecureVerifyButton.java
Patch:
@@ -19,13 +19,13 @@
  * @author Emanuel Onica
  */
 @SuppressWarnings("serial")
-public class SecureButton
+public class SecureVerifyButton
     extends SIPCommButton
     implements ActionListener
 {
     private final CallParticipant callParticipant;
 
-    public SecureButton(CallParticipant callParticipant)
+    public SecureVerifyButton(CallParticipant callParticipant)
     {
         super(ImageLoader.getImage(ImageLoader.SECURE_BUTTON_OFF));
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPane.java
Patch:
@@ -321,7 +321,6 @@ public void messageReceived(MessageReceivedEvent evt)
             // Show an envelope on the sender contact in the contact list and
             // in the systray.
             contactList.addActiveContact(metaContact);
-            contactList.refreshContact(metaContact);
 
             // Obtain the corresponding chat panel.
             final ChatPanel chatPanel

File: src/net/java/sip/communicator/impl/gui/utils/NotificationManager.java
Patch:
@@ -22,7 +22,9 @@ public class NotificationManager
     public static final String BUSY_CALL = "BusyCall";
     
     public static final String PROACTIVE_NOTIFICATION = "ProactiveNotification";
-
+    
+    public static final String WARNING_MESSAGE = "WarningMessage";
+    
     public static void registerGuiNotifications()
     {
         NotificationService notificationService

File: src/net/java/sip/communicator/impl/media/transform/zrtp/ZrtpRawPacket.java
Patch:
@@ -127,7 +127,7 @@ protected void setSeqNum(short seq)
     {
         int at = 2;
         buffer[offset + at++] = (byte)(seq>>8);
-        buffer[offset + at] = (byte)seq;        
+        buffer[offset + at] = (byte)seq;
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/CallParticipantSipImpl.java
Patch:
@@ -360,9 +360,9 @@ public void setTransportAddress(InetSocketAddress transportAddress)
 
         this.fireCallParticipantChangeEvent(
             CallParticipantChangeEvent
-                .CALL_PARTICIPANT_TRANSPORT_ADDRESS_CHANGE
-            , oldTransportAddress
-            , transportAddress);
+                .CALL_PARTICIPANT_TRANSPORT_ADDRESS_CHANGE,
+                oldTransportAddress,
+                transportAddress);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/dict/OperationSetPersistentPresenceDictImpl.java
Patch:
@@ -1162,7 +1162,6 @@ public ContactDictImpl createVolatileContact(String contactAddress)
         //if the parent volatile group is null then we create it
         if (theVolatileGroup == null)
         {
-            List emptyBuddies = new LinkedList();
             theVolatileGroup = new ContactGroupDictImpl(
                 "NotInContactList"
                 , parentProvider);

File: src/net/java/sip/communicator/impl/protocol/gibberish/OperationSetPersistentPresenceGibberishImpl.java
Patch:
@@ -1198,7 +1198,6 @@ public ContactGibberishImpl createVolatileContact(String contactAddress)
         //if the parent volatile group is null then we create it
         if (theVolatileGroup == null)
         {
-            List emptyBuddies = new LinkedList();
             theVolatileGroup = new ContactGroupGibberishImpl(
                 "NotInContactList"
                 , parentProvider);

File: src/net/java/sip/communicator/impl/protocol/ssh/OperationSetPersistentPresenceSSHImpl.java
Patch:
@@ -732,8 +732,6 @@ public void subscribe(
                    IllegalStateException,
                    OperationFailedException
     {
-        BundleContext context = SSHActivator.getBundleContext();
-        
         ContactSSH sshContact = new ContactSSHImpl(contactIdentifier,
                 parentProvider);
         
@@ -1158,7 +1156,6 @@ public ContactSSHImpl createVolatileContact(String contactAddress)
         //if the parent volatile group is null then we create it
         if (theVolatileGroup == null)
         {
-            List emptyBuddies = new LinkedList();
             theVolatileGroup = new ContactGroupSSHImpl(
                     "NotInContactList"
                     , parentProvider);

File: src/net/java/sip/communicator/impl/protocol/zeroconf/OperationSetPersistentPresenceZeroconfImpl.java
Patch:
@@ -1024,7 +1024,6 @@ public ContactZeroconfImpl createVolatileContact(String contactAddress,
         //if the parent volatile group is null then we create it
         if (theVolatileGroup == null)
         {
-            List emptyBuddies = new LinkedList();
             theVolatileGroup = new ContactGroupZeroconfImpl(
                 "Bonjour"
                 , parentProvider);

File: src/net/java/sip/communicator/plugin/whiteboard/gui/WhiteboardFrame.java
Patch:
@@ -807,7 +807,6 @@ private void initComponents()
         modifButton = new JToggleButton();
         jPanel2 = new TransparentPanel();
         jLabelThickness = new JLabel();
-        jLabel1 = new JLabel();
         jSpinnerThickness = new JSpinner();
         menuBar = new JMenuBar();
         fileMenu = new JMenu();
@@ -1490,8 +1489,6 @@ private void colorChooserButtonActionPerformed(
 
     private javax.swing.JButton jButtonSave;
 
-    private javax.swing.JLabel jLabel1;
-
     private javax.swing.JLabel jLabelColor;
 
     private javax.swing.JLabel jLabelStatus;

File: src/net/java/sip/communicator/impl/gui/main/presence/message/NewStatusMessageDialog.java
Patch:
@@ -86,6 +86,7 @@ private void init()
         this.infoArea.setEditable(false);
         this.infoArea.setLineWrap(true);
         this.infoArea.setWrapStyleWord(true);
+        this.infoArea.setOpaque(false);
 
         this.dataPanel.add(messageLabel, BorderLayout.WEST);
 

File: src/net/java/sip/communicator/impl/gui/event/PluginComponentEvent.java
Patch:
@@ -17,8 +17,7 @@
 public class PluginComponentEvent
     extends EventObject
 {
-
-    private int eventID = -1;
+    private final int eventID;
 
     /**
      * Indicates that the PluginComponentEvent instance was triggered by
@@ -43,6 +42,7 @@ public PluginComponentEvent(PluginComponent pluginComponent,
                                 int eventID)
     {
         super(pluginComponent);
+
         this.eventID = eventID;
     }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -356,7 +356,7 @@ public int getNextMatch(String prefix, int startIndex, Position.Bias bias)
      *
      * @return The list of all groups.
      */
-    public Iterator getAllGroups()
+    public Iterator<MetaContactGroup> getAllGroups()
     {
         return contactListService.getRoot().getSubgroups();
     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/SelectGroupPanel.java
Patch:
@@ -106,7 +106,7 @@ public SelectGroupPanel(AddContactWizard wizard,
         
         Object lastSelectedGroup = null;
         
-        Iterator groupsList = wizard.getMainFrame().getAllGroups();
+        Iterator<MetaContactGroup> groupsList = wizard.getMainFrame().getAllGroups();
 
         if (groupsList.hasNext())
         {
@@ -119,8 +119,7 @@ public SelectGroupPanel(AddContactWizard wizard,
 
             while(groupsList.hasNext())
             {
-                MetaContactGroup group
-                    = (MetaContactGroup)groupsList.next();
+                MetaContactGroup group = groupsList.next();
                 
                 GroupWrapper gr = new GroupWrapper(group);
                 

File: src/net/java/sip/communicator/plugin/aimaccregwizz/AimAccountRegistrationWizard.java
Patch:
@@ -92,9 +92,9 @@ public String getProtocolDescription()
     /**
      * Returns the set of pages contained in this wizard.
      */
-    public Iterator getPages()
+    public Iterator<WizardPage> getPages()
     {
-        ArrayList pages = new ArrayList();
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(this);
 
         pages.add(firstWizardPage);
@@ -105,7 +105,7 @@ public Iterator getPages()
     /**
      * Returns the set of data that user has entered through this wizard.
      */
-    public Iterator getSummary()
+    public Iterator<Map.Entry> getSummary()
     {
         Hashtable summaryTable = new Hashtable();
 

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/GoogleTalkAccountRegistrationWizard.java
Patch:
@@ -105,9 +105,9 @@ public String getProtocolDescription()
      * Returns the set of pages contained in this wizard.
      * @return Iterator
      */
-    public Iterator getPages()
+    public Iterator<WizardPage> getPages()
     {
-        ArrayList pages = new ArrayList();
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(this);
 
         pages.add(firstWizardPage);
@@ -119,7 +119,7 @@ public Iterator getPages()
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator getSummary()
+    public Iterator<Map.Entry> getSummary()
     {
         Hashtable summaryTable = new Hashtable();
 

File: src/net/java/sip/communicator/plugin/ircaccregwizz/IrcAccountRegistrationWizard.java
Patch:
@@ -103,9 +103,9 @@ public String getProtocolDescription()
      * Returns the set of pages contained in this wizard.
      * @return Iterator
      */
-    public Iterator getPages()
+    public Iterator<WizardPage> getPages()
     {
-        ArrayList pages = new ArrayList();
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(this);
 
         pages.add(firstWizardPage);
@@ -117,7 +117,7 @@ public Iterator getPages()
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator getSummary()
+    public Iterator<Map.Entry> getSummary()
     {
         Hashtable summaryTable = new Hashtable();
         String pass = new String();

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -105,9 +105,9 @@ public String getProtocolDescription()
      * Returns the set of pages contained in this wizard.
      * @return Iterator
      */
-    public Iterator getPages()
+    public Iterator<WizardPage> getPages()
     {
-        ArrayList pages = new ArrayList();
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(this);
 
         pages.add(firstWizardPage);
@@ -119,7 +119,7 @@ public Iterator getPages()
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator getSummary()
+    public Iterator<Map.Entry> getSummary()
     {
         Hashtable summaryTable = new Hashtable();
 

File: src/net/java/sip/communicator/plugin/msnaccregwizz/MsnAccountRegistrationWizard.java
Patch:
@@ -103,9 +103,9 @@ public String getProtocolDescription()
      * 
      * @return Iterator
      */
-    public Iterator getPages()
+    public Iterator<WizardPage> getPages()
     {
-        ArrayList pages = new ArrayList();
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(this);
 
         pages.add(firstWizardPage);
@@ -118,7 +118,7 @@ public Iterator getPages()
      * 
      * @return Iterator
      */
-    public Iterator getSummary()
+    public Iterator<Map.Entry> getSummary()
     {
         Hashtable summaryTable = new Hashtable();
 

File: src/net/java/sip/communicator/plugin/rssaccregwizz/RssAccountRegistrationWizard.java
Patch:
@@ -107,9 +107,9 @@ public String getProtocolDescription()
      * Returns the set of pages contained in this wizard.
      * @return Iterator
      */
-    public Iterator getPages()
+    public Iterator<WizardPage> getPages()
     {
-        ArrayList pages = new ArrayList();
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(registration, wizardContainer);
 
         pages.add(firstWizardPage);
@@ -121,7 +121,7 @@ public Iterator getPages()
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator getSummary()
+    public Iterator<Map.Entry> getSummary()
     {
         Hashtable summaryTable = new Hashtable();
 

File: src/net/java/sip/communicator/plugin/sshaccregwizz/SSHAccountRegistrationWizard.java
Patch:
@@ -113,8 +113,8 @@ public String getProtocolDescription() {
      * Returns the set of pages contained in this wizard.
      * @return Iterator
      */
-    public Iterator getPages() {
-        ArrayList pages = new ArrayList();
+    public Iterator<WizardPage> getPages() {
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(registration, wizardContainer);
         
         pages.add(firstWizardPage);
@@ -126,7 +126,7 @@ public Iterator getPages() {
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator getSummary() {
+    public Iterator<Map.Entry> getSummary() {
         Hashtable summaryTable = new Hashtable();
         
         /*

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/YahooAccountRegistrationWizard.java
Patch:
@@ -105,9 +105,9 @@ public String getProtocolDescription()
      * 
      * @return Iterator
      */
-    public Iterator getPages()
+    public Iterator<WizardPage> getPages()
     {
-        ArrayList pages = new ArrayList();
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(this);
 
         pages.add(firstWizardPage);
@@ -120,7 +120,7 @@ public Iterator getPages()
      * 
      * @return Iterator
      */
-    public Iterator getSummary()
+    public Iterator<Map.Entry> getSummary()
     {
         Hashtable summaryTable = new Hashtable();
 

File: src/net/java/sip/communicator/plugin/zeroconfaccregwizz/ZeroconfAccountRegistrationWizard.java
Patch:
@@ -108,9 +108,9 @@ public String getProtocolDescription()
      * Returns the set of pages contained in this wizard.
      * @return Iterator
      */
-    public Iterator getPages()
+    public Iterator<WizardPage> getPages()
     {
-        ArrayList pages = new ArrayList();
+        java.util.List<WizardPage> pages = new ArrayList<WizardPage>();
         firstWizardPage = new FirstWizardPage(this);
 
         pages.add(firstWizardPage);
@@ -122,7 +122,7 @@ public Iterator getPages()
      * Returns the set of data that user has entered through this wizard.
      * @return Iterator
      */
-    public Iterator getSummary()
+    public Iterator<Map.Entry> getSummary()
     {
         Hashtable summaryTable = new Hashtable();
 

File: src/net/java/sip/communicator/service/gui/AccountRegistrationWizard.java
Patch:
@@ -86,7 +86,7 @@ public interface AccountRegistrationWizard
      * @return the set of <tt>WizardPage</tt>-s for this
      * wizard. 
      */
-    public Iterator getPages();
+    public Iterator<WizardPage> getPages();
 
     /**
      * Returns the identifier of the first account registration wizard page.
@@ -113,7 +113,7 @@ public interface AccountRegistrationWizard
      * @return a set of key-value pairs that will represent the summary for
      * this wizard. 
      */
-    public Iterator getSummary();
+    public Iterator<Map.Entry> getSummary();
 
     /**
      * Defines the operations that will be executed when the user clicks on

File: src/net/java/sip/communicator/service/contactlist/MetaContactGroup.java
Patch:
@@ -120,7 +120,7 @@ public ContactGroup getContactGroup(String groupName,
      * @return a <tt>java.util.Iterator</tt> over the <tt>MetaContacts</tt> in
      * this group.
      */
-    public Iterator getChildContacts();
+    public Iterator<MetaContact> getChildContacts();
 
     /**
      * Returns the number of <tt>MetaContact</tt>s that this group contains
@@ -154,7 +154,7 @@ public ContactGroup getContactGroup(String groupName,
      * <p>
      * @return a <tt>java.util.Iterator</tt> containing all subgroups.
      */
-    public Iterator getSubgroups();
+    public Iterator<MetaContactGroup> getSubgroups();
 
     /**
      * Returns the number of subgroups that this <tt>MetaContactGroup</tt>

File: src/net/java/sip/communicator/impl/growlnotification/GrowlNotificationServiceImpl.java
Patch:
@@ -85,9 +85,9 @@ public void start(BundleContext bc)
         /* Register to Growl */
         try
         {
-            Constructor constructor = Growl.class.getConstructor(new Class[]
-                                {String.class, String.class});
-            notifier = (Growl)constructor.newInstance(
+            Constructor<Growl> constructor = Growl.class.getConstructor(
+                    new Class[] { String.class, String.class });
+            notifier = constructor.newInstance(
                     new Object[]{"SIP Communicator", sipIconPath});
 
             //init the setAllowedNotifications method

File: src/net/java/sip/communicator/impl/gui/PopupDialogImpl.java
Patch:
@@ -19,7 +19,9 @@ public class PopupDialogImpl
     extends JOptionPane
     implements PopupDialog
 {
-    /**
+    private static final long serialVersionUID = 0L;
+
+	/**
      * Creates an instance of <tt>PopupDialogImpl</tt>.
      */
     public PopupDialogImpl()

File: src/net/java/sip/communicator/impl/gui/customcontrols/BoxPopupMenu.java
Patch:
@@ -4,7 +4,6 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.impl.gui.customcontrols;
 
 import java.awt.*;

File: src/net/java/sip/communicator/impl/gui/customcontrols/ChatToolbarButton.java
Patch:
@@ -4,7 +4,6 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.impl.gui.customcontrols;
 
 import java.awt.*;
@@ -18,7 +17,9 @@
  */
 public class ChatToolbarButton extends SIPCommButton
 {
-    /**
+    private static final long serialVersionUID = 0L;
+
+	/**
      * Creates an instance of <tt>MsgToolbarButton</tt>.
      * @param iconImage The icon to display on this button.
      */

File: src/net/java/sip/communicator/impl/gui/customcontrols/ErrorDialog.java
Patch:
@@ -33,7 +33,7 @@ public class ErrorDialog
     implements  ActionListener,
                 HyperlinkListener
 {
-    private Logger logger = Logger.getLogger(ErrorDialog.class);
+    private final Logger logger = Logger.getLogger(ErrorDialog.class);
 
     private JButton okButton = new JButton(
         GuiActivator.getResources().getI18NString("service.gui.OK"));

File: src/net/java/sip/communicator/impl/gui/customcontrols/RadioButtonTableCellRenderer.java
Patch:
@@ -17,8 +17,6 @@ public class RadioButtonTableCellRenderer
     public Component getTableCellRendererComponent(JTable table, Object value,
         boolean isSelected, boolean hasFocus, int row, int column)
     {
-      if (value == null)
-        return null;
-      return (Component) value;
+      return (value == null) ? null : (Component) value;
     }
 }

File: src/net/java/sip/communicator/impl/gui/customcontrols/SCScrollPane.java
Patch:
@@ -18,7 +18,9 @@
 public class SCScrollPane
     extends JScrollPane
 {
-    public SCScrollPane()
+    private static final long serialVersionUID = 0L;
+
+	public SCScrollPane()
     {
         this.setBorder(null);
         this.setOpaque(false);

File: src/net/java/sip/communicator/impl/gui/customcontrols/TitlePanel.java
Patch:
@@ -22,11 +22,11 @@
 public class TitlePanel
     extends TransparentPanel
 {
-    private JLabel titleLabel = new JLabel();
+    private final JLabel titleLabel = new JLabel();
 
-    private Color gradientStartColor = new Color(255, 255, 255, 200);
+    private final Color gradientStartColor = new Color(255, 255, 255, 200);
 
-    private Color gradientEndColor = new Color(255, 255, 255, 50);
+    private final Color gradientEndColor = new Color(255, 255, 255, 50);
 
     /**
      * Creates an instance of <tt>TitlePanel</tt>.

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardModel.java
Patch:
@@ -4,7 +4,6 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.impl.gui.customcontrols.wizard;
 
 import java.beans.*;
@@ -22,8 +21,6 @@
  * 
  * @author Yana Stamcheva
  */
-
-
 public class WizardModel {
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -76,7 +76,7 @@ private CallParticipantPanel addCallParticipant(
 
         if (participantPanel == null)
         {
-            participantPanel = new CallParticipantPanel(this, participant);
+            participantPanel = new CallParticipantPanel(participant);
 
             this.mainPanel.add(participantPanel);
 

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommSmartComboBox.java
Patch:
@@ -173,8 +173,8 @@ public boolean accept(Object o)
     }
 
     public class CallComboEditor
-    implements  ComboBoxEditor,
-                DocumentListener
+        implements  ComboBoxEditor,
+                    DocumentListener
     {
         private JTextField text;
         private volatile boolean filtering = false;

File: src/net/java/sip/communicator/impl/media/codec/video/h264/JNIEncoder.java
Patch:
@@ -111,7 +111,7 @@ public Format[] getSupportedOutputFormats(Format in)
 
         // mismatch input format
         if (!(in instanceof VideoFormat)
-            || null == NativeDecoder.matches(in, inputFormats))
+            || null == JNIDecoder.matches(in, inputFormats))
             return new Format[0];
 
         return getMatchingOutputFormats(in);
@@ -121,7 +121,7 @@ public Format setInputFormat(Format in)
     {
         // mismatch input format
         if (!(in instanceof VideoFormat)
-            || null == NativeDecoder.matches(in, inputFormats))
+            || null == JNIDecoder.matches(in, inputFormats))
             return null;
 
         VideoFormat videoIn = (VideoFormat) in;
@@ -156,7 +156,7 @@ public Format setOutputFormat(Format out)
     {
         // mismatch output format
         if (!(out instanceof VideoFormat)
-            || null == NativeDecoder.matches(out,
+            || null == JNIDecoder.matches(out,
                 getMatchingOutputFormats(inputFormat)))
             return null;
 

File: src/net/java/sip/communicator/plugin/branding/AboutWindow.java
Patch:
@@ -70,13 +70,14 @@ public AboutWindow(Frame owner)
         int logoAreaFontSize
             = resources.getSettingsInt("plugin.branding.ABOUT_LOGO_FONT_SIZE");
 
+        // FIXME: the message exceeds the window length
         JTextArea logoArea =
             new JTextArea(resources.getI18NString("plugin.branding.LOGO_MESSAGE"));
         logoArea.setFont(
             logoArea.getFont().deriveFont(Font.BOLD, logoAreaFontSize));
         logoArea.setForeground(Constants.TITLE_COLOR);
         logoArea.setOpaque(false);
-        logoArea.setLineWrap(true);
+        logoArea.setLineWrap(false);
         logoArea.setWrapStyleWord(true);
         logoArea.setEditable(false);
         logoArea.setPreferredSize(new Dimension(100, 20));

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -79,7 +79,7 @@ public ChatWritePanel(ChatPanel panel)
         this.editorPane.addMouseListener(this);
 
         //set our own transfer (i.e. copy/paste) handler
-        this.editorPane.setTransferHandler(new ChatPanelTransferHandler());
+        this.editorPane.setTransferHandler(new ChatWritePanelTransferHandler());
 
         this.editTextToolBar = new EditTextToolBar(this);
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanelTransferHandler.java
Patch:
@@ -20,7 +20,7 @@
  * accept pasting of plain text. We do this in order to avoid html support
  * problems that appear when pasting formatted text into our editable area.
  */
-public class ChatPanelTransferHandler
+public class ChatWritePanelTransferHandler
     extends TransferHandler
 {
 

File: src/net/java/sip/communicator/impl/protocol/sip/ProxyRouter.java
Patch:
@@ -21,6 +21,7 @@
  * An implementation of the <tt>Router</tt> interface wrapping around JAIN-SIP
  * RI <tt>DefaultRouter</tt> in order to be able to change the outbound proxy
  * depending on the account which sent the request.
+ * 
  * @author Sebastien Mazy
  */
 public class ProxyRouter

File: src/net/java/sip/communicator/impl/protocol/sip/SipApplicationData.java
Patch:
@@ -15,7 +15,7 @@
 /**
  * The only Object with should be used as parameter for any JAIN-SIP class
  * setApplicationData() method (available for instance with Dialog-s and
- * Transaction-s). Allows several parts of SC code to interact independantly
+ * Transaction-s). Allows several parts of SC code to interact independently
  * with setApplicationData(...)/getApplicationData() without stepping on
  * eachother's toes. Utility functions are provided to set/get data from
  * a supported object.
@@ -36,7 +36,7 @@ public class SipApplicationData
     /**
      * Internal representation of the store.
      */
-    private Map<String, Object> storage_ = new HashMap<String, Object>();
+    private final Map<String, Object> storage_ = new HashMap<String, Object>();
 
     /**
      * Stores a <tt>value</tt> associated to the a <tt>key</tt> string in the

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallButton.java
Patch:
@@ -10,8 +10,6 @@
 import java.awt.event.*;
 import java.util.*;
 
-import javax.swing.*;
-
 import org.osgi.framework.*;
 
 import net.java.sip.communicator.impl.gui.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GroupRightButtonMenu.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.awt.*;
 import java.awt.event.*;
-import java.awt.image.*;
 import java.util.*;
 
 import javax.swing.*;
@@ -25,7 +24,6 @@
 import net.java.sip.communicator.service.gui.Container;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
-import net.java.sip.communicator.util.swing.*;
 
 import org.osgi.framework.*;
 

File: src/net/java/sip/communicator/impl/media/transform/zrtp/SCCallbackResources.java
Patch:
@@ -6,10 +6,10 @@
  */
 package net.java.sip.communicator.impl.media.transform.zrtp;
 
-import net.java.sip.communicator.service.resources.*;
-import net.java.sip.communicator.impl.media.*;
+//import net.java.sip.communicator.service.resources.*;
+//import net.java.sip.communicator.impl.media.*;
 
-import org.osgi.framework.*;
+//import org.osgi.framework.*;
 
 /**
  * The <tt>Resources</tt> class manages the access to the internationalization

File: src/net/java/sip/communicator/plugin/gibberishaccregwizz/FirstWizardPage.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.plugin.gibberishaccregwizz;
 
-import java.util.*;
-
 import java.awt.*;
 import javax.swing.*;
 import javax.swing.event.*;

File: src/net/java/sip/communicator/plugin/sshaccregwizz/FirstWizardPage.java
Patch:
@@ -12,8 +12,6 @@
  */
 package net.java.sip.communicator.plugin.sshaccregwizz;
 
-import java.util.*;
-
 import java.awt.*;
 import java.awt.event.*;
 import javax.swing.*;

File: src/net/java/sip/communicator/service/gui/WizardPage.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.service.gui;
 
-import net.java.sip.communicator.service.protocol.*;
-
 /**
  * The <tt>WizardPage</tt> represents a page in a <tt>WizardContainer</tt>.
  * A page has a unique identifier. Each page should specify the identifier

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ActionMenuPanel.java
Patch:
@@ -57,7 +57,7 @@ private static boolean isWindows()
 
     public ActionMenuPanel()
     {
-        super(new FlowLayout(FlowLayout.LEFT, 15, 15));
+        super(new FlowLayout(FlowLayout.CENTER, 15, 15));
 
         this.setOpaque(false);
         this.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -103,6 +103,7 @@ public class MediaControl
      */
     public MediaControl()
     {
+        //com.sun.media.util.Registry.set("allowLogging", Boolean.TRUE);
     }
 
     /**
@@ -948,12 +949,12 @@ public void stopProcessingMedia(Object reader)
 
         if( sourceProcessor.getState() ==  Processor.Started )
         {
+            avDataSource.disconnect();
             sourceProcessor.stop();
 
-            avDataSource.disconnect();
             try
             {
-                initProcessor(avDataSource);
+                initCaptureDevices();
             }
             catch (Exception e)
             {

File: src/net/java/sip/communicator/impl/media/codec/video/h264/NativeEncoder.java
Patch:
@@ -221,7 +221,7 @@ public int process(Buffer inBuffer, Buffer outBuffer)
             return BUFFER_PROCESSED_OK;
         }
 
-        synchronized (AVCODEC)
+        synchronized (this)
         {
             // copy data to avpicture
             rawFrameBuffer.write(0,
@@ -349,7 +349,7 @@ public synchronized void close()
         if (opened)
         {
             opened = false;
-            synchronized (AVCODEC)
+            synchronized (this)
             {
                 AVCODEC.avcodec_close(avcontext);
 

File: src/net/java/sip/communicator/impl/media/codec/video/h264/NativeDecoder.java
Patch:
@@ -318,7 +318,7 @@ else if(!parser.pushRTPInput(inputBuffer))
             System.arraycopy(data, 0, outData, 0, data.length);
 
             outputBuffer.setOffset(0);
-            outputBuffer.setLength(outData.length);
+            outputBuffer.setLength(data.length);
             outputBuffer.setData(outData);
 
             AVUTIL.av_free(encBuf);

File: src/net/java/sip/communicator/impl/media/ProcessorUtility.java
Patch:
@@ -99,7 +99,6 @@ public void controllerUpdate(ControllerEvent ce) {
      */
     public synchronized boolean waitForState(Processor processor, int state)
     {
-        System.out.println("d1");
         processor.addControllerListener(this);
         setFailed(false);
 

File: src/net/java/sip/communicator/impl/media/ProcessorUtility.java
Patch:
@@ -97,8 +97,9 @@ public void controllerUpdate(ControllerEvent ce) {
      * @param state one of the Processor.XXXed sate vars
      * @return boolean true if the state has been reached and false otherwise
      */
-    public synchronized boolean waitForState(Processor processor, int state) 
+    public synchronized boolean waitForState(Processor processor, int state)
     {
+        System.out.println("d1");
         processor.addControllerListener(this);
         setFailed(false);
 

File: src/net/java/sip/communicator/service/protocol/AbstractCallParticipant.java
Patch:
@@ -16,7 +16,7 @@
  * Provides a default implementation for most of the
  * <code>CallParticipant</code> methods with the purpose of only leaving custom
  * protocol development to clients using the PhoneUI service.
- * 
+ *
  * @author Emil Ivov
  */
 public abstract class AbstractCallParticipant
@@ -226,7 +226,7 @@ public void setState(CallParticipantState newState)
      * Gets the time at which this <code>CallParticipant</code> transitioned
      * into a state (likely {@link CallParticipantState#CONNECTED}) marking the
      * start of the duration of the participation in a <code>Call</code>.
-     * 
+     *
      * @return the time at which this <code>CallParticipant</code> transitioned
      *         into a state marking the start of the duration of the
      *         participation in a <code>Call</code> or

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -83,8 +83,9 @@ public class MainFrame
 
     private MetaContactListService contactList;
 
-    private final Map<ProtocolProviderService, ContactEventHandler> providerContactHandlers =
-        new Hashtable<ProtocolProviderService, ContactEventHandler>();
+    private final Map<ProtocolProviderService, ContactEventHandler>
+        providerContactHandlers =
+            new Hashtable<ProtocolProviderService, ContactEventHandler>();
 
     private final Map<PluginComponent, Component> nativePluginsTable =
         new Hashtable<PluginComponent, Component>();

File: src/net/java/sip/communicator/impl/media/transform/zrtp/ZRTPTransformEngine.java
Patch:
@@ -229,7 +229,7 @@ public void run()
                 long endTime = System.currentTimeMillis() + nextDelay;
                 long currentTime = System.currentTimeMillis();
                 synchronized (sync) {
-                    while ((currentTime <= endTime) && newTask && !stop)
+                    while ((currentTime < endTime) && newTask && !stop)
                     {
                         try
                         {
@@ -644,7 +644,6 @@ public boolean sendDataZRTP(byte[] data)
             e.printStackTrace();
             return false;
         }
-
         return true;
     }
 

File: src/net/java/sip/communicator/impl/gui/GuiActivator.java
Patch:
@@ -32,8 +32,7 @@
  */
 public class GuiActivator implements BundleActivator
 {
-    private static Logger logger
-        = Logger.getLogger(GuiActivator.class.getName());
+    private static final Logger logger = Logger.getLogger(GuiActivator.class);
 
     private static UIServiceImpl uiService = null;
 

File: src/net/java/sip/communicator/impl/systray/SystrayActivator.java
Patch:
@@ -31,8 +31,8 @@ public class SystrayActivator
 
     private static ConfigurationService configService;
 
-    private static Logger logger = Logger.getLogger(
-            SystrayActivator.class.getName());
+    private static final Logger logger =
+        Logger.getLogger(SystrayActivator.class);
 
     /**
      * Called when this bundle is started.

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -129,9 +129,9 @@ private void initCallLabel(JLabel callLabel)
         boolean hasMoreParticipants = false;
         String text = "";
 
-        ImageIcon imageIcon = ImageUtils.getScaledRoundedImage(
-            ImageLoader.getImage(ImageLoader.DEFAULT_USER_PHOTO),
-            40, 45);
+        ImageIcon imageIcon =
+            ImageUtils.getScaledRoundedIcon(ImageLoader
+                .getImage(ImageLoader.DEFAULT_USER_PHOTO), 40, 45);
 
         while (participantsIter.hasNext())
         {

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigFormList.java
Patch:
@@ -4,7 +4,6 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.impl.gui.main.configforms;
 
 import javax.swing.*;
@@ -22,9 +21,9 @@ public class ConfigFormList
     extends JList
     implements ListSelectionListener
 {
-    private DefaultListModel listModel = new DefaultListModel();
+    private final DefaultListModel listModel = new DefaultListModel();
     
-    private ConfigurationFrame configFrame;
+    private final ConfigurationFrame configFrame;
     
     /**
      * Creates an instance of <tt>ConfigFormList</tt>

File: src/net/java/sip/communicator/impl/media/codec/EncodingConfiguration.java
Patch:
@@ -300,7 +300,7 @@ public void registerCustomCodecs()
                             .getSupportedOutputFormats(null),
                             PlugInManager.CODEC);
                     logger.debug("Codec : " + className
-                        + " is succsefully registered : " + result);
+                        + " is successfully registered : " + result);
                 }
                 catch (Throwable ex)
                 {

File: src/net/java/sip/communicator/plugin/notificationconfiguration/NotificationConfigurationPanel.java
Patch:
@@ -82,8 +82,6 @@ public class NotificationConfigurationPanel
 
     public NotificationConfigurationPanel()
     {
-        super();
-
         JPanel actions = new TransparentPanel();
         GridBagLayout actionsLayout = new GridBagLayout();
         JPanel applyPanel = new TransparentPanel();

File: src/net/java/sip/communicator/service/gui/ExportedWindow.java
Patch:
@@ -27,9 +27,6 @@ public interface ExportedWindow
     public static final WindowID CHAT_WINDOW
         = new WindowID("ChatWindow");
     
-    public static final WindowID CONFIGURATION_WINDOW
-        = new WindowID("ConfigurationWindow");
-    
     public static final WindowID AUTHENTICATION_WINDOW
         = new WindowID("AuthenticationWindow");
 

File: src/net/java/sip/communicator/service/gui/UIService.java
Patch:
@@ -333,4 +333,6 @@ public SecurityAuthority getDefaultSecurityAuthority(
     public boolean useMacOSXScreenMenuBar();
 
     public void beginShutdown();
+
+    public void setConfigurationWindowVisible(boolean visible);
 }

File: src/net/java/sip/communicator/service/contactlist/MetaContact.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.service.contactlist;
 
-
 import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
@@ -33,11 +32,11 @@ public interface MetaContact extends Comparable
     /**
      * Returns the default protocol specific <tt>Contact</tt> to use with this
      * <tt>MetaContact</tt> for a precise operation (IM, call, ...).
-     *
+     * 
      * @param operationSet the operation for which the default contact is needed
      * @return the default contact for the specified operation.
      */
-    public Contact getDefaultContact(Class operationSet);
+    public Contact getDefaultContact(Class<? extends OperationSet> operationSet);
 
     /**
      * Returns a <tt>java.util.Iterator</tt> with all protocol specific

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommMenu.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.customcontrols;
 
-import java.awt.*;
 import java.awt.event.*;
 
 import javax.swing.*;

File: src/net/java/sip/communicator/impl/gui/customcontrols/LabelTableCellRenderer.java
Patch:
@@ -25,7 +25,7 @@ public class LabelTableCellRenderer extends JLabel
     implements TableCellRenderer
 {
     public LabelTableCellRenderer()
-    {   
+    {
         this.setHorizontalAlignment(JLabel.LEFT);
         this.setOpaque(true);
         this.setBorder(BorderFactory.createEmptyBorder(0, 8, 0, 0));
@@ -43,7 +43,7 @@ public Component getTableCellRendererComponent(JTable table, Object value,
         }
         else if (value instanceof ProtocolProviderService) {
             ProtocolProviderService pps = (ProtocolProviderService)value;
-            this.setText(pps.getAccountID().getUserID());
+            this.setText(pps.getAccountID().getDisplayName());
         }
         else if (value instanceof MetaContactGroup) {
             MetaContactGroup group = (MetaContactGroup) value;

File: src/net/java/sip/communicator/impl/gui/main/account/AccountsConfigurationPanel.java
Patch:
@@ -122,7 +122,7 @@ private void accountsInit()
     /**
      * Handles the <tt>ActionEvent</tt> triggered when user clicks on on the
      * buttons. Shows the account registration wizard when user clicks on "New".
-     * 
+     *
      * @param evt the action event that has just occurred.
      */
     public void actionPerformed(ActionEvent evt)
@@ -147,7 +147,7 @@ else if (sourceButton.equals(saveButton))
      * Implements the <tt>ServiceListener</tt> method. Verifies whether the
      * passed event concerns a <tt>ProtocolProviderService</tt> and adds the
      * corresponding UI controls.
-     * 
+     *
      * @param event The <tt>ServiceEvent</tt> object.
      */
     public void serviceChanged(ServiceEvent event)
@@ -241,7 +241,7 @@ public AccountPanel(ProtocolProviderService protocolProvider)
             this.add(protocolLabel, constraints);
 
             this.accountLabel.setText(protocolProvider.getAccountID()
-                .getUserID());
+                .getDisplayName());
             constraints.insets = new Insets(0, 0, 0, 0);
             constraints.gridx = 1;
             constraints.gridy = 0;

File: src/net/java/sip/communicator/launcher/SIPCommunicator.java
Patch:
@@ -118,7 +118,7 @@ else if(lockResult == SipCommunicatorLock.SUCCESS)
 
         //there was no error, continue;
         System.setOut(new ScStdOut(System.out));
-        Main.main(args);
+        Main.main(new String[0]);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -2309,7 +2309,7 @@ public void registrationStateChanged(RegistrationStateChangeEvent event)
         {
             ProtocolProviderServiceSipImpl listener
                 = (ProtocolProviderServiceSipImpl) event.getProvider();
-            this.sipStackSharing.removeSipListener(listener);
+            sipStackSharing.removeSipListener(listener);
             listener.removeRegistrationStateChangeListener(this);
         }
     }

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackSharing.java
Patch:
@@ -16,7 +16,6 @@
 import javax.sip.message.*;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -107,6 +107,9 @@ public void loadApplicationGui()
 
         this.mainFrame = new MainFrame();
 
+        if (UIManager.getLookAndFeel() instanceof SIPCommLookAndFeel)
+            initCustomFonts();
+
         /*
          * The mainFrame isn't fully ready without the MetaContactListService so
          * make sure it's set before allowing anything, such as LoginManager, to
@@ -822,8 +825,6 @@ private void setDefaultThemePack()
                 logger.error("The provided Look & Feel is not supported.",
                     e);
             }
-
-            this.initCustomFonts();
         }
     }
 

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -186,7 +186,7 @@ else if (evt.getReasonCode() == RegistrationStateChangeEvent
                     msgText).showDialog();
             }
 
-            logger.error(evt.getReason());
+            logger.trace(evt.getReason());
         }
         else if (evt.getNewState().equals(RegistrationState.CONNECTION_FAILED))
         {
@@ -208,7 +208,7 @@ else if (evt.getNewState().equals(RegistrationState.CONNECTION_FAILED))
                 this.login(protocolProvider);
             }
 
-            logger.error(evt.getReason());
+            logger.trace(evt.getReason());
         }
         else if (evt.getNewState().equals(RegistrationState.EXPIRED))
         {
@@ -268,7 +268,7 @@ else if (evt.getReasonCode() == RegistrationStateChangeEvent
                             .getI18NString("service.gui.ERROR"),
                         msgText).showDialog();
                 }
-                logger.error(evt.getReason());
+                logger.trace(evt.getReason());
             }
         }
     }

File: src/net/java/sip/communicator/impl/protocol/sip/SipStackSharing.java
Patch:
@@ -333,6 +333,7 @@ private void stopListening()
             while(it.hasNext())
             {
                 this.stack.deleteListeningPoint(it.next());
+                it = this.stack.getListeningPoints();
             }
 
             this.stack.stop();

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommLookAndFeel.java
Patch:
@@ -60,7 +60,7 @@ protected void initClassDefaults(UIDefaults table) {
                 "MenuUI", lfPackageName + "SIPCommMenuUI",
                 "ToolBarUI", lfPackageName + "SIPCommToolBarUI",
                 "ToolBarSeparatorUI", lfPackageName + "SIPCommToolBarSeparatorUI",
-                "TabbedPaneUI", lfPackageName + "SIPCommTabbedPaneEnhancedUI",
+                "TabbedPaneUI", "net.java.sip.communicator.util.swing.plaf.SIPCommTabbedPaneEnhancedUI",
                 "ToolTipUI", lfPackageName + "SIPCommToolTipUI",
                 "TextAreaUI", lfPackageName + "SIPCommTextAreaUI",
                 "TextPaneUI", lfPackageName + "SIPCommTextPaneUI",

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -175,13 +175,13 @@ public Iterator getSummary() {
         {
             summaryTable.put(Resources.getString(
                 "plugin.sipaccregwizz.ENABLE_DEFAULT_ENCRYPTION"),
-                Resources.getString("yes"));
+                Resources.getString("service.gui.YES"));
         }
         else
         {
             summaryTable.put(Resources.getString(
                 "plugin.sipaccregwizz.ENABLE_DEFAULT_ENCRYPTION"), 
-                Resources.getString("no"));
+                Resources.getString("service.gui.NO"));
         } 
 
         summaryTable.put(Resources.getString(

File: src/net/java/sip/communicator/plugin/sipaccregwizz/FirstWizardPage.java
Patch:
@@ -7,8 +7,6 @@
 
 import java.awt.*;
 import java.awt.event.*;
-import java.util.*;
-
 import javax.swing.*;
 import javax.swing.event.*;
 
@@ -23,6 +21,7 @@
  * @author Yana Stamcheva
  * @author Damian Minkov
  */
+@SuppressWarnings("serial")
 public class FirstWizardPage
     extends TransparentPanel
     implements WizardPage, DocumentListener, ItemListener

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -303,6 +303,7 @@ private ProtocolProviderService installAccount(
 
         if(isModification)
         {
+            accountProperties.put(ProtocolProviderFactory.USER_ID, userName);
             providerFactory.modifyAccount(  protocolProvider,
                                             accountProperties);
 

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -1001,6 +1001,9 @@ private void selectVideoSize(DataSource videoDS)
     public static Dimension selectVideoSize(DataSource videoDS,
         final int preferredWidth, final int preferredHeight)
     {
+        if(videoDS == null)
+            return null;
+
         FormatControl formatControl =
             (FormatControl) videoDS.getControl(FormatControl.class.getName());
 

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -193,7 +193,8 @@ else if (evt.getNewState().equals(RegistrationState.CONNECTION_FAILED))
             String msgText = GuiActivator.getResources().getI18NString(
                 "service.gui.CONNECTION_FAILED_MSG",
                 new String[]
-                { accountID.getUserID(), accountID.getService() });
+                {   accountID.getUserID(),
+                    accountID.getService() });
 
             int result = new MessageDialog(
                 null,

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolProviderServiceMsnImpl.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.net.*;
 import java.nio.channels.*;
-import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;

File: src/net/java/sip/communicator/impl/systray/StatusMessageMenu.java
Patch:
@@ -11,7 +11,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/gui/customcontrols/MessageDialog.java
Patch:
@@ -35,7 +35,7 @@ public class MessageDialog
     private JButton okButton = new JButton(
         GuiActivator.getResources().getI18NString("service.gui.OK"));
 
-    private JCheckBox doNotAskAgain = new JCheckBox(
+    private JCheckBox doNotAskAgain = new SIPCommCheckBox(
         GuiActivator.getResources()
             .getI18NString("service.gui.DO_NOT_ASK_AGAIN"));
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -54,7 +54,7 @@ public class ChatPanel
 
     private final JSplitPane messagePane = new JSplitPane(JSplitPane.VERTICAL_SPLIT);
 
-    private final JCheckBox sendSmsCheckBox = new JCheckBox(
+    private final JCheckBox sendSmsCheckBox = new SIPCommCheckBox(
         GuiActivator.getResources().getI18NString("service.gui.SEND_AS_SMS"));
 
     private JSplitPane topSplitPane;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -23,7 +23,8 @@
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
-import org.jdesktop.swingworker.*;
+// Java 1.6 has javax.swing.SwingWorker so we have to disambiguate.
+import org.jdesktop.swingworker.SwingWorker;
 import org.osgi.framework.*;
 
 /**

File: src/net/java/sip/communicator/service/gui/UIService.java
Patch:
@@ -330,4 +330,6 @@ public SecurityAuthority getDefaultSecurityAuthority(
      * <code>false</code> otherwise.
      */
     public boolean isContainerSupported(Container containderID);
-}
\ No newline at end of file
+
+    public boolean useMacOSXScreenMenuBar();
+}

File: src/net/java/sip/communicator/impl/growlnotification/GrowlNotificationServiceImpl.java
Patch:
@@ -6,15 +6,15 @@
  */
 package net.java.sip.communicator.impl.growlnotification;
 
-import java.util.*;
+import java.lang.reflect.*;
 
 import org.osgi.framework.*;
+
 import com.growl.*;
+
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
-import java.lang.reflect.*;
-
 
 /**
  * The Growl Notification Service displays on-screen information such as

File: src/net/java/sip/communicator/impl/gui/PopupDialogImpl.java
Patch:
@@ -8,7 +8,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.service.gui.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -25,7 +25,6 @@
 import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.*;
 import net.java.sip.communicator.impl.gui.main.login.*;
 import net.java.sip.communicator.impl.gui.utils.*;
-import net.java.sip.communicator.service.configuration.event.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;

File: src/net/java/sip/communicator/impl/gui/customcontrols/ErrorDialog.java
Patch:
@@ -15,7 +15,6 @@
 
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.lookandfeel.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/gui/customcontrols/SCScrollPane.java
Patch:
@@ -12,7 +12,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 public class SCScrollPane

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/Wizard.java
Patch:
@@ -14,7 +14,6 @@
 import javax.swing.*;
 import javax.swing.border.*;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.swing.*;

File: src/net/java/sip/communicator/impl/gui/event/PluginComponentEvent.java
Patch:
@@ -6,11 +6,9 @@
  */
 package net.java.sip.communicator.impl.gui.event;
 
-import java.awt.*;
 import java.util.*;
 
 import net.java.sip.communicator.service.gui.*;
-import net.java.sip.communicator.service.gui.Container;
 
 /**
  * The <tt>PluginComponentEvent</tt> 

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommButtonUI.java
Patch:
@@ -12,7 +12,6 @@
 import javax.swing.plaf.*;
 import javax.swing.plaf.metal.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommChatSelectorMenuUI.java
Patch:
@@ -13,7 +13,6 @@
 import javax.swing.plaf.basic.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommSelectorMenuUI.java
Patch:
@@ -12,7 +12,6 @@
 import javax.swing.plaf.*;
 import javax.swing.plaf.basic.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommSplitPaneDivider.java
Patch:
@@ -14,7 +14,6 @@
 import javax.swing.plaf.basic.*;
 import javax.swing.plaf.metal.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommTextFieldUI.java
Patch:
@@ -14,7 +14,6 @@
 import javax.swing.text.*;
 
 import net.java.sip.communicator.impl.gui.customcontrols.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommToggleButtonUI.java
Patch:
@@ -12,7 +12,6 @@
 import javax.swing.plaf.*;
 import javax.swing.plaf.basic.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/account/NewAccountDialog.java
Patch:
@@ -12,9 +12,7 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.swing.*;

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -15,7 +15,6 @@
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.swing.*;
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -14,7 +14,6 @@
 
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.utils.*;
-import net.java.sip.communicator.impl.media.keyshare.KeyProviderAlgorithm;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.swing.*;

File: src/net/java/sip/communicator/impl/gui/main/call/MainCallPanel.java
Patch:
@@ -18,7 +18,6 @@
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;

File: src/net/java/sip/communicator/impl/gui/main/call/ReceivedCallDialog.java
Patch:
@@ -14,7 +14,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/SmiliesSelectorBox.java
Patch:
@@ -13,7 +13,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatInviteDialog.java
Patch:
@@ -13,7 +13,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.lookandfeel.*;
 import net.java.sip.communicator.impl.gui.main.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomMemberListPanel.java
Patch:
@@ -4,19 +4,16 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.impl.gui.main.chat.conference;
 
 import java.awt.*;
 import java.awt.event.*;
 
 import javax.swing.*;
-import javax.swing.event.*;
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.*;
-import net.java.sip.communicator.service.contactlist.*;
 
 /**
  * The <tt>ChatContactListPanel</tt> is the panel added on the right of the

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/InvitationReceivedDialog.java
Patch:
@@ -12,7 +12,6 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -17,7 +17,6 @@
 import javax.swing.text.html.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/history/SearchPanel.java
Patch:
@@ -13,7 +13,6 @@
 import javax.swing.event.*;
 
 import net.java.sip.communicator.impl.gui.i18n.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/FileMenu.java
Patch:
@@ -16,7 +16,6 @@
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chatroomslist.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/chat/toolBars/EditTextToolBar.java
Patch:
@@ -16,7 +16,6 @@
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.swing.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/gui/main/chat/toolBars/ExtendedMainToolBar.java
Patch:
@@ -13,13 +13,11 @@
 import javax.swing.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.history.*;
 import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;

File: src/net/java/sip/communicator/impl/gui/main/chat/toolBars/MainToolBar.java
Patch:
@@ -18,7 +18,6 @@
 import net.java.sip.communicator.impl.gui.main.chat.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
 import net.java.sip.communicator.impl.gui.main.chat.history.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomListDialog.java
Patch:
@@ -11,7 +11,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.chatroomslist.createforms.*;

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomWizard.java
Patch:
@@ -9,12 +9,10 @@
 import java.util.*;
 
 import net.java.sip.communicator.impl.gui.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.customcontrols.wizard.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.impl.gui.main.chat.conference.*;
-import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MetaContactTooltip.java
Patch:
@@ -11,7 +11,6 @@
 import javax.swing.*;
 import javax.swing.plaf.metal.*;
 
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameContactDialog.java
Patch:
@@ -11,7 +11,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.service.contactlist.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameGroupDialog.java
Patch:
@@ -11,7 +11,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.service.contactlist.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactWizardExportedWindow.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.gui.main.contactlist.addcontact;
 
-import java.awt.Window;
-
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.service.gui.*;
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactWizardPage2.java
Patch:
@@ -11,7 +11,6 @@
 
 import javax.swing.event.*;
 
-import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/SelectAccountPanel.java
Patch:
@@ -19,7 +19,6 @@
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.account.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.impl.gui.utils.Constants;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.swing.*;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addgroup/CreateGroupDialog.java
Patch:
@@ -11,7 +11,6 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.*;
 import net.java.sip.communicator.service.contactlist.*;

File: src/net/java/sip/communicator/impl/gui/main/menus/HelpMenu.java
Patch:
@@ -8,14 +8,12 @@
 
 import java.awt.*;
 import java.awt.event.*;
-import java.util.*;
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.event.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/main/presence/message/NewStatusMessageDialog.java
Patch:
@@ -11,9 +11,7 @@
 
 import javax.swing.*;
 
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.swing.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/utils/SoundProperties.java
Patch:
@@ -4,11 +4,8 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-
 package net.java.sip.communicator.impl.gui.utils;
 
-import java.util.*;
-
 import net.java.sip.communicator.impl.gui.*;
 
 /**

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/bitpack.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.media.codec.audio.ilbc;
 
-import java.lang.*;
-
 /**
  * @author Jean Lorchat
  */

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/bitstream.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.media.codec.audio.ilbc;
 
-import java.lang.*;
-
 /**
  * @author Jean Lorchat
  */

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/ilbc_common.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.media.codec.audio.ilbc;
 
-import java.lang.*;
-
 /**
  * @author Jean Lorchat
  */

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/ilbc_decoder.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.media.codec.audio.ilbc;
 
-import java.lang.*;
-
 /**
  * @author Jean Lorchat
  */

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/ilbc_encoder.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.media.codec.audio.ilbc;
 
-import java.lang.*;
-
 /**
  * @author Jean Lorchat
  */

File: src/net/java/sip/communicator/impl/media/codec/audio/ilbc/ilbc_ulp.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.media.codec.audio.ilbc;
 
-import java.lang.*;
-
 /**
  * @author Jean Lorchat
  */

File: src/net/java/sip/communicator/impl/media/device/ConfigurationListener.java
Patch:
@@ -6,10 +6,8 @@
  */
 package net.java.sip.communicator.impl.media.device;
 
-import net.java.sip.communicator.service.configuration.event.*;
 import net.java.sip.communicator.util.*;
 
-
 /**
  *
  * @author Martin Andre

File: src/net/java/sip/communicator/impl/media/device/V4LAuto.java
Patch:
@@ -11,11 +11,12 @@
 package net.java.sip.communicator.impl.media.device;
 
 import java.util.*;
+
 import javax.media.*;
 
 import net.java.sip.communicator.util.*;
+
 import com.sun.media.protocol.v4l.*;
-import java.io.*;
 
 /**
  * Probes for video capture devices present on linux systems.

File: src/net/java/sip/communicator/impl/media/keyshare/DummyKeyProvider.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.impl.media.keyshare;
 
-import net.java.sip.communicator.impl.media.transform.srtp.*;
-
 /**
  * DummyProvider class implements KeyProvider interface.
  * Used only for testing - activates the hardcoded keys behaviour for SRTP traffic.

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -14,13 +14,12 @@
 import org.jivesoftware.smackx.jingle.media.*;
 import org.jivesoftware.smackx.jingle.listeners.*;
 import org.jivesoftware.smackx.jingle.nat.*;
+import org.jivesoftware.smackx.packet.DiscoverInfo;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.OperationSetBasicTelephony.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.impl.protocol.jabber.mediamgr.*;
-import org.jivesoftware.smackx.packet.DiscoverInfo;
 
 /**
  * Implements all call management logic and exports basic telephony support by

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/geolocation/GeolocationJabberUtils.java
Patch:
@@ -11,11 +11,8 @@
 import java.util.Map.*;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.jabberconstants.*;
 import net.java.sip.communicator.util.*;
 
-import org.jivesoftware.smack.packet.*;
-
 /**
  * This class give some static methods for converting a geolocation message
  * to a different format.

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/geolocation/GeolocationPresence.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.impl.protocol.jabber.extensions.geolocation;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.jabberconstants.*;
 
 import org.jivesoftware.smack.packet.*;
 import net.java.sip.communicator.impl.protocol.jabber.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/keepalive/KeepAliveEvent.java
Patch:
@@ -8,7 +8,6 @@
 
 import org.jivesoftware.smack.packet.*;
 import org.jivesoftware.smack.util.*;
-import net.java.sip.communicator.impl.protocol.jabber.extensions.*;
 
 /**
  * KeepAlive Event. Events are send on specified interval

File: src/net/java/sip/communicator/impl/protocol/msn/EventManager.java
Patch:
@@ -11,12 +11,12 @@
 import net.sf.jml.*;
 import net.sf.jml.impl.*;
 import net.sf.jml.net.*;
+import net.sf.jml.net.Message;
 import net.sf.jml.protocol.*;
 import net.sf.jml.protocol.incoming.*;
+
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.event.*;
-import net.sf.jml.net.Message;
 
 
 /**

File: src/net/java/sip/communicator/impl/protocol/rss/RssFeedReader.java
Patch:
@@ -6,16 +6,15 @@
  */
 package net.java.sip.communicator.impl.protocol.rss;
 
+import java.io.*;
 import java.net.*;
 import java.util.*;
-import java.text.*;
-import java.io.*;
 
 import com.sun.syndication.feed.synd.*;
 import com.sun.syndication.io.*;
 
-import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.service.protocol.*;
+import net.java.sip.communicator.util.*;
 
 /**
  * Wrapper class for the ROME functionality used in the RSS implementation in

File: src/net/java/sip/communicator/impl/protocol/rss/UriHandlerRssImpl.java
Patch:
@@ -6,15 +6,13 @@
  */
 package net.java.sip.communicator.impl.protocol.rss;
 
-import java.text.*;
 import java.util.*;
 
 import org.osgi.framework.*;
 
 import net.java.sip.communicator.service.argdelegation.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicInstantMessagingSipImpl.java
Patch:
@@ -7,9 +7,9 @@
 package net.java.sip.communicator.impl.protocol.sip;
 
 import java.io.*;
-import java.net.*;
 import java.text.*;
 import java.util.*;
+
 import javax.sip.*;
 import javax.sip.address.*;
 import javax.sip.header.*;

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -12,14 +12,14 @@
 import java.net.*;
 import java.text.*;
 import java.util.*;
+
 import javax.sip.*;
 import javax.sip.address.*;
 import javax.sip.header.*;
 import javax.sip.message.*;
 
 import net.java.sip.communicator.service.media.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.OperationSetSecureTelephony.SecureStatusChangeSource;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -6,11 +6,10 @@
  */
 package net.java.sip.communicator.impl.protocol.sip;
 
-import java.net.*;
-import java.text.*;
-import java.util.*;
 import java.beans.PropertyChangeEvent;
 import java.io.*;
+import java.text.*;
+import java.util.*;
 
 import javax.sip.*;
 import javax.sip.address.*;

File: src/net/java/sip/communicator/impl/protocol/sip/security/CredentialsCacheEntry.java
Patch:
@@ -6,8 +6,8 @@
  */
 package net.java.sip.communicator.impl.protocol.sip.security;
 
-import javax.sip.header.AuthorizationHeader;
 import java.util.Vector;
+
 import net.java.sip.communicator.service.protocol.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/sip/security/SipSecurityManager.java
Patch:
@@ -8,14 +8,13 @@
 
 import java.text.*;
 import java.util.*;
+
 import javax.sip.*;
 import javax.sip.header.*;
 import javax.sip.message.*;
 
-import net.java.sip.communicator.impl.netaddr.*;
 import net.java.sip.communicator.impl.protocol.sip.*;
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/ssh/ContactSSH.java
Patch:
@@ -9,14 +9,12 @@
  * SSH Suport in SIP Communicator - GSoC' 07 Project
  *
  */
-
 package net.java.sip.communicator.impl.protocol.ssh;
 
 import java.io.*;
 import com.jcraft.jsch.*;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.util.*;
 
 /**
  * This interface represents a Contact of SSH Type

File: src/net/java/sip/communicator/impl/protocol/ssh/ContactSSHImpl.java
Patch:
@@ -12,9 +12,10 @@
 package net.java.sip.communicator.impl.protocol.ssh;
 
 import com.jcraft.jsch.*;
+
 import java.io.*;
 import java.util.*;
-import net.java.sip.communicator.impl.protocol.ssh.*;
+
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.Logger;

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHFileTransferDaemon.java
Patch:
@@ -9,15 +9,14 @@
  * SSH Suport in SIP Communicator - GSoC' 07 Project
  *
  */
-
 package net.java.sip.communicator.impl.protocol.ssh;
 
 import java.io.*;
-import javax.swing.*;
+
 import com.jcraft.jsch.*;
 
-import net.java.sip.communicator.util.Logger;
 import net.java.sip.communicator.service.protocol.*;
+import net.java.sip.communicator.util.Logger;
 
 /**
  *

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHReaderDaemon.java
Patch:
@@ -9,11 +9,9 @@
  * SSH Suport in SIP Communicator - GSoC' 07 Project
  *
  */
-
 package net.java.sip.communicator.impl.protocol.ssh;
 
 import java.io.*;
-import javax.swing.*;
 
 import net.java.sip.communicator.util.Logger;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ClientThread.java
Patch:
@@ -8,7 +8,7 @@
 
 import java.io.*;
 import java.net.*;
-import java.util.*;
+
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/systray/jdic/ProviderRegistration.java
Patch:
@@ -8,7 +8,6 @@
 package net.java.sip.communicator.impl.systray.jdic;
 
 import net.java.sip.communicator.impl.systray.*;
-import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 

File: src/net/java/sip/communicator/impl/version/VersionImpl.java
Patch:
@@ -6,10 +6,9 @@
  */
 package net.java.sip.communicator.impl.version;
 
-import java.util.*;
-
-import net.java.sip.communicator.service.version.*;
 import net.java.sip.communicator.service.resources.*;
+import net.java.sip.communicator.service.version.*;
+
 import org.osgi.framework.ServiceReference;
 
 /**

File: src/net/java/sip/communicator/plugin/autoaway/StatusUpdateThread.java
Patch:
@@ -9,8 +9,6 @@
 import java.awt.*;
 import java.util.*;
 
-import javax.swing.text.Position;
-
 import net.java.sip.communicator.service.configuration.ConfigurationService;
 import net.java.sip.communicator.service.protocol.*;
 

File: src/net/java/sip/communicator/plugin/notificationconfiguration/NotificationsTableEntry.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.plugin.notificationconfiguration;
 
-import net.java.sip.communicator.service.notification.event.*;
-
 /**
  * The <tt>NotificationsTableEntry</tt> is a class which defined the different 
  * entry in the utilitary "NotificationConfiguration" JTable. It 

File: src/net/java/sip/communicator/plugin/notificationconfiguration/Resources.java
Patch:
@@ -6,11 +6,8 @@
  */
 package net.java.sip.communicator.plugin.notificationconfiguration;
 
-import java.net.*;
 import java.util.*;
 
-import javax.swing.*;
-
 import net.java.sip.communicator.service.resources.*;
 
 /**

File: src/net/java/sip/communicator/plugin/rssaccregwizz/RssAccountRegistrationWizard.java
Patch:
@@ -10,7 +10,6 @@
 import java.util.*;
 
 import org.osgi.framework.*;
-import net.java.sip.communicator.impl.gui.customcontrols.*;
 
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardSessionManager.java
Patch:
@@ -11,7 +11,6 @@
 
 import net.java.sip.communicator.plugin.whiteboard.gui.*;
 import net.java.sip.communicator.plugin.whiteboard.gui.whiteboardshapes.*;
-import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;

File: src/net/java/sip/communicator/service/protocol/OperationSetSecureTelephony.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.service.protocol;
 
-import net.java.sip.communicator.service.protocol.event.*;
-
 /**
  * An Operation Set defining the encryption operations for telephony.
  *

File: src/net/java/sip/communicator/service/protocol/WhiteboardPoint.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.service.protocol;
 
-import java.awt.geom.*;
-
 /**
  * A point representing a location in {@code (x,y)} coordinate space,
  * specified in integer precision.

File: src/net/java/sip/communicator/service/protocol/event/WhiteboardObjectDeletedEvent.java
Patch:
@@ -9,7 +9,6 @@
 import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.whiteboardobjects.WhiteboardObject;
 
 /**
  * <tt>WhiteboardObjectDeletedEvent</tt> indicates reception of a new

File: src/net/java/sip/communicator/util/IPAddressUtil.java
Patch:
@@ -32,8 +32,6 @@
  */
 package net.java.sip.communicator.util;
 
-import java.net.*;
-
 /**
  * Contains utility methods for work with IPv4 and IPv6 addresses.
  *

File: src/net/java/sip/communicator/util/UtilActivator.java
Patch:
@@ -6,7 +6,6 @@
  */
 package net.java.sip.communicator.util;
 
-import net.java.sip.communicator.plugin.extendedcallhistorysearch.*;
 import net.java.sip.communicator.service.resources.*;
 
 import org.osgi.framework.*;

File: src/net/java/sip/communicator/util/launchutils/SipCommunicatorLock.java
Patch:
@@ -12,7 +12,6 @@
 
 import net.java.sip.communicator.launcher.*;
 import net.java.sip.communicator.util.*;
-import net.java.sip.communicator.util.launchutils.*;
 
 /**
  * This class is used to prevent from running multiple instances of SIP

File: test/net/java/sip/communicator/slick/slickless/SlicklessTests.java
Patch:
@@ -9,9 +9,9 @@
 import java.util.*;
 
 import org.osgi.framework.*;
+
 import junit.framework.*;
-import net.java.sip.communicator.slick.slickless.util.*;
-import net.java.sip.communicator.slick.slickless.util.xml.*;
+
 import net.java.sip.communicator.util.*;
 
 

File: src/net/java/sip/communicator/impl/argdelegation/ArgDelegationActivator.java
Patch:
@@ -7,7 +7,6 @@
 package net.java.sip.communicator.impl.argdelegation;
 
 import net.java.sip.communicator.service.gui.*;
-import net.java.sip.communicator.service.version.*;
 import net.java.sip.communicator.util.launchutils.*;
 
 import org.osgi.framework.*;

File: src/net/java/sip/communicator/impl/argdelegation/ArgDelegationPeerImpl.java
Patch:
@@ -12,11 +12,9 @@
 
 import net.java.sip.communicator.service.argdelegation.*;
 import net.java.sip.communicator.service.gui.*;
-import net.java.sip.communicator.service.version.*;
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.util.launchutils.*;
 
-
 /**
  * Implements the <tt>UriDelegationPeer</tt> interface from our argument handler
  * utility. We use this handler to relay arguments to URI handlers that have
@@ -33,7 +31,7 @@ public class ArgDelegationPeerImpl
     /**
      * The list of uriHandlers that we are currently aware of.
      */
-    private Map<String, UriHandler> uriHandlers
+    private final Map<String, UriHandler> uriHandlers
         = new Hashtable<String, UriHandler>();
 
     /**

File: src/net/java/sip/communicator/impl/audionotifier/AudioNotifierActivator.java
Patch:
@@ -42,7 +42,7 @@ public class AudioNotifierActivator implements BundleActivator
     public void start(BundleContext bundleContext) throws Exception
     {
         try {
-            this.bundleContext = bundleContext;
+            AudioNotifierActivator.bundleContext = bundleContext;
             
             //Create the audio notifier service
             audioNotifier = new AudioNotifierServiceImpl();

File: src/net/java/sip/communicator/impl/audionotifier/SCAudioClipImpl.java
Patch:
@@ -26,7 +26,7 @@ public class SCAudioClipImpl implements SCAudioClip
 {
     private static Constructor acConstructor = null;
     
-    private  Timer playAudioTimer = new Timer(1000, null);
+    private Timer playAudioTimer = new Timer(1000, null);
     
     private AudioClip audioClip;
     

File: src/net/java/sip/communicator/impl/gui/main/account/AccountsConfigurationForm.java
Patch:
@@ -16,7 +16,6 @@
 
 import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
-import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.configuration.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;

File: src/net/java/sip/communicator/service/configuration/ConfigurationService.java
Patch:
@@ -131,7 +131,7 @@ public void removeProperty(String propertyName)
      * @return a <tt>java.util.List</tt>containing all property name String-s
      * matching the specified conditions.
      */
-    public List getPropertyNamesByPrefix(String  prefix,
+    public List<String> getPropertyNamesByPrefix(String  prefix,
                                          boolean exactPrefixMatch);
 
     /**

File: test/net/java/sip/communicator/slick/configuration/TestConfigurationService.java
Patch:
@@ -245,7 +245,7 @@ public void testGetPropertyNamesByPrefix() throws PropertyVetoException
                                          , new Object());
 
         //try an exact match first
-        List propertyNames
+        List<String> propertyNames
             = configurationService.getPropertyNamesByPrefix(prefix, true);
 
         assertTrue("Returned list did not contain all property names. "

File: src/net/java/sip/communicator/impl/gui/main/call/HoldButton.java
Patch:
@@ -10,6 +10,7 @@
 
 import javax.swing.*;
 
+import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.swing.*;
@@ -37,6 +38,8 @@ public HoldButton(CallParticipant callParticipant)
         super(new ImageIcon(ImageLoader.getImage(ImageLoader.HOLD_BUTTON)));
 
         setModel(new HoldButtonModel(callParticipant));
+        setToolTipText(GuiActivator.getResources().getI18NString(
+            "HoldButton_toolTipText"));
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/MuteButton.java
Patch:
@@ -10,6 +10,7 @@
 
 import javax.swing.*;
 
+import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.swing.*;
 
@@ -35,6 +36,8 @@ public MuteButton(CallParticipant callParticipant)
         super(new ImageIcon(ImageLoader.getImage(ImageLoader.MUTE_BUTTON)));
 
         setModel(new MuteButtonModel(callParticipant));
+        setToolTipText(GuiActivator.getResources().getI18NString(
+            "MuteButton_toolTipText"));
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallButton.java
Patch:
@@ -53,6 +53,8 @@ public TransferCallButton(CallParticipant callParticipant)
 
         this.callParticipant = callParticipant;
 
+        setToolTipText(GuiActivator.getResources().getI18NString(
+            "TransferCallButton_toolTipText"));
         addActionListener(new ActionListener()
         {
 

File: src/net/java/sip/communicator/impl/gui/main/menus/MainMenu.java
Patch:
@@ -65,15 +65,12 @@ private void init()
     {
         fileMenu.setText(fileString.getText());
         fileMenu.setMnemonic(fileString.getMnemonic());
-        fileMenu.setToolTipText(fileString.getText());
 
         toolsMenu.setText(toolsString.getText());
         toolsMenu.setMnemonic(toolsString.getMnemonic());
-        toolsMenu.setToolTipText(toolsString.getText());
 
         helpMenu.setText(helpString.getText());
         helpMenu.setMnemonic(helpString.getMnemonic());
-        helpMenu.setToolTipText(helpString.getText());
 
         this.fileMenu.setOpaque(false);
         this.toolsMenu.setOpaque(false);

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHContactInfo.java
Patch:
@@ -83,7 +83,8 @@ class SSHContactInfo extends SIPCommDialog
      * @param sshContact the concerned contact
      */
     public SSHContactInfo(ContactSSH sshContact) {
-        super(new JFrame(), true);
+        super(true);
+
         this.sshContact = sshContact;
         initForm();
         

File: src/net/java/sip/communicator/plugin/contactinfo/ContactInfoContactPanel.java
Patch:
@@ -1,10 +1,9 @@
-package net.java.sip.communicator.plugin.contactinfo;
-
 /*
  * SIP Communicator, the OpenSource Java VoIP and Instant Messaging client.
  * 
  * Distributable under LGPL license. See terms of license at gnu.org.
  */
+package net.java.sip.communicator.plugin.contactinfo;
 
 import java.awt.*;
 import java.util.*;
@@ -13,6 +12,7 @@
 import javax.swing.event.*;
 
 import net.java.sip.communicator.service.protocol.*;
+import net.java.sip.communicator.swing.*;
 
 /**
  * The left side panel of ContactInfoDialog. Display all associated subcontacts
@@ -23,7 +23,7 @@
  * @author Yana Stamcheva
  */
 public class ContactInfoContactPanel
-    extends JPanel
+    extends TransparentPanel
 {
     /**
      * The list of all subcontacts related to the selected contact.

File: src/net/java/sip/communicator/impl/gui/main/account/AccountsConfigurationForm.java
Patch:
@@ -272,7 +272,7 @@ public void actionPerformed(ActionEvent e)
                         JOptionPane.showConfirmDialog(this, Messages
                             .getI18NString("removeAccountMessage").getText(),
                             Messages.getI18NString("removeAccount").getText(),
-                            JOptionPane.YES_NO_CANCEL_OPTION);
+                            JOptionPane.YES_NO_OPTION);
 
                     if (result == JOptionPane.YES_OPTION)
                     {

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1754,8 +1754,9 @@ private void initRegistrarConnection(SipAccountID accountID)
         {
             String userID = (String) accountID.getAccountProperties()
                 .get(ProtocolProviderFactory.USER_ID);
-            if ( userID.indexOf("@") > -1 )
-                registrarAddressStr = userID.substring( userID.indexOf("@")+1);
+            int index = userID.indexOf("@");
+            if ( index > -1 )
+                registrarAddressStr = userID.substring( index+1);
         }
 
         //if we still have no registrar address or if the registrar address

File: src/net/java/sip/communicator/plugin/sipaccregwizz/FirstWizardPage.java
Patch:
@@ -557,7 +557,8 @@ public void loadAccount(ProtocolProviderService protocolProvider)
                 .get("KEEP_ALIVE_INTERVAL");
 
         uinField.setEnabled(false);
-        this.uinField.setText(accountID.getUserID() + "@" + serverAddress);
+        this.uinField.setText((serverAddress == null) ? accountID.getUserID()
+            : (accountID.getUserID() + "@" + serverAddress));
 
         if (password != null)
         {

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -135,7 +135,8 @@ public void windowClosing(WindowEvent event)
         this.initTitleFont();
 
         ResourceManagementService resources = GuiActivator.getResources();
-        String applicationName = resources.getSettingsString("applicationName");
+        String applicationName
+            = resources.getSettingsString("service.gui.APPLICATION_NAME");
 
         this.setTitle(applicationName);
 

File: src/net/java/sip/communicator/impl/gui/main/call/FullScreenLayout.java
Patch:
@@ -8,6 +8,9 @@
 
 import java.awt.*;
 
+/**
+ * @author Lubomir Marinov
+ */
 public class FullScreenLayout implements LayoutManager
 {
     public static final String CENTER = "CENTER";

File: src/net/java/sip/communicator/impl/media/MediaConfigurationPanel.java
Patch:
@@ -289,7 +289,7 @@ public void controllerUpdate(ControllerEvent event)
 
     private Component createPreview(int type, final JComboBox comboBox)
     {
-        final JComponent preview;
+        final Container preview;
         if (type == DeviceConfigurationComboBoxModel.VIDEO)
         {
             JLabel noPreview =
@@ -322,7 +322,7 @@ public void actionPerformed(ActionEvent event)
         return preview;
     }
 
-    private JComponent createVideoContainer(Component noVideoComponent)
+    private Container createVideoContainer(Component noVideoComponent)
     {
         return new VideoContainer(noVideoComponent);
     }

File: src/net/java/sip/communicator/swing/VideoContainer.java
Patch:
@@ -72,7 +72,7 @@ public void componentRemoved(ContainerEvent event)
 
     public VideoContainer(Component noVideoComponent)
     {
-        super(new VideoLayout());
+        setLayout(new VideoLayout());
 
         this.noVideoComponent = noVideoComponent;
 

File: src/net/java/sip/communicator/impl/media/codec/video/h264/Packetizer.java
Patch:
@@ -94,6 +94,8 @@ public Format setInputFormat(Format in)
         if (!(in instanceof VideoFormat) || null == matches(in, inputFormats))
             return null;
 
+        inputFormat = in;
+
         return in;
     }
 

File: src/net/java/sip/communicator/impl/media/codec/EncodingConfiguration.java
Patch:
@@ -361,12 +361,12 @@ public void registerCustomPackages()
 
     public String[] getAvailableVideoEncodings()
     {
-        return availableAudioEncodings;
+        return availableVideoEncodings;
     }
 
     public String[] getAvailableAudioEncodings()
     {
-        return availableVideoEncodings;
+        return availableAudioEncodings;
     }
 
     public String[] getSupportedVideoEncodings()

File: src/net/java/sip/communicator/impl/msghistory/MessageHistoryServiceImpl.java
Patch:
@@ -12,7 +12,6 @@
 import org.osgi.framework.*;
 
 import net.java.sip.communicator.service.configuration.*;
-import net.java.sip.communicator.service.configuration.event.*;
 import net.java.sip.communicator.service.resources.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.history.*;

File: src/net/java/sip/communicator/impl/media/MediaServiceImpl.java
Patch:
@@ -406,7 +406,6 @@ public void run()
                 try
                 {
                     deviceConfiguration.initialize();
-                    encodingConfiguration.initialize();
                     defaultMediaControl.
                         initialize(deviceConfiguration, encodingConfiguration);
                     sdpFactory = SdpFactory.getInstance();

File: src/net/java/sip/communicator/plugin/dictaccregwizz/ThreadManager.java
Patch:
@@ -91,8 +91,7 @@ public boolean waitThread()
     /**
      * Thread used to search the strategies
      * 
-     * @author ROTH Damien
-     * @author LITZELMANN Cédric
+     * @author ROTH Damien, LITZELMANN Cedric
      */
     class StrategyThread
         extends Thread

File: src/net/java/sip/communicator/impl/media/codec/Constants.java
Patch:
@@ -27,4 +27,7 @@ public class Constants
      * 30 - 30 ms
      */
     public static int ILBC_MODE = 30;
+
+    public static int VIDEO_WIDTH = 352;
+    public static int VIDEO_HEIGHT = 288;
 }

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommMenuBarUI.java
Patch:
@@ -29,6 +29,5 @@ protected void installDefaults()
         super.installDefaults();
 
         LookAndFeel.installProperty(menuBar, "opaque", Boolean.FALSE);
-        LookAndFeel.installBorder(menuBar, null);
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ChatRoomSubjectPanel.java
Patch:
@@ -14,6 +14,7 @@
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.chat.*;
+import net.java.sip.communicator.impl.gui.main.chatroomslist.*;
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatManager.java
Patch:
@@ -24,7 +24,7 @@
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;
 
-import org.jdesktop.swingworker.*;
+import org.jdesktop.swingworker.SwingWorker;
 import org.osgi.framework.*;
 
 /**

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomConfigurationWindow.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
-package net.java.sip.communicator.impl.gui.main.chat.conference;
+package net.java.sip.communicator.impl.gui.main.chatroomslist;
 
 import java.awt.*;
 import java.awt.event.*;

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -636,7 +636,6 @@ private void calculateSupportedEncodings()
                     }
                     else if (format instanceof VideoFormat)
                     {
-System.out.println("format " + format + "/" + encoding + "/" + sdp);                        
                         if (!transmittableVideoEncodings.contains(sdp))
                         {
                             if (logger.isDebugEnabled())

File: src/net/java/sip/communicator/impl/media/codec/video/h264/NativeEncoder.java
Patch:
@@ -385,8 +385,8 @@ public synchronized void open() throws ResourceUnavailableException
             
             avcontext.qcompress = 1;
             
-            //int _bitRate = 267000;
-            //avcontext.bit_rate = (_bitRate * 3) >> 2; // average bit rate
+            int _bitRate = 267000;
+            avcontext.bit_rate = (_bitRate * 3) >> 2; // average bit rate
             
             AVUTIL.av_log_set_callback(new AVUtilLibrary.LogCallback(){
 

File: src/net/java/sip/communicator/impl/protocol/dict/DictException.java
Patch:
@@ -146,16 +146,16 @@ public String getErrorMessage()
             result = "optional timing";
             break;
         case 220 :
-            result = "Connexion OK";
+            result = "Connection OK";
             break;
         case 221 :
             result = "Closing Connection";
             break;
         case 230 :
-            result = "Authentification successful";
+            result = "Authentication successful";
             break;
         case 250 :
-            result = "Ok";
+            result = "OK";
             break;
         case 330 :
             result = "send response";

File: src/net/java/sip/communicator/plugin/simpleaccreg/InitialAccountRegistrationFrame.java
Patch:
@@ -87,8 +87,8 @@ public InitialAccountRegistrationFrame()
         signinButton.addActionListener(actionListener);
         cancelButton.addActionListener(actionListener);
 
-        buttonPanel.add(cancelButton);
         buttonPanel.add(signinButton);
+        buttonPanel.add(cancelButton);
 
         messageArea.setLineWrap(true);
         messageArea.setWrapStyleWord(true);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -751,9 +751,9 @@ private String processSmilies(String message, String contentType)
         {
             String matchGroup = m.group().trim();
 
-            String replacement = endPlainTextTag + "<IMG SRC='"
-                + ImageLoader.getSmiley(matchGroup).getImagePath() + "' ALT='"
-                + matchGroup + "'></IMG>" + startPlainTextTag;
+            String replacement = endPlainTextTag + "<IMG SRC=\""
+                + ImageLoader.getSmiley(matchGroup).getImagePath() + "\" ALT=\""
+                + matchGroup + "\"></IMG>" + startPlainTextTag;
 
             m.appendReplacement(msgBuffer, GuiUtils
                 .replaceSpecialRegExpChars(replacement));

File: src/net/java/sip/communicator/impl/gui/main/presence/AccountStatusPanel.java
Patch:
@@ -22,8 +22,6 @@ public class AccountStatusPanel
     extends JPanel
     implements RegistrationStateChangeListener
 {
-    private Logger logger = Logger.getLogger(AccountStatusPanel.class);
-
     private static final int AVATAR_ICON_HEIGHT = 45;
 
     private static final int AVATAR_ICON_WIDTH = 45;

File: src/net/java/sip/communicator/util/ImageUtils.java
Patch:
@@ -120,7 +120,7 @@ public static ImageIcon getScaledRoundedImage(  byte[] imageBytes,
         }
         catch (Exception e)
         {
-            logger.error("Could not create image.", e);
+            logger.debug("Could not create image.", e);
         }
 
         return imageIcon;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -746,7 +746,8 @@ public void mousePressed(MouseEvent e)
 
         int translatedX = e.getX() - selectedCellPoint.x;
 
-        if (selectedValue instanceof MetaContact)
+        if (selectedValue instanceof MetaContact
+            && (e.getModifiers() & InputEvent.BUTTON1_MASK) != 0)
         {
             MetaContact mContact = (MetaContact) selectedValue;
 

File: src/net/java/sip/communicator/plugin/simpleaccreg/InitialAccountRegistrationFrame.java
Patch:
@@ -87,8 +87,8 @@ public InitialAccountRegistrationFrame()
         signinButton.addActionListener(actionListener);
         cancelButton.addActionListener(actionListener);
 
-        buttonPanel.add(cancelButton);
         buttonPanel.add(signinButton);
+        buttonPanel.add(cancelButton);
 
         messageArea.setLineWrap(true);
         messageArea.setWrapStyleWord(true);

File: src/net/java/sip/communicator/plugin/generalconfig/GeneralConfigurationForm.java
Patch:
@@ -70,7 +70,9 @@ private void initGUI()
                 mainPanel.add(autoStartCheckBox);
                 mainPanel.add(Box.createVerticalStrut(10));
                 autoStartCheckBox.setText(
-                    Resources.getString("autoStartOption"));
+                    Resources.getString("autoStartOption",
+                        new String[]{
+                            Resources.getSettingsString("applicationName")}));
                 initAutoStartCheckBox();
                 autoStartCheckBox.addActionListener(this);
             }

File: src/net/java/sip/communicator/impl/media/MediaUtils.java
Patch:
@@ -159,8 +159,8 @@ public static int jmfToSdpEncoding(String jmfEncoding) {
      * codes.
      * @return a list of strings representing JMF compatible encoding names.
      */
-    public static List sdpToJmfEncodings(List sdpEncodings) {
-        ArrayList jmfEncodings = new ArrayList();
+    public static List<String> sdpToJmfEncodings(List sdpEncodings) {
+        ArrayList<String> jmfEncodings = new ArrayList<String>();
 
         if (sdpEncodings == null) {
             return jmfEncodings;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -212,7 +212,7 @@ private CallJabberImpl createOutgoingCall(String calleeAddress)
         {
             throw new OperationFailedException(
                     "Failed to create OutgoingJingleSession.\n"
-                    + "user " + calleeAddress + " is unknwon to us."
+                    + "User " + calleeAddress + " is unknown to us."
                     , OperationFailedException.INTERNAL_ERROR);
         }
 
@@ -241,7 +241,7 @@ private CallJabberImpl createOutgoingCall(String calleeAddress)
         }
         catch (XMPPException ex)
         {
-            logger.warn("could not retrieves info for " + fullCalleeURI, ex);
+            logger.warn("could not retrieve info for " + fullCalleeURI, ex);
         }
 
         try
@@ -419,7 +419,7 @@ public void sessionRequested(JingleSessionRequest jingleSessionRequest)
         }
         catch (XMPPException ex)
         {
-            logger.error("Failed to accept inoming jingle request : " + ex);
+            logger.error("Failed to accept incoming jingle request : " + ex);
             return;
         }
 

File: src/net/java/sip/communicator/impl/protocol/rss/RssFeedReader.java
Patch:
@@ -143,12 +143,12 @@ private void retrieveFlow()
         this.items = (SyndEntry[]) this.feed.getEntries().toArray(new SyndEntry[0]);
         Arrays.sort(items, new SyndEntryComparator());
 
-        for(int i=0; i < items.length; ++i)
+        /*for(int i=0; i < items.length; ++i)
         {
             System.out.println("CHENZO item_list[" + i + "] URI: " + items[i].getUri()
                     + ", Date: " + items[i].getUpdatedDate() + ", Title: " +
                     items[i].getTitle());
-        }
+        }*/
         
         /*if (items.length == 0)
         {

File: src/net/java/sip/communicator/impl/protocol/rss/ImageRetriever.java
Patch:
@@ -174,7 +174,7 @@ private String findFavIconFromSiteIndex(ContactRssImpl contact)
     {
         try
         {
-            URL feedLocation = contact.getRssURL();
+            URL feedLocation = new URL(contact.getRssFeedReader().getURL());
 
             URL siteIndex = new URL(feedLocation.getProtocol() + "://"
                             + feedLocation.getHost());
@@ -261,10 +261,10 @@ private byte[] getFavIconFromSiteRoot(ContactRssImpl contact)
         ByteArrayOutputStream output = new ByteArrayOutputStream();
         byte[] result = null;
 
-        URL feedLocation = contact.getRssURL();
-
         try
         {
+            URL feedLocation = new URL(contact.getRssFeedReader().getURL());
+
             URL location = new URL(feedLocation.getProtocol() + "://"
                             + feedLocation.getHost() + "/favicon.ico");
 

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -2003,7 +2003,7 @@ private void initializeRtpManager(RTPManager rtpManager,
                 // in the call panel that appears once the call has started
                 if (usingSRTP)
                 {
-                    if (!engine.initialize("my_zid.zid"))
+                    if (!engine.initialize("GNUZRTP4J.zid"))
                         engine.sendInfo(ZrtpCodes.MessageSeverity.Info,
                                     EnumSet.of(ZRTPCustomInfoCodes.ZRTPEngineInitFailure));
 
@@ -2707,7 +2707,7 @@ public void ZRTPChangeStatus(RTPManager manager, SecureEvent event)
                 {
                     logger.trace("Normal call securing event processing");
 
-                    if (!engine.initialize("my_zid.zid"))
+                    if (!engine.initialize("GNUZRTP4J.zid"))
                         engine.sendInfo(ZrtpCodes.MessageSeverity.Info,
                                         EnumSet.of(ZRTPCustomInfoCodes.ZRTPEngineInitFailure));
                 }

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -686,7 +686,7 @@ protected void initialize(String    sipAddress,
             // init ZRTP (OperationSetBasicTelephonySipImpl implements 
             // OperationSetSecureTelephony)
             this.supportedOperationSets.put(
-                OperationSetSecuredTelephony.class.getName()
+                OperationSetSecureTelephony.class.getName()
                 , opSetAdvancedTelephony);
 
             //init presence op set.

File: src/net/java/sip/communicator/service/media/CallSession.java
Patch:
@@ -200,7 +200,7 @@ public void processSdpAnswer(CallParticipant responder, String sdpAnswer)
      * @param source the initiator of the secure status change (can be local or remote)
      */
     public void setSecureCommunicationStatus(boolean activator, 
-                                             OperationSetSecuredTelephony.
+                                             OperationSetSecureTelephony.
                                              SecureStatusChangeSource source);
 
     /**

File: src/net/java/sip/communicator/service/protocol/SecureEvent.java
Patch:
@@ -41,7 +41,7 @@ public class SecureEvent
     /**
      * The source that triggered the event - local or remote peer
      */
-    private OperationSetSecuredTelephony.SecureStatusChangeSource source;
+    private OperationSetSecureTelephony.SecureStatusChangeSource source;
     
     /**
      * The event constructor
@@ -51,7 +51,7 @@ public class SecureEvent
      */
     public SecureEvent(CallSessionImpl callSession, 
     				   int eventID, 
-    				   OperationSetSecuredTelephony.SecureStatusChangeSource source)
+    				   OperationSetSecureTelephony.SecureStatusChangeSource source)
     {
         super(callSession);
         this.eventID = eventID;
@@ -72,7 +72,7 @@ public int getEventID()
      * Retrieves the source that triggered the event
      * (change by local peer or remote peer or reverting a previous change)
      */
-    public OperationSetSecuredTelephony.SecureStatusChangeSource getSource()
+    public OperationSetSecureTelephony.SecureStatusChangeSource getSource()
     {
     	return source;
     }

File: src/net/java/sip/communicator/plugin/sipaccregwizz/FirstWizardPage.java
Patch:
@@ -28,7 +28,7 @@ public class FirstWizardPage
 {
     public static final String FIRST_PAGE_IDENTIFIER = "FirstPageIdentifier";
 
-    public static final String USER_NAME_EXAMPLE = "Ex: john@voiphone.net or simply \"john' for no server";
+    public static final String USER_NAME_EXAMPLE = "Ex: john@voiphone.net or simply \"john\" for no server";
 
     private JPanel firstTabPanel = new JPanel(new BorderLayout());
 

File: src/net/java/sip/communicator/impl/gui/main/call/DialPanel.java
Patch:
@@ -388,8 +388,6 @@ else if (buttonName.equals("star"))
 
         if(dtmfTone != null)
             this.sendDtmfTone(dtmfTone);
-        else
-            this.parentCallPanel.requestFocusInPhoneCombo();
     }
     
     private class DialButton extends SIPCommButton

File: src/net/java/sip/communicator/impl/gui/main/call/MainCallPanel.java
Patch:
@@ -201,7 +201,6 @@ else if (buttonName.equals(DIAL_BUTTON))
                         - dialpadDialog.getHeight());
 
                 dialpadDialog.setVisible(true);
-                dialpadDialog.requestFocus();
             }
             else
             {

File: src/net/java/sip/communicator/plugin/sipaccregwizz/FirstWizardPage.java
Patch:
@@ -89,7 +89,7 @@ public class FirstWizardPage
         = new JTextField(SIPAccountRegistration.DEFAULT_PORT);
 
     private JComboBox transportCombo = new JComboBox(new Object[]
-    { "UDP", "TLS", "TCP" });
+    { "UDP", "TCP", "TLS" });
 
     private JPanel presenceOpPanel = new JPanel(new BorderLayout(10, 10));
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallDialog.java
Patch:
@@ -134,6 +134,7 @@ else if (buttonName.equals(DIAL_BUTTON))
                     getLocationOnScreen().y + getHeight());
 
                 dialpadDialog.setVisible(true);
+                dialpadDialog.requestFocus();
             }
             else
             {

File: src/net/java/sip/communicator/impl/media/transform/srtp/SRTPCipherCTR.java
Patch:
@@ -62,8 +62,8 @@ public class SRTPCipherCTR
      * 
      * @param aesCipher the AESCihper object we use to do basic AES encryption / decryption
      * @param data byte array containing the byte stream to be processed
-     * @param offset byte stream star offset with data byte array
-     * @param length byte stream length in bytes
+     * @param off byte stream star offset with data byte array
+     * @param len byte stream length in bytes
      * @param iv initial vector for this operation
      */
     public static void process(Cipher aesCipher, byte[] data, int off, int len, byte[] iv)

File: src/net/java/sip/communicator/impl/media/transform/srtp/SRTPCipherF8.java
Patch:
@@ -81,8 +81,8 @@ class F8Context
      * 
      * @param aesCipher the AES cipher object used for block processing 
      * @param data byte array containing the byte stream to be processed
-     * @param offset byte stream star offset with data byte array
-     * @param length byte stream length in bytes
+     * @param off byte stream star offset with data byte array
+     * @param len byte stream length in bytes
      * @param iv initial vector for this operation
      * @param key the encryption key
      * @param salt the salt key

File: src/net/java/sip/communicator/impl/media/transform/zrtp/ZrtpRawPacket.java
Patch:
@@ -151,8 +151,8 @@ protected int getSSRC()
 
     /**
      * Check if the CRC of this packet is ok.
-     * @param crc
-     * @return
+     *
+     * @return true if the CRC is valid, false otherwise
      */
     protected boolean checkCrc() 
     {
@@ -162,7 +162,6 @@ protected boolean checkCrc()
 
     /**
      * Set ZRTP CRC in this packet
-     * @param crc
      */
     protected void setCrc() 
     {

File: src/net/java/sip/communicator/impl/protocol/mock/MockOperationSetBasicTelephony.java
Patch:
@@ -236,6 +236,7 @@ public void callStateChanged(CallChangeEvent evt)
      * (non-Javadoc)
      * @see net.java.sip.communicator.service.protocol.OperationSetBasicTelephony#setSecured(net.java.sip.communicator.service.protocol.CallParticipant, boolean, net.java.sip.communicator.service.media.CallSession.SecureStatusChangeSource)
      */
+    @Override
     public void setSecured(CallParticipant participant, boolean secured,
                            OperationSetBasicTelephony.SecureStatusChangeSource source)
     {
@@ -245,7 +246,8 @@ public void setSecured(CallParticipant participant, boolean secured,
      * (non-Javadoc)
      * @see net.java.sip.communicator.service.protocol.OperationSetBasicTelephony#getSecured(net.java.sip.communicator.service.protocol.CallParticipant)
      */
-    public boolean getSecured(CallParticipant participant)
+    @Override
+    public boolean isSecured(CallParticipant participant)
     {
         return false;
     }

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -2963,7 +2963,7 @@ public void setMute(CallParticipant participant, boolean mute)
         ((CallSipImpl) participant.getCall()).getMediaCallSession().setMute(
             mute);
     }
-    
+
     /*
      * (non-Javadoc)
      * @see net.java.sip.communicator.service.protocol.OperationSetBasicTelephony#setSecured(net.java.sip.communicator.service.protocol.CallParticipant, boolean, net.java.sip.communicator.service.media.CallSession.SecureStatusChangeSource)
@@ -2979,7 +2979,7 @@ public void setSecured(CallParticipant participant, boolean secured,
      * (non-Javadoc)
      * @see net.java.sip.communicator.service.protocol.OperationSetBasicTelephony#getSecured(net.java.sip.communicator.service.protocol.CallParticipant)
      */
-    public boolean getSecured(CallParticipant participant)
+    public boolean isSecured(CallParticipant participant)
     {
         return ((CallSipImpl) participant.getCall()).getMediaCallSession().
                 getSecureCommunicationStatus();

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -2555,7 +2555,7 @@ private boolean sayBye(CallParticipantSipImpl callParticipant)
             ArrayList viaHeaders =
                 protocolProvider.getLocalViaHeaders(destinationInetAddress,
                     protocolProvider.getRegistrarConnection()
-                        .getRegistrarListeningPoint());
+                        .getListeningPoint());
             bye.setHeader((ViaHeader) viaHeaders.get(0));
             bye.addHeader(protocolProvider.getSipCommUserAgentHeader());
         }

File: src/net/java/sip/communicator/impl/protocol/sip/SipRegistrarlessConnection.java
Patch:
@@ -154,7 +154,7 @@ public InetAddress getRegistrarAddress()
      * current registrar.
      */
     @Override
-    public ListeningPoint getRegistrarListeningPoint()
+    public ListeningPoint getListeningPoint()
     {
         return sipProvider.getDefaultListeningPoint();
     }

File: src/net/java/sip/communicator/service/protocol/OperationSetBasicTelephony.java
Patch:
@@ -166,5 +166,5 @@ public void setSecured(CallParticipant participant, boolean secured,
      * @param participant the participant for who the call state is required
      * @return the call state
      */
-    public boolean getSecured(CallParticipant participant);
+    public boolean isSecured(CallParticipant participant);
 }

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -601,7 +601,7 @@ protected abstract AccountID createAccountID(String userID,
      *         <code>ProtocolProviderService</code>s with and to be placed in
      *         the properties of the accounts created by this factory
      */
-    protected String getProtocolName()
+    public String getProtocolName()
     {
         return protocolName;
     }

File: test/net/java/sip/communicator/slick/protocol/gibberish/TestAccountUninstallationPersistence.java
Patch:
@@ -64,7 +64,8 @@ public void testAccountUninstallationPersistence()
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            GibberishSlickFixture.bc, providerBundle, "Gibberish");
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/icq/TestAccountUninstallation.java
Patch:
@@ -217,7 +217,8 @@ public void testInstallationPersistency()
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            IcqSlickFixture.bc, providerBundle, ProtocolNames.ICQ);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/icq/TestAccountUninstallationPersistence.java
Patch:
@@ -63,7 +63,8 @@ public void testAccountUninstallationPersistency()
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            IcqSlickFixture.bc, providerBundle, ProtocolNames.ICQ);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/jabber/TestAccountUninstallation.java
Patch:
@@ -151,7 +151,8 @@ public void testInstallationPersistency() throws Exception
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            JabberSlickFixture.bc, providerBundle, ProtocolNames.JABBER);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/jabber/TestAccountUninstallationPersistence.java
Patch:
@@ -63,7 +63,8 @@ public void testAccountUninstallationPersistence()
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            JabberSlickFixture.bc, providerBundle, ProtocolNames.JABBER);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/msn/TestAccountUninstallation.java
Patch:
@@ -151,7 +151,8 @@ public void testInstallationPersistency() throws Exception
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(fixture.bc,
+            providerBundle, ProtocolNames.MSN);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/msn/TestAccountUninstallationPersistence.java
Patch:
@@ -63,7 +63,8 @@ public void testAccountUninstallationPersistence()
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            MsnSlickFixture.bc, providerBundle, ProtocolNames.MSN);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/rss/TestAccountUninstallation.java
Patch:
@@ -132,7 +132,9 @@ public void testInstallationPersistence() throws Exception
     	assertTrue("Couldn't reinstall provider bundle",
     		providerBundle.getState() == Bundle.INSTALLED);
     	
-    	providerBundle.start();
+
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(fixture.bc,
+            providerBundle, ProtocolNames.RSS);
     	assertTrue("Couldn't start provider",
     		providerBundle.getState() == Bundle.ACTIVE);
     	

File: test/net/java/sip/communicator/slick/protocol/rss/TestAccountUninstallationPersistence.java
Patch:
@@ -59,8 +59,9 @@ public void testAccountUninstallationPersistence()
     		providerBundle.getLocation());
     	assertEquals("Couldn't reinstall protocol provider bundle.",
     		providerBundle.getState(), Bundle.INSTALLED);
-    	
-    	providerBundle.start();
+
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            RssSlickFixture.bc, providerBundle, ProtocolNames.RSS);
     	assertEquals("Couldn't restart protocol provider bundle.",
     		providerBundle.getState(), Bundle.ACTIVE);
     	

File: test/net/java/sip/communicator/slick/protocol/sip/TestAccountUninstallation.java
Patch:
@@ -202,7 +202,8 @@ public void testInstallationPersistency() throws Exception
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(fixture.bc,
+            providerBundle, ProtocolNames.SIP);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/sip/TestAccountUninstallationPersistence.java
Patch:
@@ -63,7 +63,8 @@ public void testAccountUninstallationPersistence()
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            SipSlickFixture.bc, providerBundle, ProtocolNames.SIP);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestAccountUninstallation.java
Patch:
@@ -151,7 +151,8 @@ public void testInstallationPersistency() throws Exception
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(fixture.bc,
+            providerBundle, ProtocolNames.YAHOO);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestAccountUninstallationPersistence.java
Patch:
@@ -63,7 +63,8 @@ public void testAccountUninstallationPersistence()
         assertEquals("Couldn't re-install protocol provider bundle."
                      , Bundle.INSTALLED, providerBundle.getState());
 
-        providerBundle.start();
+        AccountManagerUtils.startBundleAndWaitStoredAccountsLoaded(
+            YahooSlickFixture.bc, providerBundle, ProtocolNames.YAHOO);
         assertEquals("Couldn't re-start protocol provider bundle."
                      , Bundle.ACTIVE, providerBundle.getState());
 

File: src/net/java/sip/communicator/impl/gui/main/call/DialpadDialog.java
Patch:
@@ -115,6 +115,6 @@ public void focusGained(FocusEvent e)
 
     public void focusLost(FocusEvent e)
     {
-        this.dispose();
+        this.setVisible(false);
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/call/MainCallPanel.java
Patch:
@@ -201,6 +201,7 @@ else if (buttonName.equals(DIAL_BUTTON))
                         - dialpadDialog.getHeight());
 
                 dialpadDialog.setVisible(true);
+                dialpadDialog.requestFocus();
             }
             else
             {

File: src/net/java/sip/communicator/impl/gui/main/chat/toolBars/ExtendedMainToolBar.java
Patch:
@@ -111,7 +111,7 @@ public ExtendedMainToolBar(ChatWindow messageWindow)
 
         this.setRollover(true);
         this.setLayout(new FlowLayout(FlowLayout.LEFT, 0, 0));
-        this.setPreferredSize(new Dimension(300, DEFAULT_BUTTON_HEIGHT));
+        this.setPreferredSize(new Dimension(300, DEFAULT_BUTTON_HEIGHT + 5));
 
 //        this.setBorder(BorderFactory.createEmptyBorder(2, 2, 5, 2));
 

File: src/net/java/sip/communicator/impl/gui/main/menus/ExtendedQuickMenu.java
Patch:
@@ -117,8 +117,8 @@ public ExtendedQuickMenu(MainFrame mainFrame)
 
         this.toolBar.setFloatable(true);
 
-        this.setMinimumSize(new Dimension(650, 40));
-        this.setPreferredSize(new Dimension(650, 40));
+        this.setMinimumSize(new Dimension(650, DEFAULT_BUTTON_HEIGHT + 5));
+        this.setPreferredSize(new Dimension(650, DEFAULT_BUTTON_HEIGHT + 5));
 
         this.infoButton.setPreferredSize(
             new Dimension(DEFAULT_BUTTON_WIDTH, DEFAULT_BUTTON_HEIGHT));

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -173,9 +173,8 @@ private void init()
         JPanel menusPanel = new JPanel(new BorderLayout());
 
         String osName = System.getProperty("os.name");
-        if (osName.startsWith("Mac"))
-        // this.setJMenuBar(menu);
-        // menusPanel.add(menu, BorderLayout.CENTER);
+
+        this.setJMenuBar(menu);
 
         menusPanel.add(quickMenu, BorderLayout.SOUTH);
 

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -485,7 +485,7 @@ private void updateGlobalStatus()
         Iterator pProviders = mainFrame.getProtocolProviders();
 
         boolean isProtocolHidden;
-System.out.println("PROTOCOL PROVIDERRRSSSSSSSSSSSSSSSSSSS ============" + pProviders.hasNext());
+
         while (pProviders.hasNext())
         {
             ProtocolProviderService protocolProvider

File: src/net/java/sip/communicator/util/launchutils/SipCommunicatorLock.java
Patch:
@@ -153,7 +153,7 @@ public int tryLock(String[] args)
         }
         catch (IOException e)
         {
-            logger.error("Failed to create lock file", e);
+            logger.error("Failed to create lock file" + lockFile, e);
         }
 
         lockFile.deleteOnExit();
@@ -734,9 +734,9 @@ public void run()
             int argCount = 1024;
             try
             {
-                BufferedReader lineReader = 
+                BufferedReader lineReader =
                     new BufferedReader(new InputStreamReader(is));
-                
+
                 while (true)
                 {
                     String line = lineReader.readLine();

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -1293,11 +1293,13 @@ public void notifyMsnObjectRetrieval(MsnMessenger arg0messenger,
         {
             if (result == ResultStatus.GOOD)
             {
+                byte[] oldImage = contact.getImage(false);
+
                 contact.setImage(resultBytes);
 
                 parentOperationSet.fireContactPropertyChangeEvent(
                                 ContactPropertyChangeEvent.PROPERTY_IMAGE,
-                                contact, null, resultBytes);
+                                contact, oldImage, resultBytes);
             }
         }
 

File: src/net/java/sip/communicator/service/protocol/ContactGroup.java
Patch:
@@ -28,7 +28,7 @@ public interface ContactGroup
      * @return a java.util.Iterator over the <tt>ContactGroup</tt> children
      * of this group (i.e. subgroups).
      */
-    public Iterator subgroups();
+    public Iterator<ContactGroup> subgroups();
 
     /**
      * Returns the number of subgroups contained by this <tt>ContactGroup</tt>.
@@ -58,7 +58,7 @@ public interface ContactGroup
      * @return a java.util.Iterator over all contacts inside this
      * <tt>ContactGroup</tt>
      */
-    public Iterator contacts();
+    public Iterator<Contact> contacts();
 
     /**
      * Returns the number of <tt>Contact</tt> members of this

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetTypingNotificationsIcqImpl.java
Patch:
@@ -241,7 +241,7 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
             logger.debug("The ICQ provider changed state from: "
                          + evt.getOldState()
                          + " to: " + evt.getNewState());
-            if (evt.getNewState() == RegistrationState.REGISTERED)
+            if (evt.getNewState() == RegistrationState.FINALIZING_REGISTRATION)
             {
                 icqProvider.getAimConnection().getIcbmService()
                     .addIcbmListener(joustSimIcbmListener);

File: src/net/java/sip/communicator/impl/media/MediaServiceImpl.java
Patch:
@@ -130,7 +130,7 @@ public String[] getSupportedAudioEncodings()
      */
     public String[] getSupportedVideoEncodings()
     {
-        return defaultMediaControl.getSupportedAudioEncodings();
+        return defaultMediaControl.getSupportedVideoEncodings();
     }
 
 

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallButton.java
Patch:
@@ -119,7 +119,7 @@ public void callStateChanged(CallChangeEvent evt)
                 call.addCallChangeListener(callChangeListener);
                 try
                 {
-                    dialog.setModalityType(Dialog.ModalityType.DOCUMENT_MODAL);
+                    dialog.setModal(true);
                     dialog.pack();
                     dialog.setVisible(true);
                 }
@@ -129,7 +129,7 @@ public void callStateChanged(CallChangeEvent evt)
                 }
 
                 String target = dialog.getTarget();
-                if ((target != null) && !target.isEmpty())
+                if ((target != null) && (target.length() > 0))
                 {
                     try
                     {

File: src/net/java/sip/communicator/impl/gui/main/call/TransferCallDialog.java
Patch:
@@ -218,6 +218,6 @@ private String getValidTarget()
     {
         String target = targetComboBox.getEditor().getItem().toString().trim();
 
-        return ((target == null) || target.isEmpty()) ? null : target;
+        return ((target == null) || (target.length() <= 0)) ? null : target;
     }
 }

File: src/net/java/sip/communicator/util/launchutils/SipCommunicatorLock.java
Patch:
@@ -734,10 +734,11 @@ public void run()
             int argCount = 1024;
             try
             {
+                BufferedReader lineReader = 
+                    new BufferedReader(new InputStreamReader(is));
+                
                 while (true)
                 {
-                    BufferedReader lineReader = new BufferedReader(
-                                    new InputStreamReader(is));
                     String line = lineReader.readLine();
 
                     logger.debug(line);

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -685,6 +685,8 @@ public void serviceChanged(ServiceEvent event)
             {
                 logger.error("Plugin Component type is not supported." +
                             "Should provide a plugin in AWT, SWT or Swing.");
+                logger.debug("Logging exception to show the calling plugin",
+                            new Exception(""));
                 return;
             }
 

File: src/net/java/sip/communicator/impl/media/device/DeviceConfiguration.java
Patch:
@@ -80,10 +80,10 @@ private void extractConfiguredCaptureDevices()
     {
         logger.info("Scanning for configured Audio Devices.");
         Vector audioCaptureDevices = CaptureDeviceManager.getDeviceList(new
-                AudioFormat(AudioFormat.LINEAR, 44100, 16, 
+                AudioFormat(AudioFormat.LINEAR, 44100, 16,
                 1));//1 means 1 channel for mono
         if (audioCaptureDevices.size() < 1) {
-            logger.error("No Audio Device was found.");
+            logger.warn("No Audio Device was found.");
             audioCaptureDevice = null;
         }
         else {

File: src/net/java/sip/communicator/impl/protocol/sip/SipActivator.java
Patch:
@@ -37,8 +37,6 @@ public class SipActivator
 
     private static ProtocolProviderFactorySipImpl sipProviderFactory = null;
 
-    private static UriHandlerSipImpl    uriHandler            = null;
-
     /**
      * Called when this bundle is started so the Framework can perform the
      * bundle-specific activities necessary to start this bundle.
@@ -67,7 +65,7 @@ public void start(BundleContext context) throws Exception
                     sipProviderFactory,
                     hashtable);
 
-        uriHandler = new UriHandlerSipImpl(sipProviderFactory);
+        new UriHandlerSipImpl(sipProviderFactory);
 
         logger.debug("SIP Protocol Provider Factory ... [REGISTERED]");
     }

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardActivator.java
Patch:
@@ -31,7 +31,7 @@ public class WhiteboardActivator implements BundleActivator
 
     /**
      * Starts this bundle.
-     * 
+     *
      * @param bc bundle context
      * @throws java.lang.Exception
      */
@@ -58,7 +58,7 @@ public void start (BundleContext bc) throws Exception
 
     /**
      * Stops this bundle.
-     * 
+     *
      * @param bc bundle context
      * @throws java.lang.Exception
      */
@@ -68,7 +68,7 @@ public void stop (BundleContext bc) throws Exception
 
     /**
      * Returns the <tt>UIService</tt>, giving access to the main GUI.
-     * 
+     *
      * @return the <tt>UIService</tt>, giving access to the main GUI.
      */
     public static UIService getUiService()

File: src/net/java/sip/communicator/impl/argdelegation/ArgDelegationActivator.java
Patch:
@@ -45,7 +45,7 @@ public class ArgDelegationActivator
      *
      * @param bc a reference to the currently active bundle context.
      */
-    public void start(BundleContext context) throws Exception
+    public void start(BundleContext bc) throws Exception
     {
         bundleContext = bc;
         delegationPeer = new ArgDelegationPeerImpl(bc);

File: src/net/java/sip/communicator/impl/gui/utils/NotificationManager.java
Patch:
@@ -40,8 +40,6 @@ public static void registerGuiNotifications()
                 null,
                 null);
 
-        System.out.println("INCOMING MESSAGE===========" + SoundProperties.INCOMING_MESSAGE);
-
         notificationService.registerDefaultNotificationForEvent(
                 INCOMING_MESSAGE,
                 NotificationService.ACTION_SOUND,

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -384,7 +384,7 @@ private void addNewContactToMetaContact( ProtocolProviderService provider,
 
         addContactToEventIgnoreList(contactID, provider);
 
-        opSetPersPresence.addSubsciptionListener(evtRetriever);
+        opSetPersPresence.addSubscriptionListener(evtRetriever);
         opSetPersPresence.addServerStoredGroupChangeListener(evtRetriever);
 
         try
@@ -1417,7 +1417,7 @@ private void synchronizeOpSetWithLocalContactList(
         }
 
         presenceOpSet
-            .addSubsciptionListener(clSubscriptionEventHandler);
+            .addSubscriptionListener(clSubscriptionEventHandler);
 
         presenceOpSet
             .addServerStoredGroupChangeListener(clGroupEventHandler);

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatPanel.java
Patch:
@@ -156,7 +156,7 @@ private void setupListeners(boolean add)
             {
                 if (add)
                 {
-                    opsPresence.addSubsciptionListener(this);
+                    opsPresence.addSubscriptionListener(this);
                 }
                 else
                 {

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetPersistentPresenceYahooImpl.java
Patch:
@@ -831,7 +831,7 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
                 
                 initContactStatuses();
                 
-                addSubsciptionListener(statusUpdater);
+                addSubscriptionListener(statusUpdater);
             }
             else if(evt.getNewState() == RegistrationState.UNREGISTERED
                  || evt.getNewState() == RegistrationState.AUTHENTICATION_FAILED

File: src/net/java/sip/communicator/service/protocol/AbstractOperationSetPersistentPresence.java
Patch:
@@ -47,7 +47,7 @@ protected AbstractOperationSetPersistentPresence(T parentProvider)
         this.parentProvider = parentProvider;
     }
 
-    public void addSubsciptionListener(SubscriptionListener listener)
+    public void addSubscriptionListener(SubscriptionListener listener)
     {
         synchronized (subscriptionListeners)
         {

File: src/net/java/sip/communicator/service/protocol/OperationSetPresence.java
Patch:
@@ -215,7 +215,7 @@ public void removeContactPresenceStatusListener(
      * subscription was succesfully added, has failed or was removed.
      * @param listener the SubscriptionListener to register
      */
-    public void addSubsciptionListener(SubscriptionListener listener);
+    public void addSubscriptionListener(SubscriptionListener listener);
 
     /**
      * Removes the specified subscription listener.

File: test/net/java/sip/communicator/slick/protocol/gibberish/TestOperationSetPresence.java
Patch:
@@ -378,7 +378,7 @@ public void postTestSubscribe()
 
         SubscriptionEventCollector subEvtCollector
             = new SubscriptionEventCollector();
-        operationSetPresence1.addSubsciptionListener(subEvtCollector);
+        operationSetPresence1.addSubscriptionListener(subEvtCollector);
 
         // second we will accept
         authEventCollector2.responseToRequest =
@@ -504,7 +504,7 @@ public void postTestUnsubscribe()
         // First create a subscription and verify that it really gets created.
         SubscriptionEventCollector subEvtCollector
             = new SubscriptionEventCollector();
-        operationSetPresence1.addSubsciptionListener(subEvtCollector);
+        operationSetPresence1.addSubscriptionListener(subEvtCollector);
 
         Contact gibberishTesterAgentContact = operationSetPresence1
             .findContactByID(fixture.userID2);

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetPersistentPresence.java
Patch:
@@ -196,7 +196,7 @@ public void postTestPersistentSubscribe()
         //register a subscription event listener
         SubscriptionEventCollector evtCollector
             = new SubscriptionEventCollector();
-        opSetPersPresence.addSubsciptionListener(evtCollector);
+        opSetPersPresence.addSubscriptionListener(evtCollector);
 
         //create the subscription and wait for a confirmation event.
         opSetPersPresence.subscribe(group, "38687470");
@@ -250,7 +250,7 @@ public void postTestPersistentUnsubscribe()
         //register a subscription event listener
         SubscriptionEventCollector evtCollector
             = new SubscriptionEventCollector();
-        opSetPersPresence.addSubsciptionListener(evtCollector);
+        opSetPersPresence.addSubscriptionListener(evtCollector);
 
         //remove the subscription and wait for a confirmation event.
         opSetPersPresence.unsubscribe(contact);

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetPresence.java
Patch:
@@ -467,7 +467,7 @@ public void postTestSubscribe()
 
         SubscriptionEventCollector subEvtCollector
             = new SubscriptionEventCollector();
-        operationSetPresence1.addSubsciptionListener(subEvtCollector);
+        operationSetPresence1.addSubscriptionListener(subEvtCollector);
 
         // second we will accept
         authEventCollector2.responseToRequest =
@@ -609,7 +609,7 @@ public void postTestUnsubscribe()
         // First create a subscription and verify that it really gets created.
         SubscriptionEventCollector subEvtCollector
             = new SubscriptionEventCollector();
-        operationSetPresence1.addSubsciptionListener(subEvtCollector);
+        operationSetPresence1.addSubscriptionListener(subEvtCollector);
 
         Contact jabberTesterAgentContact = operationSetPresence1
             .findContactByID(fixture.userID2);

File: test/net/java/sip/communicator/slick/protocol/sip/TestOperationSetPresence.java
Patch:
@@ -363,7 +363,7 @@ public void postTestSubscribe()
 
         SubscriptionEventCollector subEvtCollector
             = new SubscriptionEventCollector();
-        this.operationSetPresence1.addSubsciptionListener(subEvtCollector);
+        this.operationSetPresence1.addSubscriptionListener(subEvtCollector);
 
 
         synchronized (subEvtCollector){
@@ -470,7 +470,7 @@ public void postTestSubscribe()
         {
             // add the the user to the reverse side needed for status tests
             subEvtCollector.collectedEvents.clear();
-            this.operationSetPresence2.addSubsciptionListener(subEvtCollector);
+            this.operationSetPresence2.addSubscriptionListener(subEvtCollector);
 
             synchronized (subEvtCollector)
             {
@@ -586,7 +586,7 @@ public void postTestUnsubscribe()
         // First create a subscription and verify that it really gets created.
         SubscriptionEventCollector subEvtCollector
             = new SubscriptionEventCollector();
-        this.operationSetPresence1.addSubsciptionListener(subEvtCollector);
+        this.operationSetPresence1.addSubscriptionListener(subEvtCollector);
 
         Contact sipTesterAgentContact = this.operationSetPresence1
             .findContactByID(this.fixture.userID2);

File: src/net/java/sip/communicator/impl/notification/NotificationServiceImpl.java
Patch:
@@ -839,7 +839,7 @@ else if (eventType.equals(
         }
     }
     
-    private boolean isDeafult(String eventType, String actionType)
+    private boolean isDefault(String eventType, String actionType)
     {
         List eventTypes = configService
                 .getPropertyNamesByPrefix(NOTIFICATIONS_PREFIX, true);
@@ -906,7 +906,7 @@ public void registerDefaultNotificationForEvent(
         NotificationActionHandler handler)
             throws IllegalArgumentException
     {
-        if(isDeafult(eventType, actionType))
+        if(isDefault(eventType, actionType))
         {
             NotificationActionHandler h = 
                 getEventNotificationActionHandler(eventType, actionType);
@@ -995,7 +995,7 @@ public void registerDefaultNotificationForEvent(    String eventType,
         logger.debug("Registering default event " + eventType + "/" + 
             actionType + "/" + actionDescriptor + "/" + defaultMessage);
         
-        if(isDeafult(eventType, actionType))
+        if(isDefault(eventType, actionType))
         {
             NotificationActionHandler handler = 
                 getEventNotificationActionHandler(eventType, actionType);

File: src/net/java/sip/communicator/service/protocol/Message.java
Patch:
@@ -17,7 +17,7 @@
  * operation set.
  * <p>
  * All messages have message ids that allow the underlying implementation to
- * notify the user of their succesful delivery.
+ * notify the user of their successful delivery.
  *
  * @author Emil Ivov
  */

File: test/net/java/sip/communicator/slick/protocol/gibberish/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -373,9 +373,8 @@ public void testCreateMessage2()
         String contentType = "text/html";
         String encoding = "UTF-16";
         String subject = "test message";
-        net.java.sip.communicator.service.protocol.Message msg
-            = opSetBasicIM1.createMessage(
-                    body.getBytes(), contentType, encoding, subject);
+        net.java.sip.communicator.service.protocol.Message msg =
+            opSetBasicIM1.createMessage(body, contentType, encoding, subject);
 
         assertEquals("message body", body, msg.getContent());
         assertTrue("message body bytes"

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -266,9 +266,8 @@ public void testCreateMessage2()
         String contentType = "text/html";
         String encoding = "UTF-16";
         String subject = "test message";
-        net.java.sip.communicator.service.protocol.Message msg
-            = opSetBasicIM.createMessage(
-                    body.getBytes(), contentType, encoding, subject);
+        net.java.sip.communicator.service.protocol.Message msg =
+            opSetBasicIM.createMessage(body, contentType, encoding, subject);
 
         assertEquals("message body", body, msg.getContent());
         assertTrue("message body bytes"

File: test/net/java/sip/communicator/slick/protocol/sip/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -412,9 +412,8 @@ public void testCreateMessage2()
         String contentType = "text/html";
         String encoding = "UTF-16";
         String subject = "test message";
-        net.java.sip.communicator.service.protocol.Message msg
-            = opSetBasicIM1.createMessage(
-                    body.getBytes(), contentType, encoding, subject);
+        net.java.sip.communicator.service.protocol.Message msg =
+            opSetBasicIM1.createMessage(body, contentType, encoding, subject);
 
         assertEquals("message body", body, msg.getContent());
         assertEquals("message encoding", encoding, msg.getEncoding());

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -225,8 +225,8 @@ public void stop(BundleContext bc)
 
                 if(opSetPresence != null)
                 {
-                    opSetPersPresence .removeSubscriptionListener(
-                        clSubscriptionEventHandler);
+                    opSetPresence
+                        .removeSubscriptionListener(clSubscriptionEventHandler);
                 }
             }
         }

File: src/net/java/sip/communicator/impl/protocol/icq/ContactIcqImpl.java
Patch:
@@ -39,7 +39,6 @@ public class ContactIcqImpl
                    boolean isResolved)
     {
         this.joustSimBuddy = buddy;
-        this.isLocal = isLocal;
         this.ssclCallback = ssclCallback;
         this.isPersistent = isPersistent;
         this.isResolved = isResolved;

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactJabberImpl.java
Patch:
@@ -48,7 +48,6 @@ public class ContactJabberImpl
                    boolean isResolved)
     {
         this.rosterEntry = rosterEntry;
-        this.isLocal = isLocal;
         this.ssclCallback = ssclCallback;
         this.isPersistent = isPersistent;
         this.isResolved = isResolved;
@@ -63,7 +62,6 @@ public class ContactJabberImpl
                boolean isPersistent)
     {
         this.tempId = id;
-        this.isLocal = isLocal;
         this.ssclCallback = ssclCallback;
         this.isPersistent = isPersistent;
         this.isResolved = false;

File: test/net/java/sip/communicator/slick/protocol/gibberish/GibberishSlickFixture.java
Patch:
@@ -112,7 +112,7 @@ public void setUp()
 
         assertTrue(
             "Failed to find a provider factory service for protocol Gibberish",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length > 0));
 
         //Keep the reference for later usage.
         providerFactory = (ProtocolProviderFactory)bc.getService(serRefs[0]);

File: test/net/java/sip/communicator/slick/protocol/icq/IcqSlickFixture.java
Patch:
@@ -87,7 +87,7 @@ public void setUp() throws Exception
 
         assertTrue(
             "Failed to find a provider factory service for protocol ICQ",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length >  0));
 
         //Keep the reference for later usage.
         providerFactory = (ProtocolProviderFactory)

File: test/net/java/sip/communicator/slick/protocol/icq/TestAccountInstallation.java
Patch:
@@ -102,7 +102,7 @@ public void testRegisterWrongUsername()
 
         assertTrue(
             "Failed to find a provider factory service for protocol ICQ",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length >  0));
 
         //Keep the reference for later usage.
         ProtocolProviderFactory icqProviderFactory =
@@ -232,7 +232,7 @@ public void testRegisterWrongPassword()
 
         assertTrue(
             "Failed to find a provider factory service for protocol ICQ",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length >  0));
 
         //Keep the reference for later usage.
         ProtocolProviderFactory icqProviderFactory =
@@ -351,7 +351,7 @@ public void testInstallAccount()
 
         assertTrue(
             "Failed to find a provider factory service for protocol ICQ",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length >  0));
 
         //Keep the reference for later usage.
         icqProviderFactory = (ProtocolProviderFactory)

File: test/net/java/sip/communicator/slick/protocol/jabber/JabberSlickFixture.java
Patch:
@@ -121,7 +121,7 @@ public void setUp()
 
         assertTrue(
             "Failed to find a provider factory service for protocol Jabber",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length >  0));
 
         //Keep the reference for later usage.
         providerFactory = (ProtocolProviderFactory)bc.getService(serRefs[0]);

File: test/net/java/sip/communicator/slick/protocol/msn/MsnSlickFixture.java
Patch:
@@ -112,7 +112,7 @@ public void setUp()
 
         assertTrue(
             "Failed to find a provider factory service for protocol msn",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length >  0));
 
         //Keep the reference for later usage.
         providerFactory = (ProtocolProviderFactory)bc.getService(serRefs[0]);

File: test/net/java/sip/communicator/slick/protocol/sip/SipSlickFixture.java
Patch:
@@ -109,7 +109,7 @@ public void setUp()
 
         assertTrue(
             "Failed to find a provider factory service for protocol SIP",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length >  0));
 
         //Keep the reference for later usage.
         providerFactory = (ProtocolProviderFactory)bc.getService(serRefs[0]);

File: test/net/java/sip/communicator/slick/protocol/yahoo/YahooSlickFixture.java
Patch:
@@ -112,7 +112,7 @@ public void setUp()
 
         assertTrue(
             "Failed to find a provider factory service for protocol yahoo",
-            serRefs != null || serRefs.length >  0);
+            (serRefs != null) && (serRefs.length >  0));
 
         //Keep the reference for later usage.
         providerFactory = (ProtocolProviderFactory)bc.getService(serRefs[0]);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -51,7 +51,7 @@ public class ChatWindow
 {
     private Logger logger = Logger.getLogger(ChatWindow.class.getName());
 
-    private MenusPanel menusPanel;
+    private final MenusPanel menusPanel;
 
     private MainFrame mainFrame;
 
@@ -149,6 +149,7 @@ public void dispose()
         try
         {
             GuiActivator.getUIService().removePluginComponentListener(this);
+            menusPanel.dispose();
         }
         finally
         {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPanel.java
Patch:
@@ -491,7 +491,7 @@ else if (evt.getErrorCode()
      * 
      * @param evt the event containing details on the typing notification
      */
-    public void typingNotificationReceifed(TypingNotificationEvent evt)
+    public void typingNotificationReceived(TypingNotificationEvent evt)
     {
         if (typingTimer.isRunning())
             typingTimer.stop();

File: src/net/java/sip/communicator/impl/protocol/gibberish/OperationSetTypingNotificationsGibberishImpl.java
Patch:
@@ -120,7 +120,7 @@ private void fireTypingNotificationsEvent(Contact sourceContact
             TypingNotificationsListener listener
                 = (TypingNotificationsListener) listeners.next();
 
-              listener.typingNotificationReceifed(evt);
+              listener.typingNotificationReceived(evt);
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetTypingNotificationsIcqImpl.java
Patch:
@@ -133,7 +133,7 @@ private void fireTypingNotificationsEvent(Contact sourceContact
             TypingNotificationsListener listener
                 = (TypingNotificationsListener) listeners.next();
 
-            listener.typingNotificationReceifed(evt);
+            listener.typingNotificationReceived(evt);
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetTypingNotificationsMsnImpl.java
Patch:
@@ -115,7 +115,7 @@ private void fireTypingNotificationsEvent(Contact sourceContact
             TypingNotificationsListener listener
                 = (TypingNotificationsListener) listeners.next();
 
-              listener.typingNotificationReceifed(evt);
+              listener.typingNotificationReceived(evt);
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetTypingNotificationsSipImpl.java
Patch:
@@ -167,7 +167,7 @@ private void fireTypingNotificationsEvent(Contact sourceContact
             TypingNotificationsListener listener
                 = (TypingNotificationsListener) listeners.next();
 
-            listener.typingNotificationReceifed(evt);
+            listener.typingNotificationReceived(evt);
         }
     }
     

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetTypingNotificationsYahooImpl.java
Patch:
@@ -110,7 +110,7 @@ private void fireTypingNotificationsEvent(Contact sourceContact
             TypingNotificationsListener listener
                 = (TypingNotificationsListener) listeners.next();
 
-              listener.typingNotificationReceifed(evt);
+              listener.typingNotificationReceived(evt);
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/zeroconf/OperationSetTypingNotificationsZeroconfImpl.java
Patch:
@@ -124,7 +124,7 @@ public void fireTypingNotificationsEvent(Contact sourceContact
             
             logger.debug("ZEROCONF: Sending TypingNotif to Listener " + listener);
             
-            listener.typingNotificationReceifed(evt);
+            listener.typingNotificationReceived(evt);
         }
     }
 

File: src/net/java/sip/communicator/service/protocol/event/TypingNotificationsListener.java
Patch:
@@ -24,5 +24,5 @@ public interface TypingNotificationsListener
      * @param event a <tt>TypingNotificationEvent</tt> containing the sender
      * of the notification and its type.
      */
-    public void typingNotificationReceifed(TypingNotificationEvent event);
+    public void typingNotificationReceived(TypingNotificationEvent event);
 }

File: test/net/java/sip/communicator/slick/protocol/gibberish/TestOperationSetTypingNotifications.java
Patch:
@@ -278,7 +278,7 @@ private class TypingEventCollector implements TypingNotificationsListener
          * @param event a <tt>TypingNotificationEvent</tt> containing the sender
          * of the notification and its type.
          */
-        public void typingNotificationReceifed(TypingNotificationEvent event)
+        public void typingNotificationReceived(TypingNotificationEvent event)
         {
             logger.debug("Received a typing notification: " + event);
             synchronized (this)

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetTypingNotifications.java
Patch:
@@ -181,7 +181,7 @@ private class TypingEventCollector implements TypingNotificationsListener
          * @param event a <tt>TypingNotificationEvent</tt> containing the sender
          * of the notification and its type.
          */
-        public void typingNotificationReceifed(TypingNotificationEvent event)
+        public void typingNotificationReceived(TypingNotificationEvent event)
         {
             logger.debug("Received a typing notification: " + event);
             synchronized (this)

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetTypingNotifications.java
Patch:
@@ -278,7 +278,7 @@ private class TypingEventCollector implements TypingNotificationsListener
          * @param event a <tt>TypingNotificationEvent</tt> containing the sender
          * of the notification and its type.
          */
-        public void typingNotificationReceifed(TypingNotificationEvent event)
+        public void typingNotificationReceived(TypingNotificationEvent event)
         {
             logger.debug("Received a typing notification: " + event);
             synchronized (this)

File: test/net/java/sip/communicator/slick/protocol/msn/TestOperationSetTypingNotifications.java
Patch:
@@ -256,7 +256,7 @@ private class TypingEventCollector implements TypingNotificationsListener
          * @param event a <tt>TypingNotificationEvent</tt> containing the sender
          * of the notification and its type.
          */
-        public void typingNotificationReceifed(TypingNotificationEvent event)
+        public void typingNotificationReceived(TypingNotificationEvent event)
         {
             logger.debug("Received a typing notification: " + event);
             synchronized (this)

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestOperationSetTypingNotifications.java
Patch:
@@ -256,7 +256,7 @@ private class TypingEventCollector implements TypingNotificationsListener
          * @param event a <tt>TypingNotificationEvent</tt> containing the sender
          * of the notification and its type.
          */
-        public void typingNotificationReceifed(TypingNotificationEvent event)
+        public void typingNotificationReceived(TypingNotificationEvent event)
         {
             logger.debug("Received a typing notification: " + event);
             synchronized (this)

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -859,6 +859,9 @@ public void contactListInitCompleted(MsnMessenger messenger)
             // if we have received status before we have inited the list
             // sho them correctly
             parentOperationSet.earlyStatusesDispatch();
+            
+            // retreive offline messages
+            msnProvider.getMessenger().retreiveOfflineMessages();
         }
 
         public void contactStatusChanged(MsnMessenger messenger,

File: src/net/java/sip/communicator/impl/resources/ResourceManagementServiceImpl.java
Patch:
@@ -554,7 +554,7 @@ public InputStream getSettingsInputStream(String streamKey)
      */
     public URL getSoundURL(String urlKey)
     {
-        String path = settingsResources.get(urlKey);
+        String path = soundResources.get(urlKey);
 
         if (path == null || path.length() == 0)
         {

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -891,7 +891,7 @@ public void contactRemovedMe(MsnMessenger messenger, MsnContact contact)
         {
         }
 
-        public void contactAddCompleted1(MsnMessenger messenger, MsnContact contact)
+        public void contactAddCompleted(MsnMessenger messenger, MsnContact contact)
         {
             String contactID = contact.getEmail().getEmailAddress();
             
@@ -906,7 +906,7 @@ public void contactAddCompleted1(MsnMessenger messenger, MsnContact contact)
             }
         }
         
-        public void contactRemoveCompleted1(MsnMessenger messenger, MsnContact contact)
+        public void contactRemoveCompleted(MsnMessenger messenger, MsnContact contact)
         {
             ContactMsnImpl contactToRemove =
                 findContactById(contact.getEmail().getEmailAddress());

File: src/net/java/sip/communicator/impl/resources/ResourceManagementActivator.java
Patch:
@@ -35,7 +35,7 @@ public void start(BundleContext bc) throws Exception
                                         resPackImpl,
                                         null);
 
-        logger.info("Default resources ... [REGISTERED]");
+        logger.info("Resource manager ... [REGISTERED]");
     }
 
     public void stop(BundleContext bc) throws Exception

File: src/net/java/sip/communicator/impl/gui/main/menus/ExtendedQuickMenu.java
Patch:
@@ -156,6 +156,8 @@ private void init()
         this.hideShowButton.addComponentListener(this);
         this.infoButton.addComponentListener(this);
         this.soundButton.addComponentListener(this);
+
+        this.initPluginComponents();
     }
     
     private void initPluginComponents()

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -153,6 +153,8 @@ private void init()
         this.searchButton.addComponentListener(this);
         this.infoButton.addComponentListener(this);
         this.soundButton.addComponentListener(this);
+
+        this.initPluginComponents();
     }
     
     private void initPluginComponents()

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -324,9 +324,6 @@ else if (itemName.equals(Constants.AWAY_STATUS))
 
                 if (status != null)
                 {
-                    System.out.println("PROTCOLLLL============" + protocolProvider.getProtocolDisplayName());
-                    System.out.println("STATUS============" + status.getStatusName());
-                    
                     new PublishPresenceStatusThread(presence, status)
                         .start();
 

File: src/net/java/sip/communicator/impl/gui/main/account/AccountsConfigurationForm.java
Patch:
@@ -124,7 +124,8 @@ private void accountsInit()
                 accountID = (AccountID) accountsList.get(i);
 
                 boolean isHidden =
-                    (accountID.getAccountProperties().get("HIDDEN_PROTOCOL")
+                    (accountID.getAccountProperties()
+                        .get(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN)
                         != null);
 
                 if (isHidden)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GroupRightButtonMenu.java
Patch:
@@ -90,7 +90,7 @@ public GroupRightButtonMenu(MainFrame mainFrame,
             
             boolean isHidden = 
                     pps.getAccountID().getAccountProperties().
-                        get("HIDDEN_PROTOCOL") != null;
+                        get(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN) != null;
             
             if(isHidden)
                 continue;

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactWizard.java
Patch:
@@ -60,8 +60,8 @@ public AddContactWizard(MainFrame mainFrame)
             ProtocolProviderService p = (ProtocolProviderService)iter.next();
 
             boolean isHidden = p.getAccountID().getAccountProperties().
-                    get("HIDDEN_PROTOCOL") != null;
-            
+                    get(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN) != null;
+
             if(!isHidden)
                 pps.add(p);
         }

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -115,7 +115,7 @@ public void runLogin(MainFrame parent)
 
                 boolean isHidden = 
                     accountID.getAccountProperties()
-                        .get("HIDDEN_PROTOCOL") != null;
+                        .get(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN) != null;
 
                 if(!isHidden)
                     hasRegisteredAccounts = true;

File: src/net/java/sip/communicator/impl/systray/jdic/StatusSubMenu.java
Patch:
@@ -151,7 +151,7 @@ private void init()
 
                 boolean isHidden = 
                     provider.getAccountID().getAccountProperties().
-                        get("HIDDEN_PROTOCOL") != null;
+                        get(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN) != null;
                 
                 if(!isHidden)
                     this.addAccount(provider);

File: src/net/java/sip/communicator/plugin/accountinfo/AccountInfoForm.java
Patch:
@@ -72,7 +72,8 @@ public AccountInfoForm()
                 accountID = (AccountID) accountsList.get(i);
 
                 boolean isHidden = 
-                    accountID.getAccountProperties().get("HIDDEN_PROTOCOL") != null;
+                    accountID.getAccountProperties()
+                        .get(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN) != null;
 
                 if(!isHidden)
                     hasRegisteredAccounts = true;

File: src/net/java/sip/communicator/plugin/simpleaccreg/SimpleAccountRegistrationActivator.java
Patch:
@@ -114,7 +114,7 @@ private static boolean hasRegisteredAccounts()
 
                 boolean isHidden = 
                     accountID.getAccountProperties()
-                        .get("HIDDEN_PROTOCOL") != null;
+                        .get(ProtocolProviderFactory.IS_PROTOCOL_HIDDEN) != null;
 
                 if(!isHidden)
                 {

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -1481,13 +1481,13 @@ private void setAttributeOnHold(MediaDescription mediaDescription,
     {
         String attribute;
 
-        if (ON_HOLD_LOCALLY == (onHold | ON_HOLD_LOCALLY))
+        if (ON_HOLD_LOCALLY == (onHold & ON_HOLD_LOCALLY))
             attribute =
-                (ON_HOLD_REMOTELY == (onHold | ON_HOLD_REMOTELY)) ? "inactive"
+                (ON_HOLD_REMOTELY == (onHold & ON_HOLD_REMOTELY)) ? "inactive"
                         : "sendonly";
         else
             attribute =
-                (ON_HOLD_REMOTELY == (onHold | ON_HOLD_REMOTELY)) ? "recvonly"
+                (ON_HOLD_REMOTELY == (onHold & ON_HOLD_REMOTELY)) ? "recvonly"
                         : null;
 
         if (attribute != null)

File: src/net/java/sip/communicator/impl/protocol/irc/ProtocolIconIrcImpl.java
Patch:
@@ -88,7 +88,7 @@ public byte[] getConnectingIcon()
      */
     public static byte[] getImageInBytes(String imageID) 
     {
-        InputStream in = DictActivator.getResources().
+        InputStream in = IrcActivator.getResources().
             getImageInputStream(imageID);
 
         if (in == null)

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -555,7 +555,6 @@ public String createSdpDescriptionForHold(String participantSdpDescription,
         boolean on) throws MediaException
     {
         SessionDescription participantDescription = null;
-        System.out.println("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!+"+participantSdpDescription);
         try
         {
             participantDescription =

File: src/net/java/sip/communicator/service/keybindings/KeybindingSet.java
Patch:
@@ -24,7 +24,7 @@ public abstract class KeybindingSet
      * @return mapping of keystrokes to the string representation of the actions
      *         they perform
      */
-    public abstract LinkedHashMap <KeyStroke, String> getBindings();
+    public abstract HashMap <KeyStroke, String> getBindings();
     
     /**
      * Resets the bindings and notifies the observer's listeners if they've

File: src/net/java/sip/communicator/impl/keybindings/KeybindingsServiceImpl.java
Patch:
@@ -41,7 +41,7 @@ class KeybindingsServiceImpl
     
     // Name of the relative directory that holds default bindings
     private static final String DEFAULT_KEYBINDING_DIR =
-            "/resources/config/defaultKeybindings";
+            "/resources/config/defaultkeybindings";
     
     // Name of the directory that holds custom bindings
     private static final String CUSTOM_KEYBINDING_DIR = "keybindings";

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolIconMsnImpl.java
Patch:
@@ -9,7 +9,6 @@
 import java.io.*;
 import java.util.*;
 
-import net.java.sip.communicator.impl.protocol.dict.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 
@@ -82,7 +81,7 @@ public byte[] getConnectingIcon()
      */
     private static byte[] getImageInBytes(String imageID) 
     {
-        InputStream in = DictActivator.getResources().
+        InputStream in = MsnActivator.getResources().
             getImageInputStream(imageID);
 
         if (in == null)

File: src/net/java/sip/communicator/impl/protocol/rss/RssStatusEnum.java
Patch:
@@ -8,7 +8,6 @@
 
 import java.util.*;
 
-import net.java.sip.communicator.impl.protocol.dict.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 import java.io.*;
@@ -89,7 +88,7 @@ static Iterator supportedStatusSet()
      */
     private static byte[] getImageInBytes(String imageID) 
     {
-        InputStream in = DictActivator.getResources().
+        InputStream in = RssActivator.getResources().
             getImageInputStream(imageID);
 
         if (in == null)

File: src/net/java/sip/communicator/impl/media/device/DeviceConfiguration.java
Patch:
@@ -80,7 +80,8 @@ private void extractConfiguredCaptureDevices()
     {
         logger.info("Scanning for configured Audio Devices.");
         Vector audioCaptureDevices = CaptureDeviceManager.getDeviceList(new
-                AudioFormat(AudioFormat.LINEAR, 44100, 16, 1));
+                AudioFormat(AudioFormat.LINEAR, 44100, 16, 
+                1));//1 means 1 channel for mono
         if (audioCaptureDevices.size() < 1) {
             logger.error("No Audio Device was found.");
             audioCaptureDevice = null;

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -233,7 +233,6 @@ private CallSipImpl createOutgoingCall(Address calleeAddress)
         CallParticipantSipImpl callParticipant
             = createCallParticipantFor(inviteTransaction, jainSipProvider);
 
-
         //invite content
         try
         {
@@ -279,10 +278,10 @@ private CallSipImpl createOutgoingCall(Address calleeAddress)
         catch (MediaException ex)
         {
             logger.error(
-                "Failed to parse sdp data while creating invite request!"
+                "Could not access media devices!"
                 , ex);
             throw new OperationFailedException(
-                "Failed to parse sdp data while creating invite request!"
+                "Could not access media devices!"
                 , OperationFailedException.INTERNAL_ERROR
                 , ex);
         }

File: src/net/java/sip/communicator/plugin/statusupdate/Resources.java
Patch:
@@ -6,8 +6,6 @@
  */
 package net.java.sip.communicator.plugin.statusupdate;
 
-import java.util.*;
-
 import net.java.sip.communicator.service.resources.*;
 
 import org.osgi.framework.*;

File: src/net/java/sip/communicator/impl/protocol/rss/ContactRssImpl.java
Patch:
@@ -44,7 +44,7 @@ public class ContactRssImpl
     /**
      * The path within the bundle for the default RSS 64x64 icon.
      */
-    private String defaultIconPath = "resources/images/rss/rss64x64.png";
+    private String defaultIconPath = "resources/images/protocol/rss/rss64x64.png";
 
     /***
      * Stores the contact's display image to avoid downloading it multiple times.

File: src/net/java/sip/communicator/plugin/updatechecker/UpdateCheckActivator.java
Patch:
@@ -96,7 +96,7 @@ public void start(BundleContext bundleContext) throws Exception
             dialogMsg += 
                 getResources().getI18NString(
                 "dialogMessage2",
-                new String[]{getResources().getSettingsString("applicationName")});
+                new String[]{getResources().getSettingsString("applicationName"), lastVersion});
         
         contentMessage.setText(dialogMsg);
 

File: src/net/java/sip/communicator/impl/media/codec/audio/ulaw/Packetizer.java
Patch:
@@ -10,7 +10,7 @@
 import javax.media.*;
 
 /**
- * Overrides the ULaw Packetizer witt a different packet size
+ * Overrides the ULaw Packetizer with a different packet size
  * @author Thomas Hofer
  */
 public class Packetizer 

File: src/net/java/sip/communicator/plugin/rssaccregwizz/RssAccRegWizzActivator.java
Patch:
@@ -94,7 +94,7 @@ public static ProtocolProviderFactory getRssProtocolProviderFactory()
 
         String osgiFilter = "("
             + ProtocolProviderFactory.PROTOCOL
-            + "=" + "RSS" + ")";
+            + "=" + ProtocolNames.RSS + ")";
 
         try
         {

File: src/net/java/sip/communicator/plugin/pluginmanager/NewBundleDialog.java
Patch:
@@ -103,7 +103,8 @@ else if (sourceButton.equals(fileChooserButton))
                 {
                     File newBundleFile = fileChooser.getSelectedFile();
 
-                    bundlePathField.setText(newBundleFile.toURL().toString());
+                    bundlePathField.setText(newBundleFile.toURI()
+                               .toURL().toString());
                 }
                 catch (MalformedURLException ex)
                 {

File: src/net/java/sip/communicator/plugin/googletalkaccregwizz/GoogleTalkAccountRegistrationWizard.java
Patch:
@@ -185,8 +185,8 @@ public ProtocolProviderService installAccount(
         accountProperties.put(ProtocolProviderFactory.PROTOCOL, PROTOCOL);
         accountProperties
             .put(ProtocolProviderFactory.PROTOCOL_ICON_PATH,
-                GoogleTalkAccountRegistrationWizard.class.getClassLoader()
-                    .getResource("resources/images/protocol/googletalk")
+                Resources.getResources()
+                    .getImageURLForPath("resources/images/protocol/googletalk")
                     .toString());
 
         if (registration.isRememberPassword())

File: src/net/java/sip/communicator/impl/msghistory/MessageHistoryActivator.java
Patch:
@@ -25,7 +25,7 @@ public class MessageHistoryActivator
 
     private MessageHistoryServiceImpl msgHistoryService = null;
 
-    private static BundleContext bundleContext;
+    static BundleContext bundleContext;
 
     /**
      * Initialize and start message history

File: src/net/java/sip/communicator/impl/configuration/ConfigurationServiceImpl.java
Patch:
@@ -66,7 +66,7 @@ public class ConfigurationServiceImpl
      * Name of the bundle where we will search for color resources.
      */
     private static final String DEFAULT_PROPERTIES_BUNDLE_NAME
-        = "resources.config.defaults";
+        = "resources.config.configuration";
 
     /**
      * Bundle which handle access to localized resources.

File: src/net/java/sip/communicator/impl/audionotifier/AudioNotifierServiceImpl.java
Patch:
@@ -44,8 +44,8 @@ public SCAudioClip createAudio(String uri)
             }
             else
             {
-                URL url = AudioNotifierServiceImpl.class.getClassLoader()
-                    .getResource(uri);
+                URL url = 
+                    AudioNotifierActivator.getResources().getSoundURLForPath(uri);
 
                 if (url == null)
                 {
@@ -56,7 +56,7 @@ public SCAudioClip createAudio(String uri)
                     }
                     catch (MalformedURLException e)
                     {
-                        logger.error("The given uri could not be parsed.", e);
+                        //logger.error("The given uri could not be parsed.", e);
                     }
                 }
                 audioClip = new SCAudioClipImpl(url, this);

File: src/net/java/sip/communicator/impl/gui/utils/Constants.java
Patch:
@@ -382,9 +382,8 @@ public static void loadAdiumStyle(){
      */
     public static void loadSimpleStyle(StyleSheet style) {
 
-        InputStream is = Constants.class
-                .getClassLoader()
-                .getResourceAsStream(DEFAULT_STYLE_PATH + "/defaultStyle.css");
+        InputStream is = 
+            GuiActivator.getResources().getSettingsInputStream("textStyle");
 
         Reader r = new BufferedReader(new InputStreamReader(is));
         try {

File: src/net/java/sip/communicator/impl/protocol/dict/OperationSetBasicInstantMessagingDictImpl.java
Patch:
@@ -227,7 +227,7 @@ public boolean isContentTypeSupported(String contentType)
     {
         if(contentType.equals(DEFAULT_MIME_TYPE))
             return true;
-        else if(contentType.equals("text/html"))
+        else if(contentType.equals(HTML_MIME_TYPE))
             return true;
         else
            return false;
@@ -299,7 +299,7 @@ private void submitDictQuery(ContactDictImpl dictContact, Message message)
         {
             fctResult = dictAdapter.define(database, word);
             msg = this.createMessage(this.retrieveDefine(fctResult, word).getBytes()
-                    , "text/html"
+                    , HTML_MIME_TYPE
                     , DEFAULT_MIME_ENCODING,
                     null);
         }

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -569,6 +569,8 @@ protected void initialize(String screenname,
             // TODO: add the feature, if any, corresponding to IM if someone
             // knows
             // supportedFeatures.add(_IM_);
+            //XHTML-IM
+            supportedFeatures.add("http://jabber.org/protocol/xhtml-im");
 
             //initialize the Whiteboard operation set
             OperationSetWhiteboardingJabberImpl whiteboard =

File: src/net/java/sip/communicator/impl/protocol/rss/OperationSetBasicInstantMessagingRssImpl.java
Patch:
@@ -114,7 +114,7 @@ public Message createMessage(byte[] content, String contentType,
     public Message createMessage(String messageText)
     {
         return new MessageRssImpl(messageText,
-                                  "text/html",
+                                  HTML_MIME_TYPE,
                                   DEFAULT_MIME_ENCODING,
                                   null);
     }
@@ -400,7 +400,7 @@ public boolean isContentTypeSupported(String contentType)
     {
         if(contentType.equals(DEFAULT_MIME_TYPE))
             return true;
-        else if(contentType.equals("text/html"))
+        else if(contentType.equals(HTML_MIME_TYPE))
             return true;
         else
            return false;

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatPanel.java
Patch:
@@ -915,7 +915,7 @@ private void sendInstantMessage()
 
         Message msg;
         if (im.isContentTypeSupported("text/html")
-            && htmlText.matches("(.*?)(<b|<i|<u)(.*?)"))
+            && htmlText.matches("(.*?)(<b|<i|<u|<font)(.*?)"))
         {
             msg = im.createMessage(     htmlText.getBytes(),
                                         "text/html",

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -101,8 +101,8 @@ public ChatPanel(ChatWindow chatWindow)
         this.messagePane.setResizeWeight(1.0D);
         this.chatContactListPanel.setPreferredSize(new Dimension(150, 100));
         this.chatContactListPanel.setMinimumSize(new Dimension(150, 100));
-        this.writeMessagePanel.setPreferredSize(new Dimension(500, 120));
-        this.writeMessagePanel.setMinimumSize(new Dimension(500, 120));
+        this.writeMessagePanel.setPreferredSize(new Dimension(500, 100));
+        this.writeMessagePanel.setMinimumSize(new Dimension(500, 100));
         this.conversationPanel.setPreferredSize(new Dimension(400, 200));
 
         this.topSplitPane.setOneTouchExpandable(true);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWritePanel.java
Patch:
@@ -413,7 +413,7 @@ public String getTextAsHtml()
         String formattedString = extractFormattedText(msgText);
 
         return formattedString
-            .substring(0, formattedString.lastIndexOf("\n"));
+            .substring(0, formattedString.lastIndexOf("<BR>"));
     }
 
     /**
@@ -475,7 +475,7 @@ private String extractFormattedText(String msgText)
             String pString = msgText
                 .substring(firstTagClosureIndex+1, lastIndex).trim();
 
-            return pString + "\n"
+            return pString + "<BR>"
                 + extractFormattedText(msgText.substring(lastIndex+1));
         }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatPanel.java
Patch:
@@ -913,11 +913,9 @@ private void sendInstantMessage()
         String plainText = getTextFromWriteArea(
             OperationSetBasicInstantMessaging.DEFAULT_MIME_TYPE);
 
-        System.out.println("HTML==========" + htmlText);
-        System.out.println("HTML==========" + plainText);
         Message msg;
         if (im.isContentTypeSupported("text/html")
-            && !htmlText.equals(plainText))
+            && htmlText.matches("(.*?)(<b|<i|<u)(.*?)"))
         {
             msg = im.createMessage(     htmlText.getBytes(),
                                         "text/html",

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -512,7 +512,8 @@ protected void initialize(String screenname,
 
             jabberIcon = new ProtocolIconJabberImpl(protocolIconPath);
 
-            jabberStatusEnum = new JabberStatusEnum(protocolIconPath);
+            jabberStatusEnum 
+                = JabberStatusEnum.getJabberStatusEnum(protocolIconPath);
 
             //this feature is mandatory to be compliant with Service Discovery
             supportedFeatures.add("http://jabber.org/protocol/disco#info");

File: src/net/java/sip/communicator/impl/protocol/sip/MessageSipImpl.java
Patch:
@@ -78,7 +78,7 @@ public MessageSipImpl(String content,
         }
         catch (UnsupportedEncodingException ex)
         {
-        	logger.warn("can't handle the requested encoding", ex);
+            logger.warn("can't handle the requested encoding", ex);
         	
             this.contentEncoding = Charset.defaultCharset().name();
             this.rawContent = content.getBytes();

File: src/net/java/sip/communicator/plugin/branding/WelcomeWindow.java
Patch:
@@ -35,6 +35,8 @@ public class WelcomeWindow extends JDialog
 
     public WelcomeWindow()
     {
+        this.setTitle(BrandingResources.getApplicationString("applicationName"));
+
         this.setModal(false);
         this.setUndecorated(true);
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactJabberImpl.java
Patch:
@@ -130,7 +130,8 @@ public boolean equals(Object obj)
     {
         if (obj == null
             || !(obj instanceof ContactJabberImpl)
-            || !(((ContactJabberImpl)obj).getAddress().equals(getAddress())
+            || !(((ContactJabberImpl)obj).getAddress()
+                                            .equalsIgnoreCase(getAddress())
                 && ((ContactJabberImpl)obj).getProtocolProvider()
                         == getProtocolProvider()))
 

File: src/net/java/sip/communicator/impl/protocol/jabber/ServerStoredContactListJabberImpl.java
Patch:
@@ -296,7 +296,7 @@ public ContactJabberImpl findContactById(String id)
         {
             ContactJabberImpl item = (ContactJabberImpl) rootContacts.next();
 
-            if(item.getAddress().equals(id))
+            if(item.getAddress().equalsIgnoreCase(id))
                 return item;
         }
 

File: src/net/java/sip/communicator/impl/gui/main/account/AccountsConfigurationForm.java
Patch:
@@ -86,8 +86,6 @@ public AccountsConfigurationForm(MainFrame mainFrame)
         this.buttonsPanel.add(newButton);
         this.buttonsPanel.add(saveButton);
 
-        this.getRootPane().setDefaultButton(saveButton);
-
         this.scrollPane.getViewport().add(wrapAccountsPanel);
 
         this.wrapAccountsPanel.add(accountsPanel, BorderLayout.NORTH);

File: src/net/java/sip/communicator/impl/gui/main/chat/SendSmsDialog.java
Patch:
@@ -157,7 +157,7 @@ private void sendSmsMessage(String phoneNumber, Message message)
                 phoneNumber,
                 new Date(System.currentTimeMillis()),
                 Constants.ERROR_MESSAGE,
-                Messages.getI18NString("msgSendConnectionProblem")
+                Messages.getI18NString("smsSendConnectionProblem")
                 .getText(), "text");
         }
         catch (Exception ex)

File: src/net/java/sip/communicator/impl/gui/main/chat/SendSmsDialog.java
Patch:
@@ -176,7 +176,8 @@ private void sendSmsMessage(String phoneNumber, Message message)
                 phoneNumber,
                 new Date(System.currentTimeMillis()),
                 Constants.ERROR_MESSAGE,
-                Messages.getI18NString("msgDeliveryInternalError")
+                Messages.getI18NString("msgDeliveryUnknownError",
+                    new String[]{ex.getMessage()})
                 .getText(), "text");
         }
         

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListModel.java
Patch:
@@ -681,8 +681,6 @@ private void initGroupsStatus(MetaContactGroup group)
         boolean isClosed = ConfigurationManager
             .getContactListGroupStatus(group.getMetaUID());
 
-        System.out.println("GROUPATAAAA========" + group.getGroupName()
-            + "=========IS CLOSED ==============" + isClosed);
         if (isClosed)
         {
             closedGroups.add(group);

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -100,7 +100,7 @@ public MainFrame()
 
         String isToolbarExtendedString
             = GuiActivator.getConfigurationService().getString(
-                "net.java.sip.communicator.impl.gui.isToolBarExteneded");
+                "isToolBarExteneded");
 
         boolean isToolBarExtended
             = new Boolean(isToolbarExtendedString).booleanValue();
@@ -121,7 +121,7 @@ public MainFrame()
 
         String applicationName
             = GuiActivator.getConfigurationService().getString(
-                "net.java.sip.communicator.impl.gui.applicationName");
+                "applicationName");
 
         this.setTitle(applicationName);
 

File: src/net/java/sip/communicator/impl/version/NightlyBuildID.java
Patch:
@@ -13,5 +13,5 @@
  */
 public class NightlyBuildID
 {
-    public static final String BUILD_ID="0.build.by.SVN";
+    public static final String BUILD_ID="0.build.by.chenzo";
 }

File: src/net/java/sip/communicator/plugin/simpleaccreg/InitialAccountRegistrationFrame.java
Patch:
@@ -94,7 +94,7 @@ public InitialAccountRegistrationFrame()
         this.initAccountWizards();
         
         // Create the default group
-        String groupName = Resources.getString("defaultGroupName");
+        String groupName = Resources.getApplicationProperty("defaultGroupName");
         
         if(groupName != null && groupName.length() > 0)
         {            

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommSelectorMenuUI.java
Patch:
@@ -29,7 +29,7 @@ public class SIPCommSelectorMenuUI
      * Creates a new SIPCommSelectorMenuUI instance.
      */
     public static ComponentUI createUI(JComponent x)
-    {   
+    {
         return new SIPCommSelectorMenuUI();
     }
 
@@ -50,9 +50,9 @@ public void paint(Graphics g, JComponent c)
     protected void paintBackground(Graphics g, JMenuItem menuItem, Color bgColor)
     {
         AntialiasingManager.activateAntialiasing(g);
-        
+
         super.paintBackground(g, menuItem, bgColor);
-        
+
         int menuWidth = menuItem.getWidth();
         int menuHeight = menuItem.getHeight();
 

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommToolBarSeparatorUI.java
Patch:
@@ -22,7 +22,8 @@ public static ComponentUI createUI(JComponent c) {
         return new SIPCommToolBarSeparatorUI();
     }
     
-    public void paint(Graphics g, JComponent c) {        
+    public void paint(Graphics g, JComponent c)
+    {
         Graphics2D g2 = (Graphics2D)g;
         
         g2.setColor(UIManager.getColor("ToolBar.separatorColor"));

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -145,7 +145,8 @@ private void init()
 
         JPanel menusPanel = new JPanel(new BorderLayout(0, 5));
 
-        menusPanel.add(menu, BorderLayout.CENTER);
+        this.setJMenuBar(menu);
+
         menusPanel.add(quickMenu, BorderLayout.SOUTH);
 
         JPanel northPanel = new JPanel(new BorderLayout());

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -21,7 +21,6 @@
 import net.java.sip.communicator.impl.gui.main.chat.menus.*;
 import net.java.sip.communicator.impl.gui.main.chat.toolBars.*;
 import net.java.sip.communicator.impl.gui.utils.*;
-import net.java.sip.communicator.impl.gui.utils.Constants;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/gui/main/chat/MenusPanel.java
Patch:
@@ -56,7 +56,7 @@ public MenusPanel(ChatWindow parentWindow)
 
         this.setLayout(new BorderLayout(5, 5));
 
-        this.add(menuBar, BorderLayout.NORTH);
+        parentWindow.setJMenuBar(menuBar);
         this.add(mainToolBar, BorderLayout.CENTER);
         // this.add(editTextToolBar);
     }

File: src/net/java/sip/communicator/impl/gui/main/chat/ProtocolContactSelectorBox.java
Patch:
@@ -214,7 +214,7 @@ private void setSelected(Contact protoContact, ImageIcon icon)
         else
             tooltipText = protoContact.getDisplayName();
         
-        this.menu.setToolTipText(tooltipText);        
+        this.menu.setToolTipText(tooltipText);
     }
     
     /**
@@ -224,7 +224,7 @@ private void setSelected(Contact protoContact, ImageIcon icon)
     public void setSelected(Contact protoContact)
     {
         this.setSelected(protoContact,
-                new ImageIcon(createContactStatusImage(protoContact)));        
+                new ImageIcon(createContactStatusImage(protoContact)));
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/menus/ExtendedQuickMenu.java
Patch:
@@ -77,7 +77,7 @@ public class ExtendedQuickMenu
     private static int DEFAULT_BUTTON_WIDTH
         = SizeProperties.getSize("mainToolbarButtonWidth");
 
-    private ConfigurationWindow configDialog;
+    private ExportedWindow configDialog;
 
     private MainFrame mainFrame;
 
@@ -227,7 +227,8 @@ public void mousePressed(MouseEvent e)
         }
         else if (buttonName.equals("config"))
         {
-            configDialog = GuiActivator.getUIService().getConfigurationWindow();
+            configDialog = GuiActivator.getUIService()
+                .getExportedWindow(ExportedWindow.CONFIGURATION_WINDOW);
 
             configDialog.setVisible(true);
         }

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -73,7 +73,7 @@ public class QuickMenu
     private static int BUTTON_WIDTH
         = SizeProperties.getSize("mainToolbarButtonWidth");
 
-    private ConfigurationWindow configDialog;
+    private ExportedWindow configDialog;
 
     private MainFrame mainFrame;
 
@@ -223,7 +223,8 @@ public void actionPerformed(ActionEvent e)
         else if (buttonName.equals("config"))
         {
 
-            configDialog = GuiActivator.getUIService().getConfigurationWindow();
+            configDialog = GuiActivator.getUIService()
+                .getExportedWindow(ExportedWindow.CONFIGURATION_WINDOW);
 
             configDialog.setVisible(true);
         }

File: src/net/java/sip/communicator/impl/gui/main/menus/ToolsMenu.java
Patch:
@@ -44,7 +44,7 @@ public class ToolsMenu
     
     private MainFrame parentWindow;
     
-    private ConfigurationWindow configDialog;
+    private ExportedWindow configDialog;
 
     /**
      * Creates an instance of <tt>FileMenu</tt>.
@@ -118,7 +118,8 @@ public void actionPerformed(ActionEvent e) {
         String itemText = menuItem.getName();
 
         if (itemText.equalsIgnoreCase("config")) {
-            configDialog = GuiActivator.getUIService().getConfigurationWindow();
+            configDialog = GuiActivator.getUIService()
+                .getExportedWindow(ExportedWindow.CONFIGURATION_WINDOW);
 
             configDialog.setVisible(true);
         }

File: src/net/java/sip/communicator/plugin/accountinfo/AccountInfoActivator.java
Patch:
@@ -43,7 +43,8 @@ public void start(BundleContext bc) throws Exception
 
         UIService uiService = (UIService) bc.getService(uiServiceRef);
 
-        ConfigurationWindow configWindow = uiService.getConfigurationWindow();
+        ExportedWindow configWindow
+            = uiService.getExportedWindow(ExportedWindow.CONFIGURATION_WINDOW);
 //        configWindow.addConfigurationForm(new AccountInfoForm());
     }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatPanel.java
Patch:
@@ -341,7 +341,7 @@ public void updateContactStatus(Contact contact, PresenceStatus newStatus)
 
         getChatConversationPanel().appendMessageToEnd(message);
 
-        if(Constants.TABBED_CHAT_WINDOW)
+        if(ConfigurationManager.isMultiChatWindowEnabled())
         {
             if (getChatWindow().getChatTabCount() > 0) {
                 getChatWindow().setTabIcon(this,

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatPanel.java
Patch:
@@ -507,7 +507,7 @@ public void chatRoomPropertyChangeFailed(
      */
     public void updateChatRoomStatus(String status)
     {
-        if(Constants.TABBED_CHAT_WINDOW)
+        if(ConfigurationManager.isMultiChatWindowEnabled())
         {
             if (getChatWindow().getChatTabCount() > 0) {
                 getChatWindow().setTabIcon(this,

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -391,11 +391,11 @@ private void initPluginComponents()
                 PluginComponent component = (PluginComponent) GuiActivator
                     .bundleContext.getService(serRefs[i]);;
 
+                component.setCurrentContact(contactItem);    
+                    
                 if (component.getComponent() == null)
                     continue;
 
-                component.setCurrentContact(contactItem);
-
                 this.add((Component)component.getComponent());
             }
         }

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -1828,7 +1828,7 @@ public void serviceChanged(ServiceEvent event)
                 }
             }
 
-            if(sourceFactory.getRegisteredAccounts().contains(
+            if(sourceFactory != null && sourceFactory.getRegisteredAccounts().contains(
                 provider.getAccountID()))
             {
                 // the account is already installed and this event is coming

File: src/net/java/sip/communicator/plugin/sipaccregwizz/FirstWizardPage.java
Patch:
@@ -548,8 +548,8 @@ public void loadAccount(ProtocolProviderService protocolProvider)
                 .get("KEEP_ALIVE_INTERVAL");
 
         uinField.setEnabled(false);
-        this.uinField.setText(accountID.getUserID());
-
+        this.uinField.setText(accountID.getUserID() + "@" + serverAddress);
+        
         if (password != null)
         {
             this.passField.setText(password);

File: src/net/java/sip/communicator/plugin/simpleaccreg/InitialAccountRegistrationFrame.java
Patch:
@@ -78,6 +78,8 @@ public InitialAccountRegistrationFrame()
         this.messageArea.setEditable(false);
         this.messageArea.setOpaque(false);
 
+        this.getRootPane().setDefaultButton(signinButton);
+
         this.initAccountWizards();
     }
 

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/YahooAccountRegistration.java
Patch:
@@ -18,7 +18,7 @@ public class YahooAccountRegistration {
 
     private String password;
 
-    private boolean rememberPassword;
+    private boolean rememberPassword = true;
 
     /**
      * Returns the password of the yahoo registration account.

File: src/net/java/sip/communicator/plugin/simpleaccreg/SimpleAccountRegistrationActivator.java
Patch:
@@ -84,7 +84,7 @@ private static boolean hasRegisteredAccounts()
 
             for (int j = 0; j < accountsList.size(); j++)
             {
-                accountID = (AccountID) accountsList.get(i);
+                accountID = (AccountID) accountsList.get(j);
 
                 boolean isHidden = 
                     accountID.getAccountProperties()

File: src/net/java/sip/communicator/impl/gui/main/presence/StatusPanel.java
Patch:
@@ -84,7 +84,7 @@ public void addAccount(ProtocolProviderService protocolProvider)
         if(isHidden)
             hiddenProviders++;
 
-        if (protocolStatusCombos.size() - hiddenProviders == 1)
+        if (protocolStatusCombos.size() - hiddenProviders == 1 && !isHidden)
         {
             this.globalStatusBox = new GlobalStatusSelectorBox(mainFrame);
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -392,7 +392,7 @@ private void initPluginComponents()
                     .bundleContext.getService(serRefs[i]);;
 
                 if (component.getComponent() == null)
-                    return;
+                    continue;
 
                 component.setCurrentContact(contactItem);
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactPanel.java
Patch:
@@ -105,7 +105,7 @@ public ChatContactPanel(ChatPanel chatPanel, ChatContact contact)
         this.callButton.setToolTipText(
             Messages.getI18NString("call").getText());
         this.infoButton.setToolTipText(
-            Messages.getI18NString("userInfo").getText());
+            Messages.getI18NString("contactInfo").getText());
         this.sendFileButton.setToolTipText(
             Messages.getI18NString("sendFile").getText());
 

File: src/net/java/sip/communicator/impl/gui/main/menus/ExtendedQuickMenu.java
Patch:
@@ -27,7 +27,6 @@
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;
-import net.java.sip.communicator.service.gui.event.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.util.*;
 
@@ -111,7 +110,7 @@ public ExtendedQuickMenu(MainFrame mainFrame)
             new Dimension(buttonWidth, DEFAULT_BUTTON_HEIGHT));
 
         this.infoButton.setToolTipText(
-            Messages.getI18NString("userInfo").getText());
+            Messages.getI18NString("contactInfo").getText());
         this.configureButton.setToolTipText(
             Messages.getI18NString("configure").getText());
         this.hideShowButton.setToolTipText(

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -835,7 +835,6 @@ private void setDefaultThemePack()
         // popup menu stays light weight it will appear behind the heavy weight
         // component.
         ToolTipManager.sharedInstance().setLightWeightPopupEnabled(false); 
-        JPopupMenu.setDefaultLightWeightPopupEnabled(false); 
 
         // we need to set the UIDefaults class loader so that it may access
         // resources packed inside OSGI bundles

File: src/net/java/sip/communicator/service/protocol/PresenceStatus.java
Patch:
@@ -126,9 +126,9 @@ public String getStatusName()
     }
 
     /**
-     * Returns a string represenation of this provider status. Strings returned
+     * Returns a string representation of this provider status. Strings returned
      * by this method have the following format: PresenceStatus:<STATUS_STRING>:
-     * <STATUS_MESSAGE> and are meant to be used for loggin/debugging purposes.
+     * <STATUS_MESSAGE> and are meant to be used for logging/debugging purposes.
      * @return a string representation of this object.
      */
     public String toString()

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -216,9 +216,9 @@ public abstract AccountID installAccount(String userID,
                NullPointerException;
 
     /**
-     * Returns a copy of the list containing the <tt>AccoudID</tt>s of all
+     * Returns a copy of the list containing the <tt>AccountID</tt>s of all
      * accounts currently registered in this protocol provider.
-     * @return a copy of the list containing the <tt>AccoudID</tt>s of all
+     * @return a copy of the list containing the <tt>AccountID</tt>s of all
      * accounts currently registered in this protocol provider.
      */
     public abstract ArrayList getRegisteredAccounts();
@@ -228,7 +228,7 @@ public abstract AccountID installAccount(String userID,
      * the specified accountID or null if the accountID is unknown.
      * @param accountID the accountID of the protocol provider we'd like to get
      * @return a ServiceReference object to the protocol provider with the
-     * specified account id and null if the account id is unknwon to the
+     * specified account id and null if the account id is unknown to the
      * provider factory.
      */
      public abstract ServiceReference getProviderForAccount(

File: src/net/java/sip/communicator/impl/media/MediaServiceImpl.java
Patch:
@@ -30,6 +30,7 @@
  * @author Martin Andre
  * @author Ryan Ricard
  * @author Symphorien Wanko
+ * @author Ken Larson
  */
 public class MediaServiceImpl
     implements MediaService
@@ -395,7 +396,7 @@ public void run()
                     sdpFactory = SdpFactory.getInstance();
                     isStarted = true;
                 }
-                catch (Exception ex)
+                catch (Throwable ex)
                 {
                     logger.error("Failed to initialize media control", ex);
                     isStarted = false;

File: src/net/java/sip/communicator/impl/media/RtpFlowImpl.java
Patch:
@@ -28,6 +28,7 @@
  * a specified format.
  *
  * @author Symphorien Wanko
+ * @author KenLarson
  */
 public class RtpFlowImpl
         implements RtpFlow,
@@ -197,6 +198,7 @@ private void initialize() throws MediaException
             {
                 rtpMgrs[i] = RTPManager.newInstance();
 
+                CallSessionImpl.registerCustomCodecFormats(rtpMgrs[i]);
                 port = remotePort + 2 * i;
                 ipAddr = InetAddress.getByName(remoteAddress);
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -193,7 +193,7 @@ private void addChatTab(ChatPanel chatPanel)
 
                 // Add first two tabs to the tabbed pane.
                 chatTabbedPane.addTab(  firstChatPanel.getChatName(),
-                                        chatPanel.getChatStatusIcon(),
+                                        firstChatPanel.getChatStatusIcon(),
                                         firstChatPanel);
 
                 chatTabbedPane.addTab(  chatName,

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -662,7 +662,6 @@ private void initPluginComponents()
 
         // Search for plugin components registered through the OSGI bundle
         // context.
-        System.out.println("TURSIME PLUGINI ZA ADDVANE!");
         ServiceReference[] serRefs = null;
 
         String osgiFilter = "("

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -1285,7 +1285,7 @@ private void initPluginComponents()
 
         String osgiFilter = "("
             + Container.CONTAINER_ID
-            + "="+Container.CONTAINER_MAIN_TABBED_PANE.getID()+")";
+            + "="+Container.CONTAINER_CONTACT_LIST.getID()+")";
 
         try
         {

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/HelpMenu.java
Patch:
@@ -89,7 +89,7 @@ private void initPluginComponents()
         }
         catch (InvalidSyntaxException exc)
         {
-            exc.printStackTrace();
+            logger.error("Could not obtain plugin reference.", exc);
         }
 
         if (serRefs == null)

File: src/net/java/sip/communicator/impl/gui/main/chat/toolBars/MainToolBar.java
Patch:
@@ -25,6 +25,7 @@
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.gui.Container;
 import net.java.sip.communicator.service.gui.event.*;
+import net.java.sip.communicator.util.*;
 
 /**
  * The <tt>MainToolBar</tt> is a <tt>JToolBar</tt> which contains buttons
@@ -40,6 +41,7 @@ public class MainToolBar
     implements  ActionListener,
                 PluginComponentListener
 {
+    private Logger logger = Logger.getLogger(MainToolBar.class);
 
     private ChatToolbarButton copyButton = new ChatToolbarButton(ImageLoader
         .getImage(ImageLoader.COPY_ICON));
@@ -398,7 +400,7 @@ private void initPluginComponents()
         }
         catch (InvalidSyntaxException exc)
         {
-            exc.printStackTrace();
+            logger.error("Could not obtain plugin reference.", exc);
         }
 
         if (serRefs == null)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/GroupRightButtonMenu.java
Patch:
@@ -29,6 +29,7 @@
 import net.java.sip.communicator.service.gui.Container;
 import net.java.sip.communicator.service.gui.event.*;
 import net.java.sip.communicator.service.protocol.*;
+import net.java.sip.communicator.util.*;
 
 /**
  * The GroupRightButtonMenu is the menu, opened when user clicks with the
@@ -42,6 +43,7 @@ public class GroupRightButtonMenu
     implements  ActionListener,
                 PluginComponentListener
     {
+    private Logger logger = Logger.getLogger(GroupRightButtonMenu.class);
 
     private I18NString addContactString = Messages.getI18NString("addContact");
 
@@ -161,7 +163,7 @@ private void initPluginComponents()
         }
         catch (InvalidSyntaxException exc)
         {
-            exc.printStackTrace();
+            logger.error("Could not obtain plugin reference.", exc);
         }
 
         if (serRefs == null)

File: src/net/java/sip/communicator/impl/gui/main/menus/ExtendedQuickMenu.java
Patch:
@@ -209,7 +209,7 @@ else if(selectedValue instanceof MetaContactGroup)
         }
         catch (InvalidSyntaxException exc)
         {
-            exc.printStackTrace();
+            logger.error("Could not obtain plugin reference.", exc);
         }
 
         if (serRefs == null)

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -205,7 +205,7 @@ else if(selectedValue instanceof MetaContactGroup)
         }
         catch (InvalidSyntaxException exc)
         {
-            exc.printStackTrace();
+            logger.error("Could not obtain plugin reference.", exc);
         }
 
         if (serRefs == null)

File: src/net/java/sip/communicator/impl/gui/main/menus/ToolsMenu.java
Patch:
@@ -106,7 +106,7 @@ private void initPluginComponents()
         }
         catch (InvalidSyntaxException exc)
         {
-            exc.printStackTrace();
+            logger.error("Could not obtain plugin reference.", exc);
         }
 
         if (serRefs == null)

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetDTMFSipImpl.java
Patch:
@@ -82,7 +82,7 @@ private void sayInfo(CallParticipantSipImpl callParticipant,
 
         //here we add the body
         ContentType ct = new ContentType("application", "dtmf-relay");
-        String content = "Signal=" + dtmftone + "\r\nDuration=250\r\n\r\n";
+        String content = "Signal=" + dtmftone + "\r\nDuration=250\r\n";
         ContentLength cl = new ContentLength(content.length());
         info.setContentLength(cl);
 

File: src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolProviderServiceGibberishImpl.java
Patch:
@@ -326,8 +326,9 @@ public void register(SecurityAuthority authority)
             credentials.setUserName(getAccountID().getUserID());
 
             //request a password from the user
-            credentials = authority.obtainCredentials("Gibberish"
-                                                      , credentials);
+            credentials = authority.obtainCredentials(
+                    "Gibberish",
+                    credentials);
 
             //extract the password the user passed us.
             char[] pass = credentials.getPassword();

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -519,7 +519,8 @@ public void run()
                 {
                     logger.error("unregistering.");
 //                    fireUnregisterd();
-                    jabberProvider.reregister();
+                    jabberProvider
+                        .reregister(SecurityAuthority.CONNECTION_FAILED);
                     failedKeepalivePackets = 0;
                 }
             }

File: src/net/java/sip/communicator/impl/protocol/msn/EventManager.java
Patch:
@@ -229,7 +229,7 @@ public void run()
                 if(!connected && msnProvider.isRegistered())
                 {
                     msnProvider.unregister(false);
-                    msnProvider.reconnect();
+                    msnProvider.reconnect(SecurityAuthority.CONNECTION_FAILED);
                 }
             }
         }, 20000);

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegSummaryPage.java
Patch:
@@ -152,7 +152,8 @@ public void pageNext()
 
         ProtocolProviderService protocolProvider = wizard.finish();
 
-        this.wizardContainer.saveAccountWizard(protocolProvider, wizard);
+        if (protocolProvider != null)
+            this.wizardContainer.saveAccountWizard(protocolProvider, wizard);
 
         this.wizardContainer.unregisterWizardPages();
         this.wizardContainer.removeWizzardIcon();

File: src/net/java/sip/communicator/impl/protocol/sip/ContactSipImpl.java
Patch:
@@ -103,7 +103,7 @@ public ContactSipImpl(
     {
         this.contactID = id;
         this.parentProvider = parentProvider;
-        
+
         this.presenceStatus = parentProvider.getSipStatusEnum()
             .getStatus(SipStatusEnum.UNKNOWN);
     }

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolIconSipImpl.java
Patch:
@@ -21,7 +21,7 @@
 public class ProtocolIconSipImpl
     implements ProtocolIcon
 {
-    private static Logger logger = Logger.getLogger(ProtocolIconSipImpl.class); 
+    private static Logger logger = Logger.getLogger(ProtocolIconSipImpl.class);
 
     private String iconPath;
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -116,7 +116,7 @@ public class OperationSetPresenceSipImpl
      * The default expiration value of a request as defined for the presence
      * package in rfc3856
      */
-    private static final int PRESENCE_DEFAULT_EXPIRE = 3600;
+    private static final int PRESENCE_DEFAULT_EXPIRE = 600;
 
     /**
      * The minimal Expires value for a SUBSCRIBE

File: src/net/java/sip/communicator/impl/protocol/sip/ContactSipImpl.java
Patch:
@@ -103,6 +103,9 @@ public ContactSipImpl(
     {
         this.contactID = id;
         this.parentProvider = parentProvider;
+        
+        this.presenceStatus = parentProvider.getSipStatusEnum()
+            .getStatus(SipStatusEnum.UNKNOWN);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegFirstPage.java
Patch:
@@ -268,6 +268,8 @@ public void pageNext()
             break;
         }
 
+        wizard.setModification(false);
+
         this.wizardContainer.setCurrentWizard(wizard);
     }
 

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -273,6 +273,8 @@ public void modifyAccount(ProtocolProviderService protocolProvider)
 
         this.setCurrentWizard(wizard);
 
+        wizard.setModification(true);
+
         Iterator i = wizard.getPages();
 
         Object identifier = null;

File: src/net/java/sip/communicator/impl/gui/main/presence/GlobalStatusSelectorBox.java
Patch:
@@ -86,6 +86,8 @@ public GlobalStatusSelectorBox(MainFrame mainFrame)
     {
         this.mainFrame = mainFrame;
 
+        this.setPreferredSize(new Dimension(28, 24));
+
         String tooltip = "<html><b>"
             + "Set global status"
             + "</b></html>";

File: src/net/java/sip/communicator/impl/protocol/msn/ContactMsnImpl.java
Patch:
@@ -235,6 +235,7 @@ void setResolved(MsnContact entry)
             return;
 
         this.isResolved = true;
+        this.isPersistent = true;
         contact = entry;
     }
 

File: src/net/java/sip/communicator/impl/protocol/msn/OperationSetPersistentPresenceMsnImpl.java
Patch:
@@ -217,12 +217,12 @@ public void createServerStoredContactGroup(ContactGroup parent,
      * be added to the server stored contact list. The volatile contact would
      * remain in the list until it is really added to the contact list or
      * until the application is terminated.
-     * @param id the address of the contact to create.
+     * @param contact the msn contact.
      * @return the newly created volatile <tt>ContactImpl</tt>
      */
-    public ContactMsnImpl createVolatileContact(String id)
+    public ContactMsnImpl createVolatileContact(MsnContact contact)
     {
-        return ssContactList.createVolatileContact(id);
+        return ssContactList.createVolatileContact(contact);
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -685,7 +685,7 @@ public void windowClosing(WindowEvent e)
                 {
                     public void run()
                     {
-                        if(!ConfigurationManager.isApplicationVisibleSaved())
+                        if(ConfigurationManager.isQuitWarningShown())
                         {
                             MessageDialog dialog
                                 = new MessageDialog(
@@ -700,7 +700,7 @@ public void run()
                             if (returnCode == MessageDialog.OK_DONT_ASK_CODE)
                             {
                                 ConfigurationManager
-                                    .setApplicationVisibleSaved(true);
+                                    .setQuitWarningShown(false);
                             }
                         }
                     }

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/Wizard.java
Patch:
@@ -468,7 +468,8 @@ private void initComponents()
         nextButton.addActionListener(wizardController);
         cancelButton.addActionListener(wizardController);
 
-        backButton.setMnemonic(Messages.getI18NString("back").getMnemonic());
+        backButton
+            .setMnemonic(Messages.getI18NString("previous").getMnemonic());
         nextButton.setMnemonic(Messages.getI18NString("next").getMnemonic());
         cancelButton
             .setMnemonic(Messages.getI18NString("cancel").getMnemonic());
@@ -509,7 +510,7 @@ public void windowClosing(WindowEvent e)
 
     static
     {
-        BACK_TEXT = Messages.getI18NString("back").getText();
+        BACK_TEXT = Messages.getI18NString("previous").getText();
         NEXT_TEXT = Messages.getI18NString("next").getText();
         CANCEL_TEXT = Messages.getI18NString("cancel").getText();
         FINISH_TEXT = Messages.getI18NString("finish").getText();

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommFrame.java
Patch:
@@ -168,7 +168,9 @@ public void setSizeAndLocation()
             y = new Integer(yString).intValue();
 
             if (x >= 0 && y >= 0)
-            this.setLocation(x, y);
+                this.setLocation(x, y);
+            else
+                this.setCenterLocation();
         }
         else
         {

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomsListPanel.java
Patch:
@@ -61,6 +61,9 @@ public ChatRoomsListPanel(MainFrame frame)
                 JComponent.WHEN_IN_FOCUSED_WINDOW);
 
         imap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), "runChat");
+
+        this.setPreferredSize(new Dimension(200, 450));
+        this.setMinimumSize(new Dimension(80, 200));
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPanel.java
Patch:
@@ -75,7 +75,7 @@ public ContactListPanel(MainFrame mainFrame) {
 
         this.getVerticalScrollBar().setUnitIncrement(30);
 
-        this.setPreferredSize(new Dimension(300, 600));
+        this.setPreferredSize(new Dimension(200, 450));
         this.setMinimumSize(new Dimension(80, 200));
 
     }

File: src/net/java/sip/communicator/impl/systray/jdic/SystrayServiceJdicImpl.java
Patch:
@@ -323,6 +323,9 @@ else if (messageType == SystrayService.INFORMATION_MESSAGE_TYPE)
         else if (messageType == SystrayService.WARNING_MESSAGE_TYPE)
             trayMsgType = TrayIcon.WARNING_MESSAGE_TYPE;
 
+        // remove eventual html code before showing the popup message
+        messageContent = messageContent.replaceAll("</?\\w++[^>]*+>", "");
+
         if(messageContent.length() > 40)
             messageContent = messageContent.substring(0, 40).concat("...");
 

File: src/net/java/sip/communicator/plugin/contactinfo/ContactInfoDetailsPanel.java
Patch:
@@ -192,8 +192,8 @@ private JPanel createSummaryInfoPanel()
         labelsPanel.add(new JLabel(Resources.getString("middleNameNS")));
         labelsPanel.add(new JLabel(Resources.getString("lastNameNS")));
         labelsPanel.add(new JLabel(Resources.getString("genderNS")));
-        labelsPanel.add(new JLabel(Resources.getString("ageNS")));
         labelsPanel.add(new JLabel(Resources.getString("bdayNS")));
+        labelsPanel.add(new JLabel(Resources.getString("ageNS")));
         labelsPanel.add(new JLabel(Resources.getString("emailNS")));
         labelsPanel.add(new JLabel(Resources.getString("phoneNS")));
 

File: src/net/java/sip/communicator/impl/media/codec/audio/alaw/DePacketizer.java
Patch:
@@ -46,7 +46,7 @@ public Format[] getSupportedOutputFormats(Format in)
 
         if (in == null)
         {
-            return new Format[]{new AudioFormat(AudioFormat.ALAW)};
+            return new Format[]{new AudioFormat("ALAW")};
         }
 
         if (matches(in, inputFormats) == null)
@@ -56,14 +56,14 @@ public Format[] getSupportedOutputFormats(Format in)
 
         if (! (in instanceof AudioFormat))
         {
-            return new Format[]{new AudioFormat(AudioFormat.ALAW)};
+            return new Format[]{new AudioFormat("ALAW")};
         }
 
         AudioFormat af = (AudioFormat) in;
         return new Format[]
         {
             new AudioFormat(
-                AudioFormat.ALAW,
+                "ALAW",
                 af.getSampleRate(),
                 af.getSampleSizeInBits(),
                 af.getChannels())

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -43,7 +43,7 @@ public class AccountRegWizardContainerImpl
     ConfigurationService configService = GuiActivator.getConfigurationService();
 
     private static final String RESOURCE_NAME 
-        = "net.java.sip.communicator.impl.gui.main.login.login";
+        = "resources.login";
 
     private static final ResourceBundle LOGIN_RESOURCE_BUNDLE
         = ResourceBundle.getBundle(RESOURCE_NAME);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -420,7 +420,7 @@ else if (itemName.equalsIgnoreCase("sendSms"))
 
             ContactListPanel clistPanel = mainFrame.getContactListPanel();
             SwingUtilities.invokeLater(clistPanel.new RunMessageWindow(
-                    contactItem, defaultSmsContact));
+                    contactItem, defaultSmsContact, true));
         }
         else if (itemName.equalsIgnoreCase("call"))
         {

File: src/net/java/sip/communicator/impl/media/codec/audio/alaw/Packetizer.java
Patch:
@@ -21,7 +21,7 @@ public class Packetizer
 {
     public Packetizer()
     {
-        packetSize = 480;
+        packetSize = 160;
         supportedInputFormats = new AudioFormat[]
             {
             new AudioFormat(

File: src/net/java/sip/communicator/impl/gui/main/chat/menus/SettingsMenu.java
Patch:
@@ -114,7 +114,7 @@ else if (item.getName().equals("sendingMessageCommand"))
                         ConfigurationManager.ENTER_COMMAND);
             else
                 ConfigurationManager.setSendMessageCommand(
-                        ConfigurationManager.ENTER_COMMAND);
+                        ConfigurationManager.CTRL_ENTER_COMMAND);
         }
         else if (item.getName().equals("autopopup"))
         {

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -455,7 +455,9 @@ protected void loadStoredAccounts(BundleContext bundleContext)
                             Base64.decode(storedPropertyValue));
                     }
                 }
-                accountProperties.put(propertyName, storedPropertyValue);
+                
+                if(storedPropertyValue != null)
+                    accountProperties.put(propertyName, storedPropertyValue);
             }
             try
             {

File: src/net/java/sip/communicator/plugin/branding/Resources.java
Patch:
@@ -21,11 +21,11 @@ public class Resources
 {
     private static Logger log = Logger.getLogger(Resources.class);
 
-    private static final String RESOUCRE_LOCATION
+    private static final String RESOURCE_LOCATION
         = "net.java.sip.communicator.plugin.branding.resources";
 
     private static final ResourceBundle resourceBundle 
-        = ResourceBundle.getBundle(RESOUCRE_LOCATION);
+        = ResourceBundle.getBundle(RESOURCE_LOCATION);
 
     private static final String COLOR_BUNDLE_NAME
         = "resources.colors.colorResources";

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommTabbedPaneEnhancedUI.java
Patch:
@@ -32,7 +32,7 @@ public class SIPCommTabbedPaneEnhancedUI extends SIPCommTabbedPaneUI {
 
     private static final Color whiteColor = Color.white;
 
-    private static final int TAB_OVERLAP = 0;
+    private static final int TAB_OVERLAP = 10;
 
     private static final int PREFERRED_WIDTH = 150;
     

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommDefaultTheme.java
Patch:
@@ -213,6 +213,9 @@ public void addCustomEntriesToTable(UIDefaults table)
                 "TabbedPane.selected", SELECTION_BACKGROUND,
                 "TabbedPane.tabAreaInsets", new Insets(2, 2, 0, 6),
                 "TabbedPane.unselectedBackground", SELECTION_BACKGROUND,
+                "TabbedPane.shadow", CONTROL_SHADOW,
+                "TabbedPane.darkShadow", CONTROL_DARK_SHADOW,
+                "TabbedPane.highlight", CONTROL_COLOR,
 
                 "TextField.border", textFieldBorder,
                 "TextField.margin", new InsetsUIResource(3, 3, 3, 3),

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommTabbedPaneUI.java
Patch:
@@ -1452,7 +1452,7 @@ public void mousePressed(MouseEvent e) {
             
             if (closeIndexStatus == OVER) {
                 closeIndexStatus = PRESSED;
-                tabScroller.tabPanel.repaint();                
+                tabScroller.tabPanel.repaint();
             }
             else if (maxIndexStatus == OVER) {
                 maxIndexStatus = PRESSED;

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/whiteboard/WhiteboardObjectTextJabberImpl.java
Patch:
@@ -56,7 +56,6 @@ public WhiteboardObjectTextJabberImpl ()
     {
         super ();
 
-        this.setID ("");
         this.setWhiteboardPoint (new WhiteboardPoint (0, 0));
         this.setFontName (fontName);
         this.setFontSize (fontSize);

File: src/net/java/sip/communicator/plugin/whiteboard/gui/WhiteboardFrame.java
Patch:
@@ -971,7 +971,7 @@ public void actionPerformed(java.awt.event.ActionEvent evt)
             }
         });
 
-//        toolBar.add(imageButton);
+        toolBar.add(imageButton);
 
         buttonGroup.add(polygonButton);
         polygonButton.setToolTipText(Resources.getString("polygon"));

File: src/net/java/sip/communicator/impl/gui/GuiActivator.java
Patch:
@@ -75,9 +75,9 @@ public void start(BundleContext bundleContext) throws Exception {
 
             logger.info("UI Service...[  STARTED ]");
 
-            bundleContext.registerService(UIService.class.getName(),
-                    this.uiService, null);
-            
+            bundleContext.registerService(  UIService.class.getName(),
+                                            this.uiService, null);
+
             logger.info("UI Service ...[REGISTERED]");
 
             this.uiService.loadApplicationGui();

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -642,7 +642,8 @@ else if ((e.getModifiers() & InputEvent.BUTTON1_MASK) != 0)
                     contactRightButtonMenu.setVisible(true);
                 }
                 // Left click on the contact label opens Chat window
-                else if ((e.getModifiers() & InputEvent.BUTTON1_MASK) != 0)
+                else if ((e.getModifiers() & InputEvent.BUTTON1_MASK) != 0
+                    && e.getClickCount() > 1)
                 {
                     fireContactListEvent(contact,
                         ContactListEvent.CONTACT_SELECTED, e.getClickCount());

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -81,8 +81,9 @@ public LoginManager(MainFrame mainFrame)
     public ProtocolProviderService installAccount(
         ProtocolProviderFactory providerFactory, String user, String passwd)
     {
+        Hashtable<String, String> accountProperties
+            = new Hashtable<String, String>();
 
-        Hashtable accountProperties = new Hashtable();
         accountProperties.put(ProtocolProviderFactory.PASSWORD, passwd);
 
         AccountID accountID = providerFactory.installAccount(user,

File: src/net/java/sip/communicator/impl/gui/utils/Constants.java
Patch:
@@ -344,7 +344,7 @@ public class Constants
      * The default path, where chat window styles could be found.
      */
     public static final String DEFAULT_STYLE_PATH
-        = "net/java/sip/communicator/impl/gui/resources/styles";
+        = "resources/styles";
 
     /*
      * ======================================================================

File: src/net/java/sip/communicator/impl/protocol/gibberish/ProtocolIconGibberishImpl.java
Patch:
@@ -37,10 +37,10 @@ public class ProtocolIconGibberishImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,    
-            loadIcon("resources/images/gibberish/gibberish-online.png"));
+            loadIcon("resources/images/protocol/gibberish/gibberish-online.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/gibberish/gibberish64x64.png"));
+            loadIcon("resources/images/protocol/gibberish/gibberish64x64.png"));
     }
         
     /**
@@ -76,7 +76,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/gibberish/gibberish-online.png");
+        return loadIcon("resources/images/protocol/gibberish/gibberish-online.png");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolIconAimImpl.java
Patch:
@@ -29,10 +29,10 @@ public class ProtocolIconAimImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,    
-            loadIcon("resources/images/aim/aim16x16-online.png"));
+            loadIcon("resources/images/protocol/aim/aim16x16-online.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/aim/aim64x64.png"));
+            loadIcon("resources/images/protocol/aim/aim64x64.png"));
     }
  
     /**
@@ -68,7 +68,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/aim/cr16-action-aim_connecting.gif");
+        return loadIcon("resources/images/protocol/aim/cr16-action-aim_connecting.gif");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolIconIcqImpl.java
Patch:
@@ -29,10 +29,10 @@ public class ProtocolIconIcqImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,    
-            loadIcon("resources/images/icq/icq16x16-online.png"));
+            loadIcon("resources/images/protocol/icq/icq16x16-online.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/icq/icq64x64.png"));
+            loadIcon("resources/images/protocol/icq/icq64x64.png"));
     }
  
     /**
@@ -68,7 +68,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/icq/cr16-action-icq_connecting-1.gif");
+        return loadIcon("resources/images/protocol/icq/cr16-action-icq_connecting-1.gif");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStatusEnum.java
Patch:
@@ -32,7 +32,7 @@ public class IrcStatusEnum
         = new IrcStatusEnum(
             0
             , "Offline"
-            , loadIcon("resources/images/irc/cr16-action-irc_offline.png"));
+            , loadIcon("resources/images/protocol/irc/cr16-action-irc_offline.png"));
 
     /**
      * The Away status. Indicates that the user has connectivity but might
@@ -42,7 +42,7 @@ public class IrcStatusEnum
         = new IrcStatusEnum(
             40
             , "Away"
-            , loadIcon("resources/images/gibberish/gibberish-away.png"));
+            , loadIcon("resources/images/protocol/gibberish/gibberish-away.png"));
 
     /**
      * The Online status. Indicate that the user is able and willing to
@@ -52,7 +52,7 @@ public class IrcStatusEnum
         = new IrcStatusEnum(
             65
             , "Online"
-            , loadIcon("resources/images/irc/cr16-action-irc_online.png"));
+            , loadIcon("resources/images/protocol/irc/cr16-action-irc_online.png"));
 
     /**
      * Initialize the list of supported status states.

File: src/net/java/sip/communicator/impl/protocol/irc/ProtocolIconIrcImpl.java
Patch:
@@ -30,10 +30,10 @@ public class ProtocolIconIrcImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,    
-            loadIcon("resources/images/irc/cr16-action-irc_online.png"));
+            loadIcon("resources/images/protocol/irc/cr16-action-irc_online.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/irc/cr32-app-irc_protocol.png"));
+            loadIcon("resources/images/protocol/irc/cr32-app-irc_protocol.png"));
     }
  
     /**
@@ -69,7 +69,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/irc/cr16-action-irc_connecting-1.gif");
+        return loadIcon("resources/images/protocol/irc/cr16-action-irc_connecting-1.gif");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolIconJabberImpl.java
Patch:
@@ -29,10 +29,10 @@ public class ProtocolIconJabberImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,    
-            loadIcon("resources/images/jabber/jabber16x16-online.png"));
+            loadIcon("resources/images/protocol/jabber/jabber16x16-online.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_48x48,
-            loadIcon("resources/images/jabber/jabber48x48.png"));
+            loadIcon("resources/images/protocol/jabber/jabber48x48.png"));
     }
  
     /**
@@ -68,7 +68,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/jabber/jabber16x16-connecting.gif");
+        return loadIcon("resources/images/protocol/jabber/jabber16x16-connecting.gif");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolIconMsnImpl.java
Patch:
@@ -29,10 +29,10 @@ public class ProtocolIconMsnImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,
-            loadIcon("resources/images/msn/msn16x16.png"));
+            loadIcon("resources/images/protocol/msn/msn16x16.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/msn/msn64x64.png"));
+            loadIcon("resources/images/protocol/msn/msn64x64.png"));
     }
  
     /**
@@ -68,7 +68,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/msn/msn16x16-connecting.gif");
+        return loadIcon("resources/images/protocol/msn/msn16x16-connecting.gif");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/rss/ProtocolIconRssImpl.java
Patch:
@@ -38,10 +38,10 @@ public class ProtocolIconRssImpl
     static 
     {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,    
-            loadIcon("resources/images/rss/rss-online.png"));
+            loadIcon("resources/images/protocol/rss/rss-online.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/rss/rss64x64.png"));
+            loadIcon("resources/images/protocol/rss/rss64x64.png"));
     }
         
     /**
@@ -77,7 +77,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/rss/rss-online.png");
+        return loadIcon("resources/images/protocol/rss/rss-online.png");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/rss/RssStatusEnum.java
Patch:
@@ -31,7 +31,7 @@ public class RssStatusEnum
         = new RssStatusEnum(
             0
             , "Offline"
-            , loadIcon("resources/images/rss/rss-offline.png"));
+            , loadIcon("resources/images/protocol/rss/rss-offline.png"));
 
     /**
      * The Online status. Indicate that the user is able and willing to
@@ -41,7 +41,7 @@ public class RssStatusEnum
         = new RssStatusEnum(
             65
             , "Online"
-            , loadIcon("resources/images/rss/rss-online.png"));
+            , loadIcon("resources/images/protocol/rss/rss-online.png"));
 
     /**
      * Initialize the list of supported status states.

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolIconSipImpl.java
Patch:
@@ -29,10 +29,10 @@ public class ProtocolIconSipImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,
-            loadIcon("resources/images/sip/sip16x16.png"));
+            loadIcon("resources/images/protocol/sip/sip16x16.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/sip/sip64x64.png"));
+            loadIcon("resources/images/protocol/sip/sip64x64.png"));
     }
  
     /**
@@ -68,7 +68,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/sip/sip-connecting.gif");
+        return loadIcon("resources/images/protocol/sip/sip-connecting.gif");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/ssh/ProtocolIconSSHImpl.java
Patch:
@@ -35,10 +35,10 @@ public class ProtocolIconSSHImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,    
-            loadIcon("resources/images/ssh/ssh-online.png"));
+            loadIcon("resources/images/protocol/ssh/ssh-online.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/ssh/ssh64x64.png"));
+            loadIcon("resources/images/protocol/ssh/ssh64x64.png"));
     }
         
     /**
@@ -77,7 +77,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/ssh/ssh-online.png");
+        return loadIcon("resources/images/protocol/ssh/ssh-online.png");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/ssh/SSHStatusEnum.java
Patch:
@@ -36,7 +36,7 @@ public class SSHStatusEnum
             = new SSHStatusEnum(
             0
             , "Offline"
-            , loadIcon("resources/images/ssh/ssh-offline.png"));
+            , loadIcon("resources/images/protocol/ssh/ssh-offline.png"));
     
     /**
      * The Not Available status. Indicates that the user has connectivity
@@ -48,7 +48,7 @@ public class SSHStatusEnum
             = new SSHStatusEnum(
             35
             , "Not Available"
-            , loadIcon("resources/images/ssh/ssh-na.png"));
+            , loadIcon("resources/images/protocol/ssh/ssh-na.png"));
     
     /**
      * The Connecting status. Indicate that the user is connecting to remote
@@ -58,7 +58,7 @@ public class SSHStatusEnum
             = new SSHStatusEnum(
             55
             , "Connecting"            
-            , loadIcon("resources/images/ssh/ssh-connecting.png"));
+            , loadIcon("resources/images/protocol/ssh/ssh-connecting.png"));
    
     /**
      * The Online status. Indicate that the user is able and willing to

File: src/net/java/sip/communicator/impl/protocol/yahoo/ProtocolIconYahooImpl.java
Patch:
@@ -29,10 +29,10 @@ public class ProtocolIconYahooImpl
     private static Hashtable iconsTable = new Hashtable();
     static {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,
-            loadIcon("resources/images/yahoo/yahoo16x16.png"));
+            loadIcon("resources/images/protocol/yahoo/yahoo16x16.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/yahoo/yahoo64x64.png"));
+            loadIcon("resources/images/protocol/yahoo/yahoo64x64.png"));
     }
  
     /**
@@ -68,7 +68,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/yahoo/yahoo16x16-connecting.gif");
+        return loadIcon("resources/images/protocol/yahoo/yahoo16x16-connecting.gif");
     }
     
     /**

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ProtocolIconZeroconfImpl.java
Patch:
@@ -32,10 +32,10 @@ public class ProtocolIconZeroconfImpl
     static 
     {
         iconsTable.put(ProtocolIcon.ICON_SIZE_16x16,    
-            loadIcon("resources/images/zeroconf/zeroconf-online.png"));
+            loadIcon("resources/images/protocol/zeroconf/zeroconf-online.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/zeroconf/zeroconf-color-64.png"));
+            loadIcon("resources/images/protocol/zeroconf/zeroconf-color-64.png"));
     }
         
     /**
@@ -74,7 +74,7 @@ public byte[] getIcon(String iconSize)
      */
     public byte[] getConnectingIcon()
     {
-        return loadIcon("resources/images/zeroconf/zeroconf-online.png");
+        return loadIcon("resources/images/protocol/zeroconf/zeroconf-online.png");
     }
     
     /**

File: src/net/java/sip/communicator/plugin/branding/AboutWindow.java
Patch:
@@ -142,7 +142,8 @@ public WindowBackground()
             try
             {
                 bgImage = ImageIO.read(WindowBackground.class
-                        .getResource("resources/aboutWindowBackground.png"));
+                        .getResource(
+                            BrandingResources.getString("aboutWindowBg")));
             }
             catch (IOException e)
             {

File: src/net/java/sip/communicator/plugin/branding/Constants.java
Patch:
@@ -53,8 +53,8 @@ public class Constants
      */
     public static void loadSimpleStyle(StyleSheet style)
     {
-        InputStream is = Constants.class
-                .getResourceAsStream("resources/defaultStyle.css");
+        InputStream is = Constants.class.getClassLoader()
+                .getResourceAsStream(BrandingResources.getString("textStyle"));
 
         Reader r = new BufferedReader(new InputStreamReader(is));
         try

File: src/net/java/sip/communicator/service/protocol/event/WhiteboardParticipantEvent.java
Patch:
@@ -30,7 +30,7 @@ public class WhiteboardParticipantEvent
      * An event id value indicating that this event is about the fact that
      * the source whiteboard participant has left the source whiteboard.
      */
-    public static final int WHITEBOARD_PARTICIPANT_REMVOVED = 2;
+    public static final int WHITEBOARD_PARTICIPANT_REMOVED = 2;
 
     /**
      * The id indicating the type of this event.

File: src/net/java/sip/communicator/plugin/whiteboard/WhiteboardActivator.java
Patch:
@@ -101,6 +101,9 @@ public static List getWhiteboardOperationSets()
                         + e);
         }
 
+        if (serRefs == null)
+            return null;
+
         for (int i = 0; i < serRefs.length; i++)
         {
             ProtocolProviderService protocolProvider

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetPersistentPresenceIcqImpl.java
Patch:
@@ -1694,7 +1694,7 @@ public void buddyOffline(BuddyService service, Screenname buddy)
     }
 
     /**
-     * Apart from loggin - does nothing so far.
+     * Apart from login - does nothing so far.
      */
     private class GlobalBuddyInfoListener extends GlobalBuddyInfoAdapter{
         public void receivedStatusUpdate(BuddyInfoManager manager,
@@ -1711,8 +1711,7 @@ public void receivedStatusUpdate(BuddyInfoManager manager,
             
             if(sourceContact != null)
             {
-                if(statusMessage != null)
-                    sourceContact.setStatusMessage(statusMessage);
+                sourceContact.setStatusMessage(statusMessage);
             }
             
         }

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -58,6 +58,7 @@ public class UIServiceImpl
         supportedContainers.add(UIService.CONTAINER_CHAT_TOOL_BAR);
         supportedContainers.add(UIService.CONTAINER_CALL_HISTORY);
         supportedContainers.add(UIService.CONTAINER_MAIN_TABBED_PANE);
+        supportedContainers.add(UIService.CONTAINER_CHAT_HELP_MENU);
     }
 
     private static final Hashtable exportedWindows = new Hashtable();

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetPersistentPresenceYahooImpl.java
Patch:
@@ -458,9 +458,9 @@ public void publishPresenceStatus(PresenceStatus status,
                 yahooProvider.getYahooSession().
                     setStatus(statusMessage, isAvailable);
             }
-            else
-                yahooProvider.getYahooSession().setStatus(
-                    ((Long)scToYahooModesMappings.get(status)).longValue());
+            
+            yahooProvider.getYahooSession().setStatus(
+                ((Long)scToYahooModesMappings.get(status)).longValue());
             
             fireProviderPresenceStatusChangeEvent(currentStatus, status);
         }

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicInstantMessagingSipImpl.java
Patch:
@@ -452,7 +452,7 @@ private Request createMessage(Contact to, Message message)
                 viaHeaders,
                 maxForwards,
                 contTypeHeader,
-                message.getContent().getBytes());
+                message.getRawData());
         }
         catch (ParseException ex)
         {

File: src/net/java/sip/communicator/impl/fileaccess/FailSafeTransactionImpl.java
Patch:
@@ -87,8 +87,6 @@ public void restoreFile()
      * When the transaction begins, the file is restored to a coherent state if
      * needed.
      * 
-     * @return The fail-safe file in which every modification must be done.
-     * 
      * @throws IllegalStateException if the file doesn't exists anymore
      * @throws IOException if an IOException occurs during the transaction
      * creation

File: src/net/java/sip/communicator/service/fileaccess/FailSafeTransaction.java
Patch:
@@ -32,8 +32,6 @@ public void restoreFile()
      * When the transaction begins, the file is restored to a coherent state if
      * needed.
      * 
-     * @return The fail-safe file in which every modification must be done.
-     * 
      * @throws IllegalStateException if the file doesn't exists anymore
      * @throws IOException if an IOException occurs during the transaction
      * creation

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -260,8 +260,6 @@ public void modifyAccount(ProtocolProviderService protocolProvider)
         AccountRegistrationWizard wizard =
             getWizardFromClassName(wizardClassName);
 
-        this.registerWizardPage(summaryPage.getIdentifier(), summaryPage);
-
         this.setCurrentWizard(wizard);
 
         Iterator i = wizard.getPages();

File: test/net/java/sip/communicator/slick/protocol/yahoo/TestOperationSetPresence.java
Patch:
@@ -287,7 +287,7 @@ public void subtestStateTransition( YahooStatusEnum newStatus)
         PresenceStatusEventCollector statusEventCollector2
             = new PresenceStatusEventCollector();
         ContactPresenceEventCollector statusEventCollector1
-            = new ContactPresenceEventCollector(fixture.userID1, newStatus);
+            = new ContactPresenceEventCollector(fixture.userID2, newStatus);
         operationSetPresence2.addProviderPresenceStatusListener(
             statusEventCollector2);
         operationSetPresence1.addContactPresenceStatusListener(
@@ -456,7 +456,7 @@ public void postTestSubscribe()
                     .removeContactPresenceStatusListener(contactPresEvtCollector);
             }
         }
-        
+
         assertEquals("Presence Notif. event dispatching failed."
                      , 1, contactPresEvtCollector.collectedEvents.size());
         ContactPresenceStatusChangeEvent presEvt =

File: src/net/java/sip/communicator/service/protocol/PresenceStatus.java
Patch:
@@ -45,7 +45,7 @@ public class PresenceStatus
      * An integer above which all values of the status coefficient indicate
      * eagerness to communicate
      */
-    public static final int EAGER_TO_COMMUNICATE_THRESSHOLD = 80;
+    public static final int EAGER_TO_COMMUNICATE_THRESHOLD = 80;
 
     /**
      * An integer indicating the maximum possible value of the status field.
@@ -166,7 +166,7 @@ public boolean isAvailable()
      */
     public boolean isEagerToCommunicate()
     {
-        return getStatus() >= EAGER_TO_COMMUNICATE_THRESSHOLD;
+        return getStatus() >= EAGER_TO_COMMUNICATE_THRESHOLD;
     }
 
     /**

File: src/net/java/sip/communicator/service/protocol/PresenceStatus.java
Patch:
@@ -45,7 +45,7 @@ public class PresenceStatus
      * An integer above which all values of the status coefficient indicate
      * eagerness to communicate
      */
-    public static final int EAGER_TO_COMMUNICATE_THRESHOLD = 80;
+    public static final int EAGER_TO_COMMUNICATE_THRESSHOLD = 80;
 
     /**
      * An integer indicating the maximum possible value of the status field.
@@ -59,7 +59,7 @@ public class PresenceStatus
 
     /**
      * Represents the connectivity status on a scale from
-     * 0 to 100  with 0 indicating complete disability for communication and 100
+     * 0 to 100  with 0 indicating complete disabiilty for communication and 100
      * maximum ability and user willingness. Implementors of this service should
      * respect the following indications for status values.
      * 0      - complete disability
@@ -166,7 +166,7 @@ public boolean isAvailable()
      */
     public boolean isEagerToCommunicate()
     {
-        return getStatus() >= EAGER_TO_COMMUNICATE_THRESHOLD;
+        return getStatus() >= EAGER_TO_COMMUNICATE_THRESSHOLD;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -265,9 +265,9 @@ else if (buttonName.equals("info"))
                 else
                 {
                     new ErrorDialog(mainFrame,
+                        Messages.getI18NString("warning").getText(),
                         Messages.getI18NString("selectContactSupportingInfo")
                             .getText(),
-                        Messages.getI18NString("warning").getText(),
                         ErrorDialog.WARNING).showDialog();
                 }
             }            

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -239,12 +239,12 @@ else if (selectedPanel != null
                             {
                                 new ErrorDialog(
                                     this.mainFrame,
+                                    Messages.getI18NString("warning").getText(),
                                     Messages.getI18NString(
                                         "contactNotSupportingTelephony",
                                         new String[]
                                         { ((MetaContact) o).getDisplayName() })
-                                            .getText(),
-                                    Messages.getI18NString("warning").getText())
+                                            .getText())
                                     .showDialog();
                             }
                         }

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomDialog.java
Patch:
@@ -134,11 +134,11 @@ public void run()
                     if(chatRoom == null)
                     {
                         new ErrorDialog(mainFrame,
+                            Messages.getI18NString("error").getText(),
                             Messages.getI18NString("chatRoomNotExist",
                                 new String[]{chatRoomName,
                                 protocolProvider.getAccountID().getService()})
-                                .getText(),
-                            Messages.getI18NString("error").getText())
+                                .getText())
                                 .showDialog();
                     }
                     else

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomWizard.java
Patch:
@@ -102,11 +102,11 @@ public void run()
             if(chatRoom == null)
             {
                 new ErrorDialog(mainFrame,
+                    Messages.getI18NString("error").getText(),
                     Messages.getI18NString("chatRoomNotExist",
                         new String[]{chatRoomName,
                         newChatRoom.getProtocolProvider().getAccountID()
-                        .getService()}).getText(),
-                    Messages.getI18NString("error").getText())
+                        .getService()}).getText())
                         .showDialog();
             }
             else

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommDialog.java
Patch:
@@ -53,19 +53,19 @@ public SIPCommDialog(Frame owner, boolean isSaveSizeAndLocation)
     {
         this(owner);
         
-        this.isSaveSizeAndLocation = isSaveSizeAndLocation;        
+        this.isSaveSizeAndLocation = isSaveSizeAndLocation;
     }
     
     private void initInputMap()
     {
         amap = this.getRootPane().getActionMap();
 
         amap.put("close", new CloseAction());
-        
+
         imap = this.getRootPane().getInputMap(
                 JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
 
-        imap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0), "close");  
+        imap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0), "close");
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommMenu.java
Patch:
@@ -72,7 +72,7 @@ public void addItem(String text, Icon icon, ActionListener actionListener)
      * @param o The object to select.
      * @param icon The icon to select.
      */
-    public void setSelected(Object o, Icon icon)
+    public void setSelected(Object o, ImageIcon icon)
     {
         this.setIcon(icon);
         this.setSelectedObject(o);

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -209,7 +209,7 @@ public class ProtocolProviderServiceSipImpl
      * the port where they would prefer us to bind our sip socket.
      */
     private static final String PREFERRED_SIP_PORT =
-        "net.java.sip.communicator.impl.protocol.sip.PREFERRED_SIP_PORT";
+        "net.java.sip.communicator.service.protocol.sip.PREFERRED_SIP_PORT";
 
 
     /**
@@ -607,8 +607,8 @@ protected void initialize(String    sipAddress,
             //init proxy port
             int preferredSipPort = ListeningPoint.PORT_5060;
 
-            String proxyPortStr = (String) accountID.getAccountProperties()
-                .get(PREFERRED_SIP_PORT);
+            String proxyPortStr = SipActivator.getConfigurationService().
+                    getString(PREFERRED_SIP_PORT);
 
             if (proxyPortStr != null && proxyPortStr.length() > 0)
             {

File: src/net/java/sip/communicator/impl/systray/jdic/SystrayServiceJdicImpl.java
Patch:
@@ -126,7 +126,7 @@ private void initSystray()
             envelopeIcon = new ImageIcon(
                     Resources.getImage("messageIconWindows"));
         }
-        // If we're running under MacOSX, we use a special back and 
+        // If we're running under MacOSX, we use a special black and 
         // white icons without background.
         else if (osName.startsWith("Mac OS X"))
         {

File: src/net/java/sip/communicator/service/protocol/PresenceStatus.java
Patch:
@@ -45,7 +45,7 @@ public class PresenceStatus
      * An integer above which all values of the status coefficient indicate
      * eagerness to communicate
      */
-    public static final int EAGER_TO_COMMUNICATE_THRESSHOLD = 80;
+    public static final int EAGER_TO_COMMUNICATE_THRESHOLD = 80;
 
     /**
      * An integer indicating the maximum possible value of the status field.
@@ -59,7 +59,7 @@ public class PresenceStatus
 
     /**
      * Represents the connectivity status on a scale from
-     * 0 to 100  with 0 indicating complete disabiilty for communication and 100
+     * 0 to 100  with 0 indicating complete disability for communication and 100
      * maximum ability and user willingness. Implementors of this service should
      * respect the following indications for status values.
      * 0      - complete disability
@@ -166,7 +166,7 @@ public boolean isAvailable()
      */
     public boolean isEagerToCommunicate()
     {
-        return getStatus() >= EAGER_TO_COMMUNICATE_THRESSHOLD;
+        return getStatus() >= EAGER_TO_COMMUNICATE_THRESHOLD;
     }
 
     /**

File: src/net/java/sip/communicator/impl/media/transform/srtp/SRTPCryptoContext.java
Patch:
@@ -166,7 +166,7 @@ public SRTPCryptoContext(long ssrc)
      * @param roc the initial Roll-Over-Counter according to RFC 3711.
      * These are the upper 32 bit of the overall 48 bit SRTP packet index.
      * Refer to chapter 3.2.1 of the RFC.
-     * @param keyDerivRate the key derivation rate defines when to recompute
+     * @param keyDerivationRate the key derivation rate defines when to recompute
      * the SRTP session keys. Refer to chapter 4.3.1 in the RFC.
      * @param masterKey byte array holding the master key for this SRTP
      * cryptographic context. Refer to chapter 3.2.1 of the RFC about the
@@ -712,7 +712,7 @@ private void update(int seqNum)
      *
      * @param ssrc The SSRC for this context
      * @param roc The Roll-Over-Counter for this context
-     * @param keyDerivRate The key derivation rate for this context
+     * @param deriveRate The key derivation rate for this context
      * @return a new SRTPCryptoContext with all relevant data set.
      */
     public SRTPCryptoContext deriveContext(long ssrc, int roc, long deriveRate)

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -223,7 +223,7 @@ public class ProtocolProviderServiceSipImpl
      * A default specifyier telling the stack whether or not to cache client
      * connections.
      */
-    private static final String NSPVALUE_CACHE_CLIENT_CONNECTIONS = "false";
+    private static final String NSPVALUE_CACHE_CLIENT_CONNECTIONS = "true";
 
     /**
      * The name of the property under which the user may specify a transport

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -1484,6 +1484,8 @@ else if( evt.getNewValue() == CallState.CALL_ENDED
             {
                 Player player = ( Player )playersIter.next();
                 player.stop();
+                player.deallocate();
+                player.close();
                 playersIter.remove();
             }
 

File: src/net/java/sip/communicator/impl/media/MediaServiceImpl.java
Patch:
@@ -155,8 +155,9 @@ public CallSession createCallSession(Call call)
         CallSessionImpl callSession = new CallSessionImpl(
                 call, this, (URL)callDataSinkMappings.get(call));
 
-        activeCallSessions.put(call, callSession);
-
+        // commented out because it leaks memory, and activeCallSessions isn't 
+        // used anyway (by Michael Koch)
+        // activeCallSessions.put(call, callSession);
         /** @todo make sure you remove the session once its over. */
 
         return callSession;

File: src/net/java/sip/communicator/impl/protocol/rss/RssItemKey.java
Patch:
@@ -119,6 +119,7 @@ public String getItemUri()
      * Used for restoring the key information from a textual representation.
      *
      * @param settings textual representation of the stored data
+     * @return the result rss item
      */
     public static RssItemKey deserialize(String settings)
     {
@@ -127,7 +128,7 @@ public static RssItemKey deserialize(String settings)
 
         while (reader.hasMoreTokens())
         {
-            String data[] = reader.nextToken().split("=");
+            String data[] = reader.nextToken().split("=", 2);
             if (data[0].equals("itemDate"))
             {
                 if (data.length == 2)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -399,15 +399,15 @@ public void actionPerformed(ActionEvent e){
                 AddContactDialog dialog = new AddContactDialog(
                         mainFrame,
                         contactItem, pps);
-    
+
                 dialog.setLocation(
                         Toolkit.getDefaultToolkit().getScreenSize().width/2
                             - 250,
                         Toolkit.getDefaultToolkit().getScreenSize().height/2
                             - 100
                         );
-    
-                dialog.setVisible(true);
+
+                dialog.showDialog();
             }
         }
         else if (itemName.equalsIgnoreCase("sendMessage"))

File: src/net/java/sip/communicator/impl/gui/main/chat/history/HistoryWindow.java
Patch:
@@ -87,7 +87,7 @@ public class HistoryWindow
     /**
      * Creates an instance of the <tt>HistoryWindow</tt>.
      * @param mainFrame the main application window
-     * @param o the <tt>MetaContact</tt> or the <tt>ChatRoom</tt>
+     * @param historyContact the <tt>MetaContact</tt> or the <tt>ChatRoom</tt>
      */
     public HistoryWindow(MainFrame mainFrame, Object historyContact)
     {

File: src/net/java/sip/communicator/service/protocol/ChatRoom.java
Patch:
@@ -310,8 +310,8 @@ public Message createMessage(byte[] content, String contentType,
     public Message createMessage(String messageText);
 
     /**
-     * Sends the <tt>message</tt> to the destination indicated by the
-     * <tt>to</tt> contact.
+     * Sends the <tt>message</tt> to this chat room.
+     * 
      * @param message the <tt>Message</tt> to send.
      * @throws OperationFailedException if sending the message fails for some
      * reason.

File: src/net/java/sip/communicator/service/protocol/OperationSetMultiUserChat.java
Patch:
@@ -72,7 +72,7 @@ public List getCurrentlyJoinedChatRooms(ChatRoomMember chatRoomMember)
      * @param roomProperties properties specifying how the room should be
      * created.
      * @throws OperationFailedException if the room couldn't be created for some
-     * reason (e.g. room already exists; user already joined to an existant
+     * reason (e.g. room already exists; user already joined to an existent
      * room or user has no permissions to create a chat room).
      * @throws OperationNotSupportedException if chat room creation is not
      * supported by this server

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatPanel.java
Patch:
@@ -51,13 +51,13 @@ public ConferenceChatPanel(ChatWindow chatWindow,
         this.chatRoomWrapper = chatRoomWrapper;
 
         subjectPanel = new ChatRoomSubjectPanel(chatWindow, chatRoomWrapper);
-        
+
         // The subject panel is added here, because it's specific for the
         // multi user chat and is not contained in the single chat chat panel.
         this.add(subjectPanel, BorderLayout.NORTH);
-        
+
         ChatRoom chatRoom = chatRoomWrapper.getChatRoom();
-        
+
         if(chatRoom != null && chatRoom.isJoined())
         {
             this.loadChatRoom(chatRoom);

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomsList.java
Patch:
@@ -491,7 +491,7 @@ public void run()
             }.start();
         }
     }
-    
+
     /**
      * Refreshes the chat room's list. Meant to be invoked when a modification
      * in a chat room is made and the list should be refreshed in order to show

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -150,7 +150,7 @@ public void addChat(ChatPanel chatPanel)
      * @param chatPanel The <tt>ChatPanel</tt> to add.
      */
     private void addSimpleChat(ChatPanel chatPanel)
-    {   
+    {
         this.getContentPane().add(chatPanel, BorderLayout.CENTER);
     }
 

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/MultiUserChatManager.java
Patch:
@@ -292,6 +292,8 @@ public void localUserPresenceChanged(
                 {
                     chatWindowManager.openChat(chatPanel, true);
                 }
+
+                chatPanel.updateChatRoomStatus(Constants.ONLINE_STATUS);
             }
 
             if (sourceChatRoom.isSystem())

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatContactPanel.java
Patch:
@@ -148,7 +148,7 @@ public ChatContactPanel(ChatPanel chatPanel, ChatContact contact)
         }
         else
         {
-            if (pps.getOperationSet(OperationSetBasicTelephony.class) == null)  
+            if (pps.getOperationSet(OperationSetBasicTelephony.class) == null)
                 this.callButton.setEnabled(false);
 
             if (pps.getOperationSet(OperationSetFileTransfer.class) == null)
@@ -270,7 +270,6 @@ else if (o instanceof Contact)
                 Vector v = new Vector();
                 v.add(m.getDefaultContact(OperationSetBasicTelephony.class));
                 cm.createCall(v);
-                        
             }
         }
         else if(button.getName().equals("info"))

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomDialog.java
Patch:
@@ -216,7 +216,7 @@ public void loadChatRoomsList()
         if(list != null)
         {
             if(list.size() == 0)
-                list.add(Messages.getI18NString("noAvailableRooms"));
+                list.add(Messages.getI18NString("noAvailableRooms").getText());
 
             chatRoomsList.setListData(new Vector(list));
             chatRoomsScrollPane.setPreferredSize(new Dimension(500, 120));

File: src/net/java/sip/communicator/service/notification/NotificationService.java
Patch:
@@ -212,7 +212,7 @@ public void removeEventNotificationAction(  String eventType,
      * @param eventType the name of the event that we'd like to retrieve actions
      * for.
      * @return a <tt>Map</tt> containing the <tt>actionType</tt>s (as keys) and
-     * <tt>actionDescriptor</tt>s (as values) that should be executed when
+     * <tt>actionHandler</tt>s (as values) that should be executed when
      * an event with the specified name has occurred, or null if no actions
      * have been defined for <tt>eventType</tt>.
      */

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatPanel.java
Patch:
@@ -364,6 +364,6 @@ public void chatRoomPropertyChanged(
 
     public void chatRoomPropertyChangeFailed(
         ChatRoomPropertyChangeFailedEvent event)
-    {   
+    {
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -639,9 +639,8 @@ else if ((e.getModifiers() & InputEvent.BUTTON1_MASK) != 0)
 
                     contactRightButtonMenu.setInvoker(this);
 
-                    Point p = new Point(e.getPoint());
-                    SwingUtilities.convertPointToScreen(p, this);
-                    contactRightButtonMenu.setLocation(p);
+                    contactRightButtonMenu.setLocation(selectedCellPoint.x,
+                        selectedCellPoint.y + renderer.getHeight());
 
                     contactRightButtonMenu.setVisible(true);
                 }

File: src/net/java/sip/communicator/impl/gui/utils/ImageLoader.java
Patch:
@@ -773,7 +773,7 @@ public class ImageLoader {
      * //TODO : change to an appropriate logo
      */
     public static final ImageLoader.ImageID CALL_16x16_ICON
-            = new ImageID("SIP_COMMUNICATOR_LOGO");
+            = new ImageID("CALL_16x16_ICON");
 
     /**
      * Delete 16x16 image.

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicTelephonyJabberImpl.java
Patch:
@@ -534,7 +534,7 @@ public void sessionCreated(JingleSession jingleSession)
      */
     public void mediaClosed(PayloadType payloadType)
     {
-        logger.info(" media losed ");
+        logger.info(" media closed ");
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/jabber/mediamgr/AudioMediaSession.java
Patch:
@@ -225,7 +225,7 @@ public void stopReceive()
      */
     public void receivedMediaStream(MediaEvent evt)
     {
-        getJingleSession().mediaReceived(evt.getFrom());
+        mediaReceived(evt.getFrom());
     }
 
     public void mediaServiceStatusChanged()

File: src/net/java/sip/communicator/impl/protocol/irc/OperationSetMultiUserChatIrcImpl.java
Patch:
@@ -375,7 +375,8 @@ private ChatRoom createLocalChatRoomInstance(String chatRoomName)
     /**
      * Returns the private room corresponding to the given nick name.
      * 
-     * @param nickName the nickName of the person for which the private room is.
+     * @param nickIdentifier the nickName of the person for which the private
+     * room is.
      * @return the private room corresponding to the given nick name
      */
     protected ChatRoomIrcImpl findPrivateChatRoom(String nickIdentifier)

File: src/net/java/sip/communicator/impl/protocol/irc/IrcStack.java
Patch:
@@ -1597,10 +1597,8 @@ protected void leave(ChatRoom chatRoom)
      * 
      * @param message The command we want to send.
      */
-    protected void sendCommand(ChatRoomIrcImpl chatRoom, Message message)
+    protected void sendCommand(ChatRoomIrcImpl chatRoom, String command)
     {
-        String command = message.getContent();
-
         if (command.startsWith("/me"))
         {
             this.sendAction(chatRoom.getName(), command.substring(3));

File: src/net/java/sip/communicator/plugin/ircaccregwizz/FirstWizardPage.java
Patch:
@@ -147,7 +147,6 @@ public FirstWizardPage(IrcAccountRegistration registration,
             new BoxLayout(valuesOptionsPanel, BoxLayout.Y_AXIS));
 
         this.portField.setEnabled(false);
-        this.passField.setEnabled(false);
         this.rememberPassBox.setEnabled(false);
     }
 
@@ -164,7 +163,7 @@ private void init()
         this.rememberPassBox.setSelected(true);
         this.autoNickChange.setSelected(true);
         this.defaultPort.setSelected(true);
-        this.passwordNotRequired.setSelected(true);
+        this.passwordNotRequired.setSelected(false);
 
         this.existingAccountLabel.setForeground(Color.RED);
 

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomCommonRightButtonMenu.java
Patch:
@@ -124,15 +124,15 @@ public void actionPerformed(ActionEvent e){
         {
             AddChatRoomDialog addChatRoomDialog
                 = new AddChatRoomDialog(mainFrame, protocolProvider);
-            
+
             addChatRoomDialog.setVisible(true);
         }
         else if (itemName.equals("searchForChatRooms"))
         {
             JoinChatRoomDialog joinChatRoomDialog
                 = new JoinChatRoomDialog(mainFrame, protocolProvider);
-            
-            joinChatRoomDialog.setVisible(true);
+
+            joinChatRoomDialog.showDialog();
         }
     }   
     

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomServerRightButtonMenu.java
Patch:
@@ -95,8 +95,8 @@ private void init()
      * Handles the <tt>ActionEvent</tt>. Determines which menu item was
      * selected and makes the appropriate operations.
      */
-    public void actionPerformed(ActionEvent e){
-
+    public void actionPerformed(ActionEvent e)
+    {
         JMenuItem menuItem = (JMenuItem) e.getSource();
         String itemName = menuItem.getName();
 
@@ -119,7 +119,7 @@ else if (itemName.equals("joinChatRoom"))
                 Toolkit.getDefaultToolkit().getScreenSize().height/2
                     - joinChannelDialog.getHeight()/2
                 );
-            joinChannelDialog.setVisible(true);
+            joinChannelDialog.showDialog();
         }
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomsListCellRenderer.java
Patch:
@@ -59,8 +59,8 @@ public ChatRoomsListCellRenderer()
      * and meta contact group cells.
      */
     public Component getListCellRendererComponent(JList list, Object value,
-            int index, boolean isSelected, boolean cellHasFocus) {
-
+            int index, boolean isSelected, boolean cellHasFocus)
+    {
         String toolTipText = "<html>";
 
         if (value instanceof ChatRoomWrapper)

File: src/net/java/sip/communicator/impl/protocol/irc/ProtocolProviderServiceIrcImpl.java
Patch:
@@ -451,7 +451,7 @@ protected RegistrationState getCurrentRegistrationState()
     /**
      * Sets the current registration state of this protocol provider.
      * 
-     * @param currentRegistrationState the new registration state to set
+     * @param regState the new registration state to set
      */
     protected void setCurrentRegistrationState(
         RegistrationState regState)

File: src/net/java/sip/communicator/plugin/ircaccregwizz/IrcAccountRegistrationWizard.java
Patch:
@@ -150,12 +150,11 @@ public ProtocolProviderService finish()
      * @param providerFactory the ProtocolProviderFactory which will create
      * the account
      * @param user the user identifier
-     * @param passwd the password
      * @return the <tt>ProtocolProviderService</tt> for the new account.
      */
     public ProtocolProviderService installAccount(
-        ProtocolProviderFactory providerFactory,
-        String user)
+                                        ProtocolProviderFactory providerFactory,
+                                        String user)
     {
 
         Hashtable accountProperties = new Hashtable();

File: src/net/java/sip/communicator/impl/systray/jdic/ProviderRegistration.java
Patch:
@@ -33,7 +33,8 @@ public class ProviderRegistration
     /**
      * The logger for this class.
      */
-    private Logger logger = Logger.getLogger(ProviderRegistration.class.getName());
+    private Logger logger
+        = Logger.getLogger(ProviderRegistration.class.getName());
 
     /**
      * Creates an instance of <tt>ProviderRegistration</tt>.
@@ -102,6 +103,4 @@ public UserCredentials obtainCredentials(String realm,
 
         return userCredentials;
     }
-
-
  }

File: src/net/java/sip/communicator/impl/systray/jdic/ProviderUnRegistration.java
Patch:
@@ -28,8 +28,9 @@ public class ProviderUnRegistration
     /**
      * The logger for this class.
      */
-    private Logger logger = Logger.getLogger(ProviderUnRegistration.class.getName());
-    
+    private Logger logger
+        = Logger.getLogger(ProviderUnRegistration.class.getName());
+
     /**
      * Creates an instance of <tt>ProviderUnRegistration</tt>.
      * @param protocolProvider the provider we want to unregister

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -559,7 +559,7 @@ private void initProcessor(DataSource dataSource)
                     if (format instanceof AudioFormat)
                     {
 
-                        if (transmittableAudioEncodings.contains(sdp))
+                        if (!transmittableAudioEncodings.contains(sdp))
                         {
                             if (logger.isDebugEnabled())
                             {

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -607,7 +607,8 @@ public Chat getChat(Contact contact)
 
         ChatWindowManager chatWindowManager = mainFrame.getChatWindowManager();
 
-        ChatPanel chatPanel = chatWindowManager.getContactChat(metaContact);
+        MetaContactChatPanel chatPanel
+            = chatWindowManager.getContactChat(metaContact);
 
         return chatPanel;
     }

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomsList.java
Patch:
@@ -253,7 +253,7 @@ public void mousePressed(MouseEvent e)
                 ChatWindowManager chatWindowManager
                     = mainFrame.getChatWindowManager();
                 
-                ChatPanel chatPanel
+                ConferenceChatPanel chatPanel
                     = chatWindowManager.getMultiChat(chatRoomWrapper);
                 
                 chatWindowManager.openChat(chatPanel, true);

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -142,9 +142,9 @@ public ChatPanel(ChatWindow chatWindow)
     public abstract Date getFirstHistoryMsgTimestamp();
 
     public abstract Date getLastHistoryMsgTimestamp();
-    
+
     public abstract void inviteChatContact(String contactAddress, String reason);
-    
+
     public ChatWindow getChatWindow()
     {
         return chatWindow;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -244,7 +244,9 @@ public String processMessage(String contactName, Date date,
 
         if (messageType.equals(Constants.INCOMING_MESSAGE))
         {   
-			this.lastIncomingMsgTimestamp = new Date(msgDate);
+            this.lastIncomingMsgTimestamp
+                = new Date(System.currentTimeMillis());
+
             chatString      = "<h2 identifier=\""
                             + msgHeaderID
                             + "\" date=\""

File: src/net/java/sip/communicator/impl/version/NightlyBuildID.java
Patch:
@@ -13,5 +13,5 @@
  */
 public class NightlyBuildID
 {
-    public static final String BUILD_ID="0.build.by.emcho";
+    public static final String BUILD_ID="0.build.by.CVS";
 }

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -15,7 +15,6 @@
 import javax.swing.Timer;
 import javax.swing.event.*;
 
-import net.java.sip.communicator.impl.gui.*;
 import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.impl.gui.i18n.*;
 import net.java.sip.communicator.impl.gui.main.*;
@@ -504,7 +503,7 @@ public void incomingCallReceived(CallEvent event)
         this.hangupButton.setEnabled(true);
 
         NotificationManager.fireNotification(
-            Sounds.INCOMING_CALL,
+            NotificationManager.INCOMING_CALL,
             null,
             "Incoming call recived from: "
                 + sourceCall.getCallParticipants().next());

File: src/net/java/sip/communicator/impl/media/RtpFlowImpl.java
Patch:
@@ -96,9 +96,9 @@ public class RtpFlowImpl
      * media data between two end points, using the given media encoding.
      *
      * @param mediaServie the media service which created us
-     * @param localAddress local IP address
+     * @param localIpAddress local IP address
      * @param localPort local port number
-     * @param remoteAddress remote IP address
+     * @param remoteIpAddress remote IP address
      * @param remotePort remote port number
      * @param mediaEncoding media encoding used for data
      *

File: src/net/java/sip/communicator/impl/protocol/jabber/mediamgr/AudioMediaSession.java
Patch:
@@ -48,7 +48,6 @@ public class AudioMediaSession
      * @param payloadType Payload used by jmf
      * @param remote      the remote information.
      * @param local       the local information.
-     * @param locator     media locator
      */
     public AudioMediaSession(PayloadType payloadType, TransportCandidate remote
             , TransportCandidate local)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatPanel.java
Patch:
@@ -551,7 +551,9 @@ public void propertyChange(PropertyChangeEvent evt)
                             .getContactListPanel().getContactList();
                     ContactListModel clistModel
                         = (ContactListModel) clist.getModel();
-
+                    
+                    // Remove the envelope from the contact when the chat has
+                    // gained the focus.
                     if(clistModel.isContactActive(selectedMetaContact))
                     {
                         clistModel.removeActiveContact(selectedMetaContact);

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/MultiUserChatManager.java
Patch:
@@ -127,10 +127,10 @@ public void messageReceived(ChatRoomMessageReceivedEvent evt)
             message.getContentType());
         
         chatWindowManager.openChat(chatPanel, false);
-
+        
         // Fire notification
-        String title = Resources.getString("messageReceived") + " "
-                + sourceMember.getName();
+        String title = Messages.getI18NString("msgReceived",
+            new String[]{sourceMember.getName()}).getText();
         
         NotificationManager.fireNotification(
                                         NotificationManager.INCOMING_MESSAGE,

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPanel.java
Patch:
@@ -246,8 +246,8 @@ else if(eventType == MessageReceivedEvent.SYSTEM_MESSAGE_RECEIVED)
             chatWindowManager.openChat(chatPanel, false);
          
             // Fire notification
-            String title = Messages.getI18NString("messageReceived").getText()
-                + " " + evt.getSourceContact().getDisplayName();
+            String title = Messages.getI18NString("msgReceived",
+                new String[]{evt.getSourceContact().getDisplayName()}).getText();
             
             NotificationManager.fireNotification(
                                             NotificationManager.INCOMING_MESSAGE,

File: src/net/java/sip/communicator/impl/systray/jdic/SystrayServiceJdicImpl.java
Patch:
@@ -25,7 +25,8 @@
 import net.java.sip.communicator.service.systray.event.*;
 import net.java.sip.communicator.util.*;
 
-import org.jdesktop.jdic.tray.*;
+import org.jdesktop.jdic.tray.SystemTray;
+import org.jdesktop.jdic.tray.TrayIcon;
 
 /**
  * The <tt>Systray</tt> provides a Icon and the associated <tt>TrayMenu</tt>

File: src/net/java/sip/communicator/impl/protocol/rss/RSSItemKey.java
Patch:
@@ -53,7 +53,7 @@ public RssItemKey()
      * Creates a RssContactSettings object that uses date to identify feed
      * items, with the last item date specified by the <tt>lastPostDate</tt>
      * parameter.
-     * @param lastPostDate date/time of the last feed item
+     * @param itemDate date/time of the item
      */
     public RssItemKey(Date itemDate)
     {
@@ -65,7 +65,7 @@ public RssItemKey(Date itemDate)
     /***
      * Creates a RssContactSettings object that uses URI to identify feed
      * items, with the last item URI specified by the <tt>lastPostUri</tt>
-     * @param lastPostUri URI/link of the last feed item
+     * @param itemUri URI/link of the item
      */
     public RssItemKey(String itemUri)
     {

File: src/net/java/sip/communicator/impl/systray/jdic/ProviderRegistration.java
Patch:
@@ -38,7 +38,6 @@ public class ProviderRegistration
     /**
      * Creates an instance of <tt>ProviderRegistration</tt>.
      *
-     * @param uiService a reference to the currently valid ui service instance.
      * @param protocolProvider the provider we want to register
      */
     public ProviderRegistration(ProtocolProviderService protocolProvider)

File: src/net/java/sip/communicator/impl/systray/jdic/SystrayServiceJdicImpl.java
Patch:
@@ -26,7 +26,6 @@
 import net.java.sip.communicator.util.*;
 
 import org.jdesktop.jdic.tray.*;
-import org.osgi.framework.*;
 
 /**
  * The <tt>Systray</tt> provides a Icon and the associated <tt>TrayMenu</tt>
@@ -74,7 +73,6 @@ public class SystrayServiceJdicImpl
 
     /**
      * Creates an instance of <tt>Systray</tt>.
-     * @param service a reference of the current <tt>UIservice</tt>
      */
     public SystrayServiceJdicImpl()
     {

File: src/net/java/sip/communicator/service/protocol/WhiteboardSession.java
Patch:
@@ -16,7 +16,8 @@
  * @author Julien Waechter
  * @author Emil Ivov
  */
-public interface WhiteboardSession {
+public interface WhiteboardSession
+{
 
     /**
      * Returns the id of the specified Whiteboard.
@@ -91,7 +92,7 @@ public void removeWhiteboardChangeListener(
 
     /**
      * Returns true if the local user is currently in the whiteboard session
-     * (after whiteboarding one of the {@link #join(String)} methods).
+     * (after whiteboarding one of the {@link #join()} methods).
      *
      * @return true if currently we're currently in this whiteboard and false
      * otherwise.

File: src/net/java/sip/communicator/service/protocol/OperationSetServerStoredAccountInfo.java
Patch:
@@ -42,6 +42,7 @@
  * @author Emil Ivov
  */
 public interface OperationSetServerStoredAccountInfo
+    extends OperationSet
 {
     /**
      * Returns an iterator over all details that are instances or descendants of

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatConversationPanel.java
Patch:
@@ -925,7 +925,7 @@ public Date getPageFirstMsgTimestamp()
         }
 
         if(firstMessageElement == null)
-            return null;
+            return new Date(Long.MAX_VALUE);
         
         String dateString = (String)firstMessageElement
             .getAttributes().getAttribute("date");
@@ -957,7 +957,7 @@ public Date getPageLastMsgTimestamp()
         }
 
         if(lastMessageElement == null)
-            return null;
+            return new Date(0);
         
         String dateString = (String) lastMessageElement
             .getAttributes().getAttribute("date");

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatPanel.java
Patch:
@@ -613,7 +613,7 @@ public void run(){
 
                 Date lastMsgDate
                     = getChatConversationPanel().getPageLastMsgTimestamp();
-                System.out.println("LAST MSG DATE=============" + lastMsgDate);
+
                 Collection c = null;
                 if(lastMsgDate != null)
                 {  

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -316,8 +316,6 @@ public void setCurrentChatPanel(ChatPanel chatPanel)
             this.chatTabbedPane.setSelectedComponent(chatPanel);
         
         this.setTitle(chatPanel.getChatName());
-
-        this.getMainToolBar().changeHistoryButtonsState(chatPanel);
         
         chatPanel.requestFocusInWriteArea();
     }

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatPanel.java
Patch:
@@ -118,7 +118,7 @@ public void loadHistory(String escapedMessageID)
      * <br>
      * Loads the previous "page" in the history.
      */
-    public void loadPreviousFromHistory()
+    public void loadPreviousPageFromHistory()
     {
         // TODO Auto-generated method stub
     }
@@ -128,7 +128,7 @@ public void loadPreviousFromHistory()
      * <br>
      * Loads the next "page" in the history.
      */
-    public void loadNextFromHistory()
+    public void loadNextPageFromHistory()
     {
         // TODO Auto-generated method stub
     }

File: src/net/java/sip/communicator/impl/gui/utils/Constants.java
Patch:
@@ -148,7 +148,7 @@ public class Constants {
      * The size of the buffer that indicates how many messages will be stored
      * in the conversation area in the chat window.
      */
-    public static final int CHAT_BUFFER_SIZE = 50;
+    public static final int CHAT_BUFFER_SIZE = 3000;
 
     /**
      * The maximum width of the <tt>ConfigurationFrame</tt>.

File: src/net/java/sip/communicator/impl/protocol/rss/ContactRssImpl.java
Patch:
@@ -239,8 +239,9 @@ public byte[] getImage()
 
         try
         {
-            ICOFile favicon = new ICOFile(feedLocation.getProtocol() + "://"
-                + feedLocation.getHost() + "/favicon.ico");
+            URL location = new URL(feedLocation.getProtocol() + "://"
+                   + feedLocation.getHost() + "/favicon.ico");
+            ICOFile favicon = new ICOFile(location);
 
             logger.trace("Icon has " + favicon.getImageCount() + " pages");
 

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -369,9 +369,10 @@ public ChatPanel getSelectedChat()
     }
     
     /**
-     * Returns the chat panel corresponding to the given chat room.
+     * Returns the chat panel corresponding to the given chat room wrapper.
      *
-     * @param chatRoom the chat room, for which the chat panel is about
+     * @param chatRoomWrapper the chat room wrapper, corresponding to the chat
+     * room for which the chat panel is about
      * @return the chat panel corresponding to the given chat room
      */
     public ChatPanel getMultiChat(ChatRoomWrapper chatRoomWrapper)

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -1529,7 +1529,7 @@ private void assertConnected() throws IllegalStateException
      * 
      * @return the <tt>ChatRoomConfigurationForm</tt> containing all
      * configuration properties for this chat room
-     * @throw OperationFailedException if the user doesn't have
+     * @throws OperationFailedException if the user doesn't have
      * permissions to see and change chat room configuration
      */
     public ChatRoomConfigurationForm getConfigurationForm()

File: src/net/java/sip/communicator/service/protocol/ChatRoom.java
Patch:
@@ -361,7 +361,7 @@ public void kickParticipant(ChatRoomMember chatRoomMember, String reason)
      * 
      * @return the <tt>ChatRoomConfigurationForm</tt> containing all
      * configuration properties for this chat room
-     * @throw OperationFailedException if the user doesn't have
+     * @throws OperationFailedException if the user doesn't have
      * permissions to see and change chat room configuration
      */
     public ChatRoomConfigurationForm getConfigurationForm()

File: src/net/java/sip/communicator/impl/gui/main/call/CallParticipantDialpadDialog.java
Patch:
@@ -8,7 +8,6 @@
 package net.java.sip.communicator.impl.gui.main.call;
 
 import java.awt.*;
-import java.awt.event.*;
 
 import javax.swing.*;
 
@@ -31,8 +30,8 @@ public class CallParticipantDialpadDialog
     /**
      * Creates an instance of the <tt>ContactInfoPanel</tt>.
      * 
-     * @param owner The frame owner of this dialog.
-     * @param contactItem The <tt>MetaContact</tt> for the info.
+     * @param callManager the call manager
+     * @param callParticipant the corresponding call participant
      */
     public CallParticipantDialpadDialog(CallManager callManager,
         CallParticipant callParticipant)

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -127,7 +127,8 @@ && getChat(metaContact).isVisible())
     /**
      * Returns TRUE if there is an opened <tt>ChatPanel</tt> for the given
      * <tt>ChatRoom</tt>.
-     * @param chatRoom the <tt>ChatRoom</tt>, for which the chat is about
+     * @param chatRoomWrapper the <tt>ChatRoomWrapper</tt>, for which the chat
+     * is about
      * @return TRUE if there is an opened <tt>ChatPanel</tt> for the given
      * <tt>ChatRoom</tt>
      */

File: src/net/java/sip/communicator/impl/gui/main/chat/conference/ConferenceChatPanel.java
Patch:
@@ -34,8 +34,8 @@ public class ConferenceChatPanel
      * Creates an instance of <tt>ConferenceChatPanel</tt>.
      *
      * @param chatWindow the <tt>ChatWindow</tt> that contains this chat panel
-     * @param chatRoom the <tt>ChatRoom</tt> object, which provides us the multi
-     * user chat functionality
+     * @param chatRoomWrapper the <tt>ChatRoomWrapper</tt> object, which
+     * corresponds to a chat room
      */
     public ConferenceChatPanel(ChatWindow chatWindow,
         ChatRoomWrapper chatRoomWrapper)

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/joinforms/JoinChatRoomPanel.java
Patch:
@@ -45,7 +45,6 @@ public class JoinChatRoomPanel
         
     /**
      * Creates and initializes the <tt>ChatRoomNamePanel</tt>.
-     * @param wizard The parent wizard, where this panel will be added
      */
     public JoinChatRoomPanel()
     {

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -1535,7 +1535,7 @@ public boolean isRegisteredUserOnly()
      * Fires a <tt>ChatRoomPropertyChangeFailedEvent</tt> to indicated that
      * the jabber <tt>ChatRoom</tt> implementation doesn't support this property.
      *  
-     * @param isRegisteredUsersOnly indicates if this chat room is only for
+     * @param isRegisteredUserOnly indicates if this chat room is only for
      * registered users.
      * @throws OperationFailedException if the user doesn't have the right to
      * change this property.
@@ -1783,7 +1783,7 @@ public void banParticipant(ChatRoomMember chatRoomMember, String reason)
     /**
      * Kicks a participant from the room.
      *
-     * @param chatRoomMember the <tt>ChatRoomMember</tt> to kick from the room
+     * @param member the <tt>ChatRoomMember</tt> to kick from the room
      * @param reason the reason why the participant is being kicked from the
      * room
      * @throws OperationFailedException if an error occurs while kicking the

File: src/net/java/sip/communicator/impl/protocol/sip/ContactSipImpl.java
Patch:
@@ -47,7 +47,7 @@ public class ContactSipImpl
     /**
      * The presence status of the contact.
      */
-    private PresenceStatus presenceStatus = SipStatusEnum.OFFLINE;
+    private PresenceStatus presenceStatus = SipStatusEnum.UNKNOWN;
 
     /**
      * Determines whether this contact is persistent, i.e. member of the contact

File: test/net/java/sip/communicator/slick/protocol/sip/TestOperationSetPresence.java
Patch:
@@ -411,6 +411,8 @@ public void postTestSubscribe()
         if(oldStatus.equals(newStatus)){
             newStatus = getSampleStatus2();
         }
+        
+        logger.debug("trying to set status " + newStatus + " for contact 2");
 
         //now do the actual status notification testing
         ContactPresenceEventCollector contactPresEvtCollector

File: src/net/java/sip/communicator/impl/gui/i18n/Messages.java
Patch:
@@ -73,7 +73,8 @@ public static I18NString getI18NString(String key, String[] params) {
         try {
             resourceString = RESOURCE_BUNDLE.getString(key);
             
-            resourceString = MessageFormat.format(resourceString, params);
+            resourceString = MessageFormat.format(
+                resourceString, (Object[]) params);
             
             int mnemonicIndex = resourceString.indexOf('&');
             

File: src/net/java/sip/communicator/impl/browserlauncher/BrowserLauncherImpl.java
Patch:
@@ -57,7 +57,7 @@ else if (osName.startsWith("Windows"))
                 }
                 else
                 {
-                   String[] browsers = {"firefox", "icedove", "opera", "konqueror",
+                   String[] browsers = {"firefox", "iceweasel", "opera", "konqueror",
                        "epiphany", "mozilla", "netscape" };
                    
                    String browser = null;

File: src/net/java/sip/communicator/service/configuration/event/VetoableChangeListener.java
Patch:
@@ -30,9 +30,9 @@ public interface VetoableChangeListener
      * This method gets called when a constrained property is about to change.
      * Note that the method only warns about the change and in case none of
      * the interested listeners vetos it (i.e. no PropertyVetoException
-     * is thrown) the propedrtyChange method will be called next to indicate
+     * is thrown) the propertyChange method will be called next to indicate
      * that the change has taken place. In case you don't want to be notified
-     * for pending changes over constained properties you should provide
+     * for pending changes over constrained properties you should provide
      * an empty implementation of the method.
      *
      * @param     evt a <tt>PropertyChangeEvent</tt> object describing the

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -243,7 +243,8 @@ else if (selectedPanel != null
                                     Messages.getI18NString(
                                         "contactNotSupportingTelephony",
                                         new String[]
-                                        { contact.getDisplayName() }).getText(),
+                                        { ((MetaContact) o).getDisplayName() })
+                                            .getText(),
                                     Messages.getI18NString("warning").getText())
                                     .showDialog();
                             }

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommLookAndFeel.java
Patch:
@@ -60,7 +60,7 @@ protected void initClassDefaults(UIDefaults table) {
                 "MenuUI", lfPackageName + "SIPCommMenuUI",
                 "ToolBarUI", lfPackageName + "SIPCommToolBarUI",
                 "ToolBarSeparatorUI", lfPackageName + "SIPCommToolBarSeparatorUI",
-                "TabbedPaneUI", lfPackageName + "SIPCommTabbedPaneUI",
+                "TabbedPaneUI", lfPackageName + "SIPCommTabbedPaneEnhancedUI",
                 "ToolTipUI", lfPackageName + "SIPCommToolTipUI",
                 "TextAreaUI", lfPackageName + "SIPCommTextAreaUI",
                 "TextPaneUI", lfPackageName + "SIPCommTextPaneUI",

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommTabbedPaneUI.java
Patch:
@@ -91,9 +91,9 @@ public class SIPCommTabbedPaneUI extends BasicTabbedPaneUI {
 
     private boolean mousePressed = false;
 
-    private boolean isCloseButtonEnabled = true;
+    private boolean isCloseButtonEnabled = false;
 
-    private boolean isMaxButtonEnabled = true;
+    private boolean isMaxButtonEnabled = false;
 
     protected JPopupMenu actionPopupMenu;
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPresenceSipImpl.java
Patch:
@@ -3217,7 +3217,7 @@ public void setPidfPresenceStatus(String presenceDoc)
                  index = basicList.getLength() - 1;
                  Node basicNode = null;
                  do {
-                     Node temp = statusList.item(index);
+                     Node temp = basicList.item(index);
                      if (temp.getNodeType() == Node.ELEMENT_NODE) {
                          basicNode = temp;
                          break;
@@ -3287,6 +3287,7 @@ private String getTextContent(Element node) {
          String res = XMLUtils.getText(node);
          
          if (res == null) {
+             logger.warn("no text for element '" + node.getNodeName() + "'");
              return "";
          }
          

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicInstantMessagingSipImpl.java
Patch:
@@ -46,7 +46,7 @@ public class OperationSetBasicInstantMessagingSipImpl
      * A reference to the persistent presence operation set that we use
      * to match incoming messages to <tt>Contact</tt>s and vice versa.
      */
-    private OperationSetPersistentPresenceSipImpl opSetPersPresence = null;
+    private OperationSetPresenceSipImpl opSetPersPresence = null;
 
     /**
      * Hashtable containing the CSeq of each discussion
@@ -576,7 +576,7 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
 
             if (evt.getNewState() == RegistrationState.REGISTERED)
             {
-                opSetPersPresence = (OperationSetPersistentPresenceSipImpl)
+                 opSetPersPresence = (OperationSetPresenceSipImpl)
                     sipProvider.getSupportedOperationSets()
                     .get(OperationSetPersistentPresence.class.getName());
             }

File: src/net/java/sip/communicator/impl/protocol/sip/SipRegistrarConnection.java
Patch:
@@ -476,6 +476,9 @@ public void unregister() throws OperationFailedException
                 "Could not find the initial register request."
                 , OperationFailedException.INTERNAL_ERROR);
         }
+        
+        setRegistrationState(RegistrationState.UNREGISTERING,
+                RegistrationStateChangeEvent.REASON_USER_REQUEST, "");
 
         //We are apparently registered so send a un-Register request.
         Request unregisterRequest = (Request) registerRequest.clone();

File: test/net/java/sip/communicator/slick/protocol/sip/TestAccountUninstallation.java
Patch:
@@ -112,10 +112,10 @@ public void testProviderUnregister()
         collector2.waitForEvent(10000);
 
         assertEquals("Provider did not distribute unregister events"
-                     , 1
+                     , 2
                      , collector1.collectedNewStates.size());
         assertEquals("Provider did not distribute unregister events"
-                     , 1
+                     , 2
                      , collector1.collectedNewStates.size());
 
         //make sure both providers are now unregistered.

File: src/net/java/sip/communicator/impl/configuration/ConfigurationActivator.java
Patch:
@@ -50,6 +50,7 @@ public void start(BundleContext bundleContext) throws Exception
     public void stop(BundleContext bundlecontext) throws Exception
     {
         logger.logEntry();
+        impl.stop();
         logger.info("The ConfigurationService stop method has been called.");
     }
 }

File: src/net/java/sip/communicator/impl/protocol/zeroconf/ProtocolProviderFactoryZeroconfImpl.java
Patch:
@@ -190,7 +190,7 @@ public boolean uninstallAccount(AccountID accountID)
         //unregister the protocol provider
         ServiceReference serRef = getProviderForAccount(accountID);
 
-        if(serRef != null)
+        if(serRef == null)
             return false;
 
         ProtocolProviderService protocolProvider

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -519,8 +519,8 @@ protected void initialize(String    sipAddress,
                 + SipActivator.getConfigurationService().getScHomeDirName()
                 + System.getProperty("file.separator");
 
-            NSPVALUE_DEBUG_LOG = logDir + NSPNAME_DEBUG_LOG;
-            NSPVALUE_SERVER_LOG = logDir + NSPNAME_SERVER_LOG;
+            NSPVALUE_DEBUG_LOG = logDir + NSPVALUE_DEBUG_LOG;
+            NSPVALUE_SERVER_LOG = logDir + NSPVALUE_SERVER_LOG;
 
             this.accountID = accountID;
 

File: src/net/java/sip/communicator/impl/protocol/jabber/extensions/version/Version.java
Patch:
@@ -44,7 +44,9 @@ public String toXML()
         buf.append("<").append(getElementName()).
             append(" xmlns=\"").append(getNamespace()).append("\"").
             append(" node=\"http://sip-communicator.org/caps\"").
-            append(" ver=\"1.0-alpha1\"/>");
+            append(" ver=\"").
+            append(System.getProperty("sip-communicator.version")).
+            append("\"/>");
 
         return buf.toString();
     }

File: src/net/java/sip/communicator/impl/protocol/gibberish/OperationSetPersistentPresenceGibberishImpl.java
Patch:
@@ -1316,7 +1316,6 @@ public ContactGibberishImpl createVolatileContact(String contactAddress)
                 , parentProvider);
             theVolatileGroup.setResolved(false);
             theVolatileGroup.setPersistent(false);
-            theVolatileGroup.addContact(newVolatileContact);
 
             this.contactListRoot.addSubgroup(theVolatileGroup);
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetPersistentPresenceSipImpl.java
Patch:
@@ -1128,7 +1128,6 @@ public ContactSipImpl createVolatileContact(String contactAddress)
                 , parentProvider);
             theVolatileGroup.setResolved(false);
             theVolatileGroup.setPersistent(false);
-            theVolatileGroup.addContact(newVolatileContact);
 
             this.contactListRoot.addSubgroup(theVolatileGroup);
 

File: src/net/java/sip/communicator/service/protocol/event/ChatRoomPropertyChangeEvent.java
Patch:
@@ -41,7 +41,7 @@ public class ChatRoomPropertyChangeEvent
      * Indicates that this event was triggered as a result of the source
      * chat room state changed.
      */
-    public static final String PROPERTY_STATE_CHANGED = "StateChanged";
+    public static final String PROPERTY_CONFIG_CHANGED = "ConfigChanged";
     
     /**
      * Indicates that this event was triggered as a result of the source

File: src/net/java/sip/communicator/service/protocol/event/ChatRoomLocalUserRoleListener.java
Patch:
@@ -13,7 +13,7 @@
  * user participant in a particular chat room. Changes could be us being granted
  * any of the roles defined in <tt>ChatRoomMemberRole</tt>.
  * 
- * @see @see net.java.sip.communicator.service.protocol.ChatRoomMemberRole
+ * @see net.java.sip.communicator.service.protocol.ChatRoomMemberRole
  * 
  * @author Stephane Remy
  */

File: src/net/java/sip/communicator/service/protocol/event/ChatRoomLocalUserRoleListener.java
Patch:
@@ -13,7 +13,7 @@
  * user participant in a particular chat room. Changes could be us being granted
  * any of the roles defined in <tt>ChatRoomMemberRole</tt>.
  * 
- * @see ChatRoomMemberRole
+ * @see @see net.java.sip.communicator.service.protocol.ChatRoomMemberRole
  * 
  * @author Stephane Remy
  */

File: src/net/java/sip/communicator/service/protocol/event/ChatRoomMemberRoleListener.java
Patch:
@@ -13,7 +13,7 @@
  * participant in a particular chat room. Changes may include participant being
  * granted any of the roles defined in <tt>ChatRoomMemberRole</tt>.
  * 
- * @see ChatRoomMemberRole
+ * @see net.java.sip.communicator.service.protocol.ChatRoomMemberRole
  *  
  * @author Emil Ivov
  * @author Stephane Remy

File: src/net/java/sip/communicator/impl/protocol/zeroconf/jmdns/DNSRecord.java
Patch:
@@ -758,7 +758,9 @@ public String toString()
     public String toString(String other)
     {
         return toString("record", ttl + "/" + 
-            getRemainingTTL(System.currentTimeMillis()) + "," + other);
+            getRemainingTTL(System.currentTimeMillis()) 
+//            + "," + other
+            );
     }
 }
 

File: src/net/java/sip/communicator/impl/protocol/sip/SipRegistrarConnection.java
Patch:
@@ -301,7 +301,7 @@ void register()
 
         //Contact Header (should contain IP)
         ContactHeader contactHeader
-            = sipProvider.getRegistrationContactHeader(
+            = sipProvider.getContactHeader(
                 registrarAddress, getRegistrarListeningPoint());
 
         //add expires in the contact header as well in case server likes it
@@ -737,7 +737,7 @@ public InetAddress getRegistrarAddress()
      * @return the listening point that should be used for communiction with our
      * current registrar.
      */
-    private ListeningPoint getRegistrarListeningPoint()
+    ListeningPoint getRegistrarListeningPoint()
     {
         return sipProvider.getListeningPoint(registrarURI.getTransportParam());
     }

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetBasicInstantMessagingYahooImpl.java
Patch:
@@ -299,7 +299,7 @@ private void handleNewMessage(SessionEvent ev)
             //to set all messages html - doesn't affect the appearance of the gui
             Message newMessage = createMessage(
                 new MessageDecoder().decodeToHTML(ev.getMessage()).getBytes(),
-                "html",
+                "text/html",
                 DEFAULT_MIME_ENCODING,
                 null);
 

File: src/net/java/sip/communicator/service/protocol/ChatRoom.java
Patch:
@@ -119,7 +119,8 @@ public void removeChatRoomPropertyChangeListener(
      * <p>
      * To be notified every time the room's subject change you should add a
      * <tt>ChatRoomChangelistener</tt> to this room.
-     * {@link #addChatRoomChangeListener(ChatRoomChangeListener)}<p>
+     * {@link #addChatRoomPropertyChangeListener(
+     *  ChatRoomPropertyChangeListener)}<p>
      *
      * To change the room's subject use {@link #setSubject(String)}.
      *

File: src/net/java/sip/communicator/service/protocol/event/MessageDeliveryFailedEvent.java
Patch:
@@ -114,6 +114,7 @@ public MessageDeliveryFailedEvent(Message source,
          this.timestamp = timestamp;
          this.reasonPhrase = reason;
      }
+
      /**
       * Returns a reference to the <tt>Contact</tt> that the source (failed)
       * <tt>Message</tt> was sent to.

File: src/net/java/sip/communicator/plugin/rssaccregwizz/FirstWizardPage.java
Patch:
@@ -157,7 +157,7 @@ public Object getWizardForm()
      */
     public void pageShowing()
     {
-        if(isExistingAccount("Rss")) setNextButtonAccordingToUserID(false);
+        if(isExistingAccount("RSS")) setNextButtonAccordingToUserID(false);
         else setNextButtonAccordingToUserID(true);
     }
 
@@ -168,8 +168,7 @@ public void pageNext()
     {
         nextPageIdentifier = SUMMARY_PAGE_IDENTIFIER;
         userPassPanel.remove(existingAccountLabel);
-        registration.setUserID("Rss");
-        registration.setPassword("rss");
+        registration.setUserID("RSS");
     }
 
     /**

File: src/net/java/sip/communicator/plugin/rssaccregwizz/RssAccRegWizzActivator.java
Patch:
@@ -57,7 +57,7 @@ public void start(BundleContext bc)
 
         wizardContainer.addAccountRegistrationWizard(rssWizard);
 
-        logger.info("Rss account registration wizard [STARTED].");
+        logger.info("RSS account registration wizard [STARTED].");
     }
 
     /**
@@ -82,7 +82,7 @@ public static ProtocolProviderFactory getRssProtocolProviderFactory()
 
         String osgiFilter = "("
             + ProtocolProviderFactory.PROTOCOL
-            + "=" + "Rss" + ")";
+            + "=" + "RSS" + ")";
 
         try
         {

File: src/net/java/sip/communicator/impl/protocol/rss/OperationSetPersistentPresenceRssImpl.java
Patch:
@@ -1047,7 +1047,7 @@ public ContactGroup createUnresolvedContactGroup(String groupUID,
             = new ContactGroupRssImpl(
                 ContactGroupRssImpl.createNameFromUID(groupUID)
                 , parentProvider);
-        newGroup.setResolved(false);
+        newGroup.setResolved(true);
 
         //if parent is null then we're adding under root.
         if(parentGroup == null)

File: src/net/java/sip/communicator/impl/protocol/rss/ProtocolProviderServiceRssImpl.java
Patch:
@@ -27,7 +27,7 @@ public class ProtocolProviderServiceRssImpl
     /**
      * The name of this protocol.
      */
-    public static final String RSS_PROTOCOL_NAME = "Rss";
+    public static final String RSS_PROTOCOL_NAME = "RSS";
 
     /**
      * The id of the account that this protocol provider represents.

File: src/net/java/sip/communicator/impl/protocol/rss/RssAccountID.java
Patch:
@@ -24,9 +24,9 @@ public class RssAccountID
      */
     RssAccountID(String userID, Map accountProperties)
     {
-        super(  userID, 
-                accountProperties, 
-                "Rss", 
+        super(  userID,
+                accountProperties,
+                ProtocolProviderServiceRssImpl.RSS_PROTOCOL_NAME,
                 "rss.org");
     }
 }

File: src/net/java/sip/communicator/impl/protocol/rss/RssActivator.java
Patch:
@@ -59,7 +59,7 @@ public void start(BundleContext context)
         this.bundleContext = context;
 
         Hashtable hashtable = new Hashtable();
-        hashtable.put(ProtocolProviderFactory.PROTOCOL, "Rss");
+        hashtable.put(ProtocolProviderFactory.PROTOCOL, "RSS");
 
         rssProviderFactory = new ProtocolProviderFactoryRssImpl();
 
@@ -72,7 +72,7 @@ public void start(BundleContext context)
                     rssProviderFactory,
                     hashtable);
         
-        logger.info("Rss protocol implementation [STARTED].");
+        logger.info("RSS protocol implementation [STARTED].");
     }
 
     /**
@@ -111,6 +111,6 @@ public void stop(BundleContext context)
     {
         this.rssProviderFactory.stop();
         rssPpFactoryServReg.unregister();
-        logger.info("Rss protocol implementation [STOPPED].");
+        logger.info("RSS protocol implementation [STOPPED].");
     }
 }

File: src/net/java/sip/communicator/impl/protocol/rss/RssTimerRefreshFeed.java
Patch:
@@ -42,6 +42,6 @@ public RssTimerRefreshFeed(OperationSetBasicInstantMessagingRssImpl opSet)
     public void run()
     {
         logger.trace("Starting a periodic rss check.");
-        this.opSet.refreshRssFeed();
+        this.opSet.refreshAllRssFeeds();
     }
 }

File: src/net/java/sip/communicator/impl/protocol/jabber/ChatRoomJabberImpl.java
Patch:
@@ -334,7 +334,7 @@ public void invite(String userAddress, String reason)
 
     /**
      * Returns true if the local user is currently in the multi user chat
-     * (after calling one of the {@link #join(String)} methods).
+     * (after calling one of the {@link #join()} methods).
      *
      * @return true if currently we're currently in this chat room and false
      *   otherwise.

File: src/net/java/sip/communicator/service/protocol/ChatRoom.java
Patch:
@@ -78,7 +78,7 @@ public void joinAs(String nickname, byte[] password)
 
     /**
      * Returns true if the local user is currently in the multi user chat
-     * (after calling one of the {@link #join(String)} methods).
+     * (after calling one of the {@link #join()} methods).
      *
      * @return true if currently we're currently in this chat room and false
      * otherwise.
@@ -119,7 +119,7 @@ public void removeChatRoomPropertyChangeListener(
      * <p>
      * To be notified every time the room's subject change you should add a
      * <tt>ChatRoomChangelistener</tt> to this room.
-     * {@link #addChatRoomChaneListener(ChatRoomChangeListener)}<p>
+     * {@link #addChatRoomChangeListener(ChatRoomChangeListener)}<p>
      *
      * To change the room's subject use {@link #setSubject(String)}.
      *
@@ -137,7 +137,7 @@ public void removeChatRoomPropertyChangeListener(
      * @param subject the new subject that we'd like this room to have
      * @throws OperationFailedException
      */
-    public void setSubject(final String subject)
+    public void setSubject(String subject)
         throws OperationFailedException;
 
     /**

File: src/net/java/sip/communicator/impl/protocol/icq/ContactIcqImpl.java
Patch:
@@ -329,11 +329,11 @@ public void setPersistentData(String persistentData)
             }
         }
     }
-    
+
     /**
      * Used to set the image of the contact if it is updated
      *
-     * @param nickname String the value
+     * @param image a photo/avatar associated with this contact.
      */
     protected void setImage(byte[] image)
     {

File: src/net/java/sip/communicator/service/protocol/event/ChatRoomMessageDeliveredEvent.java
Patch:
@@ -42,8 +42,7 @@ public class ChatRoomMessageDeliveredEvent
       * @param to the <tt>ChatRoomMember</tt> that this message was sent to.
       * @param timestamp a date indicating the exact moment when the event
       * ocurred
-      * @param chatRoomID the name/id of the chatroom where this message was
-      * delivered.
+      * @param message the message that triggered this event.
       */
      public ChatRoomMessageDeliveredEvent(ChatRoom source,
                                           ChatRoomMember to,

File: src/net/java/sip/communicator/impl/configuration/ConfigurationServiceImpl.java
Patch:
@@ -146,9 +146,9 @@ public void setProperty(String propertyName, Object property,
         if (property == null)
         {
             properties.remove(propertyName);
-            
+
             fileExtractedProperties.remove(propertyName);
-            
+
             if (isSystem)
             {
                 //we can't remove or nullset a sys prop so let's "empty" it.

File: src/net/java/sip/communicator/impl/protocol/gibberish/OperationSetPersistentPresenceGibberishImpl.java
Patch:
@@ -65,7 +65,7 @@ public class OperationSetPersistentPresenceGibberishImpl
     private String statusMessage = "Default Status Message";
 
     /**
-     * Our default presence status.
+     * Our presence status.
      */
     private PresenceStatus presenceStatus = GibberishStatusEnum.OFFLINE;
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -228,9 +228,9 @@ private CallSipImpl createOutgoingCall(Address calleeAddress)
             ((CallSipImpl)callParticipant.getCall())
                 .setMediaCallSession(callSession);
 
-            //if possible try to indicate the address of the callee so that the
-            //media service can choose the most proper local address to
-            //advertise.
+            //if possible try to indicate the address of the callee so
+            //that the media service can choose the most proper local
+            //address to advertise.
             javax.sip.address.URI calleeURI = calleeAddress.getURI();
             InetAddress intendedDestination = null;
             if(calleeURI.isSipURI())

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -14,7 +14,6 @@
 import org.jivesoftware.smack.provider.*;
 import org.jivesoftware.smack.util.*;
 import org.jivesoftware.smackx.*;
-import net.java.sip.communicator.impl.protocol.jabber.extensions.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.Message;
 import net.java.sip.communicator.service.protocol.event.*;

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -17,7 +17,6 @@
 import net.java.sip.communicator.service.protocol.jabberconstants.*;
 import net.java.sip.communicator.util.*;
 import org.jivesoftware.smack.filter.*;
-import net.java.sip.communicator.impl.protocol.jabber.extensions.*;
 import net.java.sip.communicator.impl.protocol.jabber.extensions.version.*;
 
 /**

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolProviderServiceMsnImpl.java
Patch:
@@ -130,7 +130,6 @@ void reconnect()
     /**
      * Connects and logins to the server
      * @param authority SecurityAuthority
-     * @throws XMPPException if we cannot connect to the server - network problem
      * @throws  OperationFailedException if login parameters
      *          as server port are not correct
      */

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberServerChooserDialog.java
Patch:
@@ -309,7 +309,9 @@ public ServerChooserTableModel()
                 
                 // Create the builder and parse the file
                 serverComments = factory.newDocumentBuilder()
-                    .parse(new File(Resources.getString("commentsFile")));   
+                    .parse(
+                        JabberServerChooserDialog.class.getClassLoader()
+                        .getResourceAsStream(Resources.getString("commentsFile")));   
             }
             catch (SAXException e)
             {

File: src/net/java/sip/communicator/impl/history/HistoryImpl.java
Patch:
@@ -258,7 +258,6 @@ protected Document getDocumentForFile(String filename)
      *
      * @param file File the file trying to fix
      * @return Document the fixed doc
-     * @throws Exception
      */
     public Document getFixedDocument(File file)
     {

File: src/net/java/sip/communicator/impl/contactlist/MetaContactImpl.java
Patch:
@@ -316,7 +316,7 @@ public int compareTo(Object o)
             ? 1
             : 0;
 
-        return ( (10 - isOnline) - (10 - targetIsOnline)) * 1000000
+        return ( (10 - isOnline) - (10 - targetIsOnline)) * 100000000
             + getDisplayName().compareToIgnoreCase(target.getDisplayName())
             * 10000
             + getMetaUID().compareTo(target.getMetaUID());

File: src/net/java/sip/communicator/impl/gui/utils/ConfigurationManager.java
Patch:
@@ -100,7 +100,7 @@ public static void loadGuiConfigurations()
                 .getPropertyNamesByPrefix(prefix, true);
 
         Iterator chatRoomIter = chatRooms.iterator();
-
+            
         while(chatRoomIter.hasNext())
         {
             String chatRoomRootPropName
@@ -109,7 +109,7 @@ public static void loadGuiConfigurations()
             String chatRoomID
                 = configService.getString(chatRoomRootPropName);
 
-            chatRooms.add(chatRoomID);
+            chatRoomsList.add(chatRoomID);
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/msn/EventManager.java
Patch:
@@ -16,6 +16,7 @@
 import net.java.sip.communicator.util.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
+import net.sf.jml.net.Message;
 
 
 /**

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -264,9 +264,9 @@ public void register(SecurityAuthority authority)
             // it seems icq servers doesn't accept password with
             // length more then 8. But allow such registrations
             // we must trim such passwords to 8 characters
-            if(password.length() > 8)
+            if(USING_ICQ && password.length() > 8)
                 password = password.substring(0, 8);
-            
+
             //init the necessary objects
             session = new DefaultAppSession();
             aimSession = session.openAimSession(

File: src/net/java/sip/communicator/impl/protocol/icq/ContactGroupIcqImpl.java
Patch:
@@ -433,7 +433,7 @@ ContactIcqImpl findContact(String screenName)
         {
             ContactIcqImpl item = (ContactIcqImpl) contacts.next();
             if(item.getJoustSimBuddy().getScreenname().getFormatted()
-                .equals(screenName))
+                .equalsIgnoreCase(screenName))
                 return item;
         }
         return null;

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindowManager.java
Patch:
@@ -210,7 +210,7 @@ public void closeWindow()
                 if (answer == JOptionPane.OK_OPTION)
                 {
                     chatWindow.removeAllChats();
-                    chatWindow.setVisible(false);
+                    chatWindow.dispose();
 
                     synchronized (chats)
                     {
@@ -231,7 +231,7 @@ else if (System.currentTimeMillis() - chatWindow
                 if (answer == JOptionPane.OK_OPTION)
                 {
                     chatWindow.removeAllChats();
-                    chatWindow.setVisible(false);
+                    chatWindow.dispose();
 
                     synchronized (chats)
                     {
@@ -242,7 +242,7 @@ else if (System.currentTimeMillis() - chatWindow
             else
             {
                 chatWindow.removeAllChats();
-                chatWindow.setVisible(false);
+                chatWindow.dispose();
 
                 synchronized (chats)
                 {

File: src/net/java/sip/communicator/impl/gui/main/presence/PresenceStatusSelectorBox.java
Patch:
@@ -229,7 +229,7 @@ public void updateStatus(Object presenceStatus)
         if(protocolProvider.isRegistered()
                 && !presence.getPresenceStatus().equals(status))
         {
-            new PublishPresenceStatusThread(status);
+            new PublishPresenceStatusThread(status).start();
         }
     }
 

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetPersistentPresenceIcqImpl.java
Patch:
@@ -1494,9 +1494,9 @@ public void handleYourInfo(MainBosService service,
                 //that we're very much online so make sure we change accordingly
                 if (currentIcqStatus == -1 )
                     currentIcqStatus = ICQ_ONLINE_MASK;
-                
+
                 //only notify of an event change if there was really one.
-                if( oldStatus != userInfo.getIcqStatus() )
+                if( oldStatus !=  currentIcqStatus)
                     fireProviderPresenceStatusChangeEvent(oldStatus,
                                                         currentIcqStatus);
             }

File: src/net/java/sip/communicator/impl/gui/main/chat/ChatWindow.java
Patch:
@@ -258,6 +258,8 @@ public void removeChat(ChatPanel chatPanel)
         if(getChatTabCount() == 0)
         {
             this.getContentPane().remove(chatPanel);
+            this.getContentPane().validate();
+            this.getContentPane().repaint();
             
             this.setVisible(false);
             

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -133,7 +133,7 @@ private void init()
         this.mainPanel.getActionMap().put("runChat",
                 new RunMessageWindowAction());
 
-        InputMap imap = this.getRootPane().getInputMap(
+        InputMap imap = mainPanel.getInputMap(
                 JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT);
 
         imap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), "runChat");

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetPersistentPresenceJabberImpl.java
Patch:
@@ -809,6 +809,9 @@ public void registrationStateChanged(RegistrationStateChangeEvent evt)
                 jabberProvider.getConnection().getRoster().addRosterListener(
                     new ContactChangesListener());
 
+                fireProviderPresenceStatusChangeEvent(currentStatus,
+                    JabberStatusEnum.AVAILABLE);
+                
                 // init ssList
                 ssContactList.init();
             }

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/Wizard.java
Patch:
@@ -159,7 +159,7 @@ public void showDialog(boolean modal) {
             this.setModal(true);
         
         this.pack();
-        this.setVisible(true);
+        super.setVisible(true);
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -196,7 +196,6 @@ else if (buttonName.equals("config"))
         }
         else if (buttonName.equals("search"))
         {
-
             ContactList contactList = mainFrame.getContactListPanel()
                 .getContactList();
 
@@ -209,8 +208,8 @@ else if (buttonName.equals("search"))
                 selectedObject
                     = listModel.getElementAt(currentlySelectedIndex);
             }
-
-            contactList.setShowOffline(!contactList.isShowOffline());
+            
+            contactList.setShowOffline(!ConfigurationManager.isShowOffline());
             
             if (selectedObject != null) {
                 if (selectedObject instanceof MetaContact) {

File: src/net/java/sip/communicator/impl/gui/main/chatroomslist/ChatRoomsListRightButtonMenu.java
Patch:
@@ -119,7 +119,7 @@ public void actionPerformed(ActionEvent e){
             CreateChatRoomWizard createChatRoomWizard
                 = new CreateChatRoomWizard(mainFrame);
             
-            createChatRoomWizard.showDialog(false);
+            createChatRoomWizard.setVisible(true);
         }
         else if (itemName.equals("searchForChatRooms"))
         {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/CommonRightButtonMenu.java
Patch:
@@ -80,7 +80,7 @@ public void actionPerformed(ActionEvent e) {
         else if(itemName.equals("addContact")) {
             AddContactWizard wizard = new AddContactWizard(mainFrame);
             
-            wizard.showDialog(false);
+            wizard.setVisible(true);
         }
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -183,10 +183,9 @@ public void actionPerformed(ActionEvent e)
 
         if (buttonName.equals("add"))
         {
-
             AddContactWizard wizard = new AddContactWizard(mainFrame);
             
-            wizard.showDialog(false);
+            wizard.setVisible(true);
         }
         else if (buttonName.equals("config"))
         {

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommDialog.java
Patch:
@@ -212,7 +212,9 @@ public void setVisible(boolean isVisible)
     {   
         if(isVisible) {
             this.pack();
-            this.setSizeAndLocation();
+            
+            if(isSaveSizeAndLocation)
+                this.setSizeAndLocation();
             
             JButton button = this.getRootPane().getDefaultButton();
             

File: src/net/java/sip/communicator/impl/gui/GuiActivator.java
Patch:
@@ -95,7 +95,7 @@ public void start(BundleContext bundleContext) throws Exception {
             communicatorMain.showCommunicator(true);
             SwingUtilities.invokeLater(new RunLogin());
             
-            uiService.registerExportableWindows();
+            uiService.initExportedWindows();
         }
         finally {
             logger.logExit();
@@ -279,7 +279,7 @@ public static BrowserLauncherService getBrowserLauncher() {
      * Returns the current implementation of the <tt>UIService</tt>.
      * @return the current implementation of the <tt>UIService</tt>
      */
-    public static UIService getUIService() {
+    public static UIServiceImpl getUIService() {
         return uiService;
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/chat/MetaContactChatPanel.java
Patch:
@@ -20,7 +20,6 @@
 import net.java.sip.communicator.impl.gui.utils.*;
 import net.java.sip.communicator.service.contactlist.*;
 import net.java.sip.communicator.service.contactlist.event.*;
-import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.msghistory.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
@@ -646,8 +645,8 @@ public void run()
         }
     }
 
-    public WindowID getWindowID()
+    public MetaContact getMetaContact()
     {
-        return ApplicationWindow.CHAT_WINDOW;
+        return metaContact;
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -193,7 +193,7 @@ else if (buttonName.equals("config"))
 
             configDialog = GuiActivator.getUIService().getConfigurationWindow();
 
-            configDialog.showWindow();
+            configDialog.setVisible(true);
         }
         else if (buttonName.equals("search"))
         {

File: src/net/java/sip/communicator/impl/gui/main/menus/ToolsMenu.java
Patch:
@@ -73,7 +73,7 @@ public void actionPerformed(ActionEvent e) {
         if (itemText.equalsIgnoreCase("config")) {
             configDialog = GuiActivator.getUIService().getConfigurationWindow();
 
-            configDialog.showWindow();
+            configDialog.setVisible(true);
         }
     }
 }

File: src/net/java/sip/communicator/impl/protocol/msn/ProtocolProviderServiceMsnImpl.java
Patch:
@@ -1,3 +1,4 @@
+
 /*
  * SIP Communicator, the OpenSource Java VoIP and Instant Messaging client.
  *
@@ -9,7 +10,6 @@
 import java.nio.channels.*;
 import java.util.*;
 
-import net.java.sip.communicator.impl.protocol.gibberish.*;
 import net.java.sip.communicator.service.protocol.*;
 import net.java.sip.communicator.service.protocol.event.*;
 import net.java.sip.communicator.util.*;

File: src/net/java/sip/communicator/impl/protocol/msn/VolatileContact.java
Patch:
@@ -1,3 +1,4 @@
+
 /*
  * SIP Communicator, the OpenSource Java VoIP and Instant Messaging client.
  *
@@ -53,4 +54,6 @@ public String getFriendlyName()
     public String getOldDisplayName(){return "";}
 
     public MsnUserStatus getOldStatus(){return null;}
+
+    public String getPersonalMessage(){return "";}
 }

File: src/net/java/sip/communicator/impl/gui/main/presence/StatusPanel.java
Patch:
@@ -61,7 +61,7 @@ public void addAccount(ProtocolProviderService protocolProvider)
         StatusSelectorBox protocolStatusCombo;
         
         int providerIndex = this.mainFrame.getProviderIndex(protocolProvider); 
-        if(mainFrame.getProtocolPresence(protocolProvider) != null) {
+        if(mainFrame.getProtocolPresenceOpSet(protocolProvider) != null) {
             protocolStatusCombo
                 = new PresenceStatusSelectorBox(
                         this.mainFrame, protocolProvider,
@@ -196,7 +196,7 @@ public PresenceStatus getLastPresenceStatus(
         String lastStatus = getLastStatusString(protocolProvider);
         
         OperationSetPresence presence
-            = mainFrame.getProtocolPresence(protocolProvider);
+            = mainFrame.getProtocolPresenceOpSet(protocolProvider);
     
         if(presence == null)
             return null;

File: src/net/java/sip/communicator/impl/contactlist/MclStorageManager.java
Patch:
@@ -528,6 +528,9 @@ void extractContactsForAccount(String accountID)
             processGroupXmlNode(mclServiceImpl, accountID, root
                                 , null, null);
 
+            //now save the contact list in case it has changed
+            scheduleContactListStorage();
+
             //now that we're done updating the contact list we can start listening
             //again
             this.mclServiceImpl.addMetaContactListListener(this);

File: src/net/java/sip/communicator/impl/gui/main/message/history/HistoryWindow.java
Patch:
@@ -125,8 +125,9 @@ public HistoryWindow(MainFrame mainFrame, MetaContact metaContact)
         {
             Contact protoContact = (Contact) protoContacts.next();
             
-            this.mainFrame.getProtocolIM(protoContact.getProtocolProvider())
-                .addMessageListener(this);
+            ((OperationSetBasicInstantMessaging) protoContact.getProtocolProvider()
+                .getOperationSet(OperationSetBasicInstantMessaging.class))
+                    .addMessageListener(this);
         }
     }
 

File: src/net/java/sip/communicator/impl/media/MediaServiceImpl.java
Patch:
@@ -48,7 +48,7 @@ public class MediaServiceImpl
     /**
      * Our event dispatcher.
      */
-    private MediaDispatcher mediaDispatcher = new MediaDispatcher();
+    private MediaEventDispatcher mediaDispatcher = new MediaEventDispatcher();
 
     /**
      * Our configuration helper.

File: src/net/java/sip/communicator/impl/protocol/mock/MockContact.java
Patch:
@@ -21,8 +21,8 @@ public class MockContact
     private String contactID = null;
     private MockProvider parentProvider = null;
     private MockContactGroup parentGroup = null;
-    private PresenceStatus presenceStatus = MockStatusEnum.MOCK_STATUS_50;
-    private boolean isPersistent = true;
+    private PresenceStatus presenceStatus = MockStatusEnum.MOCK_STATUS_00;
+    private final boolean isPersistent = true;
     private boolean isResolved = true;
 
     /**

File: src/net/java/sip/communicator/impl/protocol/gibberish/GibberishActivator.java
Patch:
@@ -110,6 +110,8 @@ public static BundleContext getBundleContext()
     public void stop(BundleContext context)
         throws Exception
     {
+        this.gibberishProviderFactory.stop();
+        gibberishPpFactoryServReg.unregister();
         logger.info("Gibberish protocol implementation [STOPPED].");
     }
 }

File: test/net/java/sip/communicator/slick/contactlist/TestMetaContactList.java
Patch:
@@ -166,7 +166,7 @@ public void testContactsOrder()
         ((MockPersistentPresenceOperationSet)fixture.mockPresOpSet)
             .changePresenceStatusForContact(MetaContactListServiceLick
               .mockContactToReorder
-            , MockStatusEnum.MOCK_STATUS_50);
+            , MockStatusEnum.MOCK_STATUS_00);
 
 
         //repeat order tests but this time after changing the display name of a

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -414,7 +414,7 @@ public AccountRegistrationWizardContainer getAccountRegWizardContainer() {
      * Implements the <code>UIService.getConfigurationWindow</code>.
      * Returns the current implementation of the <tt>ConfigurationWindow</tt>
      * interface.
-     * @see UIService#getConfigurationManager()
+     * @see UIService#getConfigurationWindow()
      */
     public ConfigurationWindow getConfigurationWindow() {
         return this.configurationFrame;

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommMenu.java
Patch:
@@ -42,7 +42,7 @@ public SIPCommMenu()
      * Creates an instance of <tt>SIPCommMenu</tt> by specifying the
      * initialy selected item.
      * 
-     * @param selectedItem The item that is initialy selected.
+     * @param text The item that is initialy selected.
      */
     public SIPCommMenu(String text)
     {

File: src/net/java/sip/communicator/impl/gui/i18n/Messages.java
Patch:
@@ -59,7 +59,8 @@ public static I18NString getI18NString(String key) {
      * Returns an internationalized string corresponding to the given key,
      * by replacing all occurences of '?' with the given string param.
      * @param key The key of the string.
-     * @param param The param, which will replace '?'.
+     * @param params the params, that should replace {1}, {2}, etc. in the
+     * string given by the key parameter 
      * @return An internationalized string corresponding to the given key,
      * by replacing all occurences of '?' with the given string param.
      */

File: src/net/java/sip/communicator/impl/gui/main/message/ChatContactPanel.java
Patch:
@@ -98,8 +98,9 @@ public ChatContactPanel(ChatPanel chatPanel, MetaContact contactItem) {
     /**
      * Creates an instance of <tt>ChatContactPanel</tt>.
      * 
-     * @param contactItem The <tt>MetaContact</tt>.
-     * @param status The contact status.
+     * @param chatPanel the parent chat panel
+     * @param contactItem the meta contact to add to this panel
+     * @param protocolContact the currently selected protocol contact 
      */
     public ChatContactPanel(ChatPanel chatPanel,
             MetaContact contactItem, Contact protocolContact) {

File: src/net/java/sip/communicator/impl/gui/utils/ImageLoader.java
Patch:
@@ -1001,8 +1001,8 @@ public static Image getBytesInImage(byte[] imageBytes) {
 
     /**
      * Loads an animated gif image.
-     * @param imageID The image identifier.
-     * @return A BufferedImage array containing the animated image.
+     * @param animatedImage the animated image buffer
+     * @return a <tt>BufferedImage</tt> array containing the animated image.
      */
     public static BufferedImage[] getAnimatedImage(byte[] animatedImage)
     {

File: src/net/java/sip/communicator/plugin/gibberishaccregwizz/GibberishAccountRegistrationWizard.java
Patch:
@@ -141,8 +141,7 @@ public ProtocolProviderService finish()
      * Creates an account for the given user and password.
      * @param providerFactory the ProtocolProviderFactory which will create
      * the account
-     * @param user the user identifier
-     * @param passwd the password
+     * @param user the user identifier 
      * @return the <tt>ProtocolProviderService</tt> for the new account.
      */
     public ProtocolProviderService installAccount(

File: src/net/java/sip/communicator/plugin/icqaccregwizz/IcqAccountRegistration.java
Patch:
@@ -121,7 +121,7 @@ public String getProxyType() {
 
     /**
      * Sets the proxy type for this icq account.
-     * @param proxyPort the proxy type for this icq account.
+     * @param proxyType the proxy type for this icq account
      */
     public void setProxyType(String proxyType) {
         this.proxyType = proxyType;
@@ -153,7 +153,7 @@ public String getProxyUsername() {
 
    /**
     * Sets the proxy username of the icq registration account.
-    * @param password the proxy username of the icq registration account.
+    * @param username the proxy username of the icq registration account
     */
    public void setProxyUsername(String username) {
        this.proxyUsername = username;

File: src/net/java/sip/communicator/impl/protocol/yahoo/ProtocolIconYahooImpl.java
Patch:
@@ -32,7 +32,7 @@ public class ProtocolIconYahooImpl
             loadIcon("resources/images/yahoo/yahoo16x16.png"));
 
         iconsTable.put(ProtocolIcon.ICON_SIZE_64x64,
-            loadIcon("resources/images/yahoo/yahoo16x16.png"));
+            loadIcon("resources/images/yahoo/yahoo64x64.png"));
     }
  
     /**

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -567,7 +567,7 @@ public void contactPresenceStatusChanged(
             if (metaContact != null) {
                 if(evt.getOldStatus() != evt.getNewStatus()) {
                     clistPanel.getContactList().modifyContact(metaContact);
-                    clistPanel.updateChatContactStatus(
+                    chatWindowManager.updateChatContactStatus(
                             metaContact, sourceContact);
                 }
             }

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationRequestedDialog.java
Patch:
@@ -93,7 +93,7 @@ public AuthorizationRequestedDialog(MainFrame mainFrame, Contact contact,
         titleLabel.setText(title);
         
         infoTextArea.setText(Messages.getI18NString("authorizationRequestedInfo", 
-                contact.getDisplayName()).getText());
+                new String[]{contact.getDisplayName()}).getText());
         
         this.infoTextArea.setFont(Constants.FONT.deriveFont(Font.BOLD, 12f));
         this.infoTextArea.setLineWrap(true);

File: src/net/java/sip/communicator/impl/gui/main/authorization/RequestAuthorizationDialog.java
Patch:
@@ -93,7 +93,7 @@ public RequestAuthorizationDialog(MainFrame mainFrame, Contact contact,
         this.request = request;
         
         infoTextArea.setText(Messages.getI18NString("requestAuthorizationInfo", 
-                contact.getDisplayName()).getText());
+                new String[]{contact.getDisplayName()}).getText());
         
         this.infoTextArea.setFont(Constants.FONT.deriveFont(Font.BOLD, 12f));
         this.infoTextArea.setLineWrap(true);

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -235,7 +235,8 @@ else if(selectedPanel != null
                                 new ErrorDialog(this.mainFrame,
                                 Messages.getI18NString(
                                     "contactNotSupportingTelephony",
-                                    contact.getDisplayName()).getText(),
+                                    new String[]{contact.getDisplayName()})
+                                        .getText(),
                                 Messages.getI18NString("warning").getText())
                                 .showDialog();
                             }

File: src/net/java/sip/communicator/impl/gui/main/login/AuthenticationWindow.java
Patch:
@@ -137,8 +137,8 @@ private void init() {
         this.realmTextArea.setFont(Constants.FONT.deriveFont(Font.BOLD, 12f));
         this.realmTextArea.setEditable(false);
         this.realmTextArea.setText(
-            Messages.getI18NString("securityAuthorityRealm", this.realm)
-                .getText());
+            Messages.getI18NString("securityAuthorityRealm",
+                new String[]{realm}).getText());
 
         this.uinLabel.setFont(Constants.FONT.deriveFont(Font.BOLD));
         this.passwdLabel.setFont(Constants.FONT.deriveFont(Font.BOLD));

File: src/net/java/sip/communicator/impl/gui/main/message/ChatPanel.java
Patch:
@@ -240,12 +240,14 @@ public void updateContactStatus(MetaContact metaContact, Contact protoContact)
             metaContact.getDefaultContact().getPresenceStatus());
         
         this.sendPanel.updateContactStatus(protoContact);
+        
         String message = this.conversationPanel.processMessage(
                 this.metaContact.getDisplayName(),
                 new Date(System.currentTimeMillis()),
                 Constants.SYSTEM_MESSAGE,
                 Messages.getI18NString("statusChangedChatMessage",
-                        status.getStatusName()).getText());
+                        new String[]{status.getStatusName()}).getText());
+        
         this.conversationPanel.appendMessageToEnd(message);
     }
     

File: src/net/java/sip/communicator/impl/gui/main/message/history/HistoryWindow.java
Patch:
@@ -106,7 +106,8 @@ public HistoryWindow(MainFrame mainFrame, MetaContact metaContact)
         this.metaContact = metaContact;
 
         this.setTitle(Messages.getI18NString(
-                "historyContact", metaContact.getDisplayName()).getText());
+                "historyContact",
+                new String[]{metaContact.getDisplayName()}).getText());
 
         this.datesPanel = new DatesPanel(this);
         this.historyMenu = new HistoryMenu(this);

File: src/net/java/sip/communicator/impl/history/HistoryReaderImpl.java
Patch:
@@ -28,8 +28,8 @@ public class HistoryReaderImpl
 
     // regexp used for index of case(in)sensitive impl
     private static String REGEXP_END = ".*$";
-    private static String REGEXP_SENSITIVE_START = "^.*";
-    private static String REGEXP_INSENSITIVE_START = "^(?i).*";
+    private static String REGEXP_SENSITIVE_START = "(?s)^.*";
+    private static String REGEXP_INSENSITIVE_START = "(?si)^.*";
 
     protected HistoryReaderImpl(HistoryImpl historyImpl)
     {

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -36,7 +36,7 @@ public class ProtocolProviderServiceJabberImpl
     private XMPPConnection connection = null;
 
     /**
-     * indicates whether or not the provider is initialized and ready for use.
+     * Indicates whether or not the provider is initialized and ready for use.
      */
     private boolean isInitialized = false;
 

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -123,7 +123,6 @@ public abstract class ProtocolProviderFactory
      */
     public static final String PREFERRED_TRANSPORT = "PREFERRED_TRANSPORT";
 
-
     /**
      * Initializaed and creates an account corresponding to the specified
      * accountProperties and registers the resulting ProtocolProvider in the

File: src/net/java/sip/communicator/service/protocol/event/ContactPresenceStatusListener.java
Patch:
@@ -26,6 +26,6 @@ public interface ContactPresenceStatusListener
      * change.
      */
     public void contactPresenceStatusChanged(
-        ContactPresenceStatusChangeEvent evt);
+                                    ContactPresenceStatusChangeEvent evt);
 
 }

File: src/net/java/sip/communicator/plugin/splashscreen/WelcomeWindow.java
Patch:
@@ -73,7 +73,7 @@ public WelcomeWindow()
 
         this.rightsArea.setContentType("text/html");
         this.rightsArea.setText(
-                "<html><font size=3>(c)2003-2006 Copyright <b>sip-communicator.org</b>."
+                "<html><font size=3>(c)2003-2007 Copyright <b>sip-communicator.org</b>."
                 + " All rights reserved. Visit "
                 + "<a href=\"http://sip-communicator.org\">"
                 + "http://sip-communicator.org</a>.</font></html>");

File: src/net/java/sip/communicator/impl/protocol/jabber/ContactJabberImpl.java
Patch:
@@ -129,7 +129,9 @@ public boolean equals(Object obj)
     public String toString()
     {
         StringBuffer buff =  new StringBuffer("JabberContact[ id=");
-        buff.append(getAddress()).append("]");
+        buff.append(getAddress()).
+            append(", isPersistent=").append(isPersistent).
+            append(", isResolved=").append(isResolved).append("]");
 
         return buff.toString();
     }

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetPersistentPresenceIcqImpl.java
Patch:
@@ -576,6 +576,8 @@ public void unsubscribe(Contact contact) throws IllegalArgumentException,
             return;
         }
 
+        logger.trace("Going to remove contact from ss-list : " + contact);
+        
         MutableGroup joustSimContactGroup = contactGroup.getJoustSimSourceGroup();
 
         joustSimContactGroup.deleteBuddy(contactIcqImpl.getJoustSimBuddy());

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetPresence.java
Patch:
@@ -663,7 +663,8 @@ public void postTestSubscribe()
                 testerAgentNewStatusLong = FullUserInfo.ICQSTATUS_OCCUPIED;
             }   
             
-            contactPresEvtCollector.collectedEvents.clear();
+            contactPresEvtCollector = new ContactPresenceEventCollector(
+                    fixture.testerAgent.getIcqUIN(), testerAgentNewStatus);
             operationSetPresence.addContactPresenceStatusListener(
                 contactPresEvtCollector);
 

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1696,8 +1696,8 @@ private void initOutboundProxy(AccountID accountID,
         if (proxyTransport != null && proxyTransport.length() > 0)
         {
             if (!proxyTransport.equals(ListeningPoint.UDP)
-                || !proxyTransport.equals(ListeningPoint.TCP)
-                || !proxyTransport.equals(ListeningPoint.TLS))
+                && !proxyTransport.equals(ListeningPoint.TCP)
+                && !proxyTransport.equals(ListeningPoint.TLS))
             {
                 throw new IllegalArgumentException(proxyTransport
                     + " is not a valid transport protocol. Transport must be "

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1544,7 +1544,7 @@ private void initRegistrarConnection(AccountID accountID)
 
         //registrar transport
         String registrarTransport = (String) accountID.getAccountProperties()
-            .get(ProtocolProviderFactory.SERVER_TRANSPORT);
+            .get(ProtocolProviderFactory.PREFERRED_TRANSPORT);
 
         if(registrarTransport != null && registrarTransport.length() > 0)
         {

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1549,8 +1549,8 @@ private void initRegistrarConnection(AccountID accountID)
         if(registrarTransport != null && registrarTransport.length() > 0)
         {
             if( ! registrarTransport.equals(ListeningPoint.UDP)
-                || !registrarTransport.equals(ListeningPoint.TCP)
-                || !registrarTransport.equals(ListeningPoint.TLS))
+                && !registrarTransport.equals(ListeningPoint.TCP)
+                && !registrarTransport.equals(ListeningPoint.TLS))
             {
                 throw new IllegalArgumentException(registrarTransport
                     + " is not a valid transport protocol. Transport must be "

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommDialog.java
Patch:
@@ -174,8 +174,8 @@ private void setSizeAndLocation()
         
         if(widthString != null && heightString != null)
         {   
-            width = new Integer(width).intValue();
-            height = new Integer(height).intValue();
+            width = new Integer(widthString).intValue();
+            height = new Integer(heightString).intValue();
             
             if(width > 0 && height > 0)
                 this.setSize(width, height);

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommFrame.java
Patch:
@@ -141,8 +141,8 @@ public void setSizeAndLocation() {
         
         if(widthString != null && heightString != null)
         {   
-            width = new Integer(width).intValue();
-            height = new Integer(height).intValue();
+            width = new Integer(widthString).intValue();
+            height = new Integer(heightString).intValue();
             
             if(width > 0 && height > 0)
                 this.setSize(width, height);

File: src/net/java/sip/communicator/impl/protocol/jabber/OperationSetBasicInstantMessagingJabberImpl.java
Patch:
@@ -332,7 +332,7 @@ public void processPacket(Packet packet)
                 logger.debug("Received from "
                              + fromUserID
                              + " the message "
-                             + msg.getBody());
+                             + msg.toXML());
             }
 
             KeepAliveEvent keepAliveEvent =

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegWizardContainerImpl.java
Patch:
@@ -6,6 +6,7 @@
  */
 package net.java.sip.communicator.impl.gui.main.account;
 
+import java.awt.Dimension;
 import java.io.*;
 import java.util.*;
 
@@ -58,6 +59,8 @@ public AccountRegWizardContainerImpl(MainFrame mainFrame)
         this.summaryPage = new AccountRegSummaryPage(this);
         
         this.addAccountRegistrationListener(firstPage);
+
+        this.setPreferredSize(new Dimension(450, 350));
     }
             
     /**

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigurationFrame.java
Patch:
@@ -153,8 +153,8 @@ public void removeConfigurationForm(ConfigurationForm configForm) {
      * Calculates the size of the frame depending on the size of the largest
      * contained form.
      */
-    public void recalculateSize() {
-
+    public void recalculateSize()
+    {
         double width = 0;
 
         double height = 0;
@@ -171,7 +171,7 @@ public void recalculateSize() {
             if (height < form.getPreferredSize().getHeight())
                 height = form.getPreferredSize().getHeight();
         }
-        
+     
         this.mainPanel.setPreferredSize(new Dimension(
             (int) width + 150, (int) height + 100));
     }

File: src/net/java/sip/communicator/impl/gui/main/message/ChatConversationPanel.java
Patch:
@@ -448,8 +448,8 @@ private String processKeyword(String message, String keyword)
 
             String matchGroup = m.group().trim();
 
-            String replacement = "</PLAINTEXT><B>" + matchGroup
-                                + "</B><PLAINTEXT>";
+            String replacement = "</PLAINTEXT><I>" + matchGroup
+                                + "</I><PLAINTEXT>";
 
             m.appendReplacement(msgBuffer,
                     GuiUtils.replaceSpecialRegExpChars(replacement));

File: src/net/java/sip/communicator/plugin/icqaccregwizz/IcqAccountRegistrationWizard.java
Patch:
@@ -142,10 +142,10 @@ public ProtocolProviderService installAccount(
                     .getService(serRef);
         }
         catch (IllegalArgumentException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();            
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }
         catch (IllegalStateException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }       
         
         return protocolProvider;

File: src/net/java/sip/communicator/plugin/jabberaccregwizz/JabberAccountRegistrationWizard.java
Patch:
@@ -160,10 +160,10 @@ public ProtocolProviderService installAccount(
                     .getService(serRef);
         }
         catch (IllegalArgumentException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();            
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }
         catch (IllegalStateException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }       
 
         return protocolProvider;

File: src/net/java/sip/communicator/plugin/msnaccregwizz/MsnAccountRegistrationWizard.java
Patch:
@@ -151,10 +151,10 @@ public ProtocolProviderService installAccount(
                     .getService(serRef);
         }
         catch (IllegalArgumentException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();            
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }
         catch (IllegalStateException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }    
 
         return protocolProvider;

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -191,10 +191,10 @@ public ProtocolProviderService installAccount(
 
         }
         catch (IllegalArgumentException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();            
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }
         catch (IllegalStateException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }   
         
         return protocolProvider;

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/YahooAccountRegistrationWizard.java
Patch:
@@ -151,10 +151,10 @@ public ProtocolProviderService installAccount(
                     .getService(serRef);
         }
         catch (IllegalArgumentException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();            
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }
         catch (IllegalStateException e) {
-            new ErrorDialog(null, e.getMessage()).showDialog();
+            new ErrorDialog(null, e.getMessage(), e).showDialog();
         }    
 
         return protocolProvider;

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -96,7 +96,7 @@ public QuickMenu(MainFrame mainFrame) {
             Messages.getI18NString("showOfflineUsers").getText());
         this.addButton.setToolTipText(
             Messages.getI18NString("addContact").getText());        
-        this.addButton.setToolTipText(
+        this.soundButton.setToolTipText(
             Messages.getI18NString("soundOnOff").getText());
 
         this.updateMuteButton(

File: src/net/java/sip/communicator/impl/protocol/yahoo/OperationSetPersistentPresenceYahooImpl.java
Patch:
@@ -706,7 +706,7 @@ else if(status == StatusConstants.STATUS_OFFLINE)
             return YahooStatusEnum.OFFLINE;
         // Yahoo supports custom statuses so if such is set just return available
         else
-            return YahooStatusEnum.OFFLINE;
+            return YahooStatusEnum.AVAILABLE;
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -253,7 +253,7 @@ else if (evt.getReasonCode() == RegistrationStateChangeEvent
             else if (evt.getReasonCode() == RegistrationStateChangeEvent
                     .REASON_AUTHENTICATION_FAILED) {
                 String msgText = Messages.getI18NString("authenticationFailed",
-                        protocolProvider.getAccountID().getAccountAddress())
+                        protocolProvider.getAccountID().getUserID())
                         .getText();
 
                 new ErrorDialog(null, msgText,
@@ -266,7 +266,7 @@ else if (evt.getNewState().equals(RegistrationState.CONNECTION_FAILED)) {
             this.mainFrame.getStatusPanel().updateStatus(evt.getProvider());
 
             String msgText = Messages.getI18NString("connectionFailedMessage",
-                protocolProvider.getAccountID().getAccountAddress()).getText();
+                protocolProvider.getAccountID().getUserID()).getText();
 
             new ErrorDialog(null, msgText,
                 Messages.getI18NString("error").getText()).showDialog();

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommPopupMenuUI.java
Patch:
@@ -25,13 +25,12 @@ public class SIPCommPopupMenuUI extends BasicPopupMenuUI
      * Creates a new SIPCommPopupMenuUI instance.
      */
     public static ComponentUI createUI(JComponent c) {
-        c.setOpaque(false);
         return new SIPCommPopupMenuUI();
     }
 
     public void paint(Graphics g, JComponent c) {
         AntialiasingManager.activateAntialiasing(g);
         
-        super.paint(g, c);           
+        super.paint(g, c);
     }
 }

File: test/net/java/sip/communicator/slick/protocol/yahoo/YahooProtocolProviderServiceLick.java
Patch:
@@ -84,8 +84,7 @@ public void start(BundleContext context)
 
             addTest(TestOperationSetBasicInstantMessaging.suite());
 
-            // Sending typing notifications doesn't work for now
-            //addTest(TestOperationSetTypingNotifications.suite());
+            addTest(TestOperationSetTypingNotifications.suite());
         }
 
         addTest(TestAccountUninstallation.suite());

File: src/net/java/sip/communicator/service/protocol/icqconstants/IcqStatusEnum.java
Patch:
@@ -4,7 +4,6 @@
 import java.util.*;
 
 import net.java.sip.communicator.service.protocol.*;
-import net.java.sip.communicator.service.protocol.jabberconstants.*;
 import net.java.sip.communicator.util.*;
 
 /**
@@ -124,7 +123,7 @@ protected IcqStatusEnum(int status, String statusName, byte[] statusIcon)
      * @return The image for the given identifier.
      */
     public static byte[] loadIcon(String imagePath) {
-        InputStream is = JabberStatusEnum.class.getClassLoader()
+        InputStream is = IcqStatusEnum.class.getClassLoader()
             .getResourceAsStream(imagePath);
         
         byte[] icon = null;

File: src/net/java/sip/communicator/impl/protocol/yahoo/ContactGroupYahooImpl.java
Patch:
@@ -356,7 +356,9 @@ ContactYahooImpl findContact(String id)
         while (contacts.hasNext())
         {
             ContactYahooImpl item = (ContactYahooImpl) contacts.next();
-            if(item.getAddress().equals(id))
+            
+            if(YahooSession.getYahooUserID(item.getAddress())
+                .equals(YahooSession.getYahooUserID(id)))
                 return item;
         }
         return null;

File: src/net/java/sip/communicator/impl/protocol/yahoo/ContactYahooImpl.java
Patch:
@@ -112,7 +112,8 @@ public boolean equals(Object obj)
     {
         if (obj == null
             || !(obj instanceof ContactYahooImpl)
-            || !(((ContactYahooImpl)obj).getAddress().equals(getAddress())
+            || !(YahooSession.getYahooUserID(((ContactYahooImpl)obj).getAddress())
+                .equals(YahooSession.getYahooUserID(getAddress()))
                 && ((ContactYahooImpl)obj).getProtocolProvider()
                         == getProtocolProvider()))
             return false;

File: src/net/java/sip/communicator/impl/protocol/yahoo/YahooAccountID.java
Patch:
@@ -25,9 +25,7 @@ public class YahooAccountID
      */
     YahooAccountID(String id, Map accountProperties )
     {
-        super((id.indexOf("@") > -1 )
-                    ? id.substring(0, id.indexOf("@"))
-                    : id, 
+        super(YahooSession.getYahooUserID(id), 
               accountProperties, ProtocolNames.YAHOO, "yahoo.com");
     }
 }

File: src/net/java/sip/communicator/plugin/yahooaccregwizz/FirstWizardPage.java
Patch:
@@ -42,7 +42,7 @@ public class FirstWizardPage extends JPanel
     
     private JPanel emptyPanel = new JPanel();
     
-    private JLabel uinExampleLabel = new JLabel("Ex: johnsmith@hotmail.com");
+    private JLabel uinExampleLabel = new JLabel("Ex: johnsmith@yahoo.com or johnsmith");
     
     private JTextField uinField = new JTextField();
 

File: src/net/java/sip/communicator/impl/protocol/sip/OperationSetBasicTelephonySipImpl.java
Patch:
@@ -527,7 +527,8 @@ else if (response.getStatusCode() == Response.UNAUTHORIZED
                                            , sourceProvider);
         }
         //errors
-        else if ( response.getStatusCode() / 100 == 4 )
+        else if ( response.getStatusCode() / 100 == 4 ||
+            response.getStatusCode() / 100 == 5)
         {
             CallParticipantSipImpl callParticipant = activeCallsRepository
                 .findCallParticipant(clientTransaction.getDialog());

File: src/net/java/sip/communicator/impl/media/CallSessionImpl.java
Patch:
@@ -115,7 +115,7 @@ public class CallSessionImpl
      * The name of the property indicating the length of our receive buffer.
      */
     private static final String PROPERTY_NAME_RECEIVE_BUFFER_LENGTH
-        = "net.java.sip.communicator.media.impl.RECEIVE_BUFFER_LENGTH";
+        = "net.java.sip.communicator.impl.media.RECEIVE_BUFFER_LENGTH";
 
     /**
      * The list of currently active players that we have created during this

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -1,4 +1,4 @@
-    /*
+/*
  * SIP Communicator, the OpenSource Java VoIP and Instant Messaging client.
  *
  * Distributable under LGPL license.

File: src/net/java/sip/communicator/service/media/MediaService.java
Patch:
@@ -35,7 +35,7 @@ public interface MediaService
      * like our rtp managers to bind upon.
      */
     public static final String MIN_PORT_NUMBER_PROPERTY_NAME
-        = "net.java.sip.communicator.service.media.MAX_PORT_NUMBER";
+        = "net.java.sip.communicator.service.media.MIN_PORT_NUMBER";
 
     /**
      * The name of the property that contains the maximum port number that we'd

File: src/net/java/sip/communicator/impl/history/DBStructSerializer.java
Patch:
@@ -109,8 +109,7 @@ private Element createStructureTag(Document doc,
      */
     public History loadHistory(File dbDatFile) throws SAXException,
             IOException, ParseException {
-        DocumentBuilder builder = historyService.getDocumentBuilder();
-        Document doc = builder.parse(dbDatFile);
+        Document doc = historyService.parse(dbDatFile);
 
         Node root = doc.getFirstChild();
         HistoryID id = loadID(root);

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -452,6 +452,8 @@ public void incomingCallReceived(CallEvent event)
         SoundLoader.playInLoop(Constants.getDefaultIncomingCallAudio(), 2000);
         
         activeCalls.put(sourceCall, callPanel);
+        
+        this.showCallPanel();
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -462,6 +462,8 @@ else if (errorCode == OperationFailedException
                         protocolProvider.getAccountID()
                         .getAccountAddress()).getText(),
                     Messages.getI18NString("error").getText()).showDialog();
+
+                mainFrame.getStatusPanel().updateStatus(protocolProvider);
             }
         }
     }

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegFirstPage.java
Patch:
@@ -64,7 +64,7 @@ public AccountRegFirstPage(AccountRegWizardContainerImpl container) {
         
         this.tableModel = new ExtendedTableModel();
         
-        this.setPreferredSize(new Dimension(500, 350));
+        this.setPreferredSize(new Dimension(500, 400));
         
         this.accountRegsTable.setSelectionMode(
                 ListSelectionModel.SINGLE_SELECTION);

File: src/net/java/sip/communicator/impl/growlnotification/GrowlNotificationServiceImpl.java
Patch:
@@ -77,7 +77,7 @@ public void start(BundleContext bc)
         try
         {
             Constructor constructor = Growl.class.getConstructor(new Class[]
-                                       {String.class, String.class, String.class});
+                                {String.class, String[].class, String[].class});
             notifier = (Growl)constructor.newInstance(
                     new Object[]{"SIP Communicator", allNotif, defaultNotif});
             notifier.register();

File: test/net/java/sip/communicator/slick/protocol/jabber/TestOperationSetPresence.java
Patch:
@@ -1051,7 +1051,8 @@ public void waitForAuthResponse(long waitFor)
         {
             synchronized(this)
             {
-                if(isAuthorizationResponseReceived) return;
+                if(isAuthorizationResponseReceived)
+                    return;
                 try{
                     wait(waitFor);
                 }

File: src/net/java/sip/communicator/impl/gui/customcontrols/ErrorDialog.java
Patch:
@@ -127,9 +127,6 @@ public void setMessage(String message)
     
     /**
      * Shows the dialog.
-     * @return The return code that should indicate what was the choice of
-     * the user. If the user chooses cancel, the return code is the 
-     * CANCEL_RETURN_CODE.
      */
     public void showDialog()
     {   

File: src/net/java/sip/communicator/impl/gui/main/call/AccountSelectorBox.java
Patch:
@@ -123,7 +123,7 @@ public void actionPerformed(ActionEvent e) {
     /**
      * Obtains the status icon for the given protocol contact and
      * adds to it the account index information.
-     * @param protoContact the proto contact for which to create the image
+     * @param pps the protocol provider for which to create the image
      * @return the indexed status image
      */
     public Image createAccountStatusImage(ProtocolProviderService pps)
@@ -213,7 +213,7 @@ public void setSelected(ProtocolProviderService pps, ImageIcon icon)
     
     /**
      * Sets the selected contact to the given proto contact.
-     * @param protoContact the proto contact to select
+     * @param pps the protocol provider to select
      */
     public void setSelected(ProtocolProviderService pps)
     {

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -357,7 +357,7 @@ public void addCallAccount(ProtocolProviderService pps)
     /**
      * Removes the account corresponding to the given protocol provider from the
      * call via selector box.
-     * @param protocolProvider the protocol provider service to remove
+     * @param pps the protocol provider service to remove
      */
     public void removeCallAccount(ProtocolProviderService pps)
     {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -352,7 +352,7 @@ public void removeExcContactListListener(ContactListListener listener)
      * Creates the corresponding ContactListEvent and notifies all
      * <tt>ContactListListener</tt>s that a contact is selected.
      * 
-     * @param sourceContact the contact that this event is about.
+     * @param source the contact that this event is about.
      * @param eventID the id indicating the exact type of the event to fire.
      */
     public void fireContactListEvent(Object source, int eventID)

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPanel.java
Patch:
@@ -911,7 +911,7 @@ private void setMetaContact(MetaContact metaContact)
      * depending on the chat mode and if this is the case returns
      * <code>true</code>, otherwise returns <code>false</code>.
      * 
-     * @param contact The <tt>Contact</tt> for which to check.
+     * @param metaContact The <tt>MetaContact</tt> for which to check.
      * @return <code>true</code> if there is an open chat tab or chat window
      *         for the given contact, <code>false</code> otherwise.
      */

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -809,7 +809,7 @@ else if (operation.equals(REMOVE_OPERATION)) {
                             .countContactsAndSubgroups(group);
                     int listSize = listModel.getSize();
 
-                    if(listSize > 0 && removeCount > 0) {
+                    if(listSize > 0) {
                         listModel.contentRemoved(listSize - 1, listSize
                                 + removeCount - 1);
                         listModel.contentChanged(groupIndex, listSize - 1);

File: src/net/java/sip/communicator/impl/gui/customcontrols/ErrorDialog.java
Patch:
@@ -55,8 +55,6 @@ public ErrorDialog(Frame owner)
         
         this.setTitle(Messages.getI18NString("removeContact").getText());
 
-        this.setSize(Constants.MSG_DIALOG_WIDTH, Constants.MSG_DIALOG_HEIGHT);
-
         this.getContentPane().setLayout(new BorderLayout(5, 5));
 
         this.messagePanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 0,
@@ -135,7 +133,8 @@ public void setMessage(String message)
      */
     public void showDialog()
     {   
-        setVisible(true);        
+        this.pack();
+        this.setVisible(true);        
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/customcontrols/MessageDialog.java
Patch:
@@ -9,7 +9,6 @@
 
 import java.awt.*;
 import java.awt.event.*;
-import java.lang.reflect.*;
 
 import javax.swing.*;
 

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -218,12 +218,12 @@ else if(selectedPanel != null
                             if(contact != null) 
                                 telephonyContacts.add(contact);
                             else {
-                                JOptionPane.showMessageDialog(this.mainFrame,
+                                new ErrorDialog(this.mainFrame,
                                 Messages.getI18NString(
                                     "contactNotSupportingTelephony",
                                     contact.getDisplayName()).getText(),
-                                Messages.getI18NString("warning").getText(),
-                                JOptionPane.ERROR_MESSAGE);
+                                Messages.getI18NString("warning").getText())
+                                .showDialog();
                             }
                         }
                     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -601,10 +601,11 @@ private void moveContact(MetaContact toMetaContact)
         this.moveDialog.dispose();
         
         if(toMetaContact.equals(contactItem)) {
-            JOptionPane.showMessageDialog(this.mainFrame,
+            new ErrorDialog(this.mainFrame,
                     Messages.getI18NString("moveSubcontactInSameContact").getText(),
                     Messages.getI18NString("moveSubcontact").getText(),
-                    JOptionPane.WARNING_MESSAGE);
+                    ErrorDialog.WARNING)
+                    .showDialog();
         }
         else {
             guiContactList.removeExcContactListListener(this);

File: src/net/java/sip/communicator/impl/gui/main/menus/QuickMenu.java
Patch:
@@ -193,11 +193,11 @@ else if (buttonName.equals("info")) {
                                 .toString());
                 }
                 else {
-                    JOptionPane.showMessageDialog(mainFrame,
+                    new ErrorDialog(mainFrame,
                         Messages.getI18NString("selectContactSupportingInfo")
                             .getText(),
                         Messages.getI18NString("warning").getText(),
-                        JOptionPane.WARNING_MESSAGE);
+                        ErrorDialog.WARNING).showDialog();
                 }
             }            
         }

File: src/net/java/sip/communicator/plugin/icqaccregwizz/IcqAccountRegistrationWizard.java
Patch:
@@ -10,6 +10,7 @@
 
 import javax.swing.*;
 
+import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 
@@ -141,10 +142,10 @@ public ProtocolProviderService installAccount(
                     .getService(serRef);
         }
         catch (IllegalArgumentException e) {
-            JOptionPane.showMessageDialog(null, e.getMessage());            
+            new ErrorDialog(null, e.getMessage()).showDialog();            
         }
         catch (IllegalStateException e) {
-            JOptionPane.showMessageDialog(null, e.getMessage());
+            new ErrorDialog(null, e.getMessage()).showDialog();
         }       
         
         return protocolProvider;

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -10,6 +10,7 @@
 
 import javax.swing.*;
 
+import net.java.sip.communicator.impl.gui.customcontrols.*;
 import net.java.sip.communicator.service.gui.*;
 import net.java.sip.communicator.service.protocol.*;
 
@@ -190,10 +191,10 @@ public ProtocolProviderService installAccount(
 
         }
         catch (IllegalArgumentException e) {
-            JOptionPane.showMessageDialog(null, e.getMessage());            
+            new ErrorDialog(null, e.getMessage()).showDialog();            
         }
         catch (IllegalStateException e) {
-            JOptionPane.showMessageDialog(null, e.getMessage());
+            new ErrorDialog(null, e.getMessage()).showDialog();
         }   
         
         return protocolProvider;

File: src/net/java/sip/communicator/impl/gui/main/login/LoginManager.java
Patch:
@@ -325,7 +325,7 @@ else if (evt.getReasonCode() == RegistrationStateChangeEvent
                 else {
                     SIPCommMsgTextArea msgText = new SIPCommMsgTextArea(
                         Messages.getI18NString("unregisteredMessage",
-                            protocolProvider.getProtocolName()).getText());
+                            protocolProvider.getAccountID().getUserID()).getText());
 
                     JOptionPane.showMessageDialog(null, msgText,
                         Messages.getI18NString("error").getText(),

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationRequestedDialog.java
Patch:
@@ -56,8 +56,7 @@ public class AuthorizationRequestedDialog
     
     private I18NString ignoreString = Messages.getI18NString("ignore");
     
-    private JButton acceptButton 
-        = new JButton();
+    private JButton acceptButton = new JButton(acceptString.getText());
     
     private JButton rejectButton = new JButton(rejectString.getText());
     

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListModel.java
Patch:
@@ -410,8 +410,9 @@ public boolean showOffline() {
      * false otherwise.
      */
     public void setShowOffline(boolean showOffline) {
+        int size = getSize();
         this.showOffline = showOffline;
-        this.contentChanged(0, getSize() - 1);
+        this.contentChanged(0, size - 1);        
     }    
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPanel.java
Patch:
@@ -408,6 +408,8 @@ public void messageReceived(MessageReceivedEvent evt)
             if (chatWindows.isEmpty()) {
                 // If there's no open chat window
                 chatWindow = new ChatWindow(mainFrame);
+                
+                chatWindows.put(metaContact, chatWindow);
             }
             else {
                 chatWindow = (ChatWindow) chatWindows.elements().nextElement();

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationRequestedDialog.java
Patch:
@@ -122,7 +122,7 @@ public AuthorizationRequestedDialog(MainFrame mainFrame, Contact contact,
             this.mainPanel.setPreferredSize(new Dimension(550, 400));            
         }
         else {
-            this.mainPanel.setPreferredSize(new Dimension(550, 300));
+            this.mainPanel.setPreferredSize(new Dimension(550, 350));
         }
         
         this.responseScrollPane.setBorder(BorderFactory.createCompoundBorder(

File: src/net/java/sip/communicator/impl/gui/main/login/AuthenticationWindow.java
Patch:
@@ -208,8 +208,7 @@ protected void paintComponent(Graphics g) {
 
             Graphics2D g2 = (Graphics2D) g;
 
-            g2.drawImage(bgImage, 40,
-                (this.getHeight()/2 - bgImage.getHeight(null)/2), null);
+            g2.drawImage(bgImage, 30, 30, null);
 
             g2.drawImage(ImageLoader.getImage(
                     ImageLoader.AUTH_WINDOW_BACKGROUND),

File: src/net/java/sip/communicator/impl/gui/utils/Constants.java
Patch:
@@ -404,7 +404,7 @@ public static Image getProtocolBigIcon(String protocolName) {
 
         if (protocolName.equals(Constants.SIP)) {
 
-            protocolIcon = ImageLoader.getImage(ImageLoader.SIP_ONLINE_ICON);
+            protocolIcon = ImageLoader.getImage(ImageLoader.SIP_32x32);
         } else if (protocolName.equals(Constants.ICQ)) {
 
             protocolIcon = ImageLoader.getImage(ImageLoader.ICQ_32x32);

File: src/net/java/sip/communicator/impl/gui/main/configforms/AccountsConfigurationForm.java
Patch:
@@ -79,6 +79,8 @@ public AccountsConfigurationForm(MainFrame mainFrame) {
 
         this.add(tablePane, BorderLayout.CENTER);
         this.add(rightPanel, BorderLayout.EAST);
+        
+        this.setPreferredSize(new Dimension(500, 400));
     }
 
     /**

File: src/net/java/sip/communicator/impl/gui/main/configforms/AccountsConfigurationForm.java
Patch:
@@ -245,6 +245,8 @@ else if (sourceButton.equals(modifyButton)) {
         else if(sourceButton.equals(removeButton)){
 
             if(accountsTable.getSelectedRow() != -1) {
+                mainFrame.getLoginManager().setManuallyDisconnected(true);
+                
                 ProtocolProviderService protocolProvider
                     = (ProtocolProviderService)tableModel.getValueAt(
                         accountsTable.getSelectedRow(), 0);

File: src/net/java/sip/communicator/impl/gui/main/call/CallManager.java
Patch:
@@ -198,7 +198,7 @@ else if(selectedPanel != null
                                 Messages.getString("contactNotSupportingTelephony",
                                                     contact.getDisplayName()),
                                 Messages.getString("warning"),
-                                JOptionPane.WARNING_MESSAGE);
+                                JOptionPane.ERROR_MESSAGE);
                             }
                         }
                     }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactDialog.java
Patch:
@@ -156,7 +156,7 @@ public void run() {
                                             uin),
                                     Messages.getString(
                                             "addContactErrorTitle"),
-                                    JOptionPane.WARNING_MESSAGE);
+                                    JOptionPane.ERROR_MESSAGE);
                             }
                             else if (errorCode
                                 == MetaContactListException
@@ -168,7 +168,7 @@ else if (errorCode
                                             uin),
                                     Messages.getString(
                                             "addContactErrorTitle"),
-                                    JOptionPane.WARNING_MESSAGE);
+                                    JOptionPane.ERROR_MESSAGE);
                             }
                             else if (errorCode
                                     == MetaContactListException
@@ -180,7 +180,7 @@ else if (errorCode
                                                 uin),
                                         Messages.getString(
                                                 "addContactErrorTitle"),
-                                        JOptionPane.WARNING_MESSAGE);
+                                        JOptionPane.ERROR_MESSAGE);
                             }
                             else {
                                 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addgroup/CreateGroupDialog.java
Patch:
@@ -133,7 +133,7 @@ public void run() {
                                             groupName),
                                     Messages.getString(
                                             "addGroupErrorTitle"),
-                                    JOptionPane.WARNING_MESSAGE);
+                                    JOptionPane.ERROR_MESSAGE);
                         }
                         else if (errorCode
                             == MetaContactListException.CODE_LOCAL_IO_ERROR) {
@@ -144,7 +144,7 @@ else if (errorCode
                                         groupName),
                                 Messages.getString(
                                         "addGroupErrorTitle"),
-                                JOptionPane.WARNING_MESSAGE);
+                                JOptionPane.ERROR_MESSAGE);
                         }
                         else if (errorCode
                                 == MetaContactListException.CODE_NETWORK_ERROR) {

File: src/net/java/sip/communicator/impl/gui/lookandfeel/SIPCommDefaultTheme.java
Patch:
@@ -99,6 +99,9 @@ public void addCustomEntriesToTable(UIDefaults table) {
             
             "OptionPane.warningIcon",
                 new ImageIcon(ImageLoader.getImage(ImageLoader.WARNING_ICON)),
+                
+            "OptionPane.errorIcon",
+                new ImageIcon(ImageLoader.getImage(ImageLoader.ERROR_ICON)),
 
             "RadioButton.gradient", buttonGradient,
             "RadioButton.rollover", Boolean.TRUE,

File: src/net/java/sip/communicator/impl/history/HistoryImpl.java
Patch:
@@ -364,7 +364,7 @@ private boolean isValidXML(String str)
         }
         catch (Exception ex)
         {
-            System.out.println("not valid xml " + ex.getMessage());
+            log.error("not valid xml " + str + " " + ex.getMessage());
             return false;
         }
 

File: src/net/java/sip/communicator/impl/gui/main/AboutWindow.java
Patch:
@@ -101,6 +101,7 @@ public AboutWindow(Frame owner)
         this.textPanel.add(rightsArea);
         this.textPanel.add(licenseArea);
         
+        this.getRootPane().setDefaultButton(okButton);
         this.okButton.addActionListener(this);
         this.buttonPanel.add(okButton);
         this.buttonPanel.setOpaque(false);

File: src/net/java/sip/communicator/impl/contactlist/ContactlistActivator.java
Patch:
@@ -61,6 +61,7 @@ public void start(BundleContext context) throws Exception
      */
     public void stop(BundleContext context) throws Exception
     {
+        logger.trace("Stopping the contact list.");
         if(mclServiceImpl != null)
             mclServiceImpl.stop(context);
     }

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -132,7 +132,7 @@ private void init()
     private void setInitialBounds()
     {
         this.setSize(200, 450);
-        this.contactListPanel.setPreferredSize(new Dimension(180, 400));
+        this.contactListPanel.setPreferredSize(new Dimension(300, 600));
         this.contactListPanel.setMinimumSize(new Dimension(80, 200));
 
         this.setLocation(Toolkit.getDefaultToolkit().getScreenSize().width

File: src/net/java/sip/communicator/impl/gui/main/login/AuthenticationWindow.java
Patch:
@@ -82,6 +82,8 @@ public AuthenticationWindow(MainFrame mainFrame,
                 Constants.getProtocolBigIcon(
                         protocolProvider.getProtocolName()));
 
+        this.backgroundPanel.setPreferredSize(new Dimension(420, 230));
+        
         this.backgroundPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));
 
         this.backgroundPanel.setBorder(

File: src/net/java/sip/communicator/impl/gui/main/contactlist/MoveSubcontactMessageDialog.java
Patch:
@@ -51,7 +51,8 @@ public class MoveSubcontactMessageDialog
     /**
      * Creates an instance of MoveSubcontactMessageDialog and constructs
      * all panels contained in this dialog.
-     * @param mainFrame the main application window
+     * @param parentWindow the main application window
+     * @param listener the listener that deals with moved contacts 
      */
     public MoveSubcontactMessageDialog(MainFrame parentWindow,
             ContactListListener listener)

File: src/net/java/sip/communicator/impl/gui/main/menus/HelpMenu.java
Patch:
@@ -33,7 +33,7 @@ public class HelpMenu
 
     /**
      * Creates an instance of <tt>HelpMenu</tt>.
-     * @param parentWindow The parent <tt>MainFrame</tt>.
+     * @param mainFrame The parent <tt>MainFrame</tt>.
      */
     public HelpMenu(MainFrame mainFrame) {
 

File: src/net/java/sip/communicator/impl/gui/main/menus/ViewMenu.java
Patch:
@@ -42,7 +42,7 @@ public class ViewMenu
 
     /**
      * Creates an instance of <tt>ViewMenu</tt>.
-     * @param parentWindow The parent <tt>ChatWindow</tt>.
+     * @param mainFrame The parent <tt>MainFrame</tt> window.
      */
     public ViewMenu(MainFrame mainFrame) {
 

File: src/net/java/sip/communicator/impl/gui/main/message/ChatWritePanel.java
Patch:
@@ -54,7 +54,7 @@ public class ChatWritePanel extends JScrollPane implements
     
     /**
      * Creates an instance of <tt>ChatWritePanel</tt>.
-     * @param chatPanel The parent <tt>ChatPanel</tt>.
+     * @param panel The parent <tt>ChatPanel</tt>.
      */
     public ChatWritePanel(ChatPanel panel) {
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameContactDialog.java
Patch:
@@ -43,7 +43,7 @@ public class RenameContactDialog
     /**
      * Creates an instance of <tt>RenameContactDialog</tt>.
      * 
-     * @param clist The <tt>MetaContactListService</tt>.
+     * @param mainFrame The main application window.
      * @param metaContact The <tt>MetaContact</tt> to rename.
      */
     public RenameContactDialog(MainFrame mainFrame,

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameGroupDialog.java
Patch:
@@ -44,7 +44,7 @@ public class RenameGroupDialog
     /**
      * Creates an instance of <tt>RenameGroupDialog</tt>.
      * 
-     * @param clist The <tt>MetaContactListService</tt>.
+     * @param mainFrame The main application window.
      * @param metaGroup The <tt>MetaContactGroup</tt> to rename.
      */
     public RenameGroupDialog(MainFrame mainFrame,

File: src/net/java/sip/communicator/impl/gui/main/message/ChatConversationPanel.java
Patch:
@@ -78,7 +78,7 @@ public class ChatConversationPanel
 
     private Date lastIncomingMsgTimestamp = new Date(0);
     
-    private Date pageFirstMsgTimestamp = new Date(System.currentTimeMillis());
+    private Date pageFirstMsgTimestamp = new Date(Long.MAX_VALUE);
     
     private Date pageLastMsgTimestamp = new Date(0);
     

File: src/net/java/sip/communicator/impl/gui/main/message/ChatSendPanel.java
Patch:
@@ -69,8 +69,6 @@ public ChatSendPanel(ChatPanel chatPanel)
         this.add(sendPanel, BorderLayout.EAST);
 
         this.sendButton.addActionListener(this);
-        this.sendButton.setToolTipText(Messages.getString("sendMessage")
-            + " Ctrl-Enter");
         this.sendButton.setMnemonic(Messages.getString("mnemonic.sendMessage")
             .charAt(0));
     }

File: src/net/java/sip/communicator/impl/gui/main/message/toolBars/MainToolBar.java
Patch:
@@ -386,6 +386,9 @@ public void changeHistoryButtonsSate(ChatPanel chatPanel)
     {
         ChatConversationPanel convPanel = chatPanel.getChatConversationPanel();
         
+        if(chatPanel.getFirstHistoryMsgTimestamp() == null)
+            return;
+        
         if(chatPanel.getFirstHistoryMsgTimestamp()
             .compareTo(convPanel.getPageFirstMsgTimestamp()) < 0) {
             previousButton.setEnabled(true);

File: src/net/java/sip/communicator/service/history/HistoryReader.java
Patch:
@@ -159,7 +159,7 @@ public QueryResultSet findByPeriod(Date startDate, Date endDate,
      * @return QueryResultSet the found records
      * @throws RuntimeException
      */
-    public QueryResultSet getFirstRecordsAfter(Date date, int count) throws RuntimeException;
+    public QueryResultSet findFirstRecordsAfter(Date date, int count) throws RuntimeException;
 
     /**
      * Returns the supplied number of recent messages before the given date
@@ -169,7 +169,7 @@ public QueryResultSet findByPeriod(Date startDate, Date endDate,
      * @return QueryResultSet the found records
      * @throws RuntimeException
      */
-    public QueryResultSet getLastRecordsBefore(Date date, int count) throws RuntimeException;
+    public QueryResultSet findLastRecordsBefore(Date date, int count) throws RuntimeException;
 
     /**
      * Adding progress listener for monitoring progress of search process

File: src/net/java/sip/communicator/service/msghistory/MessageHistoryService.java
Patch:
@@ -160,7 +160,7 @@ public Collection findLast(MetaContact contact, int count)
      * @return Collection of MessageReceivedEvents or MessageDeliveredEvents
      * @throws RuntimeException
      */
-    public Collection getFirstMessagesAfter(MetaContact contact, Date date, int count)
+    public Collection findFirstMessagesAfter(MetaContact contact, Date date, int count)
         throws RuntimeException;
 
     /**
@@ -173,7 +173,7 @@ public Collection getFirstMessagesAfter(MetaContact contact, Date date, int coun
      * @return Collection of MessageReceivedEvents or MessageDeliveredEvents
      * @throws RuntimeException
      */
-    public Collection getLastMessagesBefore(MetaContact contact, Date date, int count)
+    public Collection findLastMessagesBefore(MetaContact contact, Date date, int count)
         throws RuntimeException;
 
     /**

File: src/net/java/sip/communicator/service/protocol/OperationFailedException.java
Patch:
@@ -53,7 +53,8 @@ public class OperationFailedException
     public static final int CONTACT_GROUP_ALREADY_EXISTS = 5;
 
     /**
-     * Indicates that a user has tried to create a group that already exist.
+     * Indicates that a user has entered wrong account properties, like wrong
+     * port for example.
      */
     public static final int INVALID_ACCOUNT_PROPERTIES = 6;
 

File: src/net/java/sip/communicator/impl/protocol/msn/ContactGroupMsnImpl.java
Patch:
@@ -59,7 +59,7 @@ public class ContactGroupMsnImpl
      * ServerStoredContactListImpl update will only be done if source group
      * is changed.
 
-     * @param rosterGroup the Msn Group correspoinding to the group
+     * @param msnGroup the Msn Group correspoinding to the group
      * @param groupMembers the group members that we should add to the group.
      * @param ssclCallback a callback to the server stored contact list
      * we're creating.
@@ -384,7 +384,7 @@ public boolean isResolved()
 
     /**
      * Resolve this contact group against the specified group
-     * @param source the server stored group
+     * @param msnGroup the server stored group
      */
     void setResolved(MsnGroup msnGroup)
     {

File: src/net/java/sip/communicator/impl/protocol/msn/ContactMsnImpl.java
Patch:
@@ -27,7 +27,7 @@ public class ContactMsnImpl
 
     /**
      * Creates an MsnContactImpl
-     * @param rosterEntry the RosterEntry object that we will be encapsulating.
+     * @param contact the contact object that we will be encapsulating.
      * @param ssclCallback a reference to the ServerStoredContactListImpl
      * instance that created us.
      * @param isPersistent determines whether this contact is persistent or not.

File: src/net/java/sip/communicator/service/protocol/AuthorizationResponse.java
Patch:
@@ -67,8 +67,8 @@ public class AuthorizationResponse
      * @param responseCode AuthorizationResponseCode
      * @param reason String
      */
-    public AuthorizationResponse(AuthorizationResponseCode responseCode
-                                 , String reason)
+    public AuthorizationResponse(AuthorizationResponseCode responseCode,
+            String reason)
     {
         this.reason = reason;
         this.responseCode = responseCode;

File: src/net/java/sip/communicator/impl/protocol/jabber/ProtocolProviderServiceJabberImpl.java
Patch:
@@ -295,7 +295,8 @@ private void unregister(boolean fireEvent)
     {
         RegistrationState currRegState = getRegistrationState();
 
-        connection.close();
+        if(connection != null)
+            connection.close();
 
         if(fireEvent)
         {

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -240,7 +240,8 @@ public void register(SecurityAuthority authority)
      */
     public void unregister()
     {
-        aimConnection.disconnect(true);
+        if(aimConnection != null)
+            aimConnection.disconnect(true);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -87,6 +87,7 @@ public class ServerStoredContactListMsnImpl
         this.parentOperationSet = parentOperationSet;
 
         this.msnProvider = provider;
+        rootGroup.setOwnerProvider(provider);
 
         // listens for provider registered events to set the isInitialized state
         // of the contact list

File: test/net/java/sip/communicator/slick/protocol/msn/MsnProtocolProviderServiceLick.java
Patch:
@@ -82,7 +82,7 @@ public void start(BundleContext context)
         {
 //            addTest(TestOperationSetPersistentPresence.suite());
 //
-//            addTest(TestOperationSetBasicInstantMessaging.suite());
+            addTest(TestOperationSetBasicInstantMessaging.suite());
 //
 //            addTest(TestOperationSetTypingNotifications.suite());
         }

File: src/net/java/sip/communicator/impl/gui/customcontrols/MessageDialog.java
Patch:
@@ -111,6 +111,8 @@ public MessageDialog(Frame owner, String message,
      * Initializes this dialog.
      */
     private void init() {
+        this.getRootPane().setDefaultButton(okButton);
+
         this.checkBoxPanel.add(doNotAskAgain);
 
         this.buttonsPanel.add(okButton);

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommDialog.java
Patch:
@@ -63,6 +63,6 @@ protected void addKeyBinding(KeyStroke keyStroke, Action action)
         
         imap.put(keyStroke, actionID);
     }
-    
+
     protected abstract void close();
 }

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigurationFrame.java
Patch:
@@ -302,6 +302,6 @@ public void moveDialog(int x, int y) {
      */
     protected void close()
     {
-        this.dispose();
+        this.cancelButton.doClick();
     }    
 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameContactDialog.java
Patch:
@@ -64,6 +64,7 @@ public RenameContactDialog(MetaContactListService clist,
     private void init() {
         this.setTitle(Messages.getString("renameContact"));
         
+        this.getRootPane().setDefaultButton(renameButton);
         this.renameButton.setName("rename");
         this.cancelButton.setName("cancel");
         

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameGroupDialog.java
Patch:
@@ -64,6 +64,7 @@ public RenameGroupDialog(MetaContactListService clist,
     private void init() {
         this.setTitle(Messages.getString("renameContact"));
         
+        this.getRootPane().setDefaultButton(renameButton);
         this.renameButton.setName("rename");
         this.cancelButton.setName("cancel");
         

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactDialog.java
Patch:
@@ -102,6 +102,7 @@ private void init() {
         
         this.setSize(520, 250);
         
+        this.getRootPane().setDefaultButton(addButton);
         this.addButton.setName("add");
         this.cancelButton.setName("cancel");
         

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addgroup/CreateGroupDialog.java
Patch:
@@ -68,6 +68,7 @@ public CreateGroupDialog(MainFrame mainFrame) {
     private void init() {
         this.setTitle(Messages.getString("addGroup"));
         
+        this.getRootPane().setDefaultButton(addButton);
         this.addButton.setName("create");
         this.cancelButton.setName("cancel");
         

File: src/net/java/sip/communicator/impl/protocol/msn/ServerStoredContactListMsnImpl.java
Patch:
@@ -238,7 +238,6 @@ public ContactGroupMsnImpl findContactGroup(String name)
 
             if (contactGroup.getGroupName().equals(name))
                 return contactGroup;
-
         }
 
         return null;
@@ -474,7 +473,7 @@ ContactGroupMsnImpl createUnresolvedContactGroup(String groupName)
         //First create the new volatile contact;
         MsnContact[] emptyBuddies = new MsnContact[]{};
         ContactGroupMsnImpl newUnresolvedGroup = new ContactGroupMsnImpl(
-                new VolatileGroup(), emptyBuddies, this, false);
+                new VolatileGroup(groupName), emptyBuddies, this, false);
 
         this.rootGroup.addSubGroup(newUnresolvedGroup);
 
@@ -733,7 +732,6 @@ public void contactListInitCompleted(MsnMessenger messenger)
                         // if there is no such contact create it
                         contact = new ContactMsnImpl(
                             item, ServerStoredContactListMsnImpl.this, true, true);
-
                         rootGroup.addContact(contact);
 
                         fireContactAdded(rootGroup, contact);

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommTabbedPane.java
Patch:
@@ -36,8 +36,8 @@ public class SIPCommTabbedPane extends JTabbedPane {
      * Creates the <code>CloseAndMaxTabbedPane</code> with an enhanced UI if
      * <code>enhancedUI</code> parameter is set to <code>true</code>.
      *
-     * @param enhancedUI
-     *            whether the tabbedPane should use an enhanced UI
+     * @param closingTabs support for closable tabs
+     * @param maximizingTabs support for maximisable tabs
      */
     public SIPCommTabbedPane(boolean closingTabs, boolean maximizingTabs) {
         super.setTabLayoutPolicy(JTabbedPane.SCROLL_TAB_LAYOUT);

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/Wizard.java
Patch:
@@ -195,8 +195,7 @@ public boolean isModal() {
     /**
      * Convienence method that displays a modal wizard dialog and blocks until
      * the dialog has completed.
-     * @return Indicates how the dialog was closed. Compare this value against
-     * the RETURN_CODE constants at the beginning of the class.
+     * @param modal whether to show a modal dialog
      */    
     public void showDialog(boolean modal) {
         

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -131,8 +131,8 @@ public void protoContactAdded(ProtoContactEvent evt)
      */
     public void protoContactRemoved(ProtoContactEvent evt)
     {
+        System.out.println("REMOVE PROTO CONTACT");
         this.modifyContact(evt.getOldParent());
-        this.modifyContact(evt.getNewParent());
     }
 
     /**

File: src/net/java/sip/communicator/impl/media/MediaControl.java
Patch:
@@ -946,6 +946,9 @@ public void startProcessingMedia(Object reader)
      */
     public void stopProcessingMedia(Object reader)
     {
+        if(sourceProcessor == null)
+            return;
+
         if( sourceProcessor.getState() ==  Processor.Started )
             sourceProcessor.stop();
 

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -559,7 +559,7 @@ public void contactPresenceStatusChanged(
 
             if (metaContact != null) {
                 if(!evt.getOldStatus().equals(evt.getNewStatus())) {
-                    clistPanel.getContactList().refreshAll();
+                    clistPanel.getContactList().modifyContact(metaContact);
                     clistPanel.updateChatContactStatus(
                             metaContact, sourceContact);
                 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -119,6 +119,9 @@ private void init() {
 
         this.removeContactMenu.setIcon(new ImageIcon(ImageLoader
                 .getImage(ImageLoader.DELETE_16x16_ICON)));
+        
+        this.moveSubcontactMenu.setIcon(new ImageIcon(ImageLoader
+                .getImage(ImageLoader.MOVE_CONTACT_ICON)));
 
         //Initialize the addSubcontact menu.
         Iterator providers = this.mainFrame.getProtocolProviders();

File: src/net/java/sip/communicator/impl/protocol/sip/ProtocolProviderServiceSipImpl.java
Patch:
@@ -656,7 +656,7 @@ private void initListeningPoints(int preferredPortNumber)
                 = SipActivator.getConfigurationService().getString(
                     BIND_RETRIES_PROPERTY_NAME);
 
-            int bindRetries = 5;
+            int bindRetries = BIND_RETRIES_DEFAULT_VALUE;
 
             if (bindRetriesStr != null)
             {
@@ -669,7 +669,7 @@ private void initListeningPoints(int preferredPortNumber)
                     logger.error(bindRetriesStr
                                  + " does not appear to be an integer. "
                                  + "Defaulting port bind retries to 5.", ex);
-                    bindRetries = 5;
+                    bindRetries = BIND_RETRIES_DEFAULT_VALUE;
                 }
             }
 

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegFirstPage.java
Patch:
@@ -59,7 +59,7 @@ public AccountRegFirstPage(AccountRegWizardContainerImpl container) {
         
         this.tableModel = new ExtendedTableModel();
         
-        this.setPreferredSize(new Dimension(450, 250));
+        this.setPreferredSize(new Dimension(500, 320));
         
         this.accountRegsTable.setSelectionMode(
                 ListSelectionModel.SINGLE_SELECTION);

File: src/net/java/sip/communicator/plugin/sipaccregwizz/SIPAccountRegistrationWizard.java
Patch:
@@ -137,6 +137,9 @@ public ProtocolProviderService installAccount(
         
         accountProperties.put(ProtocolProviderFactory.SERVER_PORT,
                                   registration.getPort());
+        
+        accountProperties.put(ProtocolProviderFactory.PREFERRED_TRANSPORT,
+                registration.getPreferredTransport());
 
         if(protocolProvider != null) {
             providerFactory.uninstallAccount(protocolProvider.getAccountID());

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -166,7 +166,7 @@ public void callParticipantRemoved(CallParticipantEvent evt)
                             participantPanel.getEndTime());
                 
                 callManager.getMainFrame().getCallListManager().addCallRecord(
-                        1, participantRecord);
+                        0, participantRecord);
                 
                 //remove the participant panel for this participant
                 this.participantsPanels.remove(participant);

File: src/net/java/sip/communicator/impl/gui/main/call/CallPanel.java
Patch:
@@ -160,13 +160,13 @@ public void callParticipantRemoved(CallParticipantEvent evt)
                 //Create a call record and add it to the call list.
                 GuiCallParticipantRecord participantRecord
                     = new GuiCallParticipantRecord(
-                            participantPanel.getName(),
+                            participantPanel.getParticipantName(),
                             participantPanel.getCallType(),
                             participantPanel.getStartTime(),
                             participantPanel.getEndTime());
                 
-                callManager.getMainFrame().getCallList().addItem(
-                        participantRecord, 1);
+                callManager.getMainFrame().getCallListManager().addCallRecord(
+                        1, participantRecord);
                 
                 //remove the participant panel for this participant
                 this.participantsPanels.remove(participant);

File: src/net/java/sip/communicator/impl/callhistory/CallHistoryServiceImpl.java
Patch:
@@ -371,7 +371,7 @@ else if(propName.equals(STRUCTURE_NAMES[5]))
         for (int i = 0; i < callParticipantIDs.size(); i++)
         {
 
-            CallParticipantRecord cpr = new CallParticipantRecord(
+            CallParticipantRecordImpl cpr = new CallParticipantRecordImpl(
                 (String)callParticipantIDs.get(i),
                 new Date(Long.parseLong((String)callParticipantStart.get(i))),
                 new Date(Long.parseLong((String)callParticipantEnd.get(i)))
@@ -756,7 +756,7 @@ private void handleParticipantAdded(CallParticipant callParticipant)
         if(callRecord == null)
             return;
 
-        CallParticipantRecord newRec = new CallParticipantRecord(
+        CallParticipantRecordImpl newRec = new CallParticipantRecordImpl(
             callParticipant.getAddress(),
             new Date(),
             null);

File: test/net/java/sip/communicator/slick/protocol/icq/TestAccountInstallation.java
Patch:
@@ -245,7 +245,7 @@ public void testRegisterWrongPassword()
         String uin = System.getProperty( IcqProtocolProviderSlick
                                          .TESTED_IMPL_USER_ID_PROP_NAME, null);
 
-        passwd += "1234";
+        passwd = "dam1234";
 
         Hashtable icqAccountProperties = new Hashtable();
         icqAccountProperties.put(ProtocolProviderFactory.PASSWORD, passwd);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPanel.java
Patch:
@@ -119,7 +119,7 @@ public ContactList getContactList() {
      * Implements the ContactListListener.contactSelected method.
      */
     public void contactSelected(ContactListEvent evt)
-    {        
+    {
         SwingUtilities.invokeLater(
                 new RunMessageWindow(evt.getSourceContact()));
     }
@@ -411,7 +411,7 @@ public void windowClosing(WindowEvent e) {
         }
         
         if (Constants.AUTO_POPUP_NEW_MESSAGE)
-            Constants.getDefaultAudio().play();
+            Constants.getDefaultMessageAudio().play();
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -216,7 +216,7 @@ public void register(SecurityAuthority authority)
             // it seems icq servers doesn't accept password with
             // length more then 8. But allow such registrations
             // we must trim such passwords to 8 characters
-            if(password.length() > 0)
+            if(password.length() > 8)
                 password = password.substring(0, 8);
 
             //init the necessary objects

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -87,7 +87,6 @@ public ContactList(MainFrame mainFrame) {
         
         this.addListSelectionListener(new ListSelectionListener() {
             public void valueChanged(ListSelectionEvent e) {
-                new Exception().printStackTrace();
                 if(!e.getValueIsAdjusting()) {               
                     currentlySelectedObject = getSelectedValue();
                 }

File: src/net/java/sip/communicator/impl/protocol/sip/SipAccountID.java
Patch:
@@ -23,7 +23,7 @@ public class SipAccountID
      *
      * @param userID the user id part of the SIP uri identifying this contact.
      * @param accountProperties any other properties necessary for the account.
-     * @param sererName the name of the server that the user belongs to.
+     * @param serverName the name of the server that the user belongs to.
      */
     protected SipAccountID(String userID,
                            Map    accountProperties,

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommSelectorBox.java
Patch:
@@ -171,7 +171,7 @@ public void mouseReleased(MouseEvent e) {
 
     /**
      * Selects the given item.
-     * @param text The object to select.
+     * @param o The object to select.
      * @param icon The icon to select.
      */
     public void setSelected(Object o, Icon icon) {

File: src/net/java/sip/communicator/impl/gui/main/WelcomeWindow.java
Patch:
@@ -51,7 +51,6 @@ public class WelcomeWindow extends JDialog
      * @param c The application main class that runs the main application
      * window.
      * @param loginManager The login manager that runs all login windows.
-     * @param context The bundle context.
      */
     public WelcomeWindow(CommunicatorMain c,
             LoginManager loginManager) {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactProtocolButton.java
Patch:
@@ -20,7 +20,6 @@ public class ContactProtocolButton extends SIPCommButton {
     /**
      * Creates an instance of ContactProtocolButton.
      * @param bgImage The background image of the button.
-     * @param rolloverImage The rollover image of the button.
      */
     public ContactProtocolButton(Image bgImage) {
         super(bgImage, bgImage);

File: src/net/java/sip/communicator/impl/gui/main/message/ChatPanel.java
Patch:
@@ -249,9 +249,9 @@ private void setChatMetaContact(MetaContact metaContact) {
     }
 
     /**
-     * Updates the contact status in the contact info panel.
+     * Updates the contact status in the chat panel.
      * 
-     * @param status The presence status of the contact.
+     * @param protoContact the protocol contact which status to update
      */
     public void updateContactStatus(Contact protoContact) {
         PresenceStatus status = protocolContact.getPresenceStatus();

File: src/net/java/sip/communicator/impl/gui/main/message/ChatSendPanel.java
Patch:
@@ -165,7 +165,7 @@ public void setStatusMessage(String statusMessage) {
      * contacts and shows its icon in the component on the left of the "Send"
      * button.
      * 
-     * @param protocolContact The protocol specific contact to select.
+     * @param protoContact The protocol specific contact to select.
      */
     public void setSelectedProtocolContact(Contact protoContact)
     {

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -518,7 +518,8 @@ public void contactPresenceStatusChanged(
             if (metaContact != null) {
                 ContactListPanel clistPanel = tabbedPane.getContactListPanel();
 
-                clistPanel.getContactList().repaint();
+                clistPanel.getContactList().refresh();
+                
                 if(!evt.getOldStatus().equals(evt.getNewStatus()))
                     clistPanel.updateChatContactStatus(
                             metaContact, sourceContact);

File: src/net/java/sip/communicator/impl/gui/main/message/ProtocolContactSelectorBox.java
Patch:
@@ -81,7 +81,9 @@ public void actionPerformed(ActionEvent e) {
             }
         }
         logger.debug( "Could not find contact for menu item "
-                      + menuItem.getName());
+                      + menuItem.getText() + ". contactsTable("
+                      + contactsTable.size()+") is : "
+                      + contactsTable);
     }
 
     /**

File: src/net/java/sip/communicator/impl/protocol/icq/ProtocolProviderServiceIcqImpl.java
Patch:
@@ -92,6 +92,9 @@ public class ProtocolProviderServiceIcqImpl
      */
     public RegistrationState getRegistrationState()
     {
+        if(getAimConnection() == null)
+            return RegistrationState.UNREGISTERED;
+
         State connState = getAimConnection().getState();
 
         return joustSimStateToRegistrationState(connState);

File: src/net/java/sip/communicator/impl/protocol/icq/OperationSetBasicInstantMessagingIcqImpl.java
Patch:
@@ -531,7 +531,6 @@ public void gotMessage(Conversation conversation, MessageInfo minfo)
                 && conversation.getBuddy().getFormatted().
                     equals(icqProvider.getAccountID().getUserID()))
             {
-                logger.info("adddddddddd sys msg");
                 receivedKeepAlivePackets.addLast(msgBody);
                 return;
             }

File: src/net/java/sip/communicator/impl/gui/main/MainFrame.java
Patch:
@@ -92,7 +92,7 @@ public MainFrame()
 
         this.addWindowListener(new MainFrameWindowAdapter());
 
-        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
+        this.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
         this.setInitialBounds();
 
         this.setTitle(Messages.getString("sipCommunicator"));
@@ -562,7 +562,7 @@ public void callEnded(CallEvent event)
         public void outgoingCallCreated(CallEvent event)
         {
             // TODO Auto-generated method stub
-            
+
         }
 
     }

File: src/net/java/sip/communicator/impl/gui/main/WelcomeWindow.java
Patch:
@@ -88,7 +88,7 @@ public WelcomeWindow(CommunicatorMain c,
         this.windowBackground.setBorder(BorderFactory.createEmptyBorder(5, 10,
                 5, 5));
 
-        this.setDefaultCloseOperation(JDialog.EXIT_ON_CLOSE);
+        this.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
 
         this.addWindowListener(new WindowAdapter(){
             public void windowClosing(WindowEvent e) {

File: src/net/java/sip/communicator/impl/gui/main/StatusSelectorBox.java
Patch:
@@ -55,8 +55,6 @@ public class StatusSelectorBox extends SIPCommSelectorBox {
      * 
      * @param mainFrame The main application window.
      * @param protocolProvider The protocol provider.
-     * @param itemsMap The list from which to initialize the selector box.
-     * @param selectedItem The initially selected item.
      */
     public StatusSelectorBox(MainFrame mainFrame,
             ProtocolProviderService protocolProvider) {

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -348,7 +348,7 @@ public AccountRegistrationWizardContainer getAccountRegWizardContainer() {
      * Implements the <code>UIService.getConfigurationManager</code>.
      * Returns the current implementation of the <tt>ConfigurationManager</tt>
      * interface.
-     * @see UIService#getConfigurationDialog()
+     * @see UIService#getConfigurationManager()
      */
     public ConfigurationManager getConfigurationManager() {
         return this.configurationFrame;

File: src/net/java/sip/communicator/impl/gui/customcontrols/SIPCommSelectorBox.java
Patch:
@@ -151,7 +151,8 @@ public void mouseReleased(MouseEvent e) {
 
     /**
      * Selects the given item.
-     * @param menuItem The item to select.
+     * @param text The object to select.
+     * @param icon The icon to select.
      */
     public void setSelected(String text, Icon icon) {
         this.setIcon(icon);

File: src/net/java/sip/communicator/impl/gui/main/contactlist/CommonRightButtonMenu.java
Patch:
@@ -39,8 +39,7 @@ public class CommonRightButtonMenu extends JPopupMenu
     /**
      * Creates an instance of GroupRightButtonMenu.
      * 
-     * @param mainFrame The parent <tt>MainFrame</tt> window. 
-     * @param group The <tt>MetaContactGroup</tt> for which the menu is opened.
+     * @param mainFrame The parent <tt>MainFrame</tt> window.
      */
     public CommonRightButtonMenu(MainFrame mainFrame) {
     

File: src/net/java/sip/communicator/impl/gui/main/contactlist/addcontact/AddContactDialog.java
Patch:
@@ -54,7 +54,7 @@ public class AddContactDialog extends JDialog
      * Creates an instance of <tt>AddContactDialog</tt> that represents a dialog
      * that adds a new contact to an already existing meta contact.
      * 
-     * @param clist The <tt>MetaContactListService</tt>.
+     * @param mainFrame The <tt>MainFrame</tt> parent window.
      * @param metaContact The <tt>MetaContact</tt> that would contain the
      * newly created contact.
      * @param pps The <tt>ProtocolProviderService</tt>.
@@ -75,7 +75,7 @@ public AddContactDialog(MainFrame mainFrame,
      * Creates an instance of <tt>AddContactDialog</tt> that represents a dialog
      * that adds a new meta contact to an already existing meta contact group.
      * 
-     * @param clist The <tt>MetaContactListService</tt>.
+     * @param mainFrame The <tt>MainFrame</tt> parent window.
      * @param group The <tt>MetaContactGroup</tt> that would contain the
      * newly created meta contact.
      * @param pps The <tt>ProtocolProviderService</tt>.

File: src/net/java/sip/communicator/impl/gui/main/message/ChatConversationPanel.java
Patch:
@@ -82,7 +82,7 @@ public class ChatConversationPanel
 
     /**
      * Creates an instance of <tt>ChatConversationPanel</tt>.
-     * @param chatPanel The parent <tt>ChatPanel</tt>.
+     * @param chatContainer The parent <tt>ChatConversationContainer</tt>.
      */
     public ChatConversationPanel(ChatConversationContainer chatContainer)
     {

File: src/net/java/sip/communicator/impl/gui/main/message/menus/ChatRightButtonMenu.java
Patch:
@@ -43,7 +43,7 @@ public class ChatRightButtonMenu extends JPopupMenu
     /**
      * Creates an instance of <tt>ChatRightButtonMenu</tt>.
      *  
-     * @param parentWindow The window owner of this popup menu.
+     * @param chatConvPanel The conversation panel, where this menu will apear.
      */
     public ChatRightButtonMenu(ChatConversationPanel chatConvPanel) {
         super();

File: src/net/java/sip/communicator/impl/gui/utils/CrossPlatformBrowserLauncher.java
Patch:
@@ -34,7 +34,7 @@ public class CrossPlatformBrowserLauncher {
      * Launches a browser for the given url, depending on the operation system
      * and the browsers available.
      * 
-     * @param url The url to open in the browser.
+     * @param urlString The url to open in the browser.
      */
     public static void openURL(String urlString) {
         

File: src/net/java/sip/communicator/service/media/MediaService.java
Patch:
@@ -75,6 +75,9 @@ public interface MediaService
     /**
      * Returns true if the media service implementation is initialized and ready
      * for use by other services, and false otherwise.
+     *
+     * @return true if the service implementation is initialized and ready for
+     * use and false otherwise.
      */
     public boolean isInitialized();
 

File: src/net/java/sip/communicator/impl/contactlist/MetaContactGroupImpl.java
Patch:
@@ -639,7 +639,7 @@ public MetaContactGroupImpl getMetaContactSubgroupByUID(String groupUID)
             MetaContactGroupImpl mcGroup
                 = (MetaContactGroupImpl)groupsIter.next();
 
-            if(mcGroup.getGroupName().equals(groupUID))
+            if(mcGroup.getMetaUID().equals(groupUID))
                 return mcGroup;
         }
 

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -56,8 +56,6 @@ public ContactList(MetaContactListService contactList) {
 
         this.setCursor(Cursor.getPredefinedCursor(Cursor.HAND_CURSOR));
 
-        this.addKeyListener(new CListKeySearchListener(this));
-
         this.contactList.addMetaContactListListener(this);
 
         this.addListSelectionListener(new ListSelectionListener() {

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListPanel.java
Patch:
@@ -81,7 +81,7 @@ public void initList(MetaContactListService contactListService) {
         this.treePanel.setBackground(Color.WHITE);
         this.contactList.setBorder(BorderFactory.createEmptyBorder(0, 0, 0, 0));
         
-        this.addKeyListener(new CListKeySearchListener(this.contactList));
+        //this.addKeyListener(new CListKeySearchListener(this.contactList));
 
         this.getRootPane().getActionMap().put("runChat",
                 new RunMessageWindowAction());

File: src/net/java/sip/communicator/service/protocol/ProtocolProviderFactory.java
Patch:
@@ -520,6 +520,6 @@ private String getFactoryImplPackageName()
     {
         String className = getClass().getName();
 
-        return className.substring(className.lastIndexOf('.'));
+        return className.substring(0, className.lastIndexOf('.'));
     }
 }

File: src/net/java/sip/communicator/impl/netaddr/NetworkAddressManagerServiceImpl.java
Patch:
@@ -438,11 +438,12 @@ private void initializeLocalHostFinderSocket()
             try
             {
                 localHostFinderSocket = new DatagramSocket(currentlyTriedPort);
+                //we succeeded - break so that we don't try to bind again
+                break;
             }
             catch (SocketException exc)
             {
-                if (!exc.getMessage().contains(
-                    "Address already in use"))
+                if (exc.getMessage().indexOf("Address already in use") == -1)
                 {
                     logger.fatal("An exception occurred while trying to create"
                                  + "a local host discovery socket.", exc);

File: src/net/java/sip/communicator/impl/gui/main/message/history/SearchPanel.java
Patch:
@@ -139,11 +139,11 @@ public void init() {
         // this.extendedSearchButton.setName("extendedSearch");
         // this.extendedSearchOpenedButton.setName("extendedSearchOpened");
 
-        this.getRootPane().setDefaultButton(searchButton);
         this.searchButton.addActionListener(this);
         
         this.searchButtonPanel.add(searchButton);
 
+        this.historyWindow.getRootPane().setDefaultButton(searchButton);
         // this.extendedSearchPanel.add(extendedSearchButton,
         // BorderLayout.CENTER);
 

File: src/net/java/sip/communicator/impl/gui/main/QuickMenu.java
Patch:
@@ -30,7 +30,7 @@
 import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.AddContactWizardPage2;
 import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.AddContactWizardPage3;
 import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.NewContact;
-import net.java.sip.communicator.impl.gui.utils.BrowserLauncher;
+import net.java.sip.communicator.impl.gui.utils.CrossPlatformBrowserLauncher;
 import net.java.sip.communicator.impl.gui.utils.ImageLoader;
 import net.java.sip.communicator.service.contactlist.MetaContact;
 import net.java.sip.communicator.service.contactlist.MetaContactGroup;
@@ -250,7 +250,7 @@ else if (buttonName.equals("info")) {
                 OperationSetWebContactInfo wContactInfo 
                     = mainFrame.getWebContactInfo(defaultProvider);
                 
-                BrowserLauncher.openURL(
+                CrossPlatformBrowserLauncher.openURL(
                         wContactInfo.getWebContactInfo(defaultContact)
                             .toString());
             }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactRightButtonMenu.java
Patch:
@@ -26,14 +26,15 @@
 import net.java.sip.communicator.impl.gui.main.MainFrame;
 import net.java.sip.communicator.impl.gui.main.contactlist.addcontact.AddContactDialog;
 import net.java.sip.communicator.impl.gui.main.message.history.HistoryWindow;
-import net.java.sip.communicator.impl.gui.utils.BrowserLauncher;
 import net.java.sip.communicator.impl.gui.utils.Constants;
+import net.java.sip.communicator.impl.gui.utils.CrossPlatformBrowserLauncher;
 import net.java.sip.communicator.impl.gui.utils.ImageLoader;
 import net.java.sip.communicator.service.contactlist.MetaContact;
 import net.java.sip.communicator.service.contactlist.MetaContactGroup;
 import net.java.sip.communicator.service.protocol.Contact;
 import net.java.sip.communicator.service.protocol.OperationSetWebContactInfo;
 import net.java.sip.communicator.service.protocol.ProtocolProviderService;
+import edu.stanford.ejalbert.BrowserLauncher;
 
 /**
  * The ContactRightButtonMenu is the menu, opened when user clicks with the
@@ -293,7 +294,7 @@ else if (itemName.equalsIgnoreCase("userInfo")) {
             OperationSetWebContactInfo wContactInfo 
                 = mainFrame.getWebContactInfo(defaultProvider);
             
-            BrowserLauncher.openURL(
+            CrossPlatformBrowserLauncher.openURL(
                     wContactInfo.getWebContactInfo(defaultContact)
                         .toString());
         }

File: src/net/java/sip/communicator/impl/gui/main/message/ChatConversationPanel.java
Patch:
@@ -46,7 +46,7 @@
 import net.java.sip.communicator.impl.gui.i18n.Messages;
 import net.java.sip.communicator.impl.gui.main.message.menu.ChatRightButtonMenu;
 import net.java.sip.communicator.impl.gui.utils.AntialiasingManager;
-import net.java.sip.communicator.impl.gui.utils.BrowserLauncher;
+import net.java.sip.communicator.impl.gui.utils.CrossPlatformBrowserLauncher;
 import net.java.sip.communicator.impl.gui.utils.Constants;
 import net.java.sip.communicator.impl.gui.utils.ImageLoader;
 import net.java.sip.communicator.impl.gui.utils.SIPCommHTMLEditorKit;
@@ -157,7 +157,7 @@ public void actionPerformed(ActionEvent e) {
         });
         openLinkItem.addActionListener(new ActionListener() {
             public void actionPerformed(ActionEvent e) {                
-                BrowserLauncher.openURL(currentHref);
+                CrossPlatformBrowserLauncher.openURL(currentHref);
             }
         });
         /*
@@ -427,7 +427,7 @@ private String processTime(int time) {
     public void hyperlinkUpdate(HyperlinkEvent e) {
         if (e.getEventType() == HyperlinkEvent.EventType.ACTIVATED) {
             URL url = e.getURL();
-            BrowserLauncher.openURL(url.toString());
+            CrossPlatformBrowserLauncher.openURL(url.toString());
         } else if (e.getEventType() == HyperlinkEvent.EventType.ENTERED) {
             String href = e.getDescription();
             

File: src/net/java/sip/communicator/impl/gui/main/message/ChatWindow.java
Patch:
@@ -81,6 +81,8 @@ public ChatWindow(MainFrame mainFrame) {
 
         this.mainFrame = mainFrame;
 
+        this.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
+        
         this.setSize(550, 450);
 
         this.setIconImage(ImageLoader.getImage(ImageLoader.SIP_LOGO));

File: src/net/java/sip/communicator/impl/protocol/icq/VolatileBuddy.java
Patch:
@@ -34,7 +34,7 @@ public VolatileBuddy(Screenname screenname)
      */
     public String getAlias()
     {
-        return screenname.getFormatted();
+        return null;
     }
 
     /**

File: test/net/java/sip/communicator/slick/protocol/sip/SipSlickFixture.java
Patch:
@@ -11,7 +11,7 @@
 import net.java.sip.communicator.service.protocol.*;
 
 /**
- * Contains fields and methods used by most or all tests in the icq slick.
+ * Contains fields and methods used by most or all tests in the SIP slick.
  */
 public class SipSlickFixture
     extends TestCase
@@ -111,7 +111,7 @@ public void setUp()
             = bc.getServiceReferences(
                 ProtocolProviderService.class.getName(),
                 "(&"
-                +"("+ProtocolProviderFactory.PROTOCOL+"="+ProtocolNames.ICQ+")"
+                +"("+ProtocolProviderFactory.PROTOCOL+"="+ProtocolNames.SIP+")"
                 +"("+ProtocolProviderFactory.USER_ID+"="
                 + userID1 +")"
                 +")");
@@ -127,7 +127,7 @@ public void setUp()
         = bc.getServiceReferences(
             ProtocolProviderService.class.getName(),
             "(&"
-            +"("+ProtocolProviderFactory.PROTOCOL+"="+ProtocolNames.ICQ+")"
+            +"("+ProtocolProviderFactory.PROTOCOL+"="+ProtocolNames.SIP+")"
             +"("+ProtocolProviderFactory.USER_ID+"="
             + userID2 +")"
             +")");

File: src/net/java/sip/communicator/impl/protocol/sip/SipActivator.java
Patch:
@@ -54,7 +54,7 @@ public void start(BundleContext context) throws Exception
                     ProtocolProviderFactory.class.getName(),
                     sipProviderFactory,
                     hashtable);
-
+        logger.debug("SIP Protocol Provider Factory ... [REGISTERED]");
     }
 
     /**

File: test/net/java/sip/communicator/slick/protocol/icq/IcqProtocolProviderSlick.java
Patch:
@@ -50,10 +50,10 @@ public class IcqProtocolProviderSlick
         = "accounts.icq.CONTACT_LIST";
 
     /**
-     * Start the Configuration Sevice Implementation Compatibility Kit.
+     * Start the ICQ Sevice Leveraging Implementation Compatibility Kit.
      *
      * @param bundleContext BundleContext
-     * @throws Exception
+     * @throws Exception if anything goes wrong.
      */
     public void start(BundleContext bundleContext) throws Exception
     {

File: test/net/java/sip/communicator/slick/protocol/icq/TestProtocolProviderServiceIcqImpl.java
Patch:
@@ -104,7 +104,7 @@ public void testRegister()
         //they were properly dispatched.
         fixture.provider.addRegistrationStateChangeListener(regEvtCollector);
 
-        fixture.provider.register(null);
+        fixture.provider.register(new SecurityAuthorityImpl());
 
         //give it enough time to register. We won't really have to wait all this
         //time since the registration event collector would notify us the moment

File: src/net/java/sip/communicator/impl/gui/main/login/AuthenticationWindow.java
Patch:
@@ -72,7 +72,7 @@ public class AuthenticationWindow extends JDialog implements ActionListener {
     private JPanel buttonsPanel = new JPanel(new FlowLayout(FlowLayout.CENTER));
     
     private JCheckBox rememberPassCheckBox
-        = new JCheckBox(Messages.getString(rememberPassword));
+        = new JCheckBox(Messages.getString("rememberPassword"));
 
     private LoginWindowBackground backgroundPanel;
     

File: src/net/java/sip/communicator/service/gui/AccountRegistrationWizard.java
Patch:
@@ -65,10 +65,10 @@ public interface AccountRegistrationWizard {
     public void loadAccount(ProtocolProviderService protocolProvider);
     
     /**
-     * Returns the set of <tt>AccountRegistrationWizardPage</tt>-s for this
+     * Returns the set of <tt>WizardPage</tt>-s for this
      * wizard. 
      * 
-     * @return the set of <tt>AccountRegistrationWizardPage</tt>-s for this
+     * @return the set of <tt>WizardPage</tt>-s for this
      * wizard. 
      */
     public Iterator getPages();

File: src/net/java/sip/communicator/impl/gui/GuiActivator.java
Patch:
@@ -49,7 +49,7 @@ public class GuiActivator implements BundleActivator {
     /**
      * Called when this bundle is started.
      *
-     * @param context The execution context of the bundle being started.
+     * @param bundleContext The execution context of the bundle being started.
      */
     public void start(BundleContext bundleContext) throws Exception {
 
@@ -100,7 +100,7 @@ public void start(BundleContext bundleContext) throws Exception {
      * Called when this bundle is stopped so the Framework can perform the
      * bundle-specific activities necessary to stop the bundle.
      *
-     * @param context The execution context of the bundle being stopped.
+     * @param bundleContext The execution context of the bundle being stopped.
      * @throws Exception If this method throws an exception, the bundle is
      *   still marked as stopped, and the Framework will remove the bundle's
      *   listeners, unregister all services registered by the bundle, and

File: src/net/java/sip/communicator/impl/gui/main/authorization/AuthorizationResponseDialog.java
Patch:
@@ -47,7 +47,8 @@ public class AuthorizationResponseDialog extends JDialog
      * Constructs the <tt>RequestAuthorisationDialog</tt>.
      * 
      * @param contact The <tt>Contact</tt>, which requires authorisation.
-     * @param request The <tt>AuthorizationRequest</tt> that will be sent.
+     * @param response The <tt>AuthorizationResponse</tt> that has been
+     * received.
      */
     public AuthorizationResponseDialog(Contact contact,
             AuthorizationResponse response) {

File: src/net/java/sip/communicator/impl/gui/main/configforms/ConfigurationDialogImpl.java
Patch:
@@ -264,7 +264,7 @@ public void resizeDialog(int width, int height) {
 
     /**
      * Implements <code>ExportedDialog.moveDialog</code> method.
-     * @see net.java.sip.communicator.service.gui.ExportedDialog#moveDialog()
+     * @see net.java.sip.communicator.service.gui.ExportedDialog#moveDialog(int, int)
      */
     public void moveDialog(int x, int y) {
         this.setLocation(x, y);

File: src/net/java/sip/communicator/impl/gui/main/message/toolBars/EditTextToolBar.java
Patch:
@@ -23,9 +23,7 @@
  * etc. It contains only <tt>MsgToolbarButton</tt>s, which have a specific
  * background icon and rollover behaviour to differentiates them from normal
  * buttons.
- * 
- * @see net.java.sip.communicator.impl.gui.main.customcontrols.MsgToolbarButton
- * 
+ *  
  * @author Yana Stamcheva
  */
 public class EditTextToolBar extends SIPCommToolBar {

File: src/net/java/sip/communicator/impl/gui/main/message/toolBars/MainToolBar.java
Patch:
@@ -29,9 +29,7 @@
  * the main toolbar in the <tt>ChatWindow</tt>. It contains only
  * <tt>ChatToolbarButton</tt>s, which have a specific background icon and
  * rollover behaviour to differentiates them from normal buttons.
- * 
- * @see net.java.sip.communicator.impl.gui.main.customcontrols.ChatToolbarButton
- * 
+ *  
  * @author Yana Stamcheva
  */
 public class MainToolBar extends SIPCommToolBar implements ActionListener {

File: src/net/java/sip/communicator/impl/gui/customcontrols/wizard/WizardModel.java
Patch:
@@ -97,7 +97,6 @@ public class WizardModel {
      * Default constructor.
      */    
     public WizardModel() {
-        
         panelHashmap = new HashMap();
         
         buttonTextHashmap = new HashMap();
@@ -140,7 +139,7 @@ void unregisterPage(Object id) {
      * @param id The identifier of the page.
      * @return the <tt>WizardPage</tt> corresponding to the given identifier.
      */
-    WizardPage getWizardPage(Object id) {
+    WizardPage getWizardPage(Object id) {        
         return (WizardPage)panelHashmap.get(id);
     }
     
@@ -153,7 +152,7 @@ Iterator getAllPages() {
      * @param id Object-based panel identifier
      * @return boolean indicating success or failure
      */    
-     boolean setCurrentPanel(Object id) {         
+     boolean setCurrentPanel(Object id) {
         //  First, get the hashtable reference to the panel that should
         //  be displayed.
         

File: src/net/java/sip/communicator/impl/gui/main/account/AccountRegSummaryPage.java
Patch:
@@ -151,7 +151,7 @@ public void pageNext() {
                     WizardPage.SUMMARY_PAGE_IDENTIFIER);
         }
         
-        this.wizardContainer.unregisterAll();
+        this.wizardContainer.unregisterWizardPages();
         this.wizardContainer.removeWizzardIcon();
     }
 

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -1832,7 +1832,7 @@ public void groupCreated(ServerStoredGroupEvent evt)
             fireMetaContactGroupEvent(
                 newMetaGroup
                 , evt.getSourceProvider()
-                , null
+                , evt.getSourceGroup()
                 , MetaContactGroupEvent.META_CONTACT_GROUP_ADDED);
         }
 

File: src/net/java/sip/communicator/impl/contactlist/MetaContactListServiceImpl.java
Patch:
@@ -2420,7 +2420,7 @@ public void groupCreated(ServerStoredGroupEvent evt)
             {
                 Contact contact
                     = evt.getSourceGroup().getContact(subscriptionAddress);
-                if ( sourceContact != null)
+                if ( contact != null)
                 {
                     this.evt = evt;
                     this.sourceContact = contact;

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetServerStoredInfo.java
Patch:
@@ -473,8 +473,7 @@ public void testWriteInfo()
 
         logger.trace("Proceeding to Testing values!");
         // make the tests here
-        Hashtable userInfo = fixture.testerAgent.getUserInfo(fixture.
-            ourAccountID);
+        Hashtable userInfo = fixture.testerAgent.getUserInfo(fixture.ourUserID);
 
         assertEquals("The LastName we set is not set or not read properly"
                      , newLastName

File: src/net/java/sip/communicator/impl/protocol/mock/MockPersistentPresenceOperationSet.java
Patch:
@@ -701,7 +701,7 @@ public Contact createUnresolvedContact(String address,
      * @param persistentData a String returned Contact's getPersistentData()
      * method during a previous run and that has been persistently stored
      * locally.
-     * @param parentProtoGroup the group where the unresolved contact is
+     * @param parent the group where the unresolved contact is
      * supposed to belong to.
      *
      * @return the unresolved <tt>Contact</tt> created from the specified

File: src/net/java/sip/communicator/impl/gui/main/login/LoginWindow.java
Patch:
@@ -218,7 +218,7 @@ public LoginManager getLoginManager() {
 
     /**
      * Sets the <tt>LoginManager</tt> for this login window.
-     * @param <tt>loginManager</tt> The related LoginManager.
+     * @param loginManager The related LoginManager.
      */
     public void setLoginManager(LoginManager loginManager) {
         this.loginManager = loginManager;

File: src/net/java/sip/communicator/util/xml/DOMElementWriter.java
Patch:
@@ -41,7 +41,7 @@
  *
  * <p>Utility class used by {@link net.java.sip.communicator.util.xml.XMLUtils
  * XMLUtils}
- * and the {@link net.java.sip.communicator.slick.runner.SipCommunicatorSlickRunner
+ * and the {@see net.java.sip.communicator.slick.runner.SipCommunicatorSlickRunner
  * SipCommunicatorSlickRunner}.
  * </p>
  *

File: src/net/java/sip/communicator/util/xml/DOMElementWriter.java
Patch:
@@ -124,7 +124,7 @@ public void write(Element element, Writer out, int indent,
 
             case Node.TEXT_NODE:
                 //if this is a new line don't print it as we print our own.
-                if(child.getNodeValue().indexOf(lSep) == -1)
+                if(child.getNodeValue() != null && child.getNodeValue().indexOf(lSep) == -1)
                     out.write(encode(child.getNodeValue()));
                 break;
 

File: src/net/java/sip/communicator/impl/protocol/icq/message/usrinfo/DetailTlv.java
Patch:
@@ -90,10 +90,9 @@ public void writeString(String str)
         data = newData;
     }
 
-
     public String toString()
     {
-        StringBuilder result = new StringBuilder();
+        StringBuffer result = new StringBuffer();
         ByteArrayOutputStream out = new ByteArrayOutputStream();
 
         try

File: src/net/java/sip/communicator/service/contactlist/event/MetaContactRenamedEvent.java
Patch:
@@ -35,7 +35,7 @@ public MetaContactRenamedEvent(MetaContact source,
      */
     public String getNewDisplayName()
     {
-        return (String)getOldValue();
+        return (String)getNewValue();
     }
 
     /**
@@ -45,6 +45,6 @@ public String getNewDisplayName()
      */
     public String getOldDisplayName()
     {
-        return (String)getNewValue();
+        return (String)getOldValue();
     }
 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/RenameContactDialog.java
Patch:
@@ -88,7 +88,7 @@ public void actionPerformed(ActionEvent e) {
         if (name.equals("rename")) {
             if (metaContact != null) {
                 this.clist.renameMetaContact(
-                    metaContact, renameContactPanel.getName());
+                    metaContact, renameContactPanel.getNewName());
             }
             this.dispose();
         }

File: src/net/java/sip/communicator/service/protocol/OperationSetServerStoredContactInfo.java
Patch:
@@ -47,7 +47,7 @@ public interface OperationSetServerStoredContactInfo
      * @return a java.util.Iterator over all details that are instances or
      * descendants of the specified class.
      */
-    public Iterator getDetailsAndDescendants(Contact contat, Class detailClass);
+    public Iterator getDetailsAndDescendants(Contact contact, Class detailClass);
 
     /**
      * Returns an iterator over all details that are instances of exactly the
@@ -66,10 +66,11 @@ public interface OperationSetServerStoredContactInfo
      * <p>
      * @return a java.util.Iterator over all details of specified class.
      */
-    public Iterator getDetails(Contact contat, Class detailClass);
+    public Iterator getDetails(Contact contact, Class detailClass);
 
     /**
      * Returns all details existing for the specified cotact.
+     * @param contact the specified cotact
      * @return a java.util.Iterator over all details existing for the specified
      * contact.
      */

File: src/net/java/sip/communicator/impl/gui/main/message/ChatWindow.java
Patch:
@@ -236,9 +236,7 @@ public void addChat(ChatPanel chatPanel) {
     /**
      * Creates a ChatPanel for the given contact and adds it to a tabbedPane.
      * 
-     * @param contact The MetaContact added to the chat.
-     * @param status The current status.
-     * @param protocolContact The protocol contact.
+     * @param chatPanel The chat panel to add.
      */
     public void addChatTab(ChatPanel chatPanel) {
         String contactName = chatPanel.getDefaultContact().getDisplayName();

File: src/net/java/sip/communicator/service/protocol/ServerStoredDetails.java
Patch:
@@ -45,7 +45,7 @@
  * that you should leave space for internationalization when doing so).
  * <p>
  * This class is meant for usage with the  OperationSetServerStoredAccountInfo
- * and OperationSetServerStoredUserInfo operation sets.
+ * and OperationSetServerStoredContactInfo operation sets.
  *
  * @author Emil Ivov
  */

File: src/net/java/sip/communicator/service/protocol/OperationSetServerStoredAccountInfo.java
Patch:
@@ -12,7 +12,7 @@
  * The Account Info Operation set is a means of accessing and modifying detailed
  * information on the user/account that is currently logged in through this
  * provider. This operation set is more or less reciproce to
- * OperationSetServerStoredUserInfo with the most essential difference being the
+ * OperationSetServerStoredContactInfo with the most essential difference being the
  * fact that the account info operation set allows you to modify data in
  * addition to reading it (quite natural given that it's your own info that
  * you're dealing with).
@@ -37,7 +37,7 @@
  * The OperationSetServerStoredAccountInfo only concerns us (the user currently
  * logged through this provider) and our own details. In order to query details
  * concerning Contacts in our contact list we'd need to use the
- * OperationSetServerStoredUserInfo
+ * OperationSetServerStoredContactInfo
  *
  * @author Emil Ivov
  */

File: src/net/java/sip/communicator/impl/gui/main/StatusPanel.java
Patch:
@@ -127,7 +127,7 @@ public void stopConnecting(ProtocolProviderService protocolProvider) {
      * Checks if the given protocol has already its StatusSelectorBox in the 
      * StatusPanel.
      * 
-     * @param protocolName The protocol name.
+     * @param accountID The account id.
      * @return True if the protcol has already its StatusSelectorBox in the 
      * StatusPanel, False otherwise.
      */

File: src/net/java/sip/communicator/impl/gui/main/message/ChatWindow.java
Patch:
@@ -161,7 +161,7 @@ private void close() {
                             .getString("warning"),
                     JOptionPane.OK_CANCEL_OPTION, JOptionPane.WARNING_MESSAGE);
 
-            if (answer == JOptionPane.YES_OPTION) {
+            if (answer == JOptionPane.OK_OPTION) {
                 closeChat();
             }
         } else if (System.currentTimeMillis()
@@ -175,7 +175,7 @@ private void close() {
                             .getString("warning"),
                     JOptionPane.OK_CANCEL_OPTION, JOptionPane.WARNING_MESSAGE);
 
-            if (answer == JOptionPane.YES_OPTION) {
+            if (answer == JOptionPane.OK_OPTION) {
                 closeChat();
             }
         } else {

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetPresence.java
Patch:
@@ -102,7 +102,7 @@ public static Test suite()
 
         // execute this test after postTestSubscribe
         // to be sure that AuthorizationHandler is installed
-//        suite.addTest(new TestOperationSetPresence("postTestReceiveAuthorizatinonRequest"));
+        suite.addTest(new TestOperationSetPresence("postTestReceiveAuthorizatinonRequest"));
 
         return suite;
     }

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetPresence.java
Patch:
@@ -1191,7 +1191,7 @@ public void postTestReceiveAuthorizatinonRequest()
         // check have we received authorization request?
         assertTrue("Error adding buddy not recieved or the buddy(" +
                        fixture.ourAccountID +
-                       ") doesn't require authorization",
+                       ") doesn't require authorization 1",
                        fixture.testerAgent.getAuthCmdFactory().isErrorAddingReceived);
 
         assertTrue("We haven't received any authorization request ",
@@ -1253,7 +1253,7 @@ public void postTestReceiveAuthorizatinonRequest()
         // check have we received authorization request?
         assertTrue("Error adding buddy not recieved or the buddy(" +
                               fixture.ourAccountID +
-                              ") doesn't require authorization",
+                              ") doesn't require authorization 2",
                               fixture.testerAgent.getAuthCmdFactory().isErrorAddingReceived);
 
        assertTrue("We haven't received any authorization request ",

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactListCellRenderer.java
Patch:
@@ -148,7 +148,8 @@ public Component getListCellRendererComponent(JList list, Object value,
 
             MetaContactGroup groupItem = (MetaContactGroup) value;
 
-            this.nameLabel.setText(groupItem.getGroupName());
+            this.nameLabel.setText(groupItem.getGroupName() 
+                    + "  ( " + groupItem.countChildContacts() + " )");
 
             this.nameLabel.setIcon(new ImageIcon(ImageLoader
                     .getImage(ImageLoader.GROUPS_16x16_ICON)));

File: src/net/java/sip/communicator/impl/protocol/icq/ContactGroupIcqImpl.java
Patch:
@@ -441,7 +441,7 @@ String getNameCopy()
      */
     public boolean isPersistent()
     {
-        return joustSimSourceGroup instanceof VolatileGroup;
+        return !(joustSimSourceGroup instanceof VolatileGroup);
     }
 
     /**

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -478,7 +478,7 @@ public void testSendFunMessages()
     /**
      * Tests whether there is a offline message received
      * and whether is the one we have send
-
+     */
     public void testReceiveOfflineMessages()
     {
         String messageText =
@@ -489,5 +489,5 @@ public void testReceiveOfflineMessages()
         assertNotNull("No Offline messages have been received", receiveMessage);
         assertEquals("message body", messageText, receiveMessage.getContent());
     }
-*/
+
 }

File: src/net/java/sip/communicator/impl/protocol/icq/RootContactGroupIcqImpl.java
Patch:
@@ -82,7 +82,7 @@ void addSubGroup(int index, ContactGroupIcqImpl group)
      */
     void addSubGroup(ContactGroupIcqImpl group)
     {
-        addSubGroup(countContacts(), group);
+        addSubGroup(countContacts() + countSubgroups(), group);
     }
 
     /**

File: src/net/java/sip/communicator/service/contactlist/MetaContactGroup.java
Patch:
@@ -97,7 +97,7 @@ public interface MetaContactGroup
      * the specified groupName and coming from the indicated ownerProvider.
      *
      * @param groupName the name of the contact group who we're looking for.
-     * @para ownerProvider a reference to the ProtocolProviderService that
+     * @param ownerProvider a reference to the ProtocolProviderService that
      * the contact we're looking for belongs to.
      * @return a reference to a <tt>ContactGroup</tt>, encapsulated by this
      * MetaContactGroup, carrying the specified name and originating from the

File: src/net/java/sip/communicator/service/callhistory/CallHistoryService.java
Patch:
@@ -4,7 +4,7 @@
  * Distributable under LGPL license.
  * See terms of license at gnu.org.
  */
- package net.java.sip.communicator.service.callhistory;
+package net.java.sip.communicator.service.callhistory;
 
 import net.java.sip.communicator.service.history.HistoryReader;
 

File: src/net/java/sip/communicator/service/msghistory/MessageHistoryService.java
Patch:
@@ -14,6 +14,4 @@
  */
 public interface MessageHistoryService extends HistoryReader {
 
-	
-    
 }

File: src/net/java/sip/communicator/impl/fileaccess/FileAccessActivator.java
Patch:
@@ -3,9 +3,8 @@
 import org.ungoverned.gravity.servicebinder.GenericActivator;
 
 /**
- * Invoke "Service Binder" to parse the service XML and register
- * all services.
- *
+ * Invoke "Service Binder" to parse the service XML and register all services.
+ * 
  * @author Alexander Pelov
  */
 public class FileAccessActivator extends GenericActivator {

File: src/net/java/sip/communicator/impl/msghistory/MessageHistoryActivator.java
Patch:
@@ -9,11 +9,10 @@
 import org.ungoverned.gravity.servicebinder.GenericActivator;
 
 /**
- * Invoke "Service Binder" to parse the service XML and register
- * all services.
+ * Invoke "Service Binder" to parse the service XML and register all services.
  * 
  * @author Alexander Pelov
  */
 public class MessageHistoryActivator extends GenericActivator {
-	
+
 }

File: src/net/java/sip/communicator/impl/gui/main/message/ChatConversationPanel.java
Patch:
@@ -135,7 +135,7 @@ private void initEditor(){
      * Process the message given by the parameters.
      * 
      * @param contactName The name of the contact sending the message.
-     * @param calendar The time at which the message is sent or received.
+     * @param date The time at which the message is sent or received.
      * @param messageType The type of the message. One of OUTGOING_MESSAGE 
      * or INCOMING_MESSAGE. 
      * @param message The message text.

File: src/net/java/sip/communicator/impl/gui/main/message/toolBars/MainToolBar.java
Patch:
@@ -192,6 +192,8 @@ public void actionPerformed(ActionEvent e) {
 			
 			editorPane.paste();
 			
+            editorPane.requestFocus();
+            
 		} else if (buttonText.equalsIgnoreCase("smily")) {
 			
 			if (e.getSource() instanceof SIPCommButton){				

File: src/net/java/sip/communicator/impl/msghistory/MessageHistoryServiceImpl.java
Patch:
@@ -212,7 +212,7 @@ public void unsetConfigurationService(
     /**
      * Set the configuration service.
      *
-     * @param configurationService
+     * @param historyService
      * @throws IOException 
      * @throws IllegalArgumentException 
      */
@@ -230,7 +230,7 @@ public void setHistoryService(
     /**
      * Remove a configuration service.
      *
-     * @param configurationService
+     * @param historyService
      */
     public void unsetHistoryService(
     		HistoryService historyService)

File: src/net/java/sip/communicator/impl/gui/main/message/ChatWindow.java
Patch:
@@ -291,10 +291,10 @@ public void closeOperation(MouseEvent e){
         				.getDefaultContact().getPresenceStatus();
                 //Add the first two tabs to the tabbed pane.                
                 chatTabbedPane.addTab
-                		(currentChatPanel.getDefaultContact().getDisplayName(),
+                		(firstChatPanel.getDefaultContact().getDisplayName(),
                     new ImageIcon(Constants.getStatusIcon
                     			(currentContactStatus)),
-                    currentChatPanel);
+                    firstChatPanel);
                                
                 chatPanel = new ChatPanel(this, contactIMOperationSet);
                 
@@ -308,7 +308,7 @@ public void closeOperation(MouseEvent e){
                     .setTabIndex(chatTabbedPane.getTabCount() - 1);
                 
                 this.contactTabsTable.put(contact.getMetaUID(),
-                                currentChatPanel);
+                                chatPanel);
             }
             
             this.getContentPane().add(chatTabbedPane, BorderLayout.CENTER);

File: test/net/java/sip/communicator/slick/protocol/icq/TestOperationSetBasicInstantMessaging.java
Patch:
@@ -478,7 +478,7 @@ public void testSendFunMessages()
     /**
      * Tests whether there is a offline message received
      * and whether is the one we have send
-     */
+
     public void testReceiveOfflineMessages()
     {
         String messageText =
@@ -489,4 +489,5 @@ public void testReceiveOfflineMessages()
         assertNotNull("No Offline messages have been received", receiveMessage);
         assertEquals("message body", messageText, receiveMessage.getContent());
     }
+     */
 }

File: src/net/java/sip/communicator/impl/gui/main/message/ChatConversationPanel.java
Patch:
@@ -78,7 +78,9 @@ public ChatConversationPanel(ChatPanel chatPanel) {
 
 		this.setWheelScrollingEnabled(true);
         
-		this.getViewport().add(chatEditorPane);        
+		this.getViewport().add(chatEditorPane);
+		
+		this.getVerticalScrollBar().setUnitIncrement(30);
 	}
     
     private void initEditor(){

File: src/net/java/sip/communicator/impl/gui/main/message/ChatWritePanel.java
Patch:
@@ -53,7 +53,9 @@ public ChatWritePanel (ChatPanel chatPanel){
 		
 		this.enableKeyboardEvents();
 		
-		this.getViewport().add(editorPane, BorderLayout.CENTER);		
+		this.getViewport().add(editorPane, BorderLayout.CENTER);
+		
+		this.getVerticalScrollBar().setUnitIncrement(30);
 	}
 		
 	public void paint(Graphics g){

File: src/net/java/sip/communicator/impl/gui/main/message/menu/MessageWindowMenuBar.java
Patch:
@@ -20,7 +20,7 @@ public class MessageWindowMenuBar extends JMenuBar {
 
 	private FileMenu fileMenu;
 	
-	private EditMenu editMenu = new EditMenu();
+	private EditMenu editMenu; 
 	
 	private JMenu settingsMenu = new JMenu(Messages.getString("settings"));
 	
@@ -34,6 +34,8 @@ public MessageWindowMenuBar(ChatWindow parentWindow){
 		
 		fileMenu = new FileMenu(this.parentWindow);
 		
+		editMenu = new EditMenu(this.parentWindow);
+		
 		this.init();		
 	}
 	

File: src/net/java/sip/communicator/impl/gui/main/login/LoginWindow.java
Patch:
@@ -206,9 +206,7 @@ protected void paintComponent(Graphics g) {
             g2.setColor(new Color(255, 255, 255, 100));
 
             g2.fillRect(0, 0, getWidth(), getHeight());
-                
         }
-       
     }
     
     /**

File: src/net/java/sip/communicator/impl/gui/main/customcontrols/tabbedPane/SIPCommTabbedPane.java
Patch:
@@ -402,7 +402,7 @@ public void firePopupOutsideTabEvent(MouseEvent e) {
     
     /**
      * Overrides setSelectedIndex in JTabbedPane in order to remove the 
-     * hightlight if the tab which is selected is highlighted.
+     * hightlight if the tab which is selected.
      */
     public void setSelectedIndex(int tabIndex){
         if(paneUI.isTabHighlighted(tabIndex)){            
@@ -417,7 +417,8 @@ public void setSelectedIndex(int tabIndex){
      * @param tabIndex The tab index.
      */
     public void highlightTab(int tabIndex){
-        if(!paneUI.isTabHighlighted(tabIndex))
+        if(!paneUI.isTabHighlighted(tabIndex)
+        		&& this.getSelectedIndex() != tabIndex)
             this.paneUI.tabAddHightlight(tabIndex);
         
         this.repaint();

File: src/net/java/sip/communicator/impl/gui/UIServiceImpl.java
Patch:
@@ -62,16 +62,16 @@ else if(!(component instanceof Component)){
     }
 
     /**
-     * Implements getSupportedConstraints in UIService interface.
-     * @see UIService#getSupportedConstraints()
+     * Implements getSupportedContainers in UIService interface.
+     * @see UIService#getSupportedContainers()
      */
     public Iterator getSupportedContainers() {        
         return Collections.unmodifiableList(supportedContainers).iterator();
     }
 
     /**
      * Implements getComponentsForConstraint in UIService interface.
-     * @see UIService#getComponentsForConstraint(String)
+     * @see UIService#getComponentsForContainer(ContainerID)
      */
     public Iterator getComponentsForContainer(ContainerID containerID)
         throws IllegalArgumentException {

File: src/net/java/sip/communicator/impl/gui/events/ContainerPluginListener.java
Patch:
@@ -18,14 +18,14 @@ public interface ContainerPluginListener
     /**
      * Indicates that a plugin component has been successfully added
      * to the container.
-     * @param evt the PluginComponentEvent containing the corresponding plugin component
+     * @param event the PluginComponentEvent containing the corresponding plugin component
      */
     public void pluginComponentAdded(PluginComponentEvent event);
     
     /**
      * Indicates that a plugin component has been successfully removed
      * from the container.
-     * @param evt the PluginComponentEvent containing the corresponding plugin component
+     * @param event the PluginComponentEvent containing the corresponding plugin component
      */
     public void pluginComponentRemoved(PluginComponentEvent event);
 }

File: src/net/java/sip/communicator/service/gui/UIService.java
Patch:
@@ -144,7 +144,7 @@ public void addComponent(ContainerID containerID, String constraint, Object comp
      * Meant to be called in the process of initialization of the container, defined by the 
      * given constraint in order to obtain all external components that should be added in it. 
      * 
-     * @param constraint One of the constraints supported by the current UI implementation.
+     * @param containerID One of the containerID-s supported by the current UI implementation.
      * @return An Iterator to a set containing all components added to a given constraint.
      */
     public Iterator getComponentsForContainer(ContainerID containerID)

File: src/net/java/sip/communicator/service/gui/event/ContainerListener.java
Patch:
@@ -18,13 +18,13 @@ public interface ContainerListener
 
     /**
      * Indicates that a container was added to the list of supported containers.
-     * @param evt the ContainerEvent containing the corresponding container.
+     * @param event the ContainerEvent containing the corresponding container.
      */
     public void containerAdded(ContainerEvent event);
     
     /**
      * Indicates that a container was removed from the list of supported containers.
-     * @param evt the ContainerEvent containing the corresponding container.
+     * @param event the ContainerEvent containing the corresponding container.
      */
     public void containerRemoved(ContainerEvent event);
 }

File: src/net/java/sip/communicator/impl/gui/main/contactlist/ContactList.java
Patch:
@@ -159,7 +159,7 @@ public void metaContactGroupAdded(MetaContactGroupEvent evt) {
        
         this.groupAdded(sourceGroup);
         
-        this.ensureIndexIsVisible(this.listModel.getSize() - 1);
+        this.ensureIndexIsVisible(0);  
     }
    
     public void metaContactGroupModified(MetaContactGroupEvent evt) {

File: src/net/java/sip/communicator/impl/contactlist/MetaContactImpl.java
Patch:
@@ -199,7 +199,9 @@ public int compareTo(Object o)
     {
         MetaContactImpl target = (MetaContactImpl)o;
 
-        return (totalStatus - target.totalStatus) * 1000000
+        return ( (PresenceStatus.MAX_STATUS_VALUE - totalStatus)
+                    - (PresenceStatus.MAX_STATUS_VALUE - target.totalStatus))
+               * 1000000
                 + getDisplayName().compareTo(target.getDisplayName()) * 100000
                 + getMetaUID().compareToIgnoreCase(target.getMetaUID());
     }

File: src/net/java/sip/communicator/service/contactlist/event/MetaContactMovedEvent.java
Patch:
@@ -22,8 +22,8 @@ public class MetaContactMovedEvent
     /**
      * Createas an instance of this <tt>MetaContactMovedEvent</tt> using the
      * specified arguments.
-     * @param source a reference to the <tt>MetaContact</tt> that this event
-     * is about.
+     * @param sourceContact a reference to the <tt>MetaContact</tt> that this
+     * event is about.
      * @param oldParent a reference to the  <tt>MetaContactGroup</tt> that
      * contained <tt>sourceContact</tt> before it was moved.
      * @param newParent a refenrece to the <tt>MetaContactGroup</tt> that

File: src/net/java/sip/communicator/service/protocol/event/TypingNotificationEvent.java
Patch:
@@ -25,7 +25,8 @@ public class TypingNotificationEvent
     /**
      * Creats a TypingNotificationEvent with the specified parameters.
      * <p>
-     * @param source Object
+     * @param sourceContact the <tt>Contact</tt> that has sen the notification.
+     * @param state
      */
     public TypingNotificationEvent(Contact sourceContact, int state)
     {

File: src/net/java/sip/communicator/impl/gui/main/StatusSelectorBox.java
Patch:
@@ -27,7 +27,7 @@
 import javax.swing.JOptionPane;
 import javax.swing.Timer;
 
-import net.java.sip.communicator.impl.gui.Activator;
+import net.java.sip.communicator.impl.gui.GuiActivator;
 import net.java.sip.communicator.impl.gui.main.customcontrols.AntialiasedPopupMenu;
 import net.java.sip.communicator.impl.gui.main.i18n.Messages;
 import net.java.sip.communicator.impl.gui.main.utils.AntialiasingManager;
@@ -45,7 +45,7 @@ public class StatusSelectorBox extends JLabel
 
     private Map itemsMap;
     
-    private Logger logger = Logger.getLogger(Activator.class.getName());
+    private Logger logger = Logger.getLogger(GuiActivator.class.getName());
     
     private MainFrame mainFrame;
     

File: src/net/java/sip/communicator/impl/gui/main/CallPanel.java
Patch:
@@ -79,7 +79,7 @@ private void init() {
 		this.phoneNumberCombo.setEditable(true);
 		
 		this.comboPanel.add(phoneNumberCombo, BorderLayout.CENTER);
-		this.add(comboPanel, BorderLayout.NORTH);
+		//this.add(comboPanel, BorderLayout.NORTH);
 		
 		this.callButton.setName("call");
 		this.hangupButton.setName("hangup");
@@ -94,9 +94,9 @@ private void init() {
 		this.buttonsPanel.add(callButton);
 		this.buttonsPanel.add(hangupButton);
 
-		this.add(buttonsPanel, BorderLayout.CENTER);
+		//this.add(buttonsPanel, BorderLayout.CENTER);
 		
-		this.minimizeButtonPanel.add(minimizeButton);
+		this.minimizeButtonPanel.add(restoreButton);
 		
 		this.add(minimizeButtonPanel,BorderLayout.SOUTH);		
 	}

