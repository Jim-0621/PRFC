File: app/src/main/java/io/github/moonleeeaf/hook/FuckOpenContactsActivity.java
Patch:
@@ -68,8 +68,9 @@ public boolean isAvailable() {
 
     @Override
     public boolean initOnce() throws Exception {
+        // Lcom/tencent/mobileqq/activity/phone/PhoneMatchActivity;->doOnCreate(Landroid/os/Bundle;)Z
         Method _onCreate = Initiator.loadClass("com.tencent.mobileqq.activity.phone.PhoneMatchActivity")
-                .getDeclaredMethod("onCreate", Bundle.class);
+                .getDeclaredMethod("doOnCreate", Bundle.class);
 
         HookUtils.hookAfterIfEnabled(this, _onCreate, (param) -> {
             Activity self = (Activity) param.thisObject;

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -244,7 +244,9 @@ public static Class<?> _NtStartupDirector() {
                 "com.tencent.mobileqq.h3.a.a",
                 "com.tencent.mobileqq.g3.a.a",
                 "com.tencent.mobileqq.i3.a.a",
-                "com.tencent.mobileqq.j3.a.a"
+                "com.tencent.mobileqq.j3.a.a",
+                // QQ 9.1.28.21880 (8398) gray
+                "du3.a",
         };
         for (String candidate : candidates) {
             Class<?> klass = load(candidate);

File: app/src/main/java/cc/hicore/hook/ShowAccurateGaggedTime.java
Patch:
@@ -21,6 +21,7 @@
 
 package cc.hicore.hook;
 
+import static io.github.qauxv.util.HostInfo.requireMinTimVersion;
 import static io.github.qauxv.util.HostInfo.requireMinQQVersion;
 
 import android.content.Context;
@@ -34,6 +35,7 @@
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import io.github.qauxv.util.Initiator;
 import io.github.qauxv.util.QQVersion;
+import io.github.qauxv.util.TIMVersion;
 
 @FunctionHookEntry
 @UiItemAgentEntry
@@ -58,7 +60,7 @@ public String[] getUiItemLocation() {
 
     @Override
     protected boolean initOnce() throws Exception {
-        if (requireMinQQVersion(QQVersion.QQ_9_0_75)) {
+        if (requireMinQQVersion(QQVersion.QQ_9_0_75) || requireMinTimVersion(TIMVersion.TIM_4_0_95)) {
             HookUtils.hookBeforeIfEnabled(this,
                     Reflex.findMethod(Initiator.loadClass("com.tencent.qqnt.troop.impl.TroopGagUtils"), String.class,
                             "remainingTimeToStringCountDown", long.class), param -> {

File: app/src/main/java/io/github/qauxv/bridge/ContactUtils.java
Patch:
@@ -136,7 +136,7 @@ public static String getBuddyName(@NonNull AppRuntime app, @NonNull String uin)
         Objects.requireNonNull(uin, "uin is null");
         Method getBuddyName = DexKit.loadMethodFromCache(NContactUtils_getBuddyName.INSTANCE);
         if (getBuddyName == null) {
-            Log.e("getBuddyName but N_ContactUtils_getBuddyName not found");
+            Log.w("getBuddyName but N_ContactUtils_getBuddyName not found");
             return null;
         }
         try {

File: app/src/main/java/cc/ioctl/hook/msg/FileShareExtHook.java
Patch:
@@ -112,7 +112,9 @@ protected boolean initOnce() throws Exception {
         Class<?> kFileBrowserModelBase = Initiator.loadClass("com.tencent.mobileqq.filemanager.fileviewer.model.FileBrowserModelBase");
         Class<?> kDefaultFileModel = DexKit.requireClassFromCache(DefaultFileModel.INSTANCE);
         String fileViewerAdapterClassName;
-        if (requireMinQQVersion(QQVersion.QQ_9_0_80)) {
+        if (requireMinQQVersion(QQVersion.QQ_9_1_5_BETA_20015)) {
+            fileViewerAdapterClassName = "com.tencent.mobileqq.filemanager.fileviewer.i";
+        } else if (requireMinQQVersion(QQVersion.QQ_9_0_80)) {
             fileViewerAdapterClassName = "com.tencent.mobileqq.filemanager.fileviewer.h";
         } else if (requireMinQQVersion(QQVersion.QQ_9_0_15)) {
             fileViewerAdapterClassName = "com.tencent.mobileqq.filemanager.fileviewer.g";

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -161,4 +161,5 @@ private QQVersion() {
     public static final long QQ_9_0_95 = 7368;
     public static final long QQ_9_1_0_BETA_19640 = 7496;
     public static final long QQ_9_1_0 = 7518;
+    public static final long QQ_9_1_5_BETA_20015 = 7646;
 }

File: app/src/main/java/io/github/qauxv/core/MainHook.java
Patch:
@@ -160,7 +160,7 @@ protected void afterHookedMethod(MethodHookParam param) {
                     }
                 });
             } else {
-                Log.w("LoadData not found, running third stage hooks in background");
+                Log.i("LoadData not found, running third stage hooks in background");
                 if (safeMode) {
                     SettingEntryHook.INSTANCE.initialize();
                 } else {

File: app/src/main/java/cc/hicore/hook/RepeaterPlus.java
Patch:
@@ -349,6 +349,7 @@ private void repeatByForwardNt(Object msg) {
                     return;
                 }
                 if (list.get(0).getElements().get(0).getPicElement() != null
+                        || list.get(0).getElements().get(0).getMarketFaceElement() != null
                         || list.get(0).getElements().get(0).getStructMsgElement() != null
                         || list.get(0).getElements().get(0).getArkElement() != null) {
                     service.forwardMsg(l, contact, c, attrMap, (i2, str2, hashMap) -> {

File: app/src/main/java/io/github/qauxv/omnifix/ktx/MainDispatcherPreload.java
Patch:
@@ -40,7 +40,7 @@ private MainDispatcherPreload() {
 
     public static void preload() {
         try {
-            Class<?> klass = Class.forName(getMainDispatcherLoaderClassName());
+            Class<?> klass = Class.forName(getMainDispatcherLoaderClassName(), false, MainDispatcherPreload.class.getClassLoader());
             Field dispatcherField = klass.getDeclaredField("dispatcher");
             dispatcherField.setAccessible(true);
             // deliberately get the reflection object before we check whether manual invention is needed

File: app/src/main/java/io/github/qauxv/poststartup/StartupRoutine.java
Patch:
@@ -29,6 +29,7 @@
 import com.github.kyuubiran.ezxhelper.init.InitFields;
 import io.github.qauxv.core.MainHook;
 import io.github.qauxv.core.NativeCoreBridge;
+import io.github.qauxv.omnifix.ktx.MainDispatcherPreload;
 import io.github.qauxv.util.HostInfo;
 import io.github.qauxv.util.Initiator;
 import io.github.qauxv.util.Log;
@@ -76,6 +77,7 @@ public static void execPostStartupInit(@NonNull Context ctx, @Nullable Object st
             Log.w("HookBridge is null, fallback to embedded LSPlant.");
             LsplantHookImpl.initializeLsplantHookBridge();
         }
+        MainDispatcherPreload.preload();
         MainHook.getInstance().performHook(ctx, step);
     }
 

File: app/src/main/java/io/github/qauxv/util/hookstatus/ModuleAppImpl.java
Patch:
@@ -31,6 +31,7 @@
 import io.github.qauxv.core.NativeCoreBridge;
 import io.github.qauxv.loader.hookapi.IClassLoaderHelper;
 import io.github.qauxv.loader.hookapi.ILoaderService;
+import io.github.qauxv.omnifix.ktx.MainDispatcherPreload;
 import io.github.qauxv.poststartup.StartupInfo;
 import io.github.qauxv.util.HostInfo;
 import io.github.qauxv.util.soloader.NativeLoader;
@@ -59,6 +60,7 @@ public void onCreate() {
         initStartupInfo();
         // for fail-safe purpose
         com.github.kyuubiran.ezxhelper.utils.Log.INSTANCE.getCurrentLogger().setLogTag("QAuxv");
+        MainDispatcherPreload.preload();
     }
 
     private void initStartupInfo() {

File: app/src/main/java/io/github/qauxv/util/hookimpl/lsplant/LsplantBridge.java
Patch:
@@ -25,6 +25,7 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import java.lang.reflect.Member;
+import java.lang.reflect.Method;
 
 public class LsplantBridge {
 
@@ -35,8 +36,9 @@ private LsplantBridge() {
     static native void nativeInitializeLsplant() throws RuntimeException;
 
     // return backup method if success, or null if failed
+    // LSPlant backup is always a method, regardless of the target type being method or constructor
     @Nullable
-    static native Member nativeHookMethod(@NonNull Member target, @NonNull Member callback, @NonNull Object context) throws RuntimeException;
+    static native Method nativeHookMethod(@NonNull Member target, @NonNull Member callback, @NonNull Object context) throws RuntimeException;
 
     static native boolean nativeIsMethodHooked(@NonNull Member target) throws RuntimeException;
 

File: app/src/main/java/io/github/qauxv/poststartup/StartupHook.java
Patch:
@@ -26,6 +26,7 @@
 import android.util.DisplayMetrics;
 import android.util.Log;
 import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
 import io.github.qauxv.startup.HybridClassLoader;
 import io.github.qauxv.util.IoUtils;
 import io.github.qauxv.util.xpcompat.XC_MethodHook;
@@ -64,7 +65,7 @@ private StartupHook() {
      * @param lpwReserved null, not used
      * @param bReserved   false, not used
      */
-    public static void execStartupInit(Context ctx, Object step, String lpwReserved, boolean bReserved) {
+    public static void execStartupInit(@NonNull Context ctx, @Nullable Object step, String lpwReserved, boolean bReserved) {
         if (sSecondStageInit) {
             throw new IllegalStateException("Second stage init already executed");
         }

File: app/src/main/java/io/github/qauxv/poststartup/StartupRoutine.java
Patch:
@@ -24,6 +24,8 @@
 import android.app.Application;
 import android.content.Context;
 import android.os.Build;
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
 import com.github.kyuubiran.ezxhelper.init.InitFields;
 import io.github.qauxv.core.MainHook;
 import io.github.qauxv.core.NativeCoreBridge;
@@ -52,7 +54,7 @@ private StartupRoutine() {
      * @param lpwReserved null, not used
      * @param bReserved   false, not used
      */
-    public static void execPostStartupInit(Context ctx, Object step, String lpwReserved, boolean bReserved) {
+    public static void execPostStartupInit(@NonNull Context ctx, @Nullable Object step, String lpwReserved, boolean bReserved) {
         // init all kotlin utils here
         HostInfo.init((Application) ctx);
         Initiator.init(ctx.getClassLoader());

File: app/src/main/java/io/github/qauxv/util/hookimpl/lsplant/LsplantHookImpl.java
Patch:
@@ -148,6 +148,7 @@ private static synchronized void initializeLsplantInternal() {
             throw IoUtils.unsafeThrow(e);
         }
         LsplantBridge.nativeInitializeLsplant();
+        isInitialized = true;
     }
 
     private static void checkMemberValid(@NonNull Member target) {

File: app/src/main/java/io/github/qauxv/poststartup/StartupAgent.java
Patch:
@@ -53,7 +53,7 @@ public static void startup(
             @Nullable IHookBridge hookBridge
     ) {
         if (sInitialized) {
-            return;
+            throw new IllegalStateException("StartupAgent already initialized");
         }
         sInitialized = true;
         if (io.github.qauxv.R.string.res_inject_success >>> 24 == 0x7f) {

File: loader/startup/src/main/java/io/github/qauxv/startup/UnifiedEntryPoint.java
Patch:
@@ -26,7 +26,7 @@ public static void entry(
             @Nullable IHookBridge hookBridge
     ) {
         if (sInitialized) {
-            return;
+            throw new IllegalStateException("UnifiedEntryPoint already initialized");
         }
         sInitialized = true;
         // fix up the class loader

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -127,4 +127,5 @@ private QQVersion() {
     public static final long QQ_9_0_71 = 6702;
     public static final long QQ_9_0_73 = 6722;
     public static final long QQ_9_0_75 = 6786;
+    public static final long QQ_9_0_80 = 6896;
 }

File: app/src/main/java/cc/ioctl/util/ExfriendManager.java
Patch:
@@ -94,7 +94,7 @@ public class ExfriendManager {
 
     private static final long[] ROBOT_ENTERPRISE_UIN_ARRAY = new long[]{
             // 查询ROBOT信息 https://qun.qq.com/qunpro/robot/qunshare?robot_uin=66600000
-            66600000L, // =babyQ
+            66600000L, // babyQ
             2854196925L, // QQ小店助手
             2854202683L, // 游戏助手
             2854204259L, // 赞噢机器人

File: app/src/main/java/cc/hicore/hook/RepeaterPlus.java
Patch:
@@ -340,7 +340,7 @@ private void repeatByForwardNt(Object msg) {
             Method builder = DexKit.loadMethodFromCache(VasAttrBuilder.INSTANCE);
             if (builder != null) {
                 Object builderInstance = builder.getDeclaringClass().newInstance();
-                builder.invoke(builderInstance, attrMap, contact, 4);
+                builder.invoke(builderInstance, attrMap, contact.toKernelObject(), 4);
             }
 
             service.getMsgsByMsgId(contact, l, (i, str, list) -> {

File: app/src/main/java/cc/hicore/hook/stickerPanel/Hooker/StickerPanelEntryHooker.java
Patch:
@@ -53,6 +53,7 @@
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
 import io.github.qauxv.bridge.AppRuntimeHelper;
+import io.github.qauxv.bridge.kernelcompat.KernelMsgServiceCompat;
 import io.github.qauxv.bridge.ntapi.MsgServiceHelper;
 import io.github.qauxv.dsl.FunctionEntryRouter;
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
@@ -256,7 +257,7 @@ public void onGetMenuNt(@NonNull Object msg, @NonNull String componentType, @Non
         Object item = CustomMenu.createItemIconNt(msg, "保存面板", R.drawable.ic_item_save_72dp, R.id.item_save_to_panel, () -> {
             try {
                 long msgID = (long) Reflex.invokeVirtual(msg, "getMsgId");
-                IKernelMsgService service = MsgServiceHelper.getKernelMsgService(AppRuntimeHelper.getAppRuntime());
+                KernelMsgServiceCompat service = MsgServiceHelper.getKernelMsgService(AppRuntimeHelper.getAppRuntime());
                 ArrayList<Long> msgIDs = new ArrayList<>();
                 msgIDs.add(msgID);
                 service.getMsgsByMsgId(SessionUtils.AIOParam2Contact(AIOParam), msgIDs, (result, errMsg, msgList) -> {

File: app/src/main/java/cc/hicore/message/common/MsgSender.java
Patch:
@@ -25,12 +25,12 @@
 import cc.hicore.message.bridge.Chat_facade_bridge;
 import cc.hicore.message.bridge.Nt_kernel_bridge;
 import cc.hicore.message.chat.SessionUtils;
-import com.tencent.qqnt.kernel.nativeinterface.Contact;
 import com.tencent.qqnt.kernel.nativeinterface.MsgElement;
+import io.github.qauxv.bridge.kernelcompat.ContactCompat;
 import java.util.ArrayList;
 
 public class MsgSender {
-    public static void send_pic_by_contact(Contact contact,String picPath){
+    public static void send_pic_by_contact(ContactCompat contact,String picPath){
         if (QAppUtils.isQQnt()){
             ArrayList<MsgElement> newMsgArr = new ArrayList<>();
             if (contact.getChatType() == 4){

File: app/src/main/java/cc/ioctl/hook/experimental/CardMsgSender.java
Patch:
@@ -33,12 +33,12 @@
 import cc.hicore.QApp.QAppUtils;
 import cc.hicore.message.chat.SessionUtils;
 import com.tencent.qqnt.kernel.nativeinterface.ArkElement;
-import com.tencent.qqnt.kernel.nativeinterface.Contact;
 import com.tencent.qqnt.kernel.nativeinterface.MsgElement;
 import io.github.qauxv.base.IDynamicHook;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
 import io.github.qauxv.bridge.AppRuntimeHelper;
+import io.github.qauxv.bridge.kernelcompat.ContactCompat;
 import io.github.qauxv.dsl.FunctionEntryRouter.Locations.Auxiliary;
 import io.github.qauxv.remote.TransactionHelper;
 import io.github.qauxv.router.decorator.BaseSwitchFunctionDecorator;
@@ -177,7 +177,7 @@ private void sendCard(String text, View sendBtn, EditText input, Context ctx1, A
                     ArrayList<MsgElement> elem = new ArrayList<>();
                     MsgElement msgElement = getArkMsgElement(text);
                     elem.add(msgElement);
-                    Contact contact = SessionUtils.AIOParam2Contact(AIOParam);
+                    ContactCompat contact = SessionUtils.AIOParam2Contact(AIOParam);
                     send_msg(contact, elem);
                     SyncUtils.runOnUiThread(() -> {
                         input.setText("");

File: app/src/main/java/io/github/qauxv/router/dispacher/InputButtonHookDispatcher.java
Patch:
@@ -40,13 +40,13 @@
 import cc.ioctl.hook.experimental.CardMsgSender;
 import cc.ioctl.hook.msg.AioChatPieClipPasteHook;
 import cc.ioctl.util.HookUtils;
-import com.tencent.qqnt.kernel.nativeinterface.Contact;
 import com.xiaoniu.hook.CtrlEnterToSend;
 import io.github.duzhaokun123.hook.SendTTSHook;
 import io.github.qauxv.R;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.bridge.AppRuntimeHelper;
 import io.github.qauxv.bridge.SessionInfoImpl;
+import io.github.qauxv.bridge.kernelcompat.ContactCompat;
 import io.github.qauxv.bridge.ntapi.RelationNTUinAndUidApi;
 import io.github.qauxv.hook.BaseHookDispatcher;
 import io.github.qauxv.router.decorator.IBaseChatPieDecorator;
@@ -285,7 +285,7 @@ public boolean onLongClick(View v) {
      * QQNT: Get session info from AIOParam
      */
     public Parcelable getSessionByAIOParam() {
-        Contact c = SessionUtils.AIOParam2Contact(AIOParam);
+        ContactCompat c = SessionUtils.AIOParam2Contact(AIOParam);
         int type = c.getChatType() - 1; // chatType: 1 for friend, 2 for group
         String uin = c.getPeerUid();
         if (uin.startsWith("u_")) {

File: app/src/main/java/cc/ioctl/hook/chat/DisableDropSticker.java
Patch:
@@ -67,7 +67,9 @@ public boolean isApplicationRestartRequired() {
     @Override
     public boolean initOnce() throws ReflectiveOperationException {
         String className;
-        if (requireMinQQVersion(QQVersion.QQ_9_0_15)) {
+        if (requireMinQQVersion(QQVersion.QQ_9_0_60)) { // 9.0.60~9.0.70
+            className = "com.tencent.mobileqq.aio.animation.util.b";
+        } else if (requireMinQQVersion(QQVersion.QQ_9_0_15)) { // 9.0.15~9.0.56
             className = "com.tencent.mobileqq.aio.animation.util.d";
         } else if (QAppUtils.isQQnt()) {
             className = "com.tencent.mobileqq.aio.animation.util.AioAnimationConfigHelper";

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -115,7 +115,7 @@ private QQVersion() {
     public static final long QQ_9_0_17 = 5714;
     public static final long QQ_9_0_20 = 5844;
     public static final long QQ_9_0_25 = 5932;
-    public static final long QQ_9_0_30 = 6038;
+    public static final long QQ_9_0_30 = 6014;
     public static final long QQ_9_0_35 = 6148;
     public static final long QQ_9_0_50 = 6236;
     public static final long QQ_9_0_55 = 6368;

File: app/src/main/java/cc/ioctl/hook/msg/ShowMsgCount.java
Patch:
@@ -109,7 +109,7 @@ public boolean initOnce() throws NoSuchMethodException, ClassNotFoundException,
             return true;
         }
         Method updateCustomNoteTxt = null;
-        if (QAppUtils.isQQnt()) {
+        if (requireMinQQVersion(QQVersion.QQ_9_0_0)) {
             Class<?> clz = DexKit.requireClassFromCache(CCustomWidgetUtil_updateCustomNoteTxt_NT.INSTANCE);
             for (Method method : clz.getDeclaredMethods()) {
                 if (method.getParameterTypes().length == 6) {

File: app/src/main/java/cc/hicore/hook/RepeaterPlus.java
Patch:
@@ -425,7 +425,7 @@ public void onGetMenuNt(@NonNull Object msg, @NonNull String componentType, @Non
         if (ContextUtils.getCurrentActivity().getClass().getName().contains("MultiForwardActivity")) {
             return;
         }
-        Object item = CustomMenu.createItemIconNt(msg, "+1", R.drawable.ic_item_add_72dp, R.id.item_repeat, () -> {
+        Object item = CustomMenu.createItemIconNt(msg, "+1", R.drawable.ic_item_repeat_72dp, R.id.item_repeat, () -> {
             if (isMessageRepeatable(msg)) {
                 repeatByForwardNt(msg);
             } else {

File: app/src/main/java/cc/hicore/hook/RepeaterPlus.java
Patch:
@@ -425,7 +425,7 @@ public void onGetMenuNt(@NonNull Object msg, @NonNull String componentType, @Non
         if (ContextUtils.getCurrentActivity().getClass().getName().contains("MultiForwardActivity")) {
             return;
         }
-        Object item = CustomMenu.createItemIconNt(msg, "+1", R.drawable.ic_one_more, R.id.item_repeat, () -> {
+        Object item = CustomMenu.createItemIconNt(msg, "+1", R.drawable.ic_item_add_72dp, R.id.item_repeat, () -> {
             if (isMessageRepeatable(msg)) {
                 repeatByForwardNt(msg);
             } else {

File: app/src/main/java/cc/ioctl/hook/msg/PttForwardHook.java
Patch:
@@ -491,7 +491,7 @@ public void onGetMenuNt(@NonNull Object msg, @NonNull String componentType, @Non
             return;
         }
         Activity context = ContextUtils.getCurrentActivity();
-        Object item = CustomMenu.createItemNt(msg, "转发", R.id.item_ptt_forward, () -> {
+        Object item = CustomMenu.createItemIconNt(msg, "转发", R.drawable.ic_item_share_72dp, R.id.item_ptt_forward, () -> {
             File file = getPttFileByMsgNt(msg);
             if (!file.exists()) {
                 Toasts.error(context, "未找到语音文件");
@@ -500,7 +500,7 @@ public void onGetMenuNt(@NonNull Object msg, @NonNull String componentType, @Non
             }
             return Unit.INSTANCE;
         });
-        Object item2 = CustomMenu.createItemNt(msg, "保存", R.id.item_ptt_save, () -> {
+        Object item2 = CustomMenu.createItemIconNt(msg, "保存", R.drawable.ic_item_save_72dp, R.id.item_ptt_save, () -> {
             File file = getPttFileByMsgNt(msg);
             if (!file.exists()) {
                 Toasts.error(context, "未找到语音文件");

File: app/src/main/java/cc/hicore/message/chat/SessionHooker.java
Patch:
@@ -83,7 +83,9 @@ protected void afterHookedMethod(MethodHookParam param) throws Throwable {
         XposedBridge.hookMethod(DexKit.loadMethodFromCache(AIO_Destroy_QQNT.INSTANCE), new XC_MethodHook() {
             @Override
             protected void afterHookedMethod(MethodHookParam param) {
-                aioParams.pop();
+                if (!aioParams.empty()) {
+                    aioParams.pop();
+                }
                 if (!aioParams.empty()) {
                     for (SessionHooker.IAIOParamUpdate decorator : getDecorators()) {
                         decorator.onAIOParamUpdate(aioParams.peek());

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -118,4 +118,5 @@ private QQVersion() {
     public static final long QQ_9_0_50 = 6236;
     public static final long QQ_9_0_55 = 6368;
     public static final long QQ_9_0_56 = 6372;
+    public static final long QQ_9_0_60 = 6458;
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -116,4 +116,5 @@ private QQVersion() {
     public static final long QQ_9_0_30 = 6038;
     public static final long QQ_9_0_35 = 6148;
     public static final long QQ_9_0_50 = 6236;
+    public static final long QQ_9_0_55 = 6348;
 }

File: app/src/main/java/cc/ioctl/hook/chat/DefaultFont.java
Patch:
@@ -155,7 +155,7 @@ protected void afterHookedMethod(MethodHookParam param) {
 
     @Override
     public boolean isNeedFind() {
-        return DexKit.getMethodDescFromCacheImpl(NTextItemBuilder_setETText.INSTANCE) == null;
+        return !QAppUtils.isQQnt() && DexKit.getMethodDescFromCacheImpl(NTextItemBuilder_setETText.INSTANCE) == null;
     }
 
     @Override

File: app/src/main/java/com/alphi/qhmk/module/HookQWallet.java
Patch:
@@ -36,7 +36,8 @@ protected boolean initOnce() throws Exception {
                 // 预防广告视图显示导致的黑屏
                 // public final QWalletHomePreviewController.?(QWallBaseFragment|QWalletBaseFragment)Z
                 Method methodIsShowAdView = ArraysKt.single(kQWalletHomePreviewController.getDeclaredMethods(),
-                        it -> it.getReturnType() == boolean.class && it.getParameterTypes().length == 1 &&
+                        it -> it.getReturnType() == boolean.class &&
+                                it.getParameterTypes().length == 1 &&
                                 it.getParameterTypes()[0].getSimpleName().endsWith("BaseFragment"));
                 HookUtils.hookBeforeIfEnabled(this, methodIsShowAdView, param -> param.setResult(true));
             }
@@ -45,6 +46,7 @@ protected boolean initOnce() throws Exception {
                 // 加载广告及视图初始化
                 param.setResult(null);
             });
+            return true;
         }
         // 高版本 已测试 8.8.50
         Class<?> aClass = Initiator.load("Lcom/tencent/mobileqq/qwallet/config/impl/QWalletConfigServiceImpl;");

File: app/src/main/java/io/github/moonleeeaf/hook/AddEssenceViewerToGroupSettingsHook.java
Patch:
@@ -58,13 +58,13 @@ private AddEssenceViewerToGroupSettingsHook() {
     @NonNull
     @Override
     public String getName() {
-        return "在群设置页添加精华消息入口";
+        return "群设置页添加精华消息入口";
     }
   
     @NonNull
     @Override
     public String getDescription() {
-        return "本功能仅针对 TIM 用户\n如果打开后的列表为空，可能是由于 p_skey 不在内置浏览器的 Cookie 内，可以尝试打开群机器人页面，随意点击一个资料卡以解决（即使网页提示错误）\n不保证永久可用";
+        return "供 TIM 用户使用\n\n如果打开后的列表为空，可尝试打开群机器人页面，点击任一机器人资料卡以解决(想办法设置 Cookie p_skey 亦可)";
     }
 
     @NonNull

File: app/src/main/java/io/github/qauxv/startup/HybridClassLoader.java
Patch:
@@ -58,7 +58,8 @@ public static boolean isConflictingClass(String name) {
             || name.startsWith("org.intellij.lang.annotations.")
             || name.startsWith("org.jetbrains.annotations.")
             || name.startsWith("com.bumptech.glide.")
-            || name.startsWith("com.google.errorprone.annotations.");
+            || name.startsWith("com.google.errorprone.annotations.")
+            || name.startsWith("_COROUTINE.");
     }
 
     @Override

File: app/src/main/java/io/github/qauxv/lifecycle/CounterfeitActivityInfoFactory.java
Patch:
@@ -70,6 +70,8 @@ private static ActivityInfo initCommon(ActivityInfo ai, String name) {
         if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {
             ai.splitName = null;
         }
+        // add ui mode, see io.github.qauxv.omnifix.hw.HwResThemeMgrFix for more details
+        ai.configChanges |= ActivityInfo.CONFIG_UI_MODE;
         return ai;
     }
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -112,4 +112,5 @@ private QQVersion() {
     public static final long QQ_9_0_8 = 5540;
     public static final long QQ_9_0_15 = 5626;
     public static final long QQ_9_0_20 = 5844;
+    public static final long QQ_9_0_30 = 6014;
 }

File: app/src/main/java/io/github/qauxv/activity/BaseActivity.java
Patch:
@@ -27,11 +27,13 @@
 import android.content.Context;
 import android.content.Intent;
 import android.content.res.Configuration;
+import android.os.Build;
 import android.os.Bundle;
 import android.view.KeyEvent;
 import androidx.annotation.CallSuper;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.annotation.RequiresApi;
 import androidx.appcompat.app.AppCompatDelegate;
 import androidx.fragment.app.FragmentManager;
 import io.github.qauxv.ui.ResUtils;
@@ -504,6 +506,7 @@ protected void doOnConfigurationChanged(Configuration newConfig) {
         // to implement
     }
 
+    @RequiresApi(api = Build.VERSION_CODES.O)
     @Override
     public void onMultiWindowModeChanged(boolean isInMultiWindowMode, Configuration newConfig) {
         super.onMultiWindowModeChanged(isInMultiWindowMode, newConfig);

File: app/src/main/java/io/github/qauxv/util/SyncUtils.java
Patch:
@@ -27,10 +27,12 @@
 import android.content.Context;
 import android.content.Intent;
 import android.content.IntentFilter;
+import android.os.Build;
 import android.os.Handler;
 import android.os.Looper;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.core.content.ContextCompat;
 import cc.ioctl.util.HostInfo;
 import io.github.qauxv.base.IDynamicHook;
 import io.github.qauxv.core.HookInstaller;
@@ -145,7 +147,7 @@ public static void initBroadcast(Context ctx) {
         filter.addAction(ENUM_PROC_REQ);
         filter.addAction(ENUM_PROC_RESP);
         filter.addAction(GENERIC_WRAPPER);
-        ctx.registerReceiver(recv, filter);
+        ContextCompat.registerReceiver(ctx, recv, filter, ContextCompat.RECEIVER_NOT_EXPORTED);
         inited = true;
     }
 

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -111,5 +111,5 @@ private QQVersion() {
     public static final long QQ_9_0_0 = 5282;
     public static final long QQ_9_0_8 = 5540;
     public static final long QQ_9_0_15 = 5626;
-    public static final long QQ_9_0_20 = 5782;
+    public static final long QQ_9_0_20 = 5844;
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -111,4 +111,5 @@ private QQVersion() {
     public static final long QQ_9_0_0 = 5282;
     public static final long QQ_9_0_8 = 5540;
     public static final long QQ_9_0_15 = 5626;
+    public static final long QQ_9_0_20 = 5782;
 }

File: app/src/main/java/io/github/qauxv/util/TIMVersion.java
Patch:
@@ -72,4 +72,5 @@ public class TIMVersion {
     public static final long TIM_3_4_9 = 1268;
     public static final long TIM_3_5_0 = 1278;
     public static final long TIM_3_5_0_2 = 1288;
+    public static final long TIM_3_5_6 = 1338;
 }

File: app/src/main/java/cc/ioctl/hook/ui/profile/DisableAvatarDecoration.java
Patch:
@@ -73,6 +73,7 @@ protected void afterHookedMethod(@NonNull MethodHookParam param) {
                     v.pendantDiyInfoId = 0;
                 }
             });
+            return true;
         } else if (QAppUtils.isQQnt()){
             HookUtils.hookBeforeIfEnabled(this, VASMsgAvatarPendant.class.getDeclaredMethod("getPendantId"),param -> param.setResult(0L));
             HookUtils.hookBeforeIfEnabled(this, VASMsgAvatarPendant.class.getDeclaredMethod("getPendantDiyInfoId"),param -> param.setResult(0));

File: app/src/main/java/cc/ioctl/hook/misc/CleanUpMitigation.java
Patch:
@@ -48,7 +48,7 @@ private CleanUpMitigation() {
     private HashSet<String> mPathPrefixList;
     private static final HashSet<String> FILES_TO_HIDE = SetsKt.hashSetOf(
             "qa_mmkv", "qa_misc", "qa_dyn_lib", "qa_target_dpi", ".tool",
-            "xa_mmkv", "xa_conf", "xa_lib", "xa_log", "xa_daemon"
+            "xa_mmkv", "xa_conf", "xa_lib", "xa_log", "xa_daemon", "TGStickersExported"
     );
 
     @SuppressLint("SdCardPath")

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -110,4 +110,5 @@ private QQVersion() {
     public static final long QQ_8_9_93_BETA_13315 = 4964;
     public static final long QQ_9_0_0 = 5282;
     public static final long QQ_9_0_8 = 5540;
+    public static final long QQ_9_0_15 = 5626;
 }

File: app/src/main/java/top/linl/hook/OffRelationshipIdentification.java
Patch:
@@ -11,7 +11,7 @@
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import io.github.qauxv.util.Initiator;
 import java.lang.reflect.Method;
-import top.linl.util.reflect.FieIdUtils;
+import top.linl.util.reflect.FieldUtils;
 import top.linl.util.reflect.MethodTool;
 
 
@@ -29,7 +29,7 @@ protected boolean initOnce() throws Exception {
                 "onDataUpdate",
                 Initiator.loadClass("com.tencent.mobileqq.profilecard.data.ProfileCardInfo"));
         HookUtils.hookAfterIfEnabled(this, method, param -> {
-                    Object recyclerView = FieIdUtils.getFirstField(param.thisObject,
+                    Object recyclerView = FieldUtils.getFirstField(param.thisObject,
                             Initiator.loadClass("com.tencent.biz.richframework.widget.listview.card.RFWCardListView"));
                     if (recyclerView == null) {
                         return;

File: app/src/main/java/top/linl/hook/TurnOffFriendInteractionLogoView.java
Patch:
@@ -30,7 +30,7 @@
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import java.lang.reflect.Field;
 import java.lang.reflect.Method;
-import top.linl.util.reflect.FieIdUtils;
+import top.linl.util.reflect.FieldUtils;
 import top.linl.util.reflect.MethodTool;
 
 @FunctionHookEntry
@@ -52,7 +52,7 @@ protected boolean initOnce() throws Exception {
                 .returnType(void.class)
                 .get();
         HookUtils.hookBeforeIfEnabled(this, initViewMethod, param -> {
-            Field mViewContainerField = FieIdUtils.findUnknownTypeField(param.thisObject.getClass(), "mViewContainer");
+            Field mViewContainerField = FieldUtils.findUnknownTypeField(param.thisObject.getClass(), "mViewContainer");
             mViewContainerField.set(param.thisObject, 1);
             param.setResult(null);
         });

File: app/src/main/java/top/linl/util/reflect/FieldUtils.java
Patch:
@@ -31,7 +31,7 @@
 /**
  * 反射字段工具
  */
-public class FieIdUtils {
+public class FieldUtils {
 
     private static final HashMap<String, Field> FIELD_CACHE = new HashMap<>();
 

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -108,5 +108,6 @@ private QQVersion() {
     public static final long QQ_8_9_88 = 4852;
     public static final long QQ_8_9_90 = 4938;
     public static final long QQ_8_9_93_BETA_13315 = 4964;
-    public static final long QQ_9_0_0 = 5220; //beta1
+    public static final long QQ_9_0_0 = 5282;
+    public static final long QQ_9_0_8 = 5540;
 }

File: app/src/main/java/io/github/qauxv/lifecycle/Parasitics.java
Patch:
@@ -408,7 +408,7 @@ private void processLaunchActivityItem(Object item, Object clientTransaction) th
                                 fAcrIntent.set(acr, realIntent);
                             }
                         } catch (NoSuchMethodException e) {
-                            if (Build.VERSION.SDK_INT == 33) {
+                            if (Build.VERSION.SDK_INT >= 33) {
                                 // expected behavior...?!
                             } else {
                                 throw e;

File: app/src/main/java/top/linl/util/reflect/MethodTool.java
Patch:
@@ -123,6 +123,9 @@ public Method get() {
                         Class<?>[] methodParams = method.getParameterTypes();
                         if (methodParams.length == target.methodParams.length) {
                             for (int i = 0; i < methodParams.length; i++) {
+                                if (target.methodParams[i] == Object.class) {
+                                    continue;
+                                }
                                 if (!Objects.equals(methodParams[i], target.methodParams[i])) {
                                     continue MethodFor;
                                 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -108,4 +108,5 @@ private QQVersion() {
     public static final long QQ_8_9_88 = 4852;
     public static final long QQ_8_9_90 = 4938;
     public static final long QQ_8_9_93_BETA_13315 = 4964;
+    public static final long QQ_9_0_0 = 5220; //beta1
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -104,7 +104,8 @@ private QQVersion() {
     public static final long QQ_8_9_78 = 4548;
     public static final long QQ_8_9_80 = 4614;
     public static final long QQ_8_9_83 = 4680;
-    public static final long qq_8_9_85 = 4766;
+    public static final long QQ_8_9_85 = 4766;
     public static final long QQ_8_9_88 = 4852;
     public static final long QQ_8_9_90 = 4938;
+    public static final long QQ_8_9_93_BETA_13315 = 4964;
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -106,4 +106,5 @@ private QQVersion() {
     public static final long QQ_8_9_83 = 4680;
     public static final long qq_8_9_85 = 4766;
     public static final long QQ_8_9_88 = 4852;
+    public static final long QQ_8_9_90 = 4938;
 }

File: app/src/main/java/cc/ioctl/hook/msg/AioChatPieClipPasteHook.java
Patch:
@@ -220,7 +220,7 @@ private static void handleSendUriPicture(@NonNull Context ctx, @NonNull Parcelab
                 }
                 data = baos.toByteArray();
                 cpTimeout.set(false);
-            } catch (IOException e) {
+            } catch (Exception e) {
                 FaultyDialog.show(ctx, e);
             }
             cpTimeout.set(false);

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -105,5 +105,5 @@ private QQVersion() {
     public static final long QQ_8_9_80 = 4614;
     public static final long QQ_8_9_83 = 4680;
     public static final long qq_8_9_85 = 4766;
-    public static final long QQ_8_9_88_12880 = 4790; // beta
+    public static final long QQ_8_9_88 = 4852;
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -105,4 +105,5 @@ private QQVersion() {
     public static final long QQ_8_9_80 = 4614;
     public static final long QQ_8_9_83 = 4680;
     public static final long qq_8_9_85 = 4766;
+    public static final long QQ_8_9_88_12880 = 4790; // beta
 }

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -233,7 +233,8 @@ public static Class<?> _NtStartupDirector() {
                 "com.tencent.mobileqq.startup.director.a",
                 "com.tencent.mobileqq.h3.a.a",
                 "com.tencent.mobileqq.g3.a.a",
-                "com.tencent.mobileqq.i3.a.a"
+                "com.tencent.mobileqq.i3.a.a",
+                "com.tencent.mobileqq.j3.a.a"
         };
         for (String candidate : candidates) {
             Class<?> klass = load(candidate);

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -104,4 +104,5 @@ private QQVersion() {
     public static final long QQ_8_9_78 = 4548;
     public static final long QQ_8_9_80 = 4614;
     public static final long QQ_8_9_83 = 4680;
+    public static final long qq_8_9_85 = 4766;
 }

File: app/src/main/java/com/alphi/qhmk/module/HookUpgrade.java
Patch:
@@ -58,7 +58,7 @@ protected boolean initOnce() throws Exception {
             }
         }
 
-        return false;
+        return true;
     }
 
     @NonNull

File: app/src/main/java/com/alphi/qhmk/module/DisableX5.java
Patch:
@@ -42,6 +42,7 @@ protected boolean initOnce() throws Exception {
             for (Field field : tbsClass.getDeclaredFields()) {
                 Class<?> type = field.getType();
                 Package tPackage = type.getPackage();
+                // 因为 8.9 存在有个类 util.*.* 不然会 hook 错地方
                 if (tPackage != null && tPackage.getName().equals("com.tencent.smtt.utils")) {
                     tbsClassConfig = type;
                 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -103,4 +103,5 @@ private QQVersion() {
     public static final long QQ_8_9_76 = 4484;
     public static final long QQ_8_9_78 = 4548;
     public static final long QQ_8_9_80 = 4614;
+    public static final long QQ_8_9_83 = 4680;
 }

File: app/src/main/java/io/github/qauxv/startup/HybridClassLoader.java
Patch:
@@ -56,7 +56,9 @@ public static boolean isConflictingClass(String name) {
             || name.startsWith("com.google.common.")
             || name.startsWith("com.microsoft.appcenter.")
             || name.startsWith("org.intellij.lang.annotations.")
-            || name.startsWith("org.jetbrains.annotations.");
+            || name.startsWith("org.jetbrains.annotations.")
+            || name.startsWith("com.bumptech.glide.")
+            || name.startsWith("com.google.errorprone.annotations.");
     }
 
     @Override

File: app/src/main/java/cc/hicore/hook/RepeaterPlus.java
Patch:
@@ -286,7 +286,7 @@ protected void afterHookedMethod(MethodHookParam param) {
             }
             Objects.requireNonNull(kChatAdapter1, "ChatAdapter1.class is null");
             if (!RepeaterPlusIconSettingDialog.getIsShowInMenu()) {
-                HookUtils.hookAfterIfEnabled(this, XMethod.obj(kChatAdapter1).name( "getView").ret( View.class).param(
+                HookUtils.hookAfterIfEnabled(this, XMethod.clz(kChatAdapter1).name( "getView").ret( View.class).param(
                         int.class,
                         View.class,
                         ViewGroup.class

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -101,4 +101,5 @@ private QQVersion() {
     public static final long QQ_8_9_73 = 4416;
     public static final long QQ_8_9_75 = 4482;
     public static final long QQ_8_9_78 = 4548;
+    public static final long QQ_8_9_80 = 4614;
 }

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -232,7 +232,8 @@ public static Class<?> _NtStartupDirector() {
         String[] candidates = new String[]{
                 "com.tencent.mobileqq.startup.director.a",
                 "com.tencent.mobileqq.h3.a.a",
-                "com.tencent.mobileqq.g3.a.a"
+                "com.tencent.mobileqq.g3.a.a",
+                "com.tencent.mobileqq.i3.a.a"
         };
         for (String candidate : candidates) {
             Class<?> klass = load(candidate);

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -100,5 +100,5 @@ private QQVersion() {
     public static final long QQ_8_9_70 = 4330;
     public static final long QQ_8_9_73 = 4416;
     public static final long QQ_8_9_75 = 4482;
-    public static final long QQ_8_9_78 = 4506;
+    public static final long QQ_8_9_78 = 4548;
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -100,4 +100,5 @@ private QQVersion() {
     public static final long QQ_8_9_70 = 4330;
     public static final long QQ_8_9_73 = 4416;
     public static final long QQ_8_9_75 = 4482;
+    public static final long QQ_8_9_78 = 4506;
 }

File: app/src/main/java/io/github/qauxv/util/hookstatus/AbiUtils.java
Patch:
@@ -213,6 +213,7 @@ public static String archStringToLibDirName(@NonNull String arch) {
                 return "x86_64";
             case "arm":
             case "armhf":
+            case "armv7l":
             case "armeabi":
             case "armeabi-v7a":
                 return "arm";

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -99,4 +99,5 @@ private QQVersion() {
     public static final long QQ_8_9_68 = 4264;
     public static final long QQ_8_9_70 = 4330;
     public static final long QQ_8_9_73 = 4416;
+    public static final long QQ_8_9_75 = 4482;
 }

File: app/src/main/java/cc/hicore/hook/stickerPanel/MainItemImpl/RecentStickerImpl.java
Patch:
@@ -48,7 +48,7 @@ public RecentStickerImpl(Context mContext) {
 
         View setButton = cacheView.findViewById(R.id.Sticker_Panel_Set_Item);
         setButton.setOnClickListener(v-> new XPopup.Builder(ContextUtils.getFixContext(mContext))
-                .asConfirm("提示", "是否要清楚最近的表情记录?", RecentStickerHelper::cleanAllRecentRecord)
+                .asConfirm("提示", "是否要清除最近的表情记录?", RecentStickerHelper::cleanAllRecentRecord)
                 .show());
 
         try {

File: app/src/main/java/cc/hicore/hook/stickerPanel/LocalDataHelper.java
Patch:
@@ -46,7 +46,7 @@ public synchronized static List<LocalPicItems> getPicItems(String pathName) {
                     localPath.MD5 = path.getString("MD5");
                     localPath.fileName = path.optString("fileName");
                     localPath.addTime = path.optLong("addTime");
-                    localPath.type = path.getInt("type");
+                    localPath.type = path.optInt("type",1);
                     localPath.url = path.optString("url");
                     localPath.thumbName = path.optString("thumbName");
                     localPath.thumbUrl = path.optString("thumbUrl");

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -98,4 +98,5 @@ private QQVersion() {
     public static final long QQ_8_9_63 = 4194;
     public static final long QQ_8_9_68 = 4264;
     public static final long QQ_8_9_70 = 4330;
+    public static final long QQ_8_9_73 = 4416;
 }

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -231,6 +231,7 @@ public static Class<?> _NtStartupDirector() {
         }
         String[] candidates = new String[]{
                 "com.tencent.mobileqq.startup.director.a",
+                "com.tencent.mobileqq.h3.a.a",
                 "com.tencent.mobileqq.g3.a.a"
         };
         for (String candidate : candidates) {

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -97,4 +97,5 @@ private QQVersion() {
     // The first NT version
     public static final long QQ_8_9_63 = 4194;
     public static final long QQ_8_9_68 = 4264;
+    public static final long QQ_8_9_70 = 4330;
 }

File: app/src/main/java/cc/ioctl/hook/msg/RevokeMsgHook.java
Patch:
@@ -495,7 +495,7 @@ private void onRecallSysMsgForNT(int chatType, String peerUid, String recallOpUi
                         String msgAuthorName = ContactUtils.getDisplayNameForUid(msgAuthorUid, peerUid);
                         String msgAuthorUin = RelationNTUinAndUidApi.getUinFromUid(msgAuthorUid);
                         // msgAuthorUin may be empty, in the case when in a group chat, NT kernel are not so familiar with the one
-                        if (recallOpUid.equals(msgAuthorUin)) {
+                        if (recallOpUid.equals(msgAuthorUid)) {
                             builder.append(new NtGrayTipHelper.NtGrayTipJsonBuilder.UserItem(String.valueOf(operatorUin), recallOpUid, operatorName));
                             builder.appendText("撤回了一条消息(没收到) [seq=" + msgSeq + "]");
                             summary = operatorName + "撤回了一条消息(没收到)";

File: app/src/main/java/cc/hicore/hook/stickerPanel/MainItemImpl/LocalStickerImpl.java
Patch:
@@ -231,6 +231,7 @@ private View getItemContainer(Context context, String coverView, int count, Loca
     public void onViewDestroy(ViewGroup parent) {
         for (ViewInfo img : cacheImageView) {
             img.view.setImageBitmap(null);
+            img.status = 0;
             Glide.with(HostInfo.getApplication()).clear(img.view);
         }
     }

File: app/src/main/java/cc/hicore/hook/ReplyMsgWithImg.java
Patch:
@@ -224,6 +224,8 @@ protected boolean initOnce() throws Exception {
                 Log.d("ReplyMsgWithImg PhotoListPanel.a chatPie is null");
                 return;
             }
+
+            // TODO: NT版本请用getSessionByAIOParam()
             Parcelable sessionInfo = InputButtonHookDispatcher.getSessionInfo(chatPie);
             int isTroop = SessionInfoImpl.getUinType(sessionInfo);
             if (isTroop == 1 || isTroop == 0) {
@@ -488,7 +490,7 @@ public static void addEditText(@NonNull EditText ed, @NonNull String text) {
     }
 
     @Override
-    public void onInitBaseChatPie(@NonNull Object baseChatPie, @NonNull ViewGroup aioRootView, @NonNull Parcelable session, @NonNull Context ctx,
+    public void onInitBaseChatPie(@NonNull Object baseChatPie, @NonNull ViewGroup aioRootView, @Nullable Parcelable session, @NonNull Context ctx,
             @NonNull AppRuntime rt) {
         mBaseChatPie = new WeakReference<>(Objects.requireNonNull(baseChatPie, "baseChatPie is null"));
         EditText input = aioRootView.findViewById(ctx.getResources().getIdentifier("input", "id", ctx.getPackageName()));

File: app/src/main/java/cc/hicore/message/chat/SessionHooker.java
Patch:
@@ -32,6 +32,7 @@
 import io.github.qauxv.base.IDynamicHook;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.hook.BaseHookDispatcher;
+import io.github.qauxv.router.dispacher.InputButtonHookDispatcher;
 import io.github.qauxv.util.Initiator;
 import io.github.qauxv.util.dexkit.AIO_Create_QQNT;
 import io.github.qauxv.util.dexkit.DexKit;
@@ -50,7 +51,8 @@ private SessionHooker() {
     private static final SessionHooker.IAIOParamUpdate[] DECORATORS = {
             StickerPanelEntryHooker.INSTANCE,
             MultiActionHook.INSTANCE,
-            RepeaterPlus.INSTANCE
+            RepeaterPlus.INSTANCE,
+            InputButtonHookDispatcher.INSTANCE
     };
 
     @NonNull

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -373,7 +373,8 @@ public static Class<?> _ThemeUtil() {
     }
 
     public static Class<?> _TroopMemberLevelView() {
-        return findClassWithSynthetics("com.tencent.mobileqq.troop.troopMemberLevel.TroopMemberNewLevelView",
+        return findClassWithSynthetics("com.tencent.qqnt.aio.nick.memberlevel.TroopMemberLevelView",
+                "com.tencent.mobileqq.troop.troopMemberLevel.TroopMemberNewLevelView",
                 "com.tencent.mobileqq.troop.widget.troopmemberlevel.TroopMemberNewLevelView");
     }
 

File: app/src/main/java/cc/ioctl/hook/msg/RevokeMsgHook.java
Patch:
@@ -181,7 +181,9 @@ public void setEnabled(boolean value) {
 
     @Override
     public boolean initOnce() throws Exception {
-        nativeInitNtKernelRecallMsgHook();
+        if (QAppUtils.isQQnt()) {
+            nativeInitNtKernelRecallMsgHook();
+        }
         // The method is still there, even on NT.
         // I decided to hook them as long as they are there.
         // There should only be one method with such signature.

File: app/src/main/java/cc/ioctl/hook/msg/RevokeMsgHook.java
Patch:
@@ -449,7 +449,7 @@ private void onRecallSysMsgForNT(int chatType, String peerUid, String recallOpUi
                     String operatorUin = RelationNTUinAndUidApi.getUinFromUid(recallOpUid);
                     // note: operatorUin may be empty, in the case when in a group chat, NT kernel are not so familiar with the one
                     // do we have the original message?
-                    if (msgObject != null && !(msgObject.getMsgType() == 5 && msgObject.getSubMsgType() == 4)) {
+                    if (msgObject != null && msgObject.getMsgType() != 1 && !(msgObject.getMsgType() == 5 && msgObject.getSubMsgType() == 4)) {
                         // good, we have the original message
                         // then, is the original message sent by the operator?
                         String msgAuthorUid = msgObject.getSenderUid();

File: app/src/main/java/cc/ioctl/hook/SettingEntryHook.java
Patch:
@@ -98,7 +98,7 @@ public boolean initOnce() throws Exception {
 
     private void injectSettingEntryForMainSettingConfigProvider() throws ReflectiveOperationException {
         // 8.9.70+
-        Class<?> kMainSettingFragment = Initiator.loadClass("com.tencent.mobileqq.setting.main.MainSettingFragment");
+        Class<?> kMainSettingFragment = Initiator.load("com.tencent.mobileqq.setting.main.MainSettingFragment");
         if (kMainSettingFragment != null) {
             Class<?> kMainSettingConfigProvider = Initiator.loadClass("com.tencent.mobileqq.setting.main.MainSettingConfigProvider");
             Method getItemProcessList = Reflex.findSingleMethod(kMainSettingConfigProvider, List.class, false, Context.class);

File: app/src/main/java/cc/ioctl/hook/msg/PicMd5Hook.java
Patch:
@@ -47,6 +47,8 @@
 import io.github.qauxv.util.LicenseStatus;
 import io.github.qauxv.util.QQVersion;
 import io.github.qauxv.util.Toasts;
+import io.github.qauxv.util.dexkit.AbstractQQCustomMenuItem;
+import io.github.qauxv.util.dexkit.DexKitTarget;
 import java.lang.reflect.Array;
 import java.lang.reflect.Method;
 import java.util.List;
@@ -60,6 +62,7 @@ public class PicMd5Hook extends CommonSwitchFunctionHook {
     public static final PicMd5Hook INSTANCE = new PicMd5Hook();
 
     private PicMd5Hook() {
+        super(new DexKitTarget[]{AbstractQQCustomMenuItem.INSTANCE});
     }
 
     @NonNull

File: app/src/main/java/cc/ioctl/hook/msg/PttForwardHook.java
Patch:
@@ -81,6 +81,7 @@
 import io.github.qauxv.util.SyncUtils;
 import io.github.qauxv.util.Toasts;
 import io.github.qauxv.util.data.ContactDescriptor;
+import io.github.qauxv.util.dexkit.AbstractQQCustomMenuItem;
 import io.github.qauxv.util.dexkit.CDialogUtil;
 import io.github.qauxv.util.dexkit.CFaceDe;
 import io.github.qauxv.util.dexkit.DexKitTarget;
@@ -122,7 +123,7 @@ public String[] getUiItemLocation() {
     }
 
     private PttForwardHook() {
-        super(SyncUtils.PROC_MAIN, new DexKitTarget[]{CFaceDe.INSTANCE, CDialogUtil.INSTANCE});
+        super(SyncUtils.PROC_MAIN, new DexKitTarget[]{CFaceDe.INSTANCE, CDialogUtil.INSTANCE, AbstractQQCustomMenuItem.INSTANCE});
     }
 
     private static void showSavePttFileDialog(Activity activity, final File ptt) {

File: app/src/main/java/cc/hicore/hook/stickerPanel/ICreator.java
Patch:
@@ -27,8 +27,6 @@
 import com.lxj.xpopup.util.XPopupUtils;
 import io.github.qauxv.R;
 import io.github.qauxv.lifecycle.Parasitics;
-import java.net.MalformedURLException;
-import java.net.URL;
 import java.util.ArrayList;
 import java.util.List;
 
@@ -114,7 +112,7 @@ private void initDefItemsBefore() {
 
     private void initDefItemsLast() {
 
-        ViewGroup inputView = (ViewGroup) createPicImage(R.drawable.input, "导入图片", v -> {
+        ViewGroup inputView = (ViewGroup) createPicImage(R.drawable.input, "导入表情", v -> {
             listView.setSelection(IdOfInputPic);
             listView.smoothScrollToPositionFromTop(IdOfInputPic, -5);
         });

File: app/src/main/java/cc/hicore/hook/stickerPanel/Hooker/StickerPanelEntryHooker.java
Patch:
@@ -148,7 +148,7 @@ protected boolean initOnce() throws Exception {
                 Method finalGetMsg = getMsg;
                 HookUtils.hookAfterIfEnabled(this, listMethod, param -> {
                     Object msg = finalGetMsg.invoke(param.thisObject);
-                    Object item = CustomMenu.createItemNt(msg, "保存到面板", R.id.item_repeat, () -> {
+                    Object item = CustomMenu.createItemNt(msg, "保存到面板", R.id.item_save_to_panel, () -> {
                         try {
                             long msgID = (long) Reflex.invokeVirtual(msg, "getMsgId");
                             IKernelMsgService service = MsgServiceHelper.getKernelMsgService(AppRuntimeHelper.getAppRuntime());

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -96,4 +96,5 @@ private QQVersion() {
 
     // The first NT version
     public static final long QQ_8_9_63 = 4194;
+    public static final long QQ_8_9_68 = 4264;
 }

File: app/src/main/java/cc/hicore/dialog/RepeaterPlusIconSettingDialog.java
Patch:
@@ -136,7 +136,6 @@ public RepeaterPlusIconSettingDialog(Context context) {
 
         // temporary
         if (HostInfo.requireMinQQVersion(QQVersion.QQ_8_9_63)) {
-            check_double_click.setEnabled(false);
             check_showUpper.setEnabled(false);
             check_showInMenu.setEnabled(false);
         }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -93,4 +93,7 @@ private QQVersion() {
     public static final long QQ_8_9_35 = 3814;
     public static final long QQ_8_9_53 = 3964;
     public static final long QQ_8_9_55 = 4030;
+
+    // The first NT version
+    public static final long QQ_8_9_63 = 4194;
 }

File: app/src/main/java/cc/ioctl/hook/ui/profile/DisableAvatarDecoration.java
Patch:
@@ -61,6 +61,8 @@ public String[] getUiItemLocation() {
     public boolean initOnce() throws NoSuchMethodException {
         if (QAppUtils.isQQnt()){
             HookUtils.hookBeforeIfEnabled(this, VASMsgAvatarPendant.class.getDeclaredMethod("getPendantId"),param -> param.setResult(0L));
+            HookUtils.hookBeforeIfEnabled(this, VASMsgAvatarPendant.class.getDeclaredMethod("getPendantDiyInfoId"),param -> param.setResult(0));
+            return true;
         }
         for (Method m : Initiator.load("com.tencent.mobileqq.vas.PendantInfo").getDeclaredMethods()) {
             if (m.getReturnType() == void.class) {

File: app/src/main/java/cc/ioctl/hook/chat/DefaultFont.java
Patch:
@@ -124,6 +124,8 @@ public boolean initOnce() throws ReflectiveOperationException {
         if (QAppUtils.isQQnt()){
             Method getFontID = VASMsgFont.class.getDeclaredMethod("getFontId");
             HookUtils.hookBeforeIfEnabled(this, getFontID, param -> param.setResult(0));
+            Method getMagicFontType = VASMsgFont.class.getDeclaredMethod("getMagicFontType");
+            HookUtils.hookBeforeIfEnabled(this, getMagicFontType, param -> param.setResult(0));
             return true;
         }else {
             Method method = DexKit.loadMethodFromCache(NTextItemBuilder_setETText.INSTANCE);

File: app/src/main/java/cc/ioctl/hook/chat/DefaultBubbleHook.java
Patch:
@@ -55,7 +55,7 @@ public class DefaultBubbleHook implements IDynamicHook, IUiItemAgentProvider, IU
     private DefaultBubbleHook() {
     }
 
-    private static final String[] paths = {"/bubble_info", "/files/bubble_info", "/files/bubble_paster"};
+    private static final String[] paths = {"/bubble_info", "/files/bubble_info", "/files/bubble_paster", "/files/vas_material_folder/bubble_dir"};
 
     @Override
     public boolean isAvailable() {

File: app/src/main/java/cc/hicore/Env.java
Patch:
@@ -23,6 +23,6 @@
 package cc.hicore;
 
 public class Env {
-    public static String app_save_path = "/sdcard/Android/data/com.tencent.mobileqq/files/.tool";
+    public static String app_save_path = "/sdcard/Android/data/com.tencent.mobileqq/files/.tool/";
     public static Object AIOParam;
 }

File: app/src/main/java/cc/ioctl/fragment/ExfriendListFragment.java
Patch:
@@ -289,7 +289,7 @@ private View inflateItemView(Context context, EventRecord ev) {
             switch (which) {
                 case 0: {
                     SystemServiceUtils.copyToClipboard(ctx, String.valueOf(r.operand));
-                    Toasts.show(ctx, "已复制 QQ 号");
+                    Toasts.info(ctx, "已复制 QQ 号");
                     break;
                 }
                 case 1: {

File: app/src/main/java/cc/hicore/hook/stickerPanel/Hooker/Emo_Btn_Hooker.java
Patch:
@@ -55,8 +55,9 @@ private Emo_Btn_Hooker() {
                 ChatPanel_InitPanel_QQNT.INSTANCE,
                 AIO_Create_QQNT.INSTANCE
         });
-
-        ServiceHook.requireHook();
+        if (QAppUtils.isQQnt()){
+            ServiceHook.requireHook();
+        }
     }
 
     @NonNull

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -92,4 +92,5 @@ private QQVersion() {
     public static final long QQ_8_9_33 = 3772;
     public static final long QQ_8_9_35 = 3814;
     public static final long QQ_8_9_53 = 3964;
+    public static final long QQ_8_9_55 = 4030;
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -91,4 +91,5 @@ private QQVersion() {
     public static final long QQ_8_9_30 = 3730;
     public static final long QQ_8_9_33 = 3772;
     public static final long QQ_8_9_35 = 3814;
+    public static final long QQ_8_9_53 = 3964;
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -88,4 +88,6 @@ private QQVersion() {
     public static final long QQ_8_9_25 = 3640;
     public static final long QQ_8_9_28 = 3698;
     public static final long QQ_8_9_28_2 = 3700;
+
+    public static final long QQ_8_9_33 = 3772;
 }

File: app/src/main/java/io/github/qauxv/startup/HookEntry.java
Patch:
@@ -61,7 +61,6 @@ public void handleLoadPackage(final XC_LoadPackage.LoadPackageParam lpparam) thr
             return;
         }
         sLoadPackageParam = lpparam;
-        sCurrentPackageName = lpparam.packageName;
         // check LSPosed dex-obfuscation
         Class<?> kXposedBridge = XposedBridge.class;
         if (!"de.robv.android.xposed.XposedBridge".equals(kXposedBridge.getName())) {
@@ -81,6 +80,7 @@ public void handleLoadPackage(final XC_LoadPackage.LoadPackageParam lpparam) thr
                 if (sInitZygoteStartupParam == null) {
                     throw new IllegalStateException("handleLoadPackage: sInitZygoteStartupParam is null");
                 }
+                sCurrentPackageName = lpparam.packageName;
                 StartupHook.getInstance().initialize(lpparam.classLoader);
                 break;
             }

File: app/src/main/java/io/github/qauxv/fragment/CheckAbiVariantModel.java
Patch:
@@ -44,6 +44,7 @@ private CheckAbiVariantModel() {
             "com.tencent.mobileqq",
             "com.tencent.tim",
             "com.tencent.qqlite",
+            "com.tencent.minihd.qq",
             // "com.tencent.mobileqqi",
     };
 

File: app/src/main/java/io/github/qauxv/startup/HybridClassLoader.java
Patch:
@@ -106,7 +106,7 @@ public static String getObfuscatedXposedApiPackage() {
     }
 
     public static String getObfuscatedLsposedNativeApiClassName() {
-        return sProbeLsposedNativeApiClassName.replace('.', '/').substring(1, sObfuscatedPackageName.length() - 1);
+        return sProbeLsposedNativeApiClassName.replace('.', '/').substring(1, sProbeLsposedNativeApiClassName.length() - 1);
     }
 
     public static String getXposedBridgeClassName() {

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -91,4 +91,5 @@ public class QQVersion {
     public static final long QQ_8_9_18 = 3466;
     public static final long QQ_8_9_20 = 3524;
     public static final long QQ_8_9_23 = 3582;
+    public static final long QQ_8_9_25 = 3640;
 }

File: app/src/main/java/cc/ioctl/fragment/ExfriendListFragment.java
Patch:
@@ -269,7 +269,7 @@ private View inflateItemView(Context context, EventRecord ev) {
         statlp.addRule(RelativeLayout.CENTER_VERTICAL);
         statlp.rightMargin = LayoutHelper.dip2px(context, 16);
 
-        rlayout.addView(llayout);
+        rlayout.addView(llayout, MATCH_PARENT, WRAP_CONTENT);
         rlayout.addView(stat, statlp);
 
         rlayout.setClickable(true);

File: app/src/main/java/cc/ioctl/dialog/RepeaterIconSettingDialog.java
Patch:
@@ -22,7 +22,6 @@
 package cc.ioctl.dialog;
 
 import android.annotation.SuppressLint;
-import android.app.AlertDialog;
 import android.content.Context;
 import android.content.DialogInterface;
 import android.graphics.Bitmap;
@@ -41,6 +40,7 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.annotation.UiThread;
+import androidx.appcompat.app.AlertDialog;
 import androidx.core.view.ViewCompat;
 import cc.ioctl.util.ui.FaultyDialog;
 import cc.ioctl.util.ui.drawable.DebugDrawable;

File: app/src/main/java/cc/ioctl/dialog/RikkaBaseApkFormatDialog.java
Patch:
@@ -22,7 +22,6 @@
 package cc.ioctl.dialog;
 
 import android.annotation.SuppressLint;
-import android.app.AlertDialog;
 import android.content.Context;
 import android.text.Editable;
 import android.text.TextWatcher;
@@ -33,6 +32,7 @@
 import android.widget.TextView;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.appcompat.app.AlertDialog;
 import cc.ioctl.util.HostInfo;
 import cc.ioctl.hook.file.BaseApk;
 import io.github.qauxv.BuildConfig;

File: app/src/main/java/cc/ioctl/dialog/RikkaCustomDeviceModelDialog.java
Patch:
@@ -22,7 +22,6 @@
 package cc.ioctl.dialog;
 
 import android.annotation.SuppressLint;
-import android.app.AlertDialog;
 import android.content.Context;
 import android.text.Editable;
 import android.text.TextWatcher;
@@ -33,6 +32,7 @@
 import android.widget.TextView;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.appcompat.app.AlertDialog;
 import cc.ioctl.util.HostInfo;
 import cc.ioctl.hook.chat.CustomMsgTimeFormat;
 import io.github.qauxv.R;

File: app/src/main/java/cc/ioctl/dialog/RikkaCustomMsgTimeFormatDialog.java
Patch:
@@ -22,7 +22,6 @@
 package cc.ioctl.dialog;
 
 import android.annotation.SuppressLint;
-import android.app.AlertDialog;
 import android.content.Context;
 import android.text.Editable;
 import android.text.TextWatcher;
@@ -33,6 +32,7 @@
 import android.widget.TextView;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import androidx.appcompat.app.AlertDialog;
 import cc.ioctl.hook.chat.CustomMsgTimeFormat;
 import io.github.qauxv.R;
 import io.github.qauxv.config.ConfigManager;

File: app/src/main/java/com/hicore/dialog/RepeaterPlusIconSettingDialog.java
Patch:
@@ -22,7 +22,6 @@
 package com.hicore.dialog;
 
 import android.annotation.SuppressLint;
-import android.app.AlertDialog;
 import android.content.Context;
 import android.content.DialogInterface;
 import android.graphics.Bitmap;
@@ -43,6 +42,7 @@
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.annotation.UiThread;
+import androidx.appcompat.app.AlertDialog;
 import androidx.core.view.ViewCompat;
 import cc.ioctl.util.LayoutHelper;
 import cc.ioctl.util.ui.FaultyDialog;

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -90,4 +90,5 @@ public class QQVersion {
     public static final long QQ_8_9_15 = 3408;
     public static final long QQ_8_9_18 = 3466;
     public static final long QQ_8_9_20 = 3524;
+    public static final long QQ_8_9_23 = 3582;
 }

File: app/src/main/java/io/github/qauxv/base/annotation/DexDeobfs.java
Patch:
@@ -22,6 +22,7 @@
 
 package io.github.qauxv.base.annotation;
 
+import io.github.qauxv.util.dexkit.DexKitTarget;
 import java.lang.annotation.ElementType;
 import java.lang.annotation.Retention;
 import java.lang.annotation.RetentionPolicy;
@@ -34,6 +35,5 @@
     /**
      * Dex deobfuscation required to be performed before the method is called.
      */
-    String[] value();
-
+    Class<? extends DexKitTarget>[] value();
 }

File: app/src/main/java/io/github/qauxv/bridge/GreyTipBuilder.java
Patch:
@@ -73,7 +73,7 @@ public GreyTipBuilder appendTroopMember(String memberUin, String name, boolean u
         return this;
     }
 
-    @DexDeobfs("CMessageRecordFactory")
+    @DexDeobfs(CMessageRecordFactory.class)
     public Object build(String uin, int istroop, String fromUin, long time, long msgUid,
                         long msgseq, long shmsgseq) {
         Object messageRecord = null;
@@ -98,7 +98,7 @@ public Object build(String uin, int istroop, String fromUin, long time, long msg
         return messageRecord;
     }
 
-    @DexDeobfs("CMessageRecordFactory")
+    @DexDeobfs(CMessageRecordFactory.class)
     public Object build(String uin, int istroop, String fromUin, long time, long msgseq) {
         Object messageRecord = null;
         try {

File: app/src/main/java/io/github/qauxv/bridge/QQMessageFacade.java
Patch:
@@ -69,7 +69,7 @@ public static Object getMessageManager(int istroop) {
         }
     }
 
-    @DexDeobfs("CMessageCache")
+    @DexDeobfs(CMessageCache.class)
     public static void revokeMessage(Object msg) throws ReflectiveOperationException {
         if (msg == null) {
             throw new NullPointerException("msg == null");

File: app/src/main/java/io/github/qauxv/ui/CustomDialog.java
Patch:
@@ -52,7 +52,7 @@ public class CustomDialog {
     private AlertDialog.Builder mBuilder = null;
     private boolean failsafe = false;
 
-    @DexDeobfs("CDialogUtil")
+    @DexDeobfs(CDialogUtil.class)
     public static CustomDialog create(Context ctx) {
         try {
             if (clz_DialogUtil == null) {

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -88,4 +88,5 @@ public class QQVersion {
 
     public static final long QQ_8_9_13 = 3350;
     public static final long QQ_8_9_15 = 3408;
+    public static final long QQ_8_9_18 = 3466;
 }

File: app/src/main/java/cc/ioctl/hook/FlashPicHook.java
Patch:
@@ -105,8 +105,7 @@ public boolean initOnce() throws Exception {
         Objects.requireNonNull(kItemBuilderFactory, "CItemBuilderFactory.INSTANCE");
         sn_ItemBuilderFactory = kItemBuilderFactory.getName();
         Objects.requireNonNull(sn_ItemBuilderFactory, "sn_ItemBuilderFactory not found");
-        sn_BasePicDownloadProcessor =
-                Objects.requireNonNull(DexKit.loadClassFromCache(CBasePicDlProcessor.INSTANCE), "CBASE_PIC_DL_PROC.INSTANCE").getName();
+        sn_BasePicDownloadProcessor = DexKit.requireClassFromCache(CBasePicDlProcessor.INSTANCE).getName();
         Objects.requireNonNull(sn_BasePicDownloadProcessor, "sn_BasePicDownloadProcessor not found");
         snarray_CheckStackClasses = new String[]{
                 Objects.requireNonNull(sn_ItemBuilderFactory, "sn_ItemBuilderFactory not found"),

File: app/src/main/java/io/github/qauxv/bridge/QQMessageFacade.java
Patch:
@@ -116,6 +116,9 @@ public static void commitMessageRecordList(@NonNull List<Object> messages) throw
     public static void commitMessageRecordList(@NonNull List<Object> messages, @NonNull String account) throws ReflectiveOperationException {
         Objects.requireNonNull(messages, "messages == null");
         Objects.requireNonNull(account, "account == null");
+        if (Long.parseLong(account) < 10000) {
+            throw new IllegalArgumentException("account is invalid: " + account);
+        }
         if (messages.isEmpty()) {
             return;
         }

File: app/src/main/java/io/github/qauxv/router/dispacher/InputButtonHookDispatcher.java
Patch:
@@ -50,6 +50,7 @@
 import io.github.qauxv.util.Toasts;
 import io.github.qauxv.util.dexkit.CArkAppItemBubbleBuilder;
 import io.github.qauxv.util.dexkit.CFaceDe;
+import io.github.qauxv.util.dexkit.CTestStructMsg;
 import io.github.qauxv.util.dexkit.DexKit;
 import io.github.qauxv.util.dexkit.DexKitTarget;
 import io.github.qauxv.util.dexkit.NBaseChatPie_init;
@@ -67,6 +68,7 @@ private InputButtonHookDispatcher() {
                 CArkAppItemBubbleBuilder.INSTANCE,
                 CFaceDe.INSTANCE,
                 NBaseChatPie_init.INSTANCE,
+                CTestStructMsg.INSTANCE
         });
     }
 

File: app/src/main/java/cc/ioctl/hook/RevokeMsgHook.java
Patch:
@@ -51,7 +51,6 @@
 import io.github.qauxv.util.Log;
 import io.github.qauxv.util.QQVersion;
 import io.github.qauxv.util.SyncUtils;
-import io.github.qauxv.util.dexkit.CContactUtils;
 import io.github.qauxv.util.dexkit.CMessageRecordFactory;
 import io.github.qauxv.util.dexkit.DexKit;
 import io.github.qauxv.util.dexkit.DexKitTarget;
@@ -92,7 +91,6 @@ private RevokeMsgHook() {
         //FIXME: is MSF really necessary?
         super(SyncUtils.PROC_MAIN | SyncUtils.PROC_MSF, new DexKitTarget[]{
                 CMessageRecordFactory.INSTANCE,
-                CContactUtils.INSTANCE,
                 NContactUtils_getDiscussionMemberShowName.INSTANCE,
                 NContactUtils_getBuddyName.INSTANCE
         });

File: app/src/main/java/cc/ioctl/hook/CardMsgSender.java
Patch:
@@ -41,6 +41,7 @@
 import io.github.qauxv.util.Toasts;
 import io.github.qauxv.util.dexkit.CArkAppItemBubbleBuilder;
 import io.github.qauxv.util.dexkit.CFaceDe;
+import io.github.qauxv.util.dexkit.CTestStructMsg;
 import io.github.qauxv.util.dexkit.DexKitTarget;
 import io.github.qauxv.util.dexkit.NBaseChatPie_init;
 import java.lang.reflect.InvocationTargetException;
@@ -56,7 +57,8 @@ private CardMsgSender() {
         super("qn_send_card_msg", false, new DexKitTarget[]{
                 CArkAppItemBubbleBuilder.INSTANCE,
                 CFaceDe.INSTANCE,
-                NBaseChatPie_init.INSTANCE
+                NBaseChatPie_init.INSTANCE,
+                CTestStructMsg.INSTANCE
         });
     }
 

File: app/src/main/java/com/hicore/hook/TroopMemberLeaveGreyTip.java
Patch:
@@ -85,7 +85,7 @@ public String[] getUiItemLocation() {
     @Override
     protected boolean initOnce() throws Exception {
         HookUtils.hookBeforeIfEnabled(this,
-                Objects.requireNonNull(DexKit.loadClassFromCache(CSystemMessageProcessor.INSTANCE), "OnlinePushPbPushTransMsg")
+                Objects.requireNonNull(DexKit.loadClassFromCache(COnlinePushPbPushTransMsg.INSTANCE), "OnlinePushPbPushTransMsg")
                         .getDeclaredMethod("a", Initiator.loadClass("com.tencent.mobileqq.app.MessageHandler"),
                                 Initiator.loadClass("com.tencent.qphone.base.remote.ToServiceMsg"),
                                 Initiator.loadClass("com.tencent.qphone.base.remote.FromServiceMsg")),

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -84,6 +84,7 @@ public class QQVersion {
     public static final long QQ_8_9_5 = 3176;
     public static final long QQ_8_9_8 = 3236;
     public static final long QQ_8_9_10 = 3292;
+    public static final long QQ_8_9_10_2 = 3296;
 
     public static final long QQ_8_9_13 = 3350;
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -84,4 +84,6 @@ public class QQVersion {
     public static final long QQ_8_9_5 = 3176;
     public static final long QQ_8_9_8 = 3236;
     public static final long QQ_8_9_10 = 3292;
+
+    public static final long QQ_8_9_13 = 3350;
 }

File: app/src/main/java/cc/ioctl/hook/RepeaterHook.java
Patch:
@@ -64,6 +64,8 @@
 import io.github.qauxv.ui.widget.LinearLayoutDelegate;
 import io.github.qauxv.util.QQVersion;
 import io.github.qauxv.util.Toasts;
+import io.github.qauxv.util.dexkit.CFaceDe;
+import io.github.qauxv.util.dexkit.DexKitTarget;
 import java.lang.reflect.Method;
 import kotlin.Unit;
 import kotlin.jvm.functions.Function1;
@@ -79,7 +81,7 @@ public class RepeaterHook extends BaseFunctionHook {
     public static final RepeaterHook INSTANCE = new RepeaterHook();
 
     private RepeaterHook() {
-        super();
+        super(null, false, new DexKitTarget[]{CFaceDe.INSTANCE});
     }
 
     private IUiItemAgent mUiAgent = null;

File: app/src/main/java/io/github/qauxv/step/ShadowBatchDexDeobfStep.java
Patch:
@@ -49,7 +49,7 @@ public boolean step() {
 
     @Override
     public boolean isDone() {
-        return indexes.length != 0;
+        return indexes.length == 0;
     }
 
     @Override

File: app/src/main/java/com/rymmmmm/hook/DefaultFont.java
Patch:
@@ -77,7 +77,7 @@ public String[] getUiItemLocation() {
 
     @Override
     public boolean isPreparationRequired() {
-        return true;
+        return isNeedFind();
     }
 
     @Nullable
@@ -103,15 +103,15 @@ public boolean initOnce() throws ReflectiveOperationException {
 
     @Override
     public boolean isNeedFind() {
-        return DexKit.getMethodFromCache(DexKit.N_TextItemBuilder_setETText) == null;
+        Log.d("desc: " + DexKit.getMethodDescFromCache(DexKit.N_TextItemBuilder_setETText));
+        return DexKit.getMethodDescFromCache(DexKit.N_TextItemBuilder_setETText) == null;
     }
 
     @Override
     public boolean doFind() {
         if (!DexDeobfsProvider.INSTANCE.isDexKitBackend()) {
             return false;
         }
-        Log.i("doFind");
         // protected (BaseBubbleBuilder, TextItemBuilder).void ?(BaseBubbleBuilder.ViewHolder, ChatMessage)
         Set<Method> candidates = new HashSet<>(2);
         for (Method m : Initiator._TextItemBuilder().getDeclaredMethods()) {

File: app/src/main/java/cc/ioctl/hook/AioChatPieClipPasteHook.java
Patch:
@@ -26,7 +26,6 @@
 import android.content.ClipData.Item;
 import android.content.ClipDescription;
 import android.content.ClipboardManager;
-import android.content.ComponentName;
 import android.content.Context;
 import android.content.Intent;
 import android.graphics.Bitmap;
@@ -46,6 +45,7 @@
 import androidx.core.view.ViewCompat;
 import androidx.core.view.inputmethod.EditorInfoCompat;
 import androidx.core.view.inputmethod.InputConnectionCompat;
+import cc.ioctl.util.HostInfo;
 import cc.ioctl.util.SendCacheUtils;
 import cc.ioctl.util.ui.FaultyDialog;
 import de.robv.android.xposed.XC_MethodHook;
@@ -280,8 +280,9 @@ private static void executeSendMessage(@NonNull Context context, @NonNull Parcel
             FaultyDialog.show(context, e);
             return;
         }
+        var packageManager = context.getPackageManager();
         Intent intent = new Intent();
-        intent.setComponent(new ComponentName(context.getPackageName(), "com.tencent.mobileqq.activity.SplashActivity"));
+        intent.setComponent(packageManager.getLaunchIntentForPackage(HostInfo.getPackageName()).getComponent());
         intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TOP);
         intent.putExtra("forward_from_jump", true);
         intent.putExtra("preAct", "JumpActivity");

File: app/src/main/java/com/rymmmmm/hook/BaseApk.java
Patch:
@@ -122,7 +122,7 @@ protected void afterHookedMethod(MethodHookParam param) throws Throwable {
                                         .replace("%n", applicationInfo.loadLabel(packageManager).toString())
                                         .replace("%p", applicationInfo.packageName)
                                         .replace("%v", packageArchiveInfo.versionName)
-                                        .replace("%c", String.valueOf(BuildConfig.VERSION_CODE));
+                                        .replace("%c", String.valueOf(packageArchiveInfo.versionCode));
                                 param.setResult(result);
                             }
                         }
@@ -158,7 +158,7 @@ protected void afterHookedMethod(MethodHookParam param) throws Throwable {
                                         .replace("%n", applicationInfo.loadLabel(packageManager).toString())
                                         .replace("%p", applicationInfo.packageName)
                                         .replace("%v", packageArchiveInfo.versionName)
-                                        .replace("%c", String.valueOf(BuildConfig.VERSION_CODE));
+                                        .replace("%c", String.valueOf(packageArchiveInfo.versionCode));
                                 fileName.set(item, result);
                             }
                         }

File: app/src/main/java/com/rymmmmm/hook/BaseApk.java
Patch:
@@ -50,6 +50,7 @@
 import kotlin.Unit;
 import kotlin.jvm.functions.Function3;
 import kotlinx.coroutines.flow.MutableStateFlow;
+import io.github.qauxv.BuildConfig;
 
 //重命名base.apk
 @FunctionHookEntry
@@ -121,7 +122,7 @@ protected void afterHookedMethod(MethodHookParam param) throws Throwable {
                                         .replace("%n", applicationInfo.loadLabel(packageManager).toString())
                                         .replace("%p", applicationInfo.packageName)
                                         .replace("%v", packageArchiveInfo.versionName)
-                                        .replace("%c", String.valueOf(HostInfo.getApplication()));
+                                        .replace("%c", String.valueOf(BuildConfig.VERSION_CODE));
                                 param.setResult(result);
                             }
                         }
@@ -157,7 +158,7 @@ protected void afterHookedMethod(MethodHookParam param) throws Throwable {
                                         .replace("%n", applicationInfo.loadLabel(packageManager).toString())
                                         .replace("%p", applicationInfo.packageName)
                                         .replace("%v", packageArchiveInfo.versionName)
-                                        .replace("%c", String.valueOf(HostInfo.getApplication()));
+                                        .replace("%c", String.valueOf(BuildConfig.VERSION_CODE));
                                 fileName.set(item, result);
                             }
                         }

File: app/src/main/java/com/rymmmmm/hook/DefaultFont.java
Patch:
@@ -84,10 +84,11 @@ public boolean initOnce() throws ReflectiveOperationException {
         // 8.9.0 q0
         // 8.9.2 q0
         // 8.9.3 p0
+        // 8.9.10 o0
         Method method = null;
         for (Method m : candidates) {
             String name = m.getName();
-            if ("a".equals(name) || "p0".equals(name) || "q0".equals(name)) {
+            if ("a".equals(name) || "p0".equals(name) || "q0".equals(name) || "o0".equals(name)) {
                 method = m;
                 break;
             }

File: app/src/main/java/io/github/qauxv/startup/HybridClassLoader.java
Patch:
@@ -113,7 +113,9 @@ public static String getXposedBridgeClassName() {
         if (sObfuscatedPackageName == null) {
             return "de.robv.android.xposed.XposedBridge";
         } else {
-            return sObfuscatedPackageName + ".XposedBridge";
+            var sb = new StringBuilder(sObfuscatedPackageName);
+            sb.append(".XposedBridge");
+            return sb.toString();
         }
     }
 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -82,4 +82,5 @@ public class QQVersion {
     public static final long QQ_8_9_2 = 3072;
     public static final long QQ_8_9_3 = 3118;
     public static final long QQ_8_9_5 = 3176;
+    public static final long QQ_8_9_8 = 3236;
 }

File: app/src/main/java/io/github/qauxv/util/dexkit/impl/DexBuilderDexDeobfs.java
Patch:
@@ -111,7 +111,7 @@ public DexMethodDescriptor doFindMethodImpl(int i) {
     }
 
     public static final String ID = "DexBuilder";
-    public static final String NAME = "DexBuilder(更快)";
+    public static final String NAME = "DexBuilder(较快)";
 
     @NonNull
     @Override

File: app/src/main/java/io/github/qauxv/util/dexkit/impl/LegacyDexDeobfs.java
Patch:
@@ -236,7 +236,7 @@ public static ArrayList<Integer> a(byte[] buf, byte[] target) {
     }
 
     public static final String ID = "Legacy";
-    public static final String NAME = "Legacy(默认)";
+    public static final String NAME = "Legacy(兼容性好, 最慢)";
 
     @NonNull
     @Override

File: app/src/main/java/io/github/qauxv/activity/ConfigV2Activity.java
Patch:
@@ -252,6 +252,7 @@ public boolean onCreateOptionsMenu(Menu menu) {
         super.onCreateOptionsMenu(menu);
         if (HostInfo.isInModuleProcess()) {
             getMenuInflater().inflate(R.menu.main_v2_toolbar, menu);
+            updateMenuItems();
         } else {
             getMenuInflater().inflate(R.menu.host_main_v2_options, menu);
         }

File: app/src/main/java/io/github/qauxv/util/dexkit/DexBuilderDexDeobfs.java
Patch:
@@ -51,7 +51,6 @@ private static DexHelper getHelper() {
     @Override
     public DexMethodDescriptor doFindMethodImpl(int i) {
         var ret = DexKit.getMethodDescFromCache(i);
-        Log.d("getMethodDescFromCache" + ret);
         if (ret != null) {
             return ret;
         }
@@ -84,6 +83,7 @@ public DexMethodDescriptor doFindMethodImpl(int i) {
             Log.d("save id: " + i + ",method: " + ret);
             saveDescriptor(i, ret);
         }
+        ret = LegacyDexDeobfs.INSTANCE.doFindMethodImpl(i);
         return ret;
     }
 

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -67,6 +67,7 @@ private DexKit() {
     static final String NO_SUCH_CLASS = "Lio/github/qauxv/util/DexKit$NoSuchClass;";
     public static final DexMethodDescriptor NO_SUCH_METHOD = new DexMethodDescriptor(NO_SUCH_CLASS, "a", "()V");
     public static final String KEY_DEX_DEOBFS_BACKEND_DEXBUILDER = "dex_deobfs_backend_dexbuilder";
+    public static final boolean CFG_DEL_VAL_KEY_DEX_DEOBFS_BACKEND_DEXBUILDER = false;
     static DexHelper helper = null;
 
     //WARN: NEVER change the index!
@@ -156,7 +157,8 @@ public static DexHelper getHelper() {
     }
 
     public static boolean isUseDexBuilderAsBackend() {
-        return ConfigManager.getDefaultConfig().getBoolean(KEY_DEX_DEOBFS_BACKEND_DEXBUILDER, true);
+        return ConfigManager.getDefaultConfig().getBoolean(KEY_DEX_DEOBFS_BACKEND_DEXBUILDER,
+                CFG_DEL_VAL_KEY_DEX_DEOBFS_BACKEND_DEXBUILDER);
     }
 
     /**

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -81,4 +81,5 @@ public class QQVersion {
     public static final long QQ_8_9_1 = 3068;
     public static final long QQ_8_9_2 = 3072;
     public static final long QQ_8_9_3 = 3118;
+    public static final long QQ_8_9_5 = 3176;
 }

File: app/src/main/java/cc/ioctl/dialog/RepeaterIconSettingDialog.java
Patch:
@@ -56,6 +56,7 @@
 import java.io.FileInputStream;
 import java.io.IOException;
 import java.io.InputStream;
+import java.util.Locale;
 
 public class RepeaterIconSettingDialog implements View.OnClickListener,
         DialogInterface.OnClickListener, RadioGroup.OnCheckedChangeListener,
@@ -326,7 +327,7 @@ private void updateBitmapPreview(@NonNull byte[] data) {
         }
         long fileSize = data.length;
         if (fileSize > 16 * 1024) {
-            textViewWarning.setText(String.format("该图片文件体积较大(%dbytes),可能导致卡顿", fileSize));
+            textViewWarning.setText(String.format(Locale.ROOT, "该图片文件体积较大(%dbytes),可能导致卡顿", fileSize));
             textViewWarning.setVisibility(View.VISIBLE);
         } else {
             textViewWarning.setVisibility(View.GONE);

File: app/src/main/java/cc/ioctl/dialog/RikkaBaseApkFormatDialog.java
Patch:
@@ -40,6 +40,7 @@
 import io.github.qauxv.config.ConfigManager;
 import io.github.qauxv.ui.CustomDialog;
 import io.github.qauxv.util.Toasts;
+import java.util.Locale;
 
 public class RikkaBaseApkFormatDialog {
 
@@ -111,7 +112,7 @@ public void afterTextChanged(Editable s) {
                         .replace("%p", HostInfo.PACKAGE_NAME_SELF)
                         .replace("%v", BuildConfig.VERSION_NAME)
                         .replace("%c", String.valueOf(BuildConfig.VERSION_CODE));
-                if (!format.toLowerCase().contains(".apk")) {
+                if (!format.toLowerCase(Locale.ROOT).contains(".apk")) {
                     result += "\n提示:你还没有输入.apk后缀哦";
                 }
                 preview.setText(result);

File: app/src/main/java/cc/ioctl/hook/BlockFluxThief.java
Patch:
@@ -108,7 +108,7 @@ protected boolean initOnce() throws Exception {
                     if (size != -1) {
                         if (size > maxSize) {
                             param.setResult(null);
-                            Toasts.show(null, String.format("已拦截异常图片加载, 大小: %s",
+                            Toasts.show(null, String.format(Locale.ROOT, "已拦截异常图片加载, 大小: %s",
                                     BugUtils.getSizeString(size)));
                         }
                     } else {

File: app/src/main/java/cc/ioctl/hook/FileRecvRedirect.java
Patch:
@@ -49,6 +49,7 @@
 import io.github.qauxv.util.Toasts;
 import java.io.File;
 import java.lang.reflect.Field;
+import java.util.Locale;
 import kotlin.Unit;
 import kotlin.jvm.functions.Function3;
 import kotlinx.coroutines.flow.MutableStateFlow;
@@ -173,7 +174,7 @@ private boolean doSetPath(String str) {
                         field.setAccessible(true);
                         Object value = field.get(null);
                         String path = String.valueOf(value);
-                        if (path.toLowerCase().endsWith("file_recv/")) {
+                        if (path.toLowerCase(Locale.ROOT).endsWith("file_recv/")) {
                             TARGET_FIELD = field;
                             break;
                         }

File: app/src/main/java/cc/ioctl/hook/InterceptZipBomb.java
Patch:
@@ -34,6 +34,7 @@
 import java.io.File;
 import java.lang.reflect.Method;
 import java.util.Enumeration;
+import java.util.Locale;
 import java.util.zip.ZipEntry;
 import java.util.zip.ZipFile;
 
@@ -68,7 +69,7 @@ protected boolean initOnce() throws Exception {
             if (sizeSum >= 104550400 && sizeSum > file.length() * 10) {
                 param.setResult(null);
                 Toasts.show(HostInfo.getApplication(),
-                        String.format("已拦截 %s ,解压后大小异常: %s",
+                        String.format(Locale.ROOT, "已拦截 %s ,解压后大小异常: %s",
                                 file.getPath(), BugUtils.getSizeString(sizeSum)));
             }
         });

File: app/src/main/java/cc/ioctl/hook/JumpController.java
Patch:
@@ -49,6 +49,7 @@
 import java.lang.reflect.Method;
 import java.text.ParseException;
 import java.util.ArrayList;
+import java.util.Locale;
 import java.util.regex.Pattern;
 import kotlin.Unit;
 import kotlin.jvm.functions.Function3;
@@ -98,7 +99,7 @@ public static ArrayList<Rule> parseRules(String rules) throws ParseException {
                 throw new ParseException("expected ',', got " + expr.charAt(1), idx + 1);
             }
             Rule r = new Rule();
-            String verb = expr.substring(0, 1).toUpperCase();
+            String verb = expr.substring(0, 1).toUpperCase(Locale.ROOT);
             switch (verb.charAt(0)) {
                 case 'A':
                     r.verb = JMP_ALLOW;
@@ -120,7 +121,7 @@ public static ArrayList<Rule> parseRules(String rules) throws ParseException {
                 if (condition.charAt(1) != ':') {
                     throw new ParseException("expected ':', got " + condition.charAt(1), idx);
                 }
-                String type = condition.substring(0, 1).toUpperCase();
+                String type = condition.substring(0, 1).toUpperCase(Locale.ROOT);
                 switch (type.charAt(0)) {
                     case 'P': {
                         r.pkg = condition.substring(2);

File: app/src/main/java/cc/ioctl/util/BugUtils.java
Patch:
@@ -22,9 +22,9 @@
 
 package cc.ioctl.util;
 
-import android.annotation.SuppressLint;
 import androidx.annotation.NonNull;
 import java.util.LinkedHashMap;
+import java.util.Locale;
 import java.util.Map;
 
 /**
@@ -57,8 +57,7 @@ public static String getSizeString(long size) {
             long longValue = (Long) entry.getKey();
             String str = (String) entry.getValue();
             if (size >= longValue) {
-                @SuppressLint("DefaultLocale")
-                String format = String.format("%.2f", ((double) size) / ((double) longValue));
+                String format = String.format(Locale.ROOT, "%.2f", ((double) size) / ((double) longValue));
                 int indexOf = format.indexOf(".00");
                 if (indexOf != -1) {
                     return format.substring(0, indexOf) + str;

File: app/src/main/java/com/hicore/dialog/RepeaterPlusIconSettingDialog.java
Patch:
@@ -65,6 +65,7 @@
 import java.io.FileInputStream;
 import java.io.IOException;
 import java.io.InputStream;
+import java.util.Locale;
 
 public class RepeaterPlusIconSettingDialog implements View.OnClickListener,
         DialogInterface.OnClickListener, TextWatcher,
@@ -329,7 +330,7 @@ private void updateBitmapPreview(@NonNull byte[] data) {
         }
         long fileSize = data.length;
         if (fileSize > 16 * 1024) {
-            textViewWarning.setText(String.format("该图片文件体积较大(%dbytes),可能导致卡顿", fileSize));
+            textViewWarning.setText(String.format(Locale.ROOT, "该图片文件体积较大(%dbytes),可能导致卡顿", fileSize));
             textViewWarning.setVisibility(View.VISIBLE);
         } else {
             textViewWarning.setVisibility(View.GONE);

File: app/src/main/java/com/rymmmmm/hook/ShowMsgCount.java
Patch:
@@ -68,7 +68,7 @@ public String[] getUiItemLocation() {
     @Override
     public boolean initOnce() {
         Class<?> kCustomWidgetUtil = DexKit.loadClassFromCache(DexKit.C_CustomWidgetUtil);
-        // target: com.tencent.qqmini.sdk.core.utils.CustomWidgetUtil
+        // target: com.tencent.widget.CustomWidgetUtil
         // com.tencent.qqmini.sdk.core.utils.CustomWidgetUtil is not what we want
         Objects.requireNonNull(kCustomWidgetUtil, "CustomWidgetUtil.class is null");
         Method updateCustomNoteTxt = null;

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -1356,6 +1356,9 @@ private static DexMethodDescriptor verifyTargetMethod(int i, HashSet<DexMethodDe
             case C_CustomWidgetUtil:
                 a:
                 for (DexMethodDescriptor m : __methods) {
+                    if (m.declaringClass.contains("/") && !m.declaringClass.contains("com/tencent/widget")) {
+                        continue;
+                    }
                     Class<?> clz = Initiator.load(m.declaringClass);
                     if (clz.isEnum()) {
                         continue;

File: app/src/main/java/io/github/qauxv/bridge/ContactUtils.java
Patch:
@@ -132,7 +132,7 @@ public static String getBuddyName(@NonNull AppRuntime app, @NonNull String uin)
             return null;
         }
         try {
-            return (String) getBuddyName.invoke(null, app, uin);
+            return (String) getBuddyName.invoke(null, app, uin, false);
         } catch (IllegalAccessException e) {
             // should not happen
             Log.e(e);

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -1647,7 +1647,7 @@ private static DexMethodDescriptor verifyTargetMethod(int i, HashSet<DexMethodDe
                 try {
                     Method method = m.getMethodInstance(Initiator.getHostClassLoader());
                     if (method.getReturnType() == String.class && Modifier.isStatic(method.getModifiers())
-                            && method.getParameterTypes().length == 2) {
+                            && method.getParameterTypes().length == 3) {
                         return m;
                     }
                 } catch (NoSuchMethodException e) {

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -1513,14 +1513,14 @@ private static DexMethodDescriptor verifyTargetMethod(int i, HashSet<DexMethodDe
                 break;
             case N_Conversation_onCreate:
                 for (DexMethodDescriptor m : __methods) {
-                    if (m.declaringClass.endsWith("Conversation")) {
+                    if (m.declaringClass.contains("Conversation")) {
                         return m;
                     }
                 }
                 break;
             case N_QQSettingMe_onResume:
                 for (DexMethodDescriptor m : __methods) {
-                    if (m.declaringClass.endsWith("QQSettingMe")) {
+                    if (m.declaringClass.contains("QQSettingMe")) {
                         return m;
                     }
                 }

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -80,4 +80,5 @@ public class QQVersion {
     public static final long QQ_8_9_0 = 3060;
     public static final long QQ_8_9_1 = 3068;
     public static final long QQ_8_9_2 = 3072;
+    public static final long QQ_8_9_3 = 3118;
 }

File: app/src/main/java/com/hicore/messageUtils/QQMsgSender.java
Patch:
@@ -8,6 +8,7 @@
 import com.hicore.ReflectUtil.MField;
 import com.hicore.ReflectUtil.MMethod;
 import com.hicore.Utils.FileUtils;
+import com.hicore.Utils.QClasses;
 import io.github.qauxv.util.Initiator;
 import io.github.qauxv.util.Log;
 import io.github.qauxv.util.QQVersion;
@@ -138,7 +139,7 @@ public static void sendReply(Object _Session, Object replyRecord) {
                 Method mMethod = MMethod.FindMethod("com.tencent.mobileqq.replymsg.d", null, void.class, new Class[]{
                         MClass.loadClass("com.tencent.mobileqq.app.QQAppInterface"),
                         MClass.loadClass("com.tencent.mobileqq.data.ChatMessage"),
-                        Initiator._BaseSessionInfo(),
+                        QClasses._BaseSessionInfo(),
                         int.class,
                         int.class,
                         boolean.class

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -876,9 +876,7 @@ public static byte[][] b(int i) {
                         0x74, 0x20, 0x69, 0x6E, 0x66, 0x6F, 0x20, 0x69, 0x73, 0x20, 0x6E, 0x75,
                         0x6C, 0x6C}};
             case N_Conversation_onCreate:
-                return new byte[][]{
-                    new byte[]{0x0F, 0x52, 0x65, 0x63, 0x65, 0x6E, 0x74, 0x5F, 0x4F, 0x6E, 0x43,
-                        0x72, 0x65, 0x61, 0x74, 0x65}};
+                return new byte[][]{forFiniteString8("Recent_OnCreate")};
             case N_QQSettingMe_onResume:
                 return new byte[][]{
                     new byte[]{

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -78,4 +78,6 @@ public class QQVersion {
     public static final long QQ_8_8_93 = 2886;
     public static final long QQ_8_8_98 = 3002;
     public static final long QQ_8_9_0 = 3060;
+    public static final long QQ_8_9_1 = 3068;
+    public static final long QQ_8_9_2 = 3072;
 }

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -1544,7 +1544,9 @@ private static DexMethodDescriptor a(int i, HashSet<DexMethodDescriptor> __metho
                 // only 1 expected
                 if (__methods.size() == 1) {
                     DexMethodDescriptor m = __methods.iterator().next();
-                    if (m.declaringClass.contains("TroopAppShortcutBarHelper")) {
+                    if (m.declaringClass.contains("TroopAppShortcutBarHelper")
+                            || m.declaringClass.contains("ShortcutBarAIOHelper")
+                            || m.declaringClass.contains("/aio/helper/")) {
                         return m;
                     }
                 }

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -1013,7 +1013,7 @@ public static int[] d(int i) {
             case N_AtPanel__showDialogAtView:
                 return new int[]{12, 10, 4};
             case C_CustomWidgetUtil:
-                return new int[]{5, 4, 9};
+                return new int[]{20, 5, 4, 9};
             case C_ClockInEntryHelper:
                 return new int[]{6, 2};
             case C_CaptureUtil:
@@ -1374,7 +1374,7 @@ private static DexMethodDescriptor a(int i, HashSet<DexMethodDescriptor> __metho
             case C_CustomWidgetUtil:
                 a:
                 for (DexMethodDescriptor m : __methods) {
-                    Class clz = Initiator.load(m.declaringClass);
+                    Class<?> clz = Initiator.load(m.declaringClass);
                     if (clz.isEnum()) {
                         continue;
                     }

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -1263,6 +1263,7 @@ private static DexMethodDescriptor a(int i, HashSet<DexMethodDescriptor> __metho
             case N_LeftSwipeReply_Helper__reply:
             case N_FriendChatPie_updateUITitle:
             case N_VipUtils_getUserStatus:
+            case C_VipStatusManagerImpl:
                 // NOTICE: this must only has one result
                 if (__methods.size() == 1) {
                     return (DexMethodDescriptor) __methods.toArray()[0];

File: app/src/main/java/cc/ioctl/hook/GagInfoDisclosure.java
Patch:
@@ -54,7 +54,7 @@ public class GagInfoDisclosure extends CommonSwitchFunctionHook {
     private GagInfoDisclosure() {
         // TODO: 2020/6/12 Figure out whether MSF is really needed
         super(SyncUtils.PROC_MAIN | SyncUtils.PROC_MSF,
-                new int[]{DexKit.C_MSG_REC_FAC});
+                new int[]{DexKit.C_MessageRecordFactory});
     }
 
     public static String getGagTimeString(long sec) {

File: app/src/main/java/cc/ioctl/hook/RevokeMsgHook.java
Patch:
@@ -71,7 +71,7 @@ public class RevokeMsgHook extends CommonSwitchFunctionHook {
     private RevokeMsgHook() {
         //FIXME: is MSF really necessary?
         super(SyncUtils.PROC_MAIN | SyncUtils.PROC_MSF,
-                new int[]{DexKit.C_MSG_REC_FAC, DexKit.C_CONTACT_UTILS});
+                new int[]{DexKit.C_MessageRecordFactory, DexKit.C_CONTACT_UTILS});
     }
 
     @NonNull
@@ -248,7 +248,7 @@ private Object createBareHighlightGreyTip(String entityUin, int istroop, String
             throws Exception {
         int msgtype = -2030;// MessageRecord.MSG_TYPE_TROOP_GAP_GRAY_TIPS
         Object messageRecord = Reflex.invokeStaticDeclaredOrdinalModifier(
-                DexKit.doFindClass(DexKit.C_MSG_REC_FAC), 0, 1, true, Modifier.PUBLIC, 0, msgtype,
+                DexKit.doFindClass(DexKit.C_MessageRecordFactory), 0, 1, true, Modifier.PUBLIC, 0, msgtype,
                 int.class);
         callMethod(messageRecord, "init", AppRuntimeHelper.getAccount(), entityUin, fromUin, msg,
                 time,
@@ -263,7 +263,7 @@ private Object createBarePlainGreyTip(String entityUin, int istroop, String from
                                           String msg, long msgUid, long shmsgseq) throws Exception {
         int msgtype = -2031;// MessageRecord.MSG_TYPE_REVOKE_GRAY_TIPS
         Object messageRecord = Reflex.invokeStaticDeclaredOrdinalModifier(
-                DexKit.doFindClass(DexKit.C_MSG_REC_FAC), 0, 1, true, Modifier.PUBLIC, 0, msgtype,
+                DexKit.doFindClass(DexKit.C_MessageRecordFactory), 0, 1, true, Modifier.PUBLIC, 0, msgtype,
                 int.class);
         callMethod(messageRecord, "init", AppRuntimeHelper.getAccount(), entityUin, fromUin, msg,
                 time,

File: app/src/main/java/io/github/qauxv/bridge/GreyTipBuilder.java
Patch:
@@ -76,7 +76,7 @@ public Object build(String uin, int istroop, String fromUin, long time, long msg
         Object messageRecord = null;
         try {
             messageRecord = Reflex.invokeStaticDeclaredOrdinalModifier(
-                DexKit.doFindClass(DexKit.C_MSG_REC_FAC), 0, 1, true, Modifier.PUBLIC, 0, type,
+                DexKit.doFindClass(DexKit.C_MessageRecordFactory), 0, 1, true, Modifier.PUBLIC, 0, type,
                 int.class);
             callMethod(messageRecord, "init", AppRuntimeHelper.getAccount(), uin, fromUin, msg.toString(),
                 time, type, istroop, msgseq);
@@ -99,7 +99,7 @@ public Object build(String uin, int istroop, String fromUin, long time, long msg
         Object messageRecord = null;
         try {
             messageRecord = Reflex.invokeStaticDeclaredOrdinalModifier(
-                DexKit.doFindClass(DexKit.C_MSG_REC_FAC), 0, 1, true, Modifier.PUBLIC, 0, type,
+                DexKit.doFindClass(DexKit.C_MessageRecordFactory), 0, 1, true, Modifier.PUBLIC, 0, type,
                 int.class);
             callMethod(messageRecord, "init", AppRuntimeHelper.getAccount(), uin, fromUin, msg.toString(),
                 time, type, istroop, msgseq);

File: app/src/main/java/com/hicore/hook/UploadTransparentAvatar.java
Patch:
@@ -81,7 +81,7 @@ protected void beforeHookedMethod(MethodHookParam param) {
             }
         });
         var methodName = HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "i" : "a";
-        var clazzName = HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "com.tencent.mobileqq.pic.compress.e" : "com.tencent.mobileqq.pic.compress.Utils";
+        var clazzName = HostInfo.requireMinQQVersion(QQVersion.QQ_8_9_0) ? "com.tencent.mobileqq.pic.compress.e" : "com.tencent.mobileqq.pic.compress.Utils";
         Method hookMethod = Reflex.findMethod(Initiator.loadClass(clazzName),
                 boolean.class, methodName, String.class, Bitmap.class, int.class, String.class,
                 Initiator.loadClass("com.tencent.mobileqq.pic.CompressInfo"));

File: app/src/main/java/com/hicore/hook/UploadTransparentAvatar.java
Patch:
@@ -51,7 +51,7 @@ private UploadTransparentAvatar() {
     @NonNull
     @Override
     public String getName() {
-        return "允许上传透明头像和表情";
+        return "允许上传透明头像和表情,上传不成功可尝试开启非会员贴表情";
     }
 
     @NonNull
@@ -76,7 +76,8 @@ protected void beforeHookedMethod(MethodHookParam param) {
             }
         });
         var methodName = HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "i" : "a";
-        Method hookMethod = Reflex.findMethod(Initiator.loadClass("com.tencent.mobileqq.pic.compress.Utils"),
+        var clazzName = HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "com.tencent.mobileqq.pic.compress.e" : "com.tencent.mobileqq.pic.compress.Utils";
+        Method hookMethod = Reflex.findMethod(Initiator.loadClass(clazzName),
                 boolean.class, methodName, String.class, Bitmap.class, int.class, String.class,
                 Initiator.loadClass("com.tencent.mobileqq.pic.CompressInfo"));
         HookUtils.hookBeforeAlways(this, hookMethod, param -> {

File: app/src/main/java/cc/ioctl/hook/ContactListSortHook.java
Patch:
@@ -80,6 +80,9 @@ protected boolean initOnce() throws ReflectiveOperationException {
         fFriends_lastLoginType = Reflex.findField(kFriends, long.class, "lastLoginType");
         mFriends_getFriendNick = Reflex.findMethod(kFriends, String.class, "getFriendNick");
         Class<?> kBuddyListItem = Initiator.load("com.tencent.mobileqq.activity.contacts.base.BuddyListItem");
+        if (kBuddyListItem == null) {
+            kBuddyListItem = Initiator.load("com.tencent.mobileqq.activity.contacts.base.c");
+        }
         if (kBuddyListItem == null) {
             kBuddyListItem = Initiator.loadClass("com.tencent.mobileqq.adapter.contacts.BuddyListItem");
         }

File: app/src/main/java/com/rymmmmm/hook/CustomSplash.java
Patch:
@@ -116,6 +116,7 @@ public boolean initOnce() throws Exception {
         HookUtils.hookBeforeIfEnabled(this, open, 53, param -> {
             String fileName = (String) param.args[0];
             if ("splash.jpg".equals(fileName)
+                    || "splash.png".equals(fileName)
                     || "splash_big.jpg".equals(fileName)
                     || "splash/splash_simple.png".equals(fileName)
                     || "splash/splash_big_simple.png".equals(fileName)) {

File: app/src/main/java/cc/ioctl/util/Reflex.java
Patch:
@@ -880,7 +880,7 @@ public static Object invokeStatic(Class<?> staticClass, String name, Object... a
      * @throws InvocationTargetException if the method throws an exception
      */
     @Nullable
-    public static Object invokeNonVirtual(@NonNull Object obj, @NonNull Method m, Object[] args)
+    public static Object invokeNonVirtual(@NonNull Object obj, @NonNull Method m, Object... args)
             throws IllegalArgumentException, InvocationTargetException {
         Objects.requireNonNull(obj, "obj is null");
         Objects.requireNonNull(m, "m is null");

File: app/src/main/java/io/github/qauxv/util/QQVersion.java
Patch:
@@ -76,4 +76,5 @@ public class QQVersion {
     public static final long QQ_8_8_88 = 2770;
     public static final long QQ_8_8_90 = 2828;
     public static final long QQ_8_8_93 = 2886;
+    public static final long QQ_8_8_98 = 3002;
 }

File: app/src/main/java/cc/ioctl/fragment/FriendListExportFragment.java
Patch:
@@ -418,7 +418,7 @@ public Function1<IUiItemAgent, String> getTitleProvider() {
 
         @Nullable
         @Override
-        public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+        public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
             return (agent, ctx) -> "支持 CSV/JSON 格式";
         }
 

File: app/src/main/java/cc/ioctl/hook/AddAccount.java
Patch:
@@ -108,7 +108,7 @@ public Function1<IUiItemAgent, String> getTitleProvider() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+    public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/CheckCommonGroup.java
Patch:
@@ -113,7 +113,7 @@ public Function1<IUiItemAgent, String> getTitleProvider() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+    public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/ContactListSortHook.java
Patch:
@@ -205,7 +205,7 @@ public Function1<IUiItemAgent, String> getTitleProvider() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+    public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/DefaultBubbleHook.java
Patch:
@@ -170,7 +170,7 @@ public Function1<IUiItemAgent, String> getTitleProvider() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+    public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/FakeBatteryHook.java
Patch:
@@ -407,7 +407,7 @@ public Function1<IUiItemAgent, String> getTitleProvider() {
 
         @Nullable
         @Override
-        public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+        public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
             return null;
         }
 

File: app/src/main/java/cc/ioctl/hook/OpenProfileCard.java
Patch:
@@ -171,7 +171,7 @@ public Function1<IUiItemAgent, String> getTitleProvider() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+    public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/RepeaterHook.java
Patch:
@@ -138,7 +138,7 @@ public MutableStateFlow<String> getValueState() {
                 }
 
                 @Override
-                public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+                public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
                     return (agent, context) -> "点击设置自定义+1图标";
                 }
 

File: app/src/main/java/com/hicore/hook/RepeaterPlus.java
Patch:
@@ -125,7 +125,7 @@ public MutableStateFlow<String> getValueState() {
                 }
 
                 @Override
-                public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
+                public Function2<IUiItemAgent, Context, CharSequence> getSummaryProvider() {
                     return (agent, context) -> "点击设置自定义+1图标";
                 }
 

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -1391,10 +1391,11 @@ private static DexMethodDescriptor a(int i, HashSet<DexMethodDescriptor> __metho
                     if ("onCardUpdate".equals(method.getName())) {
                         return m;
                     }
-                    if (method.getClass().isAssignableFrom(Initiator.load("com.tencent.mobileqq.profilecard.vas.VasProfileTemplateController"))) {
+                    Class<?> kVasProfileTemplateController = Initiator.load("com.tencent.mobileqq.profilecard.vas.VasProfileTemplateController");
+                    if (kVasProfileTemplateController != null && method.getDeclaringClass().isAssignableFrom(kVasProfileTemplateController)) {
                         return m;
                     }
-                    if (method.getClass().isAssignableFrom(Initiator._FriendProfileCardActivity())) {
+                    if (method.getDeclaringClass().isAssignableFrom(Initiator._FriendProfileCardActivity())) {
                         return m;
                     }
                 }

File: app/src/main/java/cc/ioctl/hook/MutePokePacket.java
Patch:
@@ -51,7 +51,7 @@ public String getName() {
     @NonNull
     @Override
     public String[] getUiItemLocation() {
-        return Simplify.MAIN_UI_MSG;
+        return Simplify.UI_CHAT_MSG;
     }
 
     @Override

File: app/src/main/java/com/rymmmmm/hook/DisableDropSticker.java
Patch:
@@ -52,7 +52,7 @@ public String getName() {
     @NonNull
     @Override
     public String[] getUiItemLocation() {
-        return Simplify.MAIN_UI_MSG;
+        return Simplify.UI_CHAT_MSG;
     }
 
     @Override

File: app/src/main/java/com/rymmmmm/hook/CustomMsgTimeFormat.java
Patch:
@@ -27,12 +27,14 @@
 import androidx.annotation.Nullable;
 import cc.ioctl.dialog.RikkaCustomMsgTimeFormatDialog;
 import cc.ioctl.util.HookUtils;
+import cc.ioctl.util.HostInfo;
 import io.github.qauxv.base.IUiItemAgent;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
 import io.github.qauxv.dsl.FunctionEntryRouter.Locations.Auxiliary;
 import io.github.qauxv.hook.CommonConfigFunctionHook;
 import io.github.qauxv.util.DexKit;
+import io.github.qauxv.util.QQVersion;
 import java.lang.reflect.Method;
 import java.lang.reflect.Modifier;
 import java.text.SimpleDateFormat;
@@ -87,7 +89,7 @@ public Function3<IUiItemAgent, Activity, View, Unit> getOnUiItemClickListener()
     public boolean initOnce() {
         for (Method m : DexKit.doFindClass(DexKit.C_TimeFormatterUtils).getDeclaredMethods()) {
             Class<?>[] argt = m.getParameterTypes();
-            if (m.getName().equals("a") && Modifier.isStatic(m.getModifiers())
+            if (m.getName().equals(HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "e" : "a") && Modifier.isStatic(m.getModifiers())
                     && argt.length == 3 && argt[2] == long.class) {
                 HookUtils.hookBeforeIfEnabled(this, m, param -> {
                     String result = formatTime((long) param.args[2]);

File: app/src/main/java/io/github/qauxv/bridge/QQMessageFacade.java
Patch:
@@ -87,8 +87,8 @@ public static void revokeMessage(Object msg) throws Exception {
             Reflex.invokeVirtual(msgCache, methodName, true, boolean.class, void.class);
             if (HostInfo.requireMinQQVersion(QQVersion.QQ_8_6_0)) {
                 Reflex.invokeVirtualDeclaredFixedModifierOrdinal(mgr, Modifier.PUBLIC, 0,
-                        Initiator._BaseMessageManager(), HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? 5 : 4, 7, true, msg2, Initiator._MessageRecord(),
-                        void.class);
+                    Initiator._BaseMessageManager(), 4, 7, true, msg2, Initiator._MessageRecord(),
+                    void.class);
             } else {
                 Reflex.invokeVirtualDeclaredFixedModifierOrdinal(mgr, Modifier.PUBLIC, 0,
                     Initiator._BaseMessageManager(), 2, 4, true, msg2, Initiator._MessageRecord(),

File: app/src/main/java/io/github/qauxv/bridge/QQMessageFacade.java
Patch:
@@ -87,8 +87,8 @@ public static void revokeMessage(Object msg) throws Exception {
             Reflex.invokeVirtual(msgCache, methodName, true, boolean.class, void.class);
             if (HostInfo.requireMinQQVersion(QQVersion.QQ_8_6_0)) {
                 Reflex.invokeVirtualDeclaredFixedModifierOrdinal(mgr, Modifier.PUBLIC, 0,
-                    Initiator._BaseMessageManager(), 4, 7, true, msg2, Initiator._MessageRecord(),
-                    void.class);
+                        Initiator._BaseMessageManager(), HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? 5 : 4, 7, true, msg2, Initiator._MessageRecord(),
+                        void.class);
             } else {
                 Reflex.invokeVirtualDeclaredFixedModifierOrdinal(mgr, Modifier.PUBLIC, 0,
                     Initiator._BaseMessageManager(), 2, 4, true, msg2, Initiator._MessageRecord(),

File: app/src/main/java/io/github/qauxv/bridge/QQMessageFacade.java
Patch:
@@ -79,8 +79,8 @@ public static void revokeMessage(Object msg) throws Exception {
             t -= 1 + 10f * Math.random();
             Reflex.setInstanceObject(msg2, "time", t);
             Object msgCache = Reflex.invokeVirtualAny(getQQAppInterface(),
-                DexKit.doFindClass(DexKit.C_MessageCache));
-            String methodName = "b"; //Default method name for QQ
+                    DexKit.doFindClass(DexKit.C_MessageCache));
+            String methodName = HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "z2" : "b"; //Default method name for QQ
             if (HostInfo.isTim()) {
                 methodName = ConfigTable.INSTANCE.getConfig(QQMessageFacade.class.getSimpleName());
             }

File: app/src/main/java/com/hicore/hook/TroopMemberLeaveGreyTip.java
Patch:
@@ -35,7 +35,6 @@
 import io.github.qauxv.dsl.FunctionEntryRouter;
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import io.github.qauxv.util.Initiator;
-import io.github.qauxv.util.Log;
 import java.lang.reflect.Method;
 import java.util.ArrayList;
 import java.util.Objects;
@@ -110,7 +109,7 @@ private static void onProcessGroupSystemMsg(int msgPosUnused, Object structMsg,
 //                actionUin = 1;
 //            }
 //        }
-        Log.d("onOnlinePushPbPushTransMsg actionUin=" + actionUin + ", userUin=" + userUin + ", troopUin=" + troopUin + ", msgType=" + msgType);
+//        Log.d("onOnlinePushPbPushTransMsg actionUin=" + actionUin + ", userUin=" + userUin + ", troopUin=" + troopUin + ", msgType=" + msgType);
         commitTroopMemberLeaveGreyTip(troopUin, userUin, 3, actionUin);
     }
 
@@ -141,7 +140,7 @@ private static void onOnlinePushPbPushTransMsg(Object msgHandler, Object toServi
             byte opType = msgData[9];
             long opUin = getLongData(msgData, 10);
 
-            Log.d("onProcessGroupSystemMsg troopUin=" + troopUin + ", memberUin=" + memberUin + ", opType=" + opType + ", opUin=" + opUin);
+//            Log.d("onProcessGroupSystemMsg troopUin=" + troopUin + ", memberUin=" + memberUin + ", opType=" + opType + ", opUin=" + opUin);
             commitTroopMemberLeaveGreyTip(troopUin, memberUin, opType, opUin);
         }
     }

File: app/src/main/java/cc/ioctl/hook/FileShareExtHook.java
Patch:
@@ -131,7 +131,7 @@ protected boolean initOnce() throws Exception {
             Reflex.setInstanceObject(item, "argus", String.class, filePath);
             row2.add(item);
         });
-        return false;
+        return true;
     }
 
     private final XC_MethodHook mItemClickHandler = HookUtils.afterIfEnabled(this, param -> {

File: app/src/main/java/com/hicore/hook/RepeaterPlus.java
Patch:
@@ -49,6 +49,7 @@
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
 import io.github.qauxv.dsl.FunctionEntryRouter.Locations.Auxiliary;
 import io.github.qauxv.hook.BaseFunctionHook;
+import io.github.qauxv.util.Log;
 import io.github.qauxv.util.QQVersion;
 import java.util.List;
 import java.util.concurrent.atomic.AtomicReference;
@@ -179,7 +180,7 @@ public boolean initOnce() throws Exception {
                     RepeaterHelper.createRepeatIcon(finalBaseChatItem, ChatMsg, session);
                     finalBaseChatItem.getViewTreeObserver().removeOnGlobalLayoutListener(listenerContainer.get());
                 } catch (Exception e) {
-                    e.printStackTrace();
+                    Log.e(e);
                 }
             });
 

File: app/src/main/java/com/hicore/hook/RepeaterHelper.java
Patch:
@@ -74,7 +74,6 @@ public static void createRepeatIcon(RelativeLayout baseChatItem, Object ChatMsg,
             } else {
                 imageButton.setVisibility(View.VISIBLE);
                 imageButton.setTag(ChatMsg);
-                imageButton.setImageBitmap(RepeaterPlusIconSettingDialog.getRepeaterIcon());
 
             }
             RelativeLayout.LayoutParams param = (RelativeLayout.LayoutParams) imageButton.getLayoutParams();

File: app/src/main/java/com/rymmmmm/hook/DisableEnterEffect.java
Patch:
@@ -57,8 +57,8 @@ public String[] getUiItemLocation() {
     @Override
     public boolean initOnce() {
         for (Method m : Initiator._TroopEnterEffectController().getDeclaredMethods()) {
-            if (m.getName().equals("a") && !Modifier.isStatic(m.getModifiers())
-                && m.getReturnType() == void.class) {
+            if ((m.getName().equals("a") || m.getName().equals("l")) && !Modifier.isStatic(m.getModifiers())
+                    && m.getParameterTypes().length == 0 && m.getReturnType() == void.class) {
                 HookUtils.hookBeforeIfEnabled(this, m, param -> param.setResult(null));
                 return true;
             }

File: app/src/main/java/com/hicore/hook/ShowGuildData.java
Patch:
@@ -26,12 +26,14 @@
 import android.widget.RelativeLayout;
 import androidx.annotation.NonNull;
 import cc.ioctl.util.HookUtils;
+import cc.ioctl.util.HostInfo;
 import cc.ioctl.util.Reflex;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
 import io.github.qauxv.dsl.FunctionEntryRouter;
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import io.github.qauxv.util.Initiator;
+import io.github.qauxv.util.QQVersion;
 
 @FunctionHookEntry
 @UiItemAgentEntry
@@ -58,7 +60,7 @@ public String[] getUiItemLocation() {
     protected boolean initOnce() throws Exception {
         HookUtils.hookAfterIfEnabled(this,
                 Initiator.loadClass("com.tencent.mobileqq.guild.setting.popup.GuildMainSettingDialogFragment")
-                        .getDeclaredMethod("o"),
+                        .getDeclaredMethod(HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "mk" : "o"),
                 param -> {
                     View v = Reflex.getInstanceObject(param.thisObject, "o", RelativeLayout.class);
                     v.setVisibility(View.VISIBLE);

File: app/src/main/java/io/github/qauxv/bridge/ChatActivityFacade.java
Patch:
@@ -37,6 +37,7 @@
 import io.github.qauxv.util.DexKit;
 import io.github.qauxv.util.Initiator;
 import io.github.qauxv.util.Log;
+import io.github.qauxv.util.QQVersion;
 import io.github.qauxv.util.Toasts;
 import java.io.Externalizable;
 import java.io.File;
@@ -268,7 +269,8 @@ public static void repeatMessage(@NonNull AppRuntime app, @NonNull Parcelable se
             case "MessageForPic":
                 try {
                     for (Method mi : DexKit.doFindClass(DexKit.C_FACADE).getMethods()) {
-                        if (!mi.getName().equals("a") && !mi.getName().equals("b")) {
+                        if (!mi.getName().equals("a") && !mi.getName().equals("b")
+                                && (!mi.getName().equals("o0") && !HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93))) {
                             continue;
                         }
                         argt = mi.getParameterTypes();

File: app/src/main/java/com/rymmmmm/hook/DefaultFont.java
Patch:
@@ -60,7 +60,7 @@ public String[] getUiItemLocation() {
     @Override
     public boolean initOnce() {
         for (Method m : Initiator._TextItemBuilder().getDeclaredMethods()) {
-            if (m.getName().equals(HostInfo.requireMinPlayQQVersion(QQVersion.QQ_8_8_93) ? "m0" : "a")
+            if (m.getName().equals(HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "q0" : "a")
                     && !Modifier.isStatic(m.getModifiers())
                     && m.getReturnType() == void.class) {
                 Class<?>[] argt = m.getParameterTypes();

File: app/src/main/java/cc/ioctl/hook/CheatHook.java
Patch:
@@ -62,7 +62,8 @@ private CheatHook() {
 
     @Override
     protected boolean initOnce() throws Exception {
-        XposedHelpers.findAndHookMethod(DexKit.doFindClass(DexKit.C_PNG_FRAME_UTIL), "a", int.class,
+        var method = HostInfo.requireMinQQVersion(QQVersion.QQ_8_8_93) ? "d" : "a";
+        XposedHelpers.findAndHookMethod(DexKit.doFindClass(DexKit.C_PNG_FRAME_UTIL), method, int.class,
                 new XC_MethodHook(43) {
                     @Override
                     protected void afterHookedMethod(MethodHookParam param) {

File: app/src/main/java/com/hicore/hook/RepeaterPlus.java
Patch:
@@ -161,7 +161,7 @@ public boolean initOnce() throws Exception {
             if (context.getClass().getName().contains("MultiForwardActivity")) {
                 return;
             }
-            List MessageRecoreList = MField.GetField(param.thisObject, "a", List.class);
+            List MessageRecoreList = MField.GetFirstField(param.thisObject, List.class);
             if (MessageRecoreList == null) {
                 return;
             }

File: app/src/main/java/com/hicore/messageUtils/QQMessageUtils.java
Patch:
@@ -14,11 +14,11 @@ public static void AddAndSendMsg(Object MessageRecord) {
         try {
             Object MessageFacade = MMethod.CallMethodNoParam(QQEnvUtils.getAppRuntime(), "getMessageFacade",
                     MClass.loadClass("com.tencent.imcore.message.QQMessageFacade"));
-            Method mMethod = MMethod.FindMethod("com.tencent.imcore.message.BaseQQMessageFacade", "a", void.class, new Class[]{
+            Method mMethod = MMethod.FindMethod("com.tencent.imcore.message.BaseQQMessageFacade", null, void.class, new Class[]{
                     MClass.loadClass("com.tencent.mobileqq.data.MessageRecord"),
-                    MClass.loadClass("com.tencent.mobileqq.app.BusinessObserver")
+                    MClass.loadClass("com.tencent.mobileqq.app.BusinessObserver"),boolean.class
             });
-            mMethod.invoke(MessageFacade, MessageRecord, null);
+            mMethod.invoke(MessageFacade, MessageRecord, null,false);
         } catch (Exception e) {
         }
 

File: app/src/main/java/cc/ioctl/hook/FlashPicHook.java
Patch:
@@ -93,7 +93,7 @@ public boolean initOnce() throws Exception {
         for (Method mi : clz.getDeclaredMethods()) {
             if (mi.getReturnType().equals(boolean.class) && mi.getParameterTypes().length == 1) {
                 String name = mi.getName();
-                if (name.equals("a") || name.equals("z") || name.equals("W")) {
+                if (name.equals("c") || name.equals("a") || name.equals("z") || name.equals("W")) {
                     isFlashPic = mi;
                     break;
                 }

File: app/src/main/java/cc/ioctl/hook/HideQFSRedPointTips.java
Patch:
@@ -69,8 +69,7 @@ protected boolean initOnce() throws Exception {
         Class<?> kQFSRedPointTipsHelper = Initiator.loadClass("com.tencent.mobileqq.activity.qcircle.utils.QFSRedPointTipsHelper");
         Method showTips = null;
         for (Method method : kQFSRedPointTipsHelper.getDeclaredMethods()) {
-            if (method.getName().equals("a") && method.getParameterTypes().length == 3
-                    && !Modifier.isStatic(method.getModifiers())) {
+            if (method.getParameterTypes().length == 3 && !Modifier.isStatic(method.getModifiers())) {
                 showTips = method;
                 break;
             }

File: app/src/main/java/com/hicore/hook/ShowAccurateGaggedTime.java
Patch:
@@ -69,8 +69,8 @@ protected boolean initOnce() throws Exception {
                     param.setResult(secondToTime(time));
                 });
 
-        HookUtils.hookBeforeIfEnabled(this, Reflex.findMethod(Initiator._TroopGagMgr(),
-                String.class, "a", Context.class, long.class, long.class), param -> {
+        HookUtils.hookBeforeIfEnabled(this, Reflex.findSingleMethod(Initiator._TroopGagMgr(),
+                String.class, false, Context.class, long.class, long.class), param -> {
             long time = (long) param.args[1];
             if (time <= 0) {
                 param.setResult("[0秒]");

File: app/src/main/java/com/hicore/hook/IgnorePhoneCallState.java
Patch:
@@ -25,6 +25,7 @@
 import android.content.Context;
 import androidx.annotation.NonNull;
 import cc.ioctl.util.HookUtils;
+import cc.ioctl.util.Reflex;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
 import io.github.qauxv.dsl.FunctionEntryRouter;
@@ -63,8 +64,8 @@ protected boolean initOnce() throws Exception {
                 param -> param.setResult(false));
 
         HookUtils.hookBeforeIfEnabled(this,
-                Initiator.loadClass("com.tencent.av.camera.QavCameraUsage")
-                        .getDeclaredMethod("a", Context.class, boolean.class),
+                Reflex.findSingleMethod(Initiator.loadClass("com.tencent.av.camera.QavCameraUsage"),
+                        boolean.class, false, Context.class, boolean.class),
                 param -> param.setResult(false));
         return true;
     }

File: app/src/main/java/cc/ioctl/hook/GalleryBgHook.java
Patch:
@@ -25,6 +25,7 @@
 import android.view.ViewGroup;
 import androidx.annotation.NonNull;
 import cc.ioctl.util.HookUtils;
+import cc.ioctl.util.Reflex;
 import io.github.qauxv.SyncUtils;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
@@ -79,7 +80,7 @@ public boolean initOnce() throws Exception {
             // com.tencent.mobileqq.activity.aio.photo.AIOGalleryActivity
             // source code from: ColorQQ by qiwu
             Class<?> kAbstractGalleryScene = DexKit.doFindClass(DexKit.C_ABS_GAL_SCENE);
-            Method m = kAbstractGalleryScene.getDeclaredMethod("a", ViewGroup.class);
+            Method m = Reflex.findSingleMethod(kAbstractGalleryScene, void.class, false, ViewGroup.class);
             Field fv = null;
             for (Field f : kAbstractGalleryScene.getDeclaredFields()) {
                 if (f.getType().equals(View.class)) {

File: app/src/main/java/cc/ioctl/hook/SharePicExtHook.java
Patch:
@@ -107,7 +107,7 @@ protected boolean initOnce() throws Exception {
         Class<?> kiv2OnItemClickListener = Initiator.loadClass("com.tencent.mobileqq.widget.share.ShareActionSheet$OnItemClickListener");
         // using kv3OnItemClickListenerV2 = com.tencent.mobileqq.widget.share.ShareActionSheet.OnItemClickListenerV2
         Method miv2OnItemClick = kiv2OnItemClickListener.getDeclaredMethod("onItemClick", kActionSheetItem, kiShareActionSheet);
-        Method showActionSheetForPic = kAIOPictureView.getDeclaredMethod("a",
+        Method showActionSheetForPic = Reflex.findSingleMethod(kAIOPictureView, void.class, false,
                 Initiator.loadClass("com.tencent.mobileqq.richmediabrowser.model.AIOPictureData"),
                 Initiator.loadClass("com.tencent.richmediabrowser.model.RichMediaBrowserInfo")
         );

File: app/src/main/java/cc/ioctl/dialog/RikkaBaseApkFormatDialog.java
Patch:
@@ -29,7 +29,6 @@
 import android.view.LayoutInflater;
 import android.view.View;
 import android.widget.CheckBox;
-import android.widget.CompoundButton;
 import android.widget.LinearLayout;
 import android.widget.TextView;
 import androidx.annotation.NonNull;

File: app/src/main/java/io/github/qauxv/core/HookInstaller.java
Patch:
@@ -61,9 +61,6 @@ public static int getHookIndex(@NonNull IDynamicHook hook) {
     }
 
     public static void allowEarlyInit(@NonNull IDynamicHook hook) {
-        if (hook == null) {
-            return;
-        }
         try {
             if (hook.isTargetProcess() && hook.isEnabled() && !hook.isPreparationRequired() && !hook.isInitialized()) {
                 hook.initialize();

File: app/src/main/java/cc/ioctl/hook/InterceptZipBomb.java
Patch:
@@ -65,7 +65,7 @@ protected boolean initOnce() throws Exception {
                 sizeSum += entries.nextElement().getSize();
             }
             zipFile.close();
-            if (sizeSum >= 104550400) {
+            if (sizeSum >= 104550400 && sizeSum > file.length() * 10) {
                 param.setResult(null);
                 Toasts.show(HostInfo.getApplication(),
                         String.format("已拦截 %s ,解压后大小异常: %s",

File: app/src/main/java/com/hicore/hook/RepeaterPlus.java
Patch:
@@ -129,7 +129,7 @@ public Function2<IUiItemAgent, Context, String> getSummaryProvider() {
                 @NonNull
                 @Override
                 public Function1<IUiItemAgent, String> getTitleProvider() {
-                    return agent -> "消息+1Plus";
+                    return agent -> "消息+1 Plus";
                 }
             };
         }

File: app/src/main/java/cc/ioctl/hook/CardMsgSender.java
Patch:
@@ -99,7 +99,7 @@ public boolean doDecorate(@NonNull String text,
             long uin = AppRuntimeHelper.getLongAccountUin();
             if (uin < 10000) {
                 Toasts.error(ctx1, "Invalid account uin");
-                return true;
+                return false;
             }
             SyncUtils.async(() -> {
                 if (text.contains("<?xml")) {
@@ -143,8 +143,9 @@ public boolean doDecorate(@NonNull String text,
                     }
                 }
             });
+            return true;
         }
-        return true;
+        return false;
     }
 
     @SuppressWarnings("JavaJniMissingFunction")

File: app/src/main/java/com/rymmmmm/hook/DisablePokeEffect.java
Patch:
@@ -61,7 +61,7 @@ public boolean initOnce() {
             if (m.getName().equals("a") && argt.length == 3 && !Modifier.isStatic(m.getModifiers())) {
                 HookUtils.hookBeforeIfEnabled(this, m, param -> {
                     // param.setResult(null);// 此处不应为null
-                    if (param.getResult().getClass().isPrimitive()) {// 判断是boolean (基本类型)
+                    if (((Method) param.method).getReturnType() == boolean.class) {// 判断是boolean (基本类型)
                         param.setResult(false);
                     }
                 });

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -62,7 +62,7 @@ public static Class<?> load(String className) {
         if (sPluginParentClassLoader == null || className == null || className.isEmpty()) {
             return null;
         }
-        if (className.contains("/")) {
+        if (className.endsWith(";") || className.contains("/")) {
             className = className.replace('/', '.');
             if (className.endsWith(";")) {
                 if (className.charAt(0) == 'L') {

File: app/src/main/java/com/hicore/hook/TroopMemberLeaveGreyTip.java
Patch:
@@ -119,6 +119,9 @@ private static void onOnlinePushPbPushTransMsg(Object msgHandler, Object toServi
         }
         Object pbMsgInfo = Initiator.loadClass("com.tencent.pb.onlinepush.OnlinePushTrans$PbMsgInfo").newInstance();
         byte[] wupBuffer = (byte[]) Reflex.invokeVirtual(toServiceMsg, "getWupBuffer", byte[].class);
+        if (wupBuffer == null || wupBuffer.length == 0) {
+            return;
+        }
         byte[] body = new byte[wupBuffer.length - 4];
         System.arraycopy(wupBuffer, 4, body, 0, body.length);
         Reflex.invokeVirtual(pbMsgInfo, "mergeFrom", body, byte[].class, Initiator.loadClass("com.tencent.mobileqq.pb.MessageMicro"));

File: app/src/main/java/com/hicore/hook/UploadTransparentAvatar.java
Patch:
@@ -49,7 +49,7 @@ private UploadTransparentAvatar() {
     @NonNull
     @Override
     public String getName() {
-        return "运行上传透明头像";
+        return "允许上传透明头像";
     }
 
     @NonNull

File: app/src/main/java/cc/ioctl/hook/FileRecvRedirect.java
Patch:
@@ -62,7 +62,7 @@ public class FileRecvRedirect extends CommonConfigFunctionHook {
     private Field TARGET_FIELD = null;
 
     private FileRecvRedirect() {
-        super(SyncUtils.PROC_MAIN, new int[]{DexKit.C_APP_CONSTANTS});
+        super(SyncUtils.PROC_ANY & ~(SyncUtils.PROC_MSF | SyncUtils.PROC_UNITY | SyncUtils.PROC_MINI), new int[]{DexKit.C_APP_CONSTANTS});
     }
 
     @NonNull

File: app/src/main/java/io/github/qauxv/startup/HybridClassLoader.java
Patch:
@@ -51,7 +51,7 @@ public static boolean isConflictingClass(String name) {
             || name.startsWith("kotlin.") || name.startsWith("kotlinx.")
             || name.startsWith("com.tencent.mmkv.")
             || name.startsWith("com.android.tools.r8.")
-            || name.startsWith("com.google.android.material.")
+            || name.startsWith("com.google.android.")
             || name.startsWith("com.google.gson.")
             || name.startsWith("com.google.common.")
             || name.startsWith("com.microsoft.appcenter.")

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -252,7 +252,8 @@ public static Class<? extends AppRuntime> _QQAppInterface() {
     }
 
     public static Class<?> _BaseQQAppInterface() {
-        return load("com.tencent.common.app.business.BaseQQAppInterface");
+        Class<?> ref = load("com.tencent.common.app.business.BaseQQAppInterface");
+        return ref == null ? _QQAppInterface() : ref;
     }
 
     public static Class<?> _BaseMessageManager() {

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -252,7 +252,7 @@ public static Class<? extends AppRuntime> _QQAppInterface() {
     }
 
     public static Class<?> _BaseQQAppInterface() {
-        return load("com/tencent/mobileqq/app/BaseQQAppInterface");
+        return load("com.tencent.common.app.business.BaseQQAppInterface");
     }
 
     public static Class<?> _BaseMessageManager() {

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -1361,6 +1361,8 @@ private static DexMethodDescriptor a(int i, HashSet<DexMethodDescriptor> __metho
             case C_ClockInEntryHelper:
             case C_FaceManager:
             case C_AvatarUtil:
+            case N_AtPanel__refreshUI:
+            case N_AtPanel__showDialogAtView:
                 for (DexMethodDescriptor m : __methods) {
                     Class clz = Initiator.load(m.declaringClass);
                     if (clz.isEnum()) {
@@ -1379,8 +1381,6 @@ private static DexMethodDescriptor a(int i, HashSet<DexMethodDescriptor> __metho
             case C_IntimateDrawer:
             case C_HttpDownloader:
             case C_MultiMsg_Manager:
-            case N_AtPanel__refreshUI:
-            case N_AtPanel__showDialogAtView:
             case C_AIOPictureView:
                 //has superclass
                 for (DexMethodDescriptor m : __methods) {

File: app/src/main/java/io/github/qauxv/util/Initiator.java
Patch:
@@ -232,7 +232,7 @@ public static Class<?> _C2CMessageProcessor() {
 
     public static Class<?> _C2CMessageManager() {
         return findClassWithSynthetics("com/tencent/imcore/message/C2CMessageManager",
-                "com/tencent/mobileqq/app/message/C2CMessageManager");
+                "com/tencent/mobileqq/app/message/C2CMessageManager", 1, 2);
     }
 
     public static Class<?> _AllInOne() {

File: app/src/main/java/io/github/qauxv/util/DexKit.java
Patch:
@@ -322,7 +322,7 @@ public static DexMethodDescriptor doFindMethodFromNative(int i) {
             String str = new String(Arrays.copyOfRange(key, 1, key.length));
             Log.d("doFindMethodFromNative: id " + i + ", key:" + str);
             long[] ms = helper.findMethodUsingString(
-                    str, true, -1, (short) 0, null, -1,
+                    str, true, -1, (short) -1, null, -1,
                     null, null, null, false);
             for (long methodIndex : ms) {
                 Executable m = helper.decodeMethodIndex(methodIndex);

File: app/src/main/java/cc/ioctl/hook/AioChatPieClipPasteHook.java
Patch:
@@ -127,10 +127,10 @@ protected void beforeHookedMethod(MethodHookParam param) {
                     .getDeclaredMethod("onCreateInputConnection", EditorInfo.class);
             XposedBridge.hookMethod(m2, new XC_MethodHook() {
                 @Override
-                protected void beforeHookedMethod(MethodHookParam param) {
+                protected void afterHookedMethod(MethodHookParam param) {
                     EditText editText = (EditText) param.thisObject;
                     EditorInfo outAttrs = (EditorInfo) param.args[0];
-                    InputConnection ic = editText.onCreateInputConnection(outAttrs);
+                    InputConnection ic = (InputConnection) param.getResult();
 
                     // On SDK 30 and below, we manually configure the InputConnection here to use
                     // ViewCompat.performReceiveContent. On S and above, the platform's BaseInputConnection

File: app/src/main/java/cc/ioctl/hook/AioChatPieClipPasteHook.java
Patch:
@@ -123,7 +123,7 @@ protected void beforeHookedMethod(MethodHookParam param) {
             }
         });
         if (Build.VERSION.SDK_INT <= Build.VERSION_CODES.R) {
-            Method m2 = Initiator.loadClass("com.tencent.widget.XEditTextEx")
+            Method m2 = Initiator.loadClass("com.tencent.widget.XEditText")
                     .getDeclaredMethod("onCreateInputConnection", EditorInfo.class);
             XposedBridge.hookMethod(m2, new XC_MethodHook() {
                 @Override

File: app/src/main/java/io/github/qauxv/util/CustomMenu.java
Patch:
@@ -38,7 +38,7 @@ public static Object createItem(Class<?> clazz, int id, String title, int icon)
                 //no direct constructor, reflex
                 Object item = createItem(clazz, id, title);
                 Field f;
-                f = Reflex.findField(clazz, int.class, "b");
+                f = Reflex.findFieldOrNull(clazz, int.class, "b");
                 if (f == null) {
                     f = Reflex.findField(clazz, int.class, "icon");
                 }
@@ -65,13 +65,13 @@ public static Object createItem(Class<?> clazz, int id, String title) throws Ref
         }
         item = clazz.newInstance();
         Field f;
-        f = Reflex.findField(clazz, int.class, "id");
+        f = Reflex.findFieldOrNull(clazz, int.class, "id");
         if (f == null) {
             f = Reflex.findField(clazz, int.class, "a");
         }
         f.setAccessible(true);
         f.set(item, id);
-        f = Reflex.findField(clazz, String.class, "title");
+        f = Reflex.findFieldOrNull(clazz, String.class, "title");
         if (f == null) {
             f = Reflex.findField(clazz, String.class, "a");
         }

File: app/src/main/java/cc/ioctl/hook/SharePicExtHook.java
Patch:
@@ -44,6 +44,7 @@
 import io.github.qauxv.dsl.FunctionEntryRouter;
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import io.github.qauxv.lifecycle.Parasitics;
+import io.github.qauxv.ui.ResUtils;
 import io.github.qauxv.util.Initiator;
 import io.github.qauxv.util.Log;
 import io.github.qauxv.util.Toasts;
@@ -156,8 +157,9 @@ protected boolean initOnce() throws Exception {
                 assert row2 != null;
                 Object item = ctorActionSheetItem.newInstance();
                 Parasitics.injectModuleResources(ctx.getResources());
+                int drawableId = ResUtils.isInNightMode() ? R.drawable.ic_launch_28dp_night : R.drawable.ic_launch_28dp_light;
                 Reflex.setInstanceObject(item, "id", int.class, R.id.ShareActionSheet_sharePictureWithExtApp);
-                Reflex.setInstanceObject(item, "icon", int.class, R.drawable.ic_launch_28dp_grey);
+                Reflex.setInstanceObject(item, "icon", int.class, drawableId);
                 Reflex.setInstanceObject(item, "label", String.class, "其他应用");
                 Reflex.setInstanceObject(item, "argus", String.class, picFile.getAbsolutePath());
                 row2.add(item);

File: app/src/main/java/cc/ioctl/hook/RepeaterHook.java
Patch:
@@ -25,6 +25,7 @@
 import static cc.ioctl.util.Reflex.getFirstNSFByType;
 import static cc.ioctl.util.Reflex.setInstanceObject;
 import static io.github.qauxv.util.Initiator._PicItemBuilder;
+import static io.github.qauxv.util.Initiator._PttItemBuilder;
 import static io.github.qauxv.util.Initiator._QQAppInterface;
 import static io.github.qauxv.util.Initiator._SessionInfo;
 import static io.github.qauxv.util.Initiator._TextItemBuilder;
@@ -341,7 +342,7 @@ public void afterHookedMethod(XC_MethodHook.MethodHookParam param) {
         }
         //end: text
         //begin: ptt
-        Method pttMethod = _TextItemBuilder().getDeclaredMethod("a",
+        Method pttMethod = _PttItemBuilder().getDeclaredMethod("a",
                 ChatMessage, itemHolder, View.class, BaseChatItemLayout, listener2);
         HookUtils.hookAfterIfEnabled(this, pttMethod, 51, param -> {
             ViewGroup convertView = (ViewGroup) param.getResult();

File: app/src/main/java/io/github/qauxv/util/consis/StartupDirectorBridge.java
Patch:
@@ -108,8 +108,6 @@ private void callActivityOnCreate() {
      * @return true if the host is in splash screen
      */
     public boolean onActivityCreate(@NonNull Activity activity, @Nullable Intent intent) {
-        Log.d("onActivityCreate: " + activity.getClass().getName() + ", mStartupFinished=" + mStartupFinished
-                + ", mNeedInterceptStartActivity=" + mNeedInterceptStartActivity);
         if (mStartupFinished || !mNeedInterceptStartActivity) {
             return false;
         }

File: app/src/main/java/cc/ioctl/fragment/ChatTailFragment.java
Patch:
@@ -60,14 +60,14 @@
 import com.tencent.mobileqq.widget.BounceScrollView;
 import io.github.qauxv.R;
 import io.github.qauxv.config.ConfigManager;
-import io.github.qauxv.fragment.BaseSettingFragment;
+import io.github.qauxv.fragment.BaseClipSettingFragment;
 import io.github.qauxv.util.Log;
 import io.github.qauxv.util.Toasts;
 import java.text.SimpleDateFormat;
 import java.util.Date;
 import me.kyuubiran.util.UtilsKt;
 
-public class ChatTailFragment extends BaseSettingFragment implements View.OnClickListener {
+public class ChatTailFragment extends BaseClipSettingFragment implements View.OnClickListener {
 
     public static final String delimiter = "#msg#";
     private static int battery = 0;
@@ -98,7 +98,7 @@ public String getTitle() {
 
     @Nullable
     @Override
-    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,
+    public View doOnCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,
             @Nullable Bundle savedInstanceState) {
         Context context = requireContext();
         if (!FakeBatteryHook.INSTANCE.isEnabled()) {

File: app/src/main/java/cc/ioctl/fragment/ExfriendListFragment.java
Patch:
@@ -54,7 +54,7 @@
 import io.github.qauxv.R;
 import io.github.qauxv.bridge.AppRuntimeHelper;
 import io.github.qauxv.bridge.FaceImpl;
-import io.github.qauxv.fragment.BaseSettingFragment;
+import io.github.qauxv.fragment.BaseClipSettingFragment;
 import io.github.qauxv.ui.CustomDialog;
 import io.github.qauxv.ui.ResUtils;
 import io.github.qauxv.util.Log;
@@ -64,7 +64,7 @@
 import java.util.Map;
 import java.util.concurrent.ConcurrentHashMap;
 
-public class ExfriendListFragment extends BaseSettingFragment {
+public class ExfriendListFragment extends BaseClipSettingFragment {
 
     private static final int R_ID_EXL_TITLE = 0x300AFF01;
     private static final int R_ID_EXL_SUBTITLE = 0x300AFF02;
@@ -104,7 +104,7 @@ public String getTitle() {
 
     @Nullable
     @Override
-    public View onCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,
+    public View doOnCreateView(@NonNull LayoutInflater inflater, @Nullable ViewGroup container,
             @Nullable Bundle savedInstanceState) {
         Context context = inflater.getContext();
         try {

File: app/src/main/java/io/github/qauxv/util/hookstatus/HookStatus.java
Patch:
@@ -202,7 +202,7 @@ public static boolean checkABI() {
         int moduleABI = getModuleABI();
         HashMap<String, String> hostABI = getHostABI();
         for (String i : hostABI.values()) {
-            if ((AbiUtils.archStringToArchInt(i) & moduleABI) != moduleABI) {
+            if ((AbiUtils.archStringToArchInt(i) | moduleABI) != moduleABI) {
                 return false;
             }
         }

File: app/src/main/java/io/github/qauxv/util/hookstatus/AbiUtils.java
Patch:
@@ -152,11 +152,11 @@ public static int archStringToArchInt(@NonNull String arch) {
     public static String archIntToArchString(int arch) {
         switch (arch) {
             case 1:
-                return "arm32";
+                return "arm32, armAll, universal";
             case 1 << 1:
-                return "arm64";
+                return "arm64, armAll, universal";
             case 1 << 1 + 1:
-                return "armAll";
+                return "armAll, universal";
             default:
                 return "universal";
         }

File: app/src/main/java/cc/ioctl/hook/DeletionObserver.java
Patch:
@@ -126,8 +126,7 @@ protected void beforeHookedMethod(MethodHookParam param) throws Throwable {
                     Log.e(e);
                 }
                 rell.addView(exfriend, exlp);
-                RelativeLayout.LayoutParams dotlp = new RelativeLayout.LayoutParams(WRAP_CONTENT,
-                    WRAP_CONTENT);
+                RelativeLayout.LayoutParams dotlp = new RelativeLayout.LayoutParams(WRAP_CONTENT, WRAP_CONTENT);
                 dotlp.topMargin = 0;
                 dotlp.rightMargin = LayoutHelper.dip2px(splashActivity, 24);
                 dotlp.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);

File: app/src/main/java/cc/ioctl/hook/MultiForwardAvatarHook.java
Patch:
@@ -36,9 +36,9 @@
 import cc.ioctl.util.HostStyledViewBuilder;
 import cc.ioctl.util.LayoutHelper;
 import cc.ioctl.util.Reflex;
-import io.github.qauxv.core.MainHook;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
+import io.github.qauxv.core.MainHook;
 import io.github.qauxv.dsl.FunctionEntryRouter.Locations.Auxiliary;
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import io.github.qauxv.ui.CustomDialog;
@@ -120,7 +120,7 @@ private static void createAndShowDialogForTroop(final Context __ctx, final Objec
         String senderuin = (String) Reflex.getInstanceObjectOrNull(msg, "senderuin");
         String frienduin = (String) Reflex.getInstanceObjectOrNull(msg, "frienduin");
         HostStyledViewBuilder.newDialogClickableItemClickToCopy(ctx, "群号", frienduin, ll, true,
-                v -> OpenProfileCard.openTroopCard(__ctx, frienduin));
+                v -> OpenProfileCard.openTroopProfileActivity(__ctx, frienduin));
         HostStyledViewBuilder.newDialogClickableItemClickToCopy(ctx, "成员", senderuin, ll, true,
                 v -> {
                     try {

File: app/src/main/java/cc/ioctl/util/HostStyledViewBuilder.java
Patch:
@@ -137,9 +137,6 @@ public static LinearLayout newDialogClickableItem(final Context ctx, String titl
         if (ll != null) {
             v.setOnLongClickListener(ll);
         }
-        if (l != null || ll != null) {
-            ViewCompat.setBackground(v, getDialogClickableItemBackground());
-        }
         if (attach) {
             vg.addView(root);
         }

File: app/src/main/java/io/github/qauxv/activity/AppCompatTransferActivity.java
Patch:
@@ -65,8 +65,10 @@ protected void requestTranslucentStatusBar() {
         View decorView = window.getDecorView();
         int option = decorView.getSystemUiVisibility()
                 | View.SYSTEM_UI_FLAG_LAYOUT_STABLE
-                | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN;
+                | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN
+                | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION;
         decorView.setSystemUiVisibility(option);
         window.setStatusBarColor(Color.TRANSPARENT);
+        window.setNavigationBarColor(Color.TRANSPARENT);
     }
 }

File: app/src/main/java/io/github/qauxv/activity/AppCompatTransferActivity.java
Patch:
@@ -65,8 +65,10 @@ protected void requestTranslucentStatusBar() {
         View decorView = window.getDecorView();
         int option = decorView.getSystemUiVisibility()
                 | View.SYSTEM_UI_FLAG_LAYOUT_STABLE
-                | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN;
+                | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN
+                | View.SYSTEM_UI_FLAG_LAYOUT_HIDE_NAVIGATION;
         decorView.setSystemUiVisibility(option);
         window.setStatusBarColor(Color.TRANSPARENT);
+        window.setNavigationBarColor(Color.TRANSPARENT);
     }
 }

File: app/src/main/java/com/rymmmmm/hook/CustomMsgTimeFormat.java
Patch:
@@ -84,7 +84,8 @@ public Function3<IUiItemAgent, Activity, View, Unit> getOnUiItemClickListener()
     public boolean initOnce() {
         for (Method m : DexKit.doFindClass(DexKit.C_TimeFormatterUtils).getDeclaredMethods()) {
             Class<?>[] argt = m.getParameterTypes();
-            if (m.getName().equals("a") && argt.length == 3 && Modifier.isStatic(m.getModifiers())) {
+            if (m.getName().equals("a") && Modifier.isStatic(m.getModifiers())
+                    && argt.length == 3 && argt[2] == long.class) {
                 HookUtils.hookBeforeIfEnabled(this, m, param -> {
                     String fmt = RikkaCustomMsgTimeFormatDialog.getCurrentMsgTimeFormat();
                     if (fmt != null) {

File: app/src/main/java/io/github/qauxv/core/MainHook.java
Patch:
@@ -24,6 +24,7 @@
 import android.content.Context;
 import android.content.Intent;
 import android.os.Parcelable;
+import cc.ioctl.hook.FileRecvRedirect;
 import cc.ioctl.hook.GagInfoDisclosure;
 import cc.ioctl.hook.MuteAtAllAndRedPacket;
 import cc.ioctl.hook.MuteQZoneThumbsUp;
@@ -123,6 +124,7 @@ protected void afterHookedMethod(MethodHookParam param) {
         HookInstaller.allowEarlyInit(CustomSplash.INSTANCE);
         HookInstaller.allowEarlyInit(RemoveCameraButton.INSTANCE);
         HookInstaller.allowEarlyInit(RemoveSuperQQShow.INSTANCE);
+        HookInstaller.allowEarlyInit(FileRecvRedirect.INSTANCE);
         if (SyncUtils.isMainProcess()) {
             ConfigItems.removePreviousCacheIfNecessary();
             injectStartupHookForMain(ctx);

File: app/src/main/java/cc/ioctl/dialog/RikkaCustomDeviceModelDialog.java
Patch:
@@ -39,6 +39,7 @@
 import io.github.qauxv.config.ConfigManager;
 import io.github.qauxv.ui.CustomDialog;
 import io.github.qauxv.util.Toasts;
+import java.io.File;
 
 public class RikkaCustomDeviceModelDialog {
 
@@ -186,6 +187,8 @@ public void afterTextChanged(Editable s) {
                         cfg.putString(rq_custom_device_manufacturer, currentDeviceManufacturer);
                         cfg.putString(rq_custom_device_model, currentDeviceModel);
                     }
+                    //移除缓存文件
+                    new File(ctx.getCacheDir().getParent()+"/app_x5webview/Default/Local Storage/leveldb","MANIFEST-000001").delete();
                     cfg.save();
                     Toasts.success(ctx, "重启" + HostInfo.getAppName() + "生效!");
                     dialog.dismiss();

File: app/src/main/java/cc/ioctl/dialog/RikkaCustomDeviceModelDialog.java
Patch:
@@ -39,6 +39,7 @@
 import io.github.qauxv.config.ConfigManager;
 import io.github.qauxv.ui.CustomDialog;
 import io.github.qauxv.util.Toasts;
+import java.io.File;
 
 public class RikkaCustomDeviceModelDialog {
 
@@ -186,6 +187,8 @@ public void afterTextChanged(Editable s) {
                         cfg.putString(rq_custom_device_manufacturer, currentDeviceManufacturer);
                         cfg.putString(rq_custom_device_model, currentDeviceModel);
                     }
+                    //移除缓存文件
+                    new File(ctx.getCacheDir().getParent()+"/app_x5webview/Default/Local Storage/leveldb","MANIFEST-000001").delete();
                     cfg.save();
                     Toasts.success(ctx, "重启" + HostInfo.getAppName() + "生效!");
                     dialog.dismiss();

File: app/src/main/java/cn/lliiooll/msg/MessageManager.java
Patch:
@@ -37,6 +37,8 @@ public class MessageManager {
         RegexAntiMeg.INSTANCE,
         AntiMessage.INSTANCE,
     };
+    public static Class<?> intType = int.class;
+    public static Class<?> booleanType = boolean.class;
 
     /**
      * 通过这里广播拦截的消息

File: app/src/main/java/cn/lliiooll/msg/MessageManager.java
Patch:
@@ -37,6 +37,8 @@ public class MessageManager {
         RegexAntiMeg.INSTANCE,
         AntiMessage.INSTANCE,
     };
+    public static Class<?> intType = int.class;
+    public static Class<?> booleanType = boolean.class;
 
     /**
      * 通过这里广播拦截的消息

File: app/src/main/java/io/github/qauxv/core/MainHook.java
Patch:
@@ -44,7 +44,6 @@
 import java.lang.reflect.Method;
 import java.lang.reflect.Modifier;
 import me.kyuubiran.hook.RemoveCameraButton;
-import me.kyuubiran.hook.RemoveRedDot;
 
 /*TitleKit:Lcom/tencent/mobileqq/widget/navbar/NavBarCommon*/
 
@@ -122,7 +121,6 @@ protected void afterHookedMethod(MethodHookParam param) {
         HookInstaller.allowEarlyInit(GagInfoDisclosure.INSTANCE);
         HookInstaller.allowEarlyInit(CustomSplash.INSTANCE);
         HookInstaller.allowEarlyInit(RemoveCameraButton.INSTANCE);
-        HookInstaller.allowEarlyInit(RemoveRedDot.INSTANCE);
         if (SyncUtils.isMainProcess()) {
             ConfigItems.removePreviousCacheIfNecessary();
             injectStartupHookForMain(ctx);

File: app/src/main/java/cc/ioctl/hook/JumpController.java
Patch:
@@ -316,7 +316,7 @@ protected ArrayList<Rule> reloadRuleList() {
     }
 
     public int getEffectiveRulesCount() {
-        if (isEnabled() && isInitialized()) {
+        if (isEnabled()) {
             return getRuleList().size();
         } else {
             return -1;

File: app/src/main/java/cc/ioctl/hook/InterceptZipBomb.java
Patch:
@@ -78,12 +78,12 @@ protected boolean initOnce() throws Exception {
     @NonNull
     @Override
     public String getName() {
-        return "拦截异常体积图片加载";
+        return "拦截资料卡异常体积压缩包";
     }
 
     @NonNull
     @Override
     public String[] getUiItemLocation() {
-        return Auxiliary.MESSAGE_CATEGORY;
+        return Auxiliary.PROFILE_CATEGORY;
     }
 }

File: app/src/main/java/io/github/qauxv/config/ConfigItems.java
Patch:
@@ -179,7 +179,7 @@ public static void removePreviousCacheIfNecessary() {
         }
         ConfigManager cache = ConfigManager.getCache();
         if (cache.getIntOrDefault(cache_qn_prev_version, -1) < BuildConfig.VERSION_CODE) {
-            cache.getFile().delete();
+            cache.clear();
             cache.putInt(cache_qn_prev_version, BuildConfig.VERSION_CODE);
             cache.save();
         }

File: app/src/main/java/io/github/qauxv/ui/CommonContextWrapper.java
Patch:
@@ -104,7 +104,7 @@ public Resources getResources() {
 
     @NonNull
     public static CommonContextWrapper createAppCompatContext(@NonNull Context base) {
-        return new CommonContextWrapper(base, R.style.Theme_AppCompat_DayNight,
+        return new CommonContextWrapper(base, androidx.appcompat.R.style.Theme_AppCompat_DayNight,
             recreateNighModeConfig(base, ResUtils.getNightModeMasked()));
     }
 

File: app/src/main/java/io/github/qauxv/lifecycle/CounterfeitActivityInfoFactory.java
Patch:
@@ -35,13 +35,14 @@
 public class CounterfeitActivityInfoFactory {
 
     @Nullable
-    public static ActivityInfo makeProxyActivityInfo(@NonNull String className, int flags) {
+    public static ActivityInfo makeProxyActivityInfo(@NonNull String className, long flags) {
         try {
             Context ctx = HostInfo.getApplication();
             Class<?> cl = Class.forName(className);
             try {
+                // TODO: 2022-02-11 cast flags from long to int loses information
                 ActivityInfo proto = ctx.getPackageManager().getActivityInfo(new ComponentName(
-                    ctx.getPackageName(), "com.tencent.mobileqq.activity.QQSettingSettingActivity"), flags);
+                        ctx.getPackageName(), "com.tencent.mobileqq.activity.QQSettingSettingActivity"), (int) flags);
                 // init style here, comment it out if it crashes on Android >= 10
                 proto.theme = R.style.Theme_MaiTungTMDesign;
                 return initCommon(proto, className);

File: app/src/main/java/cc/ioctl/hook/AddAccount.java
Patch:
@@ -46,7 +46,6 @@
 import io.github.qauxv.util.Toasts;
 import java.io.File;
 import java.io.IOException;
-import java.util.List;
 import kotlin.Unit;
 import kotlin.jvm.functions.Function1;
 import kotlin.jvm.functions.Function2;
@@ -149,7 +148,7 @@ public Function3<IUiItemAgent, Activity, View, Unit> getOnClickListener() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, List<String>> getExtraSearchKeywordProvider() {
+    public Function2<IUiItemAgent, Context, String[]> getExtraSearchKeywordProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/CheckCommonGroup.java
Patch:
@@ -154,7 +154,7 @@ public Function3<IUiItemAgent, Activity, View, Unit> getOnClickListener() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, List<String>> getExtraSearchKeywordProvider() {
+    public Function2<IUiItemAgent, Context, String[]> getExtraSearchKeywordProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/DefaultBubbleHook.java
Patch:
@@ -192,7 +192,7 @@ public Function3<IUiItemAgent, Activity, View, Unit> getOnClickListener() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, List<String>> getExtraSearchKeywordProvider() {
+    public Function2<IUiItemAgent, Context, String[]> getExtraSearchKeywordProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/FakeBatteryHook.java
Patch:
@@ -456,7 +456,7 @@ public Function3<IUiItemAgent, Activity, View, Unit> getOnClickListener() {
 
         @Nullable
         @Override
-        public Function2<IUiItemAgent, Context, List<String>> getExtraSearchKeywordProvider() {
+        public Function2<IUiItemAgent, Context, String[]> getExtraSearchKeywordProvider() {
             return null;
         }
     };

File: app/src/main/java/cc/ioctl/hook/FakeVipHook.java
Patch:
@@ -31,7 +31,6 @@
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import io.github.qauxv.util.DexKit;
 import io.github.qauxv.util.Log;
-import java.util.List;
 
 @FunctionHookEntry
 @UiItemAgentEntry
@@ -87,7 +86,7 @@ public String getDescription() {
 
     @Nullable
     @Override
-    public List<String> getExtraSearchKeywords() {
-        return List.of("VIP", "SVIP", "贴表情", "贴收藏表情");
+    public String[] getExtraSearchKeywords() {
+        return new String[]{"VIP", "SVIP", "贴表情", "贴收藏表情"};
     }
 }

File: app/src/main/java/cc/ioctl/hook/OpenProfileCard.java
Patch:
@@ -181,7 +181,7 @@ public Function3<IUiItemAgent, Activity, View, Unit> getOnClickListener() {
 
     @Nullable
     @Override
-    public Function2<IUiItemAgent, Context, List<String>> getExtraSearchKeywordProvider() {
+    public Function2<IUiItemAgent, Context, String[]> getExtraSearchKeywordProvider() {
         return null;
     }
 

File: app/src/main/java/cc/ioctl/hook/RepeaterHook.java
Patch:
@@ -58,7 +58,6 @@
 import io.github.qauxv.ui.widget.LinearLayoutDelegate;
 import io.github.qauxv.util.Toasts;
 import java.lang.reflect.Method;
-import java.util.List;
 import kotlin.Unit;
 import kotlin.jvm.functions.Function1;
 import kotlin.jvm.functions.Function2;
@@ -101,8 +100,8 @@ public boolean isCheckable() {
                 };
 
                 @Override
-                public Function2<IUiItemAgent, Context, List<String>> getExtraSearchKeywordProvider() {
-                    return (agent, context) -> List.of("复读机", "+1");
+                public Function2<IUiItemAgent, Context, String[]> getExtraSearchKeywordProvider() {
+                    return (agent, context) -> new String[]{"复读机", "+1"};
                 }
 
                 @Override

File: app/src/main/java/io/github/qauxv/startup/StartupRoutine.java
Patch:
@@ -53,6 +53,7 @@ public static void execPostStartupInit(Context ctx, Object step, String lpwReser
         EzXHelperInit.INSTANCE.initHandleLoadPackage(HookEntry.getLoadPackageParam());
         // resource injection is done somewhere else, do not init it here
         EzXHelperInit.INSTANCE.initAppContext(ctx, false, false);
+        EzXHelperInit.INSTANCE.setLogTag("QAuxv");
         HostInfo.init((Application) ctx);
         Initiator.init(ctx.getClassLoader());
         try {

File: app/src/main/java/io/github/qauxv/core/InjectDelayableHooks.java
Patch:
@@ -157,7 +157,7 @@ public static boolean step(@NonNull Object director) {
                         if (!h.isPreparationRequired()) {
                             h.initialize();
                         } else {
-                            Log.e("InjectDelayableHooks/E not init " + h + " ,since checkPreconditions == false");
+                            Log.e("InjectDelayableHooks/E not init " + h + ", checkPreconditions == false");
                         }
                     }
                 } catch (Throwable e) {

File: app/src/main/java/io/github/qauxv/core/MainHook.java
Patch:
@@ -132,8 +132,7 @@ protected void afterHookedMethod(MethodHookParam param) {
             Class loadData = Initiator.load("com/tencent/mobileqq/startup/step/LoadData");
             Method doStep = null;
             for (Method method : loadData.getDeclaredMethods()) {
-                if (method.getReturnType().equals(boolean.class)
-                    && method.getParameterTypes().length == 0) {
+                if (method.getReturnType().equals(boolean.class) && method.getParameterTypes().length == 0) {
                     doStep = method;
                     break;
                 }

File: app/src/main/java/io/github/qauxv/router/dispacher/InputButtonHookDispatcher.java
Patch:
@@ -146,7 +146,7 @@ public boolean onLongClick(View v) {
                         }
                         for (IInputButtonDecorator decorator : DECORATORS) {
                             try {
-                                if (decorator.doDecorate(text, session, input, sendBtn, ctx1, qqApp)) {
+                                if (decorator.isEnabled() && decorator.doDecorate(text, session, input, sendBtn, ctx1, qqApp)) {
                                     return true;
                                 }
                             } catch (Throwable e) {

File: app/src/main/java/io/github/qauxv/startup/StartupRoutine.java
Patch:
@@ -23,6 +23,7 @@
 
 import android.app.Application;
 import android.content.Context;
+import cc.ioctl.hook.AppCenterFix;
 import com.github.kyuubiran.ezxhelper.init.EzXHelperInit;
 import io.github.qauxv.core.MainHook;
 import io.github.qauxv.util.HostInfo;
@@ -59,6 +60,7 @@ public static void execPostStartupInit(Context ctx, Object step, String lpwReser
         } catch (Exception | LinkageError e3) {
             Log.e(e3);
         }
+        AppCenterFix.init();
         MainHook.getInstance().performHook(ctx, step);
     }
 }

File: app/src/main/java/cc/ioctl/hook/FakeBatteryHook.java
Patch:
@@ -34,11 +34,13 @@
 import android.view.View;
 import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
+import cc.ioctl.fragment.FakeBatteryConfigFragment;
 import cc.ioctl.util.HostInfo;
 import de.robv.android.xposed.XC_MethodHook;
 import de.robv.android.xposed.XposedBridge;
 import de.robv.android.xposed.XposedHelpers;
 import io.github.qauxv.SyncUtils;
+import io.github.qauxv.activity.SettingsUiFragmentHostActivity;
 import io.github.qauxv.base.ISwitchCellAgent;
 import io.github.qauxv.base.IUiItemAgent;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
@@ -394,7 +396,7 @@ public int getTargetProcesses() {
     }
 
     public static void onItemClicked(Activity activity) {
-        // TODO: 2022-02-01 add settings UI
+        SettingsUiFragmentHostActivity.startFragmentWithContext(activity, FakeBatteryConfigFragment.class, null);
     }
 
     @NonNull

File: app/src/main/java/cc/ioctl/hook/JumpController.java
Patch:
@@ -350,7 +350,7 @@ public void updateStateValue() {
     @Override
     public Function3<IUiItemAgent, Activity, View, Unit> getOnUiItemClickListener() {
         return (agent, activity, view) -> {
-            SettingsUiFragmentHostActivity.startActivityForFragment(activity, JefsRuleConfigFragment.class, null);
+            SettingsUiFragmentHostActivity.startFragmentWithContext(activity, JefsRuleConfigFragment.class, null);
             return Unit.INSTANCE;
         };
     }

File: app/src/main/java/io/github/qauxv/activity/AppCompatTransferActivity.java
Patch:
@@ -29,7 +29,7 @@
 import io.github.qauxv.util.CliOper;
 import io.github.qauxv.util.SavedInstanceStatePatchedClassReferencer;
 
-public class AppCompatTransferActivity extends AppCompatActivity {
+public abstract class AppCompatTransferActivity extends AppCompatActivity {
 
     private ClassLoader mXref = null;
 

File: app/src/main/java/cc/ioctl/hook/SettingEntryHook.java
Patch:
@@ -57,7 +57,7 @@ public boolean initOnce() throws Exception {
         return true;
     }
 
-    private final XC_MethodHook mAddModuleEntry = new XC_MethodHook(54) {
+    private final XC_MethodHook mAddModuleEntry = new XC_MethodHook(51) {
         @Override
         protected void afterHookedMethod(final MethodHookParam param) throws Throwable {
             try {

File: app/src/main/java/cc/ioctl/hook/GalleryBgHook.java
Patch:
@@ -39,7 +39,7 @@
 @UiItemAgentEntry
 public class GalleryBgHook extends CommonSwitchFunctionHook {
 
-    private static final GalleryBgHook INSTANCE = new GalleryBgHook();
+    public static final GalleryBgHook INSTANCE = new GalleryBgHook();
 
     private GalleryBgHook() {
         super(SyncUtils.PROC_PEAK, new int[]{DexKit.C_ABS_GAL_SCENE});

File: app/src/main/java/com/rymmmmm/hook/DisableShakeWindow.java
Patch:
@@ -37,7 +37,7 @@
 @FunctionHookEntry
 public class DisableShakeWindow extends CommonSwitchFunctionHook {
 
-    private static final DisableShakeWindow INSTANCE = new DisableShakeWindow();
+    public static final DisableShakeWindow INSTANCE = new DisableShakeWindow();
 
     private DisableShakeWindow() {
         super("rq_disable_shake_window");

File: app/src/main/java/io/github/qauxv/core/HookInstaller.java
Patch:
@@ -39,9 +39,7 @@ public static IDynamicHook[] queryAllAnnotatedHooks() {
         }
         synchronized (HookInstaller.class) {
             if (sAnnotatedHooks == null) {
-                throw new UnsupportedOperationException("Not supported yet.");
-                // TODO: 2022-02-08 add
-//                sAnnotatedHooks = io.github.qauxv.gen.HookProvider.queryAllAnnotatedHooks();
+                sAnnotatedHooks = io.github.qauxv.gen.AnnotatedFunctionHookEntryList.getAnnotatedFunctionHookEntryList();
             }
         }
         return sAnnotatedHooks;

File: app/src/main/java/cc/ioctl/hook/AddAccount.java
Patch:
@@ -163,6 +163,6 @@ public String[] getUiItemLocation() {
     @NonNull
     @Override
     public String getItemAgentProviderUniqueIdentifier() {
-        return IUiItemAgentProvider.super.getItemAgentProviderUniqueIdentifier();
+        return getClass().getName();
     }
 }

File: app/src/main/java/cc/ioctl/hook/CheckCommonGroup.java
Patch:
@@ -168,6 +168,6 @@ public String[] getUiItemLocation() {
     @NonNull
     @Override
     public String getItemAgentProviderUniqueIdentifier() {
-        return IUiItemAgentProvider.super.getItemAgentProviderUniqueIdentifier();
+        return getClass().getName();
     }
 }

File: app/src/main/java/cc/ioctl/hook/DefaultBubbleHook.java
Patch:
@@ -211,6 +211,6 @@ public String[] getUiItemLocation() {
     @NonNull
     @Override
     public String getItemAgentProviderUniqueIdentifier() {
-        return IUiItemAgentProvider.super.getItemAgentProviderUniqueIdentifier();
+        return getClass().getName();
     }
 }

File: app/src/main/java/cc/ioctl/hook/FileRecvRedirect.java
Patch:
@@ -86,9 +86,7 @@ public MutableStateFlow<String> getValueState() {
     @Override
     public Function3<IUiItemAgent, Activity, View, Unit> getOnUiItemClickListener() {
         return (agent, activity, view) -> {
-            Intent intent = new Intent(activity, FileRecvRedirectActivity.class);
-            activity.startActivity(intent);
-            return Unit.INSTANCE;
+            throw new NoClassDefFoundError("FileRecvRedirectActivity");
         };
     }
 

File: app/src/main/java/cc/ioctl/hook/FriendDeletionNotification.java
Patch:
@@ -26,7 +26,7 @@
 import androidx.annotation.Nullable;
 import io.github.qauxv.base.annotation.FunctionHookEntry;
 import io.github.qauxv.base.annotation.UiItemAgentEntry;
-import io.github.qauxv.dsl.FunctionEntryRouter.Locations;
+import io.github.qauxv.dsl.FunctionEntryRouter.Locations.Auxiliary;
 import io.github.qauxv.hook.CommonSwitchFunctionHook;
 import java.util.List;
 
@@ -60,7 +60,7 @@ public String getDescription() {
     @NonNull
     @Override
     public String[] getUiItemLocation() {
-        return Locations.PASSIVE_AUXILIARY_CATEGORY;
+        return Auxiliary.FRIEND_CATEGORY;
     }
 
     @NonNull

File: app/src/main/java/cc/ioctl/hook/PttForwardHook.java
Patch:
@@ -54,6 +54,7 @@
 import androidx.core.view.ViewCompat;
 import cc.ioctl.util.DebugUtils;
 import cc.ioctl.util.HookUtils;
+import cc.ioctl.util.HostStyledViewBuilder;
 import cc.ioctl.util.Reflex;
 import cc.ioctl.util.ui.drawable.HighContrastBorder;
 import de.robv.android.xposed.XC_MethodHook;
@@ -296,10 +297,10 @@ protected void beforeHookedMethod(MethodHookParam param) throws Throwable {
                 heads.setGravity(Gravity.CENTER_VERTICAL);
                 heads.setOrientation(LinearLayout.HORIZONTAL);
                 View div = new View(ctx);
-                div.setBackgroundColor(ResUtils.skin_gray3.getDefaultColor());
+                div.setBackgroundColor(HostStyledViewBuilder.getColorSkinGray3());
                 TextView tv = new TextView(ctx);
                 tv.setText("[语音转发]" + path);
-                tv.setTextColor(ResUtils.skin_gray3);
+                tv.setTextColor(HostStyledViewBuilder.getColorSkinGray3());
                 tv.setTextSize(dip2sp(ctx, 16));
                 int pd = dip2px(ctx, 8);
                 tv.setPadding(pd, pd, pd, pd);

File: app/src/main/java/io/github/qauxv/SyncUtils.java
Patch:
@@ -32,7 +32,7 @@
 import androidx.annotation.NonNull;
 import cc.ioctl.util.HostInfo;
 import io.github.qauxv.base.IDynamicHook;
-import io.github.qauxv.core.InjectDelayableHooks;
+import io.github.qauxv.core.HookInstaller;
 import io.github.qauxv.util.Log;
 import java.util.ArrayList;
 import java.util.Collection;
@@ -423,7 +423,7 @@ public void onReceive(Context ctx, Intent intent) {
                     int targetType = intent.getIntExtra("process", 0);
                     int hookId = intent.getIntExtra("hook", -1);
                     if (hookId != -1 && (myType & targetType) != 0) {
-                        IDynamicHook hook = InjectDelayableHooks.getHookByType(hookId);
+                        IDynamicHook hook = HookInstaller.getHookById(hookId);
                         if (hook != null && hook.isAvailable() && hook.isTargetProcess()
                             && !hook.isPreparationRequired()) {
                             try {

File: app/src/main/java/io/github/qauxv/ui/CommonContextWrapper.java
Patch:
@@ -110,7 +110,7 @@ public static CommonContextWrapper createAppCompatContext(@NonNull Context base)
 
     @NonNull
     public static CommonContextWrapper createMaterialDesignContext(@NonNull Context base) {
-        return new CommonContextWrapper(base, R.style.Theme_MaiTungTMUI,
+        return new CommonContextWrapper(base, R.style.Theme_MaiTungTMDesign,
             recreateNighModeConfig(base, ResUtils.getNightModeMasked()));
     }
 }

File: app/src/main/java/io/github/qauxv/startup/StartupRoutine.java
Patch:
@@ -52,7 +52,7 @@ public static void execPostStartupInit(Context ctx, Object step, String lpwReser
         EzXHelperInit.INSTANCE.initHandleLoadPackage(HookEntry.getLoadPackageParam());
         // resource injection is done somewhere else, do not init it here
         EzXHelperInit.INSTANCE.initAppContext(ctx, false, false);
-        HostInfoKt.init((Application) ctx);
+        HostInfo.init((Application) ctx);
         Initiator.init(ctx.getClassLoader());
         try {
             Natives.load(ctx);

